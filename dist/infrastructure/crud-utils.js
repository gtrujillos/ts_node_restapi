var a146_0x451b=['send','stack','find','query','limit','findAll','created_by_user_id','updated_by_user_id','deleted_by_user_id','created_at','updated_at','default','headers','toJSON','toJSONLocalizedOnly','lang','env','IMAGE_FILES_FOLDER','images/','uuid','.jpg','base64Sync','parse','stringify','image_data','findByUuid','findOne','existsSync','save','body','password','generateHash','user_uuid','user_id','findUuidAndUpdate','create','dataValues','findByPk','update','saveImageFile','bind','findOrCreate','remove','authentication\x20failed','findById','destroy','match','png','jpg','ensureDirSync','writeFile','log','__importDefault','defineProperty','__esModule','./sequelize-utils','../infrastructure/auth-utils','fs-extra','base64-img','i18n','count','user','length','model','params','then','json','catch','status'];(function(_0x7e35f3,_0x587d99){var _0x47b3ba=function(_0x581253){while(--_0x581253){_0x7e35f3['push'](_0x7e35f3['shift']());}};_0x47b3ba(++_0x587d99);}(a146_0x451b,0x18d));var a146_0x2673=function(_0x237690,_0x224bb9){_0x237690=_0x237690-0x0;var _0x3df843=a146_0x451b[_0x237690];return _0x3df843;};'use strict';var __importDefault=this&&this[a146_0x2673('0x0')]||function(_0x5e58ad){return _0x5e58ad&&_0x5e58ad['__esModule']?_0x5e58ad:{'default':_0x5e58ad};};Object[a146_0x2673('0x1')](exports,a146_0x2673('0x2'),{'value':!![]});const sequelize_utils_1=__importDefault(require(a146_0x2673('0x3')));const authUtils=require(a146_0x2673('0x4'));const fsExtra=require(a146_0x2673('0x5'));const base64Img=require(a146_0x2673('0x6'));class CrudUtils{constructor(_0x41481c,_0x1500ab){this['model']=_0x41481c;this[a146_0x2673('0x7')]=_0x1500ab;}[a146_0x2673('0x8')](_0x38c0bf,_0x4f80bc,_0x3bebb8){if(!_0x38c0bf[a146_0x2673('0x9')]||_0x38c0bf['user'][a146_0x2673('0xa')]==0x0){}return this[a146_0x2673('0xb')]['count']({'where':_0x38c0bf[a146_0x2673('0xc')]})[a146_0x2673('0xd')](_0x3d6509=>{const _0x3ba7a1=_0x3d6509;if(_0x4f80bc){return _0x4f80bc[a146_0x2673('0xe')]({'success':!![],'data':{'total':_0x3d6509}});}else{return _0x3ba7a1;}})[a146_0x2673('0xf')](_0x386f38=>{if(_0x4f80bc){return _0x4f80bc[a146_0x2673('0x10')](0x1f4)[a146_0x2673('0x11')]({'success':![],'data':_0x386f38[a146_0x2673('0x12')]});}else{return _0x386f38[a146_0x2673('0x12')];}});}[a146_0x2673('0x13')](_0x161218,_0x398c74,_0x2dfe0f,_0xf5f5d7=![],_0x13887a=[],_0x218af=null){const _0xa245a8=_0x161218[a146_0x2673('0x14')]['offset']?Number(_0x161218[a146_0x2673('0x14')]['offset']):null;const _0x4bd216=_0x161218[a146_0x2673('0x14')][a146_0x2673('0x15')]?Number(_0x161218['query'][a146_0x2673('0x15')]):null;if(!_0x161218['user']||_0x161218[a146_0x2673('0x9')][a146_0x2673('0xa')]==0x0){}return this[a146_0x2673('0xb')][a146_0x2673('0x16')]({'attributes':{'exclude':_0xf5f5d7?[]:[a146_0x2673('0x17'),a146_0x2673('0x18'),a146_0x2673('0x19'),a146_0x2673('0x1a'),a146_0x2673('0x1b'),'deleted_at']},'where':_0x161218[a146_0x2673('0xc')],'offset':_0xa245a8,'limit':_0x4bd216,'include':_0x13887a,'order':_0x218af})[a146_0x2673('0xd')](_0x583ddf=>{const _0xe6d4d3=this[a146_0x2673('0x7')]?sequelize_utils_1[a146_0x2673('0x1c')]['toJSONLocalizedOnly'](_0x583ddf,_0x161218[a146_0x2673('0x1d')]['lang']):sequelize_utils_1['default'][a146_0x2673('0x1e')](_0x583ddf);if(_0x398c74){return _0x398c74['json']({'success':!![],'data':_0xe6d4d3});}else{return _0xe6d4d3;}})['catch'](_0x41e329=>{if(_0x398c74){return _0x398c74[a146_0x2673('0x10')](0x1f4)['send']({'success':![],'data':_0x41e329[a146_0x2673('0x12')]});}else{return _0x41e329[a146_0x2673('0x12')];}});}['findById'](_0x3de6e7,_0x491b56,_0x30f467){if(!_0x3de6e7[a146_0x2673('0x9')]||_0x3de6e7['user'][a146_0x2673('0xa')]==0x0){}this[a146_0x2673('0xb')]['findById'](_0x3de6e7[a146_0x2673('0xc')]['id'])['then'](_0x1b7d2d=>{let _0x5757ea=this['i18n']?sequelize_utils_1[a146_0x2673('0x1c')][a146_0x2673('0x1f')](_0x1b7d2d,_0x3de6e7[a146_0x2673('0x1d')][a146_0x2673('0x20')]):_0x1b7d2d;if(_0x5757ea){const _0x3db905=process[a146_0x2673('0x21')][a146_0x2673('0x22')]+a146_0x2673('0x23')+_0x5757ea[a146_0x2673('0x24')]+a146_0x2673('0x25');let _0x551418=null;if(fsExtra['existsSync'](_0x3db905)){_0x551418=base64Img[a146_0x2673('0x26')](_0x3db905);_0x5757ea=JSON[a146_0x2673('0x27')](JSON[a146_0x2673('0x28')](_0x5757ea));_0x5757ea[a146_0x2673('0x29')]=_0x551418;}}return _0x491b56[a146_0x2673('0xe')]({'success':!![],'data':_0x5757ea});})['catch'](_0x166f3e=>{return _0x491b56[a146_0x2673('0x10')](0x1f4)[a146_0x2673('0x11')]({'success':![],'data':_0x166f3e['stack']});});}[a146_0x2673('0x2a')](_0x2309bc,_0x358ccd,_0xe65590){if(!_0x2309bc[a146_0x2673('0x9')]||_0x2309bc[a146_0x2673('0x9')]['length']==0x0){}this[a146_0x2673('0xb')][a146_0x2673('0x2b')]({'attributes':{'exclude':['id',a146_0x2673('0x17'),a146_0x2673('0x18'),'deleted_by_user_id',a146_0x2673('0x1a'),'updated_at','deleted_at']},'where':{'uuid':_0x2309bc[a146_0x2673('0xc')][a146_0x2673('0x24')]}})[a146_0x2673('0xd')](_0xf5e355=>{let _0x251e4f=this[a146_0x2673('0x7')]?sequelize_utils_1[a146_0x2673('0x1c')]['toJSONLocalizedOnly'](_0xf5e355,_0x2309bc[a146_0x2673('0x1d')][a146_0x2673('0x20')]):_0xf5e355;if(_0x251e4f){const _0x3acf92=process[a146_0x2673('0x21')]['IMAGE_FILES_FOLDER']+a146_0x2673('0x23')+_0x251e4f[a146_0x2673('0x24')]+a146_0x2673('0x25');let _0x41987f=null;if(fsExtra[a146_0x2673('0x2c')](_0x3acf92)){_0x41987f=base64Img['base64Sync'](_0x3acf92);_0x251e4f=JSON[a146_0x2673('0x27')](JSON[a146_0x2673('0x28')](_0x251e4f));_0x251e4f['image_data']=_0x41987f;}}return _0x358ccd['json']({'success':!![],'data':_0x251e4f});})[a146_0x2673('0xf')](_0x1b73d6=>{return _0x358ccd[a146_0x2673('0x10')](0x1f4)['send']({'success':![],'data':_0x1b73d6[a146_0x2673('0x12')]});});}[a146_0x2673('0x2d')](_0x28c0cc,_0x315a25,_0x5b9967){if(!_0x28c0cc[a146_0x2673('0x9')]||_0x28c0cc[a146_0x2673('0x9')][a146_0x2673('0xa')]==0x0){}if(_0x28c0cc[a146_0x2673('0x9')]&&_0x28c0cc[a146_0x2673('0x9')][a146_0x2673('0xa')]>0x0){_0x28c0cc[a146_0x2673('0x2e')][a146_0x2673('0x17')]=_0x28c0cc[a146_0x2673('0x9')][0x0]['id'];}if(_0x28c0cc[a146_0x2673('0x2e')][a146_0x2673('0x2f')]&&_0x28c0cc[a146_0x2673('0x2e')][a146_0x2673('0x2f')]!=''){_0x28c0cc['body'][a146_0x2673('0x2f')]=authUtils[a146_0x2673('0x30')](_0x28c0cc[a146_0x2673('0x2e')][a146_0x2673('0x2f')]);}if(_0x28c0cc['body'][a146_0x2673('0x31')]&&_0x28c0cc[a146_0x2673('0x2e')]['user_uuid']!=''){_0x28c0cc[a146_0x2673('0x2e')][a146_0x2673('0x32')]='1';}if(_0x28c0cc[a146_0x2673('0x2e')]['uuid']&&_0x28c0cc['body']['uuid']!=''){return this[a146_0x2673('0x33')](_0x28c0cc,_0x315a25,_0x5b9967);}else{return this[a146_0x2673('0xb')][a146_0x2673('0x34')](_0x28c0cc[a146_0x2673('0x2e')],this[a146_0x2673('0x7')]?{'language_id':_0x28c0cc[a146_0x2673('0x1d')][a146_0x2673('0x20')]}:{})[a146_0x2673('0xd')](_0x52d74c=>{const _0x377894=this[a146_0x2673('0x7')]?sequelize_utils_1[a146_0x2673('0x1c')][a146_0x2673('0x1f')](_0x52d74c,_0x28c0cc[a146_0x2673('0x1d')][a146_0x2673('0x20')]):_0x52d74c;delete _0x377894[a146_0x2673('0x35')]['id'];delete _0x377894[a146_0x2673('0x35')][a146_0x2673('0x17')];delete _0x377894[a146_0x2673('0x35')][a146_0x2673('0x18')];delete _0x377894[a146_0x2673('0x35')][a146_0x2673('0x19')];delete _0x377894[a146_0x2673('0x35')][a146_0x2673('0x1a')];delete _0x377894[a146_0x2673('0x35')]['updated_at'];delete _0x377894[a146_0x2673('0x35')]['deleted_at'];delete _0x377894[a146_0x2673('0x35')][a146_0x2673('0x2f')];this['saveImageFile'](_0x28c0cc,_0x377894);if(_0x315a25){return _0x315a25[a146_0x2673('0xe')]({'success':!![],'data':_0x377894});}else{return _0x377894;}})[a146_0x2673('0xf')](_0xc0e029=>{if(_0x315a25){return _0x315a25[a146_0x2673('0x10')](0x1f4)['send']({'success':![],'data':_0xc0e029[a146_0x2673('0x12')]});}else{return _0xc0e029[a146_0x2673('0x12')];}});}}['findOneAndUpdate'](_0x56539d,_0xb35721,_0x2eb79e){if(!_0x56539d[a146_0x2673('0x9')]||_0x56539d['user'][a146_0x2673('0xa')]==0x0){}if(_0x56539d['user']&&_0x56539d[a146_0x2673('0x9')][a146_0x2673('0xa')]>0x0){}this[a146_0x2673('0xb')][a146_0x2673('0x36')](_0x56539d[a146_0x2673('0x2e')]['id'])[a146_0x2673('0xd')](_0x5ed9e1=>{if(_0x5ed9e1==null)return _0xb35721[a146_0x2673('0xe')]({'success':!![],'data':_0x5ed9e1});_0x5ed9e1[a146_0x2673('0x37')](_0x56539d[a146_0x2673('0x2e')],{'language_id':_0x56539d['headers'][a146_0x2673('0x20')]})[a146_0x2673('0xd')](function(_0x3d23b6){const _0x3bc8e8=this['i18n']?sequelize_utils_1[a146_0x2673('0x1c')][a146_0x2673('0x1f')](_0x5ed9e1,_0x56539d[a146_0x2673('0x1d')][a146_0x2673('0x20')]):_0x5ed9e1;return _0xb35721['json']({'success':!![],'data':_0x3bc8e8});}['bind'](this))['catch'](_0x577152=>{return _0xb35721['status'](0x1f4)[a146_0x2673('0x11')]({'success':![],'data':_0x577152[a146_0x2673('0x12')]});});})[a146_0x2673('0xf')](_0x19bfb3=>{return _0xb35721[a146_0x2673('0x10')](0x1f4)[a146_0x2673('0x11')]({'success':![],'data':_0x19bfb3[a146_0x2673('0x12')]});});}[a146_0x2673('0x33')](_0x51915f,_0xec9296,_0x7afa9c){if(!_0x51915f[a146_0x2673('0x9')]||_0x51915f[a146_0x2673('0x9')][a146_0x2673('0xa')]==0x0){}if(_0x51915f[a146_0x2673('0x9')]&&_0x51915f[a146_0x2673('0x9')][a146_0x2673('0xa')]>0x0){}console['log'](_0x51915f[a146_0x2673('0xc')]);const _0x4d1b8e=_0x51915f[a146_0x2673('0x2e')][a146_0x2673('0x24')]&&_0x51915f[a146_0x2673('0x2e')]['uuid']!=''?_0x51915f[a146_0x2673('0x2e')][a146_0x2673('0x24')]:_0x51915f[a146_0x2673('0xc')][a146_0x2673('0x24')];this[a146_0x2673('0xb')]['findOne']({'where':{'uuid':_0x4d1b8e}})[a146_0x2673('0xd')](_0x5c4054=>{if(_0x5c4054==null)return _0xec9296[a146_0x2673('0xe')]({'success':!![],'data':_0x5c4054});_0x5c4054[a146_0x2673('0x37')](_0x51915f[a146_0x2673('0x2e')],{'language_id':_0x51915f[a146_0x2673('0x1d')][a146_0x2673('0x20')]})['then'](function(_0x296a80){const _0x1056f0=this[a146_0x2673('0x7')]?sequelize_utils_1[a146_0x2673('0x1c')][a146_0x2673('0x1f')](_0x5c4054,_0x51915f[a146_0x2673('0x1d')][a146_0x2673('0x20')]):_0x5c4054;this[a146_0x2673('0x38')](_0x51915f,_0x1056f0);return _0xec9296[a146_0x2673('0xe')]({'success':!![],'data':_0x1056f0});}[a146_0x2673('0x39')](this))[a146_0x2673('0xf')](_0x5e29c0=>{return _0xec9296[a146_0x2673('0x10')](0x1f4)[a146_0x2673('0x11')]({'success':![],'data':_0x5e29c0[a146_0x2673('0x12')]});});})['catch'](_0x47abf0=>{return _0xec9296[a146_0x2673('0x10')](0x1f4)[a146_0x2673('0x11')]({'success':![],'data':_0x47abf0[a146_0x2673('0x12')]});});}['updateOrCreate'](_0xed96f1,_0x224f00,_0xdae2ba,_0x1b21e5=![]){if(!_0xed96f1[a146_0x2673('0x9')]||_0xed96f1['user'][a146_0x2673('0xa')]==0x0){}if(_0xed96f1[a146_0x2673('0x9')]&&_0xed96f1['user'][a146_0x2673('0xa')]>0x0){}return this[a146_0x2673('0xb')]['findOne']({'where':_0xed96f1['params']})['then'](function(_0x32162e){if(_0x32162e){return _0x32162e[a146_0x2673('0x37')](_0xed96f1[a146_0x2673('0x2e')])[a146_0x2673('0xd')](function(_0x56e172){const _0x57b85f=_0x56e172['dataValues'];if(_0x1b21e5){delete _0x57b85f['id'];}if(_0x224f00){return _0x224f00['json']({'success':!![],'data':_0x57b85f});}else{return _0x57b85f;}}[a146_0x2673('0x39')](this));}else{return this[a146_0x2673('0xb')]['create'](_0xed96f1['body'])[a146_0x2673('0xd')](function(_0x1ebd08){if(_0x224f00){return _0x224f00[a146_0x2673('0xe')]({'success':!![],'data':_0x1ebd08[a146_0x2673('0x1e')]()});}else{return _0x1ebd08;}});}}[a146_0x2673('0x39')](this))[a146_0x2673('0xf')](_0x598481=>{if(_0x224f00){return _0x224f00[a146_0x2673('0x10')](0x1f4)['send']({'success':![],'data':_0x598481[a146_0x2673('0x12')]});}else{return _0x598481[a146_0x2673('0x12')];}});}[a146_0x2673('0x3a')](_0x16c5c3,_0x22995a,_0x20b65d){if(!_0x16c5c3[a146_0x2673('0x9')]||_0x16c5c3['user']['length']==0x0){}if(_0x16c5c3['user']&&_0x16c5c3['user'][a146_0x2673('0xa')]>0x0){}return this[a146_0x2673('0xb')]['findOrCreate']({'where':{'uuid':_0x16c5c3[a146_0x2673('0x2e')][a146_0x2673('0x24')]},'defaults':_0x16c5c3['body']})[a146_0x2673('0xd')]((_0x204862,_0x50deee)=>{if(_0x50deee){}else{}return _0x22995a['json']({'success':!![],'data':_0x204862});})[a146_0x2673('0xf')](_0x198c9e=>{return _0x22995a['status'](0x1f4)[a146_0x2673('0x11')]({'success':![],'data':_0x198c9e['stack']});});}[a146_0x2673('0x3b')](_0x2a8406,_0x492362,_0x45fe6a){if(!_0x2a8406['user']||_0x2a8406[a146_0x2673('0x9')]['length']==0x0){return _0x492362[a146_0x2673('0x10')](0x191)[a146_0x2673('0x11')]({'success':![],'data':a146_0x2673('0x3c')});}if(_0x2a8406[a146_0x2673('0x9')]&&_0x2a8406['user']['length']>0x0){_0x2a8406[a146_0x2673('0x2e')][a146_0x2673('0x17')]=_0x2a8406[a146_0x2673('0x9')][0x0]['id'];}this['model'][a146_0x2673('0x3d')](_0x2a8406['params']['id'])[a146_0x2673('0xd')](_0x3e2c71=>{if(_0x3e2c71==null)return _0x492362[a146_0x2673('0xe')]({'success':!![],'data':_0x3e2c71});_0x3e2c71[a146_0x2673('0x3e')]()[a146_0x2673('0xd')](function(_0x430002){const _0x2c63a7=this['i18n']?sequelize_utils_1['default'][a146_0x2673('0x1f')](_0x3e2c71,_0x2a8406[a146_0x2673('0x1d')][a146_0x2673('0x20')]):_0x3e2c71;return _0x492362['json']({'success':!![],'data':_0x2c63a7});})[a146_0x2673('0xf')](_0x7680c2=>{return _0x492362[a146_0x2673('0x10')](0x1f4)[a146_0x2673('0x11')]({'success':![],'data':_0x7680c2[a146_0x2673('0x12')]});});})[a146_0x2673('0xf')](_0x647508=>{return _0x492362[a146_0x2673('0x10')](0x1f4)[a146_0x2673('0x11')]({'success':![],'data':_0x647508['stack']});});}['saveImageFile'](_0x5503b4,_0x2bae15){if(_0x5503b4[a146_0x2673('0x2e')][a146_0x2673('0x29')]&&_0x5503b4[a146_0x2673('0x2e')][a146_0x2673('0x29')]!=''){const _0x47d465=process['env']['IMAGE_FILES_FOLDER']+'images/';const _0x4187c5=_0x5503b4[a146_0x2673('0x2e')][a146_0x2673('0x29')];let _0x3d0b04='';const _0x2dbc88=_0x4187c5['replace'](/^data:image\/(png|jpeg);base64,/,'');if(_0x4187c5[a146_0x2673('0x3f')](/^data:image\/png;base64,/,'')){_0x3d0b04=a146_0x2673('0x40');}else if(_0x4187c5['match'](/^data:image\/(jpg|jpeg);base64,/,'')){_0x3d0b04=a146_0x2673('0x41');}fsExtra[a146_0x2673('0x42')](_0x47d465);const _0x2db014=''+_0x47d465+_0x2bae15[a146_0x2673('0x35')][a146_0x2673('0x24')]+'.'+_0x3d0b04;fsExtra[a146_0x2673('0x43')](_0x2db014,_0x2dbc88,'base64',function(_0x36d7c){console[a146_0x2673('0x44')](_0x36d7c);});}}}exports['default']=CrudUtils;
var a201_0x32a0=['express-ts@starter.com','Your\x20password\x20has\x20been\x20changed','\x20has\x20just\x20been\x20changed.\x0a','Success!\x20Your\x20password\x20has\x20been\x20changed.','getForgot','account/forgot','Forgot\x20Password','postForgot','randomBytes','toString','hex','Reset\x20your\x20password\x20on\x20Hackathon\x20Starter','You\x20are\x20receiving\x20this\x20email\x20because\x20you\x20(or\x20someone\x20else)\x20have\x20requested\x20the\x20reset\x20of\x20the\x20password\x20for\x20your\x20account.\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Please\x20click\x20on\x20the\x20following\x20link,\x20or\x20paste\x20this\x20into\x20your\x20browser\x20to\x20complete\x20the\x20process:\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20http://','headers','host','/reset/','\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20If\x20you\x20did\x20not\x20request\x20this,\x20please\x20ignore\x20this\x20email\x20and\x20your\x20password\x20will\x20remain\x20unchanged.\x0a','__esModule','nodemailer','passport','getLogin','user','redirect','render','account/login','postLogin','assert','email','Email\x20is\x20not\x20valid','isEmail','password','Password\x20cannot\x20be\x20blank','notEmpty','sanitize','/login','default','authenticate','local','errors','message','logIn','flash','success','Success!\x20You\x20are\x20logged\x20in.','session','logout','account/signup','Create\x20Account','postSignup','Password\x20must\x20be\x20at\x20least\x204\x20characters\x20long','Passwords\x20do\x20not\x20match','equals','body','normalizeEmail','validationErrors','/signup','findOne','Account\x20with\x20that\x20email\x20address\x20already\x20exists.','save','account/profile','Account\x20Management','findById','name','gender','location','website','code','The\x20email\x20address\x20you\x20have\x20entered\x20is\x20already\x20associated\x20with\x20an\x20account.','/account','Profile\x20information\x20has\x20been\x20updated.','postUpdatePassword','len','confirmPassword','Password\x20has\x20been\x20changed.','postDeleteAccount','remove','Your\x20account\x20has\x20been\x20deleted.','params','provider','tokens','filter','kind','info','getReset','isAuthenticated','token','now','exec','/forgot','Password\x20Reset','postReset','Password\x20must\x20be\x20at\x20least\x204\x20characters\x20long.','Passwords\x20must\x20match.','back','waterfall','where','passwordResetExpires','passwordResetToken','createTransport','SendGrid','SENDGRID_USER','env','SENDGRID_PASSWORD'];(function(_0x2aadb4,_0x51c93b){var _0x2f661b=function(_0x20d24b){while(--_0x20d24b){_0x2aadb4['push'](_0x2aadb4['shift']());}};_0x2f661b(++_0x51c93b);}(a201_0x32a0,0x146));var a201_0x384f=function(_0x443b21,_0x50005b){_0x443b21=_0x443b21-0x0;var _0x13efc8=a201_0x32a0[_0x443b21];return _0x13efc8;};'use strict';var __importDefault=this&&this['__importDefault']||function(_0x5aeb42){return _0x5aeb42&&_0x5aeb42['__esModule']?_0x5aeb42:{'default':_0x5aeb42};};Object['defineProperty'](exports,a201_0x384f('0x0'),{'value':!![]});const async_1=__importDefault(require('async'));const crypto_1=__importDefault(require('crypto'));const nodemailer_1=__importDefault(require(a201_0x384f('0x1')));const passport_1=__importDefault(require(a201_0x384f('0x2')));const User_1=__importDefault(require('../models/User'));const request=require('express-validator');exports[a201_0x384f('0x3')]=(_0x3bd540,_0x42623f)=>{if(_0x3bd540[a201_0x384f('0x4')]){return _0x42623f[a201_0x384f('0x5')]('/');}_0x42623f[a201_0x384f('0x6')](a201_0x384f('0x7'),{'title':'Login'});};exports[a201_0x384f('0x8')]=(_0x8d67d5,_0x2d5895,_0x1aa06e)=>{_0x8d67d5[a201_0x384f('0x9')](a201_0x384f('0xa'),a201_0x384f('0xb'))[a201_0x384f('0xc')]();_0x8d67d5[a201_0x384f('0x9')](a201_0x384f('0xd'),a201_0x384f('0xe'))[a201_0x384f('0xf')]();_0x8d67d5[a201_0x384f('0x10')](a201_0x384f('0xa'))['normalizeEmail']({'gmail_remove_dots':![]});const _0x2fd1d9=_0x8d67d5['validationErrors']();if(_0x2fd1d9){_0x8d67d5['flash']('errors',_0x2fd1d9);return _0x2d5895['redirect'](a201_0x384f('0x11'));}passport_1[a201_0x384f('0x12')][a201_0x384f('0x13')](a201_0x384f('0x14'),(_0xd009bd,_0x3d3fbd,_0x4e6156)=>{if(_0xd009bd){return _0x1aa06e(_0xd009bd);}if(!_0x3d3fbd){_0x8d67d5['flash'](a201_0x384f('0x15'),_0x4e6156[a201_0x384f('0x16')]);return _0x2d5895[a201_0x384f('0x5')]('/login');}_0x8d67d5[a201_0x384f('0x17')](_0x3d3fbd,_0xd009bd=>{if(_0xd009bd){return _0x1aa06e(_0xd009bd);}_0x8d67d5[a201_0x384f('0x18')](a201_0x384f('0x19'),{'msg':a201_0x384f('0x1a')});_0x2d5895[a201_0x384f('0x5')](_0x8d67d5[a201_0x384f('0x1b')]['returnTo']||'/');});})(_0x8d67d5,_0x2d5895,_0x1aa06e);};exports[a201_0x384f('0x1c')]=(_0x250873,_0x121cfa)=>{_0x250873[a201_0x384f('0x1c')]();_0x121cfa['redirect']('/');};exports['getSignup']=(_0x46626d,_0x3f2235)=>{if(_0x46626d[a201_0x384f('0x4')]){return _0x3f2235[a201_0x384f('0x5')]('/');}_0x3f2235[a201_0x384f('0x6')](a201_0x384f('0x1d'),{'title':a201_0x384f('0x1e')});};exports[a201_0x384f('0x1f')]=(_0x53d2a1,_0x31cd1a,_0x1d3365)=>{_0x53d2a1[a201_0x384f('0x9')]('email','Email\x20is\x20not\x20valid')[a201_0x384f('0xc')]();_0x53d2a1['assert'](a201_0x384f('0xd'),a201_0x384f('0x20'))['len']({'min':0x4});_0x53d2a1[a201_0x384f('0x9')]('confirmPassword',a201_0x384f('0x21'))[a201_0x384f('0x22')](_0x53d2a1[a201_0x384f('0x23')][a201_0x384f('0xd')]);_0x53d2a1['sanitize'](a201_0x384f('0xa'))[a201_0x384f('0x24')]({'gmail_remove_dots':![]});const _0x3a88dd=_0x53d2a1[a201_0x384f('0x25')]();if(_0x3a88dd){_0x53d2a1['flash'](a201_0x384f('0x15'),_0x3a88dd);return _0x31cd1a[a201_0x384f('0x5')](a201_0x384f('0x26'));}const _0x54a320=new User_1[(a201_0x384f('0x12'))]({'email':_0x53d2a1['body'][a201_0x384f('0xa')],'password':_0x53d2a1['body']['password']});User_1['default'][a201_0x384f('0x27')]({'email':_0x53d2a1[a201_0x384f('0x23')][a201_0x384f('0xa')]},(_0x11ab3c,_0x5287b3)=>{if(_0x11ab3c){return _0x1d3365(_0x11ab3c);}if(_0x5287b3){_0x53d2a1['flash'](a201_0x384f('0x15'),{'msg':a201_0x384f('0x28')});return _0x31cd1a['redirect'](a201_0x384f('0x26'));}_0x54a320[a201_0x384f('0x29')](_0x11ab3c=>{if(_0x11ab3c){return _0x1d3365(_0x11ab3c);}_0x53d2a1[a201_0x384f('0x17')](_0x54a320,_0x11ab3c=>{if(_0x11ab3c){return _0x1d3365(_0x11ab3c);}_0x31cd1a[a201_0x384f('0x5')]('/');});});});};exports['getAccount']=(_0x156852,_0x1e97b4)=>{_0x1e97b4[a201_0x384f('0x6')](a201_0x384f('0x2a'),{'title':a201_0x384f('0x2b')});};exports['postUpdateProfile']=(_0x441e96,_0x202d08,_0x34678f)=>{_0x441e96['assert'](a201_0x384f('0xa'),'Please\x20enter\x20a\x20valid\x20email\x20address.')[a201_0x384f('0xc')]();_0x441e96['sanitize'](a201_0x384f('0xa'))[a201_0x384f('0x24')]({'gmail_remove_dots':![]});const _0x26a24c=_0x441e96[a201_0x384f('0x25')]();if(_0x26a24c){_0x441e96[a201_0x384f('0x18')](a201_0x384f('0x15'),_0x26a24c);return _0x202d08[a201_0x384f('0x5')]('/account');}User_1[a201_0x384f('0x12')][a201_0x384f('0x2c')](_0x441e96[a201_0x384f('0x4')]['id'],(_0x284cb0,_0x5c4b0f)=>{if(_0x284cb0){return _0x34678f(_0x284cb0);}_0x5c4b0f[a201_0x384f('0xa')]=_0x441e96[a201_0x384f('0x23')][a201_0x384f('0xa')]||'';_0x5c4b0f['profile']['name']=_0x441e96[a201_0x384f('0x23')][a201_0x384f('0x2d')]||'';_0x5c4b0f['profile']['gender']=_0x441e96[a201_0x384f('0x23')][a201_0x384f('0x2e')]||'';_0x5c4b0f['profile'][a201_0x384f('0x2f')]=_0x441e96[a201_0x384f('0x23')][a201_0x384f('0x2f')]||'';_0x5c4b0f['profile'][a201_0x384f('0x30')]=_0x441e96[a201_0x384f('0x23')][a201_0x384f('0x30')]||'';_0x5c4b0f[a201_0x384f('0x29')](_0x284cb0=>{if(_0x284cb0){if(_0x284cb0[a201_0x384f('0x31')]===0x2af8){_0x441e96[a201_0x384f('0x18')](a201_0x384f('0x15'),{'msg':a201_0x384f('0x32')});return _0x202d08[a201_0x384f('0x5')](a201_0x384f('0x33'));}return _0x34678f(_0x284cb0);}_0x441e96[a201_0x384f('0x18')]('success',{'msg':a201_0x384f('0x34')});_0x202d08['redirect'](a201_0x384f('0x33'));});});};exports[a201_0x384f('0x35')]=(_0x2b457b,_0x503b09,_0x5b9466)=>{_0x2b457b[a201_0x384f('0x9')]('password','Password\x20must\x20be\x20at\x20least\x204\x20characters\x20long')[a201_0x384f('0x36')]({'min':0x4});_0x2b457b[a201_0x384f('0x9')](a201_0x384f('0x37'),a201_0x384f('0x21'))[a201_0x384f('0x22')](_0x2b457b[a201_0x384f('0x23')][a201_0x384f('0xd')]);const _0x2cdca5=_0x2b457b[a201_0x384f('0x25')]();if(_0x2cdca5){_0x2b457b[a201_0x384f('0x18')](a201_0x384f('0x15'),_0x2cdca5);return _0x503b09[a201_0x384f('0x5')](a201_0x384f('0x33'));}User_1[a201_0x384f('0x12')]['findById'](_0x2b457b[a201_0x384f('0x4')]['id'],(_0x51473a,_0x22752f)=>{if(_0x51473a){return _0x5b9466(_0x51473a);}_0x22752f[a201_0x384f('0xd')]=_0x2b457b[a201_0x384f('0x23')][a201_0x384f('0xd')];_0x22752f['save'](_0x51473a=>{if(_0x51473a){return _0x5b9466(_0x51473a);}_0x2b457b[a201_0x384f('0x18')](a201_0x384f('0x19'),{'msg':a201_0x384f('0x38')});_0x503b09['redirect'](a201_0x384f('0x33'));});});};exports[a201_0x384f('0x39')]=(_0x42228b,_0x28a9a9,_0x16f447)=>{User_1[a201_0x384f('0x12')][a201_0x384f('0x3a')]({'_id':_0x42228b[a201_0x384f('0x4')]['id']},_0x1aae59=>{if(_0x1aae59){return _0x16f447(_0x1aae59);}_0x42228b['logout']();_0x42228b[a201_0x384f('0x18')]('info',{'msg':a201_0x384f('0x3b')});_0x28a9a9[a201_0x384f('0x5')]('/');});};exports['getOauthUnlink']=(_0x8870ac,_0x2d8400,_0x4414c3)=>{const _0x35e759=_0x8870ac[a201_0x384f('0x3c')][a201_0x384f('0x3d')];User_1[a201_0x384f('0x12')]['findById'](_0x8870ac[a201_0x384f('0x4')]['id'],(_0x2251a7,_0x2341cf)=>{if(_0x2251a7){return _0x4414c3(_0x2251a7);}_0x2341cf[_0x35e759]=undefined;_0x2341cf[a201_0x384f('0x3e')]=_0x2341cf[a201_0x384f('0x3e')][a201_0x384f('0x3f')](_0x1235eb=>_0x1235eb[a201_0x384f('0x40')]!==_0x35e759);_0x2341cf[a201_0x384f('0x29')](_0x2251a7=>{if(_0x2251a7){return _0x4414c3(_0x2251a7);}_0x8870ac['flash'](a201_0x384f('0x41'),{'msg':_0x35e759+'\x20account\x20has\x20been\x20unlinked.'});_0x2d8400[a201_0x384f('0x5')](a201_0x384f('0x33'));});});};exports[a201_0x384f('0x42')]=(_0x2b6b47,_0x449c44,_0x2cc300)=>{if(_0x2b6b47[a201_0x384f('0x43')]()){return _0x449c44[a201_0x384f('0x5')]('/');}User_1[a201_0x384f('0x12')][a201_0x384f('0x27')]({'passwordResetToken':_0x2b6b47[a201_0x384f('0x3c')][a201_0x384f('0x44')]})['where']('passwordResetExpires')['gt'](Date[a201_0x384f('0x45')]())[a201_0x384f('0x46')]((_0x2dcb32,_0x5d9412)=>{if(_0x2dcb32){return _0x2cc300(_0x2dcb32);}if(!_0x5d9412){_0x2b6b47['flash']('errors',{'msg':'Password\x20reset\x20token\x20is\x20invalid\x20or\x20has\x20expired.'});return _0x449c44['redirect'](a201_0x384f('0x47'));}_0x449c44[a201_0x384f('0x6')]('account/reset',{'title':a201_0x384f('0x48')});});};exports[a201_0x384f('0x49')]=(_0x7dcdb1,_0x1e3bc2,_0x363078)=>{_0x7dcdb1[a201_0x384f('0x9')](a201_0x384f('0xd'),a201_0x384f('0x4a'))[a201_0x384f('0x36')]({'min':0x4});_0x7dcdb1['assert']('confirm',a201_0x384f('0x4b'))[a201_0x384f('0x22')](_0x7dcdb1[a201_0x384f('0x23')][a201_0x384f('0xd')]);const _0x20965a=_0x7dcdb1['validationErrors']();if(_0x20965a){_0x7dcdb1[a201_0x384f('0x18')](a201_0x384f('0x15'),_0x20965a);return _0x1e3bc2['redirect'](a201_0x384f('0x4c'));}async_1['default'][a201_0x384f('0x4d')]([function resetPassword(_0xeed314){User_1[a201_0x384f('0x12')][a201_0x384f('0x27')]({'passwordResetToken':_0x7dcdb1['params'][a201_0x384f('0x44')]})[a201_0x384f('0x4e')](a201_0x384f('0x4f'))['gt'](Date[a201_0x384f('0x45')]())[a201_0x384f('0x46')]((_0x2e5ad7,_0x2db46a)=>{if(_0x2e5ad7){return _0x363078(_0x2e5ad7);}if(!_0x2db46a){_0x7dcdb1[a201_0x384f('0x18')](a201_0x384f('0x15'),{'msg':'Password\x20reset\x20token\x20is\x20invalid\x20or\x20has\x20expired.'});return _0x1e3bc2['redirect'](a201_0x384f('0x4c'));}_0x2db46a[a201_0x384f('0xd')]=_0x7dcdb1['body'][a201_0x384f('0xd')];_0x2db46a[a201_0x384f('0x50')]=undefined;_0x2db46a['passwordResetExpires']=undefined;_0x2db46a[a201_0x384f('0x29')](_0x2e5ad7=>{if(_0x2e5ad7){return _0x363078(_0x2e5ad7);}_0x7dcdb1[a201_0x384f('0x17')](_0x2db46a,_0x2e5ad7=>{_0xeed314(_0x2e5ad7,_0x2db46a);});});});},function sendResetPasswordEmail(_0x2bbac5,_0x4864bd){const _0x3f4f0a=nodemailer_1[a201_0x384f('0x12')][a201_0x384f('0x51')]({'service':a201_0x384f('0x52'),'auth':{'user':process['env'][a201_0x384f('0x53')],'pass':process[a201_0x384f('0x54')][a201_0x384f('0x55')]}});const _0x2f0196={'to':_0x2bbac5[a201_0x384f('0xa')],'from':a201_0x384f('0x56'),'subject':a201_0x384f('0x57'),'text':'Hello,\x0a\x0aThis\x20is\x20a\x20confirmation\x20that\x20the\x20password\x20for\x20your\x20account\x20'+_0x2bbac5[a201_0x384f('0xa')]+a201_0x384f('0x58')};_0x3f4f0a['sendMail'](_0x2f0196,_0x1d66f5=>{_0x7dcdb1[a201_0x384f('0x18')]('success',{'msg':a201_0x384f('0x59')});_0x4864bd(_0x1d66f5);});}],_0x3ff213=>{if(_0x3ff213){return _0x363078(_0x3ff213);}_0x1e3bc2[a201_0x384f('0x5')]('/');});};exports[a201_0x384f('0x5a')]=(_0x196633,_0xe2688a)=>{if(_0x196633['isAuthenticated']()){return _0xe2688a[a201_0x384f('0x5')]('/');}_0xe2688a['render'](a201_0x384f('0x5b'),{'title':a201_0x384f('0x5c')});};exports[a201_0x384f('0x5d')]=(_0x202902,_0x2d5812,_0xc53e47)=>{_0x202902['assert'](a201_0x384f('0xa'),'Please\x20enter\x20a\x20valid\x20email\x20address.')[a201_0x384f('0xc')]();_0x202902[a201_0x384f('0x10')](a201_0x384f('0xa'))[a201_0x384f('0x24')]({'gmail_remove_dots':![]});const _0x2ba295=_0x202902['validationErrors']();if(_0x2ba295){_0x202902[a201_0x384f('0x18')]('errors',_0x2ba295);return _0x2d5812[a201_0x384f('0x5')](a201_0x384f('0x47'));}async_1[a201_0x384f('0x12')][a201_0x384f('0x4d')]([function createRandomToken(_0x59d355){crypto_1[a201_0x384f('0x12')][a201_0x384f('0x5e')](0x10,(_0xf50fa,_0x3a762d)=>{const _0x4c31eb=_0x3a762d[a201_0x384f('0x5f')](a201_0x384f('0x60'));_0x59d355(_0xf50fa,_0x4c31eb);});},function setRandomToken(_0x7275ee,_0xbf0e19){User_1[a201_0x384f('0x12')]['findOne']({'email':_0x202902[a201_0x384f('0x23')][a201_0x384f('0xa')]},(_0x1b159e,_0x579588)=>{if(_0x1b159e){return _0xbf0e19(_0x1b159e);}if(!_0x579588){_0x202902['flash'](a201_0x384f('0x15'),{'msg':'Account\x20with\x20that\x20email\x20address\x20does\x20not\x20exist.'});return _0x2d5812[a201_0x384f('0x5')]('/forgot');}_0x579588[a201_0x384f('0x50')]=_0x7275ee;_0x579588[a201_0x384f('0x4f')]=Date['now']()+0x36ee80;_0x579588[a201_0x384f('0x29')](_0x1b159e=>{_0xbf0e19(_0x1b159e,_0x7275ee,_0x579588);});});},function sendForgotPasswordEmail(_0x150997,_0x396c35,_0xda6be3){const _0x5d3b3e=nodemailer_1[a201_0x384f('0x12')]['createTransport']({'service':a201_0x384f('0x52'),'auth':{'user':process[a201_0x384f('0x54')][a201_0x384f('0x53')],'pass':process['env'][a201_0x384f('0x55')]}});const _0x2330ed={'to':_0x396c35[a201_0x384f('0xa')],'from':'hackathon@starter.com','subject':a201_0x384f('0x61'),'text':a201_0x384f('0x62')+_0x202902[a201_0x384f('0x63')][a201_0x384f('0x64')]+a201_0x384f('0x65')+_0x150997+a201_0x384f('0x66')};_0x5d3b3e['sendMail'](_0x2330ed,_0x222393=>{_0x202902['flash']('info',{'msg':'An\x20e-mail\x20has\x20been\x20sent\x20to\x20'+_0x396c35[a201_0x384f('0xa')]+'\x20with\x20further\x20instructions.'});_0xda6be3(_0x222393);});}],_0x4fd6c4=>{if(_0x4fd6c4){return _0xc53e47(_0x4fd6c4);}_0x2d5812[a201_0x384f('0x5')](a201_0x384f('0x47'));});};
var a91_0x14ea=['sendMail','Success!\x20Your\x20password\x20has\x20been\x20changed.','account/forgot','Forgot\x20Password','postForgot','Please\x20enter\x20a\x20valid\x20email\x20address.','/forgot','waterfall','randomBytes','Account\x20with\x20that\x20email\x20address\x20does\x20not\x20exist.','SENDGRID_PASSWORD','hackathon@starter.com','Reset\x20your\x20password\x20on\x20Hackathon\x20Starter','You\x20are\x20receiving\x20this\x20email\x20because\x20you\x20(or\x20someone\x20else)\x20have\x20requested\x20the\x20reset\x20of\x20the\x20password\x20for\x20your\x20account.\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Please\x20click\x20on\x20the\x20following\x20link,\x20or\x20paste\x20this\x20into\x20your\x20browser\x20to\x20complete\x20the\x20process:\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20http://','headers','host','\x20with\x20further\x20instructions.','__importDefault','__esModule','defineProperty','async','nodemailer','passport','user','render','account/login','Login','postLogin','assert','email','isEmail','Password\x20cannot\x20be\x20blank','sanitize','normalizeEmail','errors','redirect','/login','authenticate','local','flash','message','logIn','success','Success!\x20You\x20are\x20logged\x20in.','session','returnTo','logout','getSignup','Create\x20Account','Email\x20is\x20not\x20valid','password','confirmPassword','Passwords\x20do\x20not\x20match','equals','validationErrors','/signup','default','body','Account\x20with\x20that\x20email\x20address\x20already\x20exists.','save','getAccount','account/profile','Account\x20Management','/account','findById','profile','name','gender','location','website','code','The\x20email\x20address\x20you\x20have\x20entered\x20is\x20already\x20associated\x20with\x20an\x20account.','Password\x20must\x20be\x20at\x20least\x204\x20characters\x20long','len','Password\x20has\x20been\x20changed.','remove','Your\x20account\x20has\x20been\x20deleted.','params','tokens','filter','kind','info','\x20account\x20has\x20been\x20unlinked.','getReset','isAuthenticated','findOne','token','now','exec','account/reset','Password\x20Reset','postReset','confirm','Passwords\x20must\x20match.','back','passwordResetExpires','Password\x20reset\x20token\x20is\x20invalid\x20or\x20has\x20expired.','passwordResetToken','createTransport','SendGrid','env','SENDGRID_USER','express-ts@starter.com','Your\x20password\x20has\x20been\x20changed','\x20has\x20just\x20been\x20changed.\x0a'];(function(_0x4b4d86,_0x1c222d){var _0x4086a5=function(_0x4369fd){while(--_0x4369fd){_0x4b4d86['push'](_0x4b4d86['shift']());}};_0x4086a5(++_0x1c222d);}(a91_0x14ea,0x1b5));var a91_0x364e=function(_0x252f73,_0x339c98){_0x252f73=_0x252f73-0x0;var _0x170a9e=a91_0x14ea[_0x252f73];return _0x170a9e;};'use strict';var __importDefault=this&&this[a91_0x364e('0x0')]||function(_0x1aa060){return _0x1aa060&&_0x1aa060[a91_0x364e('0x1')]?_0x1aa060:{'default':_0x1aa060};};Object[a91_0x364e('0x2')](exports,a91_0x364e('0x1'),{'value':!![]});const async_1=__importDefault(require(a91_0x364e('0x3')));const crypto_1=__importDefault(require('crypto'));const nodemailer_1=__importDefault(require(a91_0x364e('0x4')));const passport_1=__importDefault(require(a91_0x364e('0x5')));const User_1=__importDefault(require('../models/User'));const request=require('express-validator');exports['getLogin']=(_0x25f948,_0x5ac6df)=>{if(_0x25f948[a91_0x364e('0x6')]){return _0x5ac6df['redirect']('/');}_0x5ac6df[a91_0x364e('0x7')](a91_0x364e('0x8'),{'title':a91_0x364e('0x9')});};exports[a91_0x364e('0xa')]=(_0x28a774,_0x3a0889,_0x529cf7)=>{_0x28a774[a91_0x364e('0xb')](a91_0x364e('0xc'),'Email\x20is\x20not\x20valid')[a91_0x364e('0xd')]();_0x28a774[a91_0x364e('0xb')]('password',a91_0x364e('0xe'))['notEmpty']();_0x28a774[a91_0x364e('0xf')]('email')[a91_0x364e('0x10')]({'gmail_remove_dots':![]});const _0x34b3ee=_0x28a774['validationErrors']();if(_0x34b3ee){_0x28a774['flash'](a91_0x364e('0x11'),_0x34b3ee);return _0x3a0889[a91_0x364e('0x12')](a91_0x364e('0x13'));}passport_1['default'][a91_0x364e('0x14')](a91_0x364e('0x15'),(_0x531ab7,_0x13f084,_0x29bac1)=>{if(_0x531ab7){return _0x529cf7(_0x531ab7);}if(!_0x13f084){_0x28a774[a91_0x364e('0x16')](a91_0x364e('0x11'),_0x29bac1[a91_0x364e('0x17')]);return _0x3a0889[a91_0x364e('0x12')](a91_0x364e('0x13'));}_0x28a774[a91_0x364e('0x18')](_0x13f084,_0x531ab7=>{if(_0x531ab7){return _0x529cf7(_0x531ab7);}_0x28a774[a91_0x364e('0x16')](a91_0x364e('0x19'),{'msg':a91_0x364e('0x1a')});_0x3a0889['redirect'](_0x28a774[a91_0x364e('0x1b')][a91_0x364e('0x1c')]||'/');});})(_0x28a774,_0x3a0889,_0x529cf7);};exports['logout']=(_0x1a463f,_0x256e4a)=>{_0x1a463f[a91_0x364e('0x1d')]();_0x256e4a['redirect']('/');};exports[a91_0x364e('0x1e')]=(_0x30a2f7,_0x526fb8)=>{if(_0x30a2f7['user']){return _0x526fb8[a91_0x364e('0x12')]('/');}_0x526fb8[a91_0x364e('0x7')]('account/signup',{'title':a91_0x364e('0x1f')});};exports['postSignup']=(_0x4d8790,_0x2a2b64,_0x4284f7)=>{_0x4d8790[a91_0x364e('0xb')]('email',a91_0x364e('0x20'))[a91_0x364e('0xd')]();_0x4d8790[a91_0x364e('0xb')](a91_0x364e('0x21'),'Password\x20must\x20be\x20at\x20least\x204\x20characters\x20long')['len']({'min':0x4});_0x4d8790[a91_0x364e('0xb')](a91_0x364e('0x22'),a91_0x364e('0x23'))[a91_0x364e('0x24')](_0x4d8790['body'][a91_0x364e('0x21')]);_0x4d8790['sanitize'](a91_0x364e('0xc'))['normalizeEmail']({'gmail_remove_dots':![]});const _0x26b4e2=_0x4d8790[a91_0x364e('0x25')]();if(_0x26b4e2){_0x4d8790[a91_0x364e('0x16')](a91_0x364e('0x11'),_0x26b4e2);return _0x2a2b64[a91_0x364e('0x12')](a91_0x364e('0x26'));}const _0x2e398d=new User_1[(a91_0x364e('0x27'))]({'email':_0x4d8790[a91_0x364e('0x28')][a91_0x364e('0xc')],'password':_0x4d8790['body'][a91_0x364e('0x21')]});User_1[a91_0x364e('0x27')]['findOne']({'email':_0x4d8790[a91_0x364e('0x28')][a91_0x364e('0xc')]},(_0x4122c0,_0x318fdf)=>{if(_0x4122c0){return _0x4284f7(_0x4122c0);}if(_0x318fdf){_0x4d8790[a91_0x364e('0x16')](a91_0x364e('0x11'),{'msg':a91_0x364e('0x29')});return _0x2a2b64[a91_0x364e('0x12')](a91_0x364e('0x26'));}_0x2e398d[a91_0x364e('0x2a')](_0x4122c0=>{if(_0x4122c0){return _0x4284f7(_0x4122c0);}_0x4d8790[a91_0x364e('0x18')](_0x2e398d,_0x4122c0=>{if(_0x4122c0){return _0x4284f7(_0x4122c0);}_0x2a2b64['redirect']('/');});});});};exports[a91_0x364e('0x2b')]=(_0x52b57c,_0x321063)=>{_0x321063[a91_0x364e('0x7')](a91_0x364e('0x2c'),{'title':a91_0x364e('0x2d')});};exports['postUpdateProfile']=(_0x568d7d,_0x328ee1,_0xd88b11)=>{_0x568d7d[a91_0x364e('0xb')](a91_0x364e('0xc'),'Please\x20enter\x20a\x20valid\x20email\x20address.')[a91_0x364e('0xd')]();_0x568d7d['sanitize'](a91_0x364e('0xc'))[a91_0x364e('0x10')]({'gmail_remove_dots':![]});const _0x14ac7b=_0x568d7d[a91_0x364e('0x25')]();if(_0x14ac7b){_0x568d7d[a91_0x364e('0x16')](a91_0x364e('0x11'),_0x14ac7b);return _0x328ee1[a91_0x364e('0x12')](a91_0x364e('0x2e'));}User_1['default'][a91_0x364e('0x2f')](_0x568d7d[a91_0x364e('0x6')]['id'],(_0x314493,_0x33763d)=>{if(_0x314493){return _0xd88b11(_0x314493);}_0x33763d['email']=_0x568d7d[a91_0x364e('0x28')][a91_0x364e('0xc')]||'';_0x33763d[a91_0x364e('0x30')][a91_0x364e('0x31')]=_0x568d7d[a91_0x364e('0x28')]['name']||'';_0x33763d[a91_0x364e('0x30')][a91_0x364e('0x32')]=_0x568d7d[a91_0x364e('0x28')][a91_0x364e('0x32')]||'';_0x33763d['profile'][a91_0x364e('0x33')]=_0x568d7d[a91_0x364e('0x28')][a91_0x364e('0x33')]||'';_0x33763d[a91_0x364e('0x30')][a91_0x364e('0x34')]=_0x568d7d[a91_0x364e('0x28')][a91_0x364e('0x34')]||'';_0x33763d[a91_0x364e('0x2a')](_0x314493=>{if(_0x314493){if(_0x314493[a91_0x364e('0x35')]===0x2af8){_0x568d7d['flash']('errors',{'msg':a91_0x364e('0x36')});return _0x328ee1[a91_0x364e('0x12')]('/account');}return _0xd88b11(_0x314493);}_0x568d7d[a91_0x364e('0x16')](a91_0x364e('0x19'),{'msg':'Profile\x20information\x20has\x20been\x20updated.'});_0x328ee1[a91_0x364e('0x12')](a91_0x364e('0x2e'));});});};exports['postUpdatePassword']=(_0x10d7f9,_0x442add,_0x45741a)=>{_0x10d7f9[a91_0x364e('0xb')](a91_0x364e('0x21'),a91_0x364e('0x37'))[a91_0x364e('0x38')]({'min':0x4});_0x10d7f9[a91_0x364e('0xb')](a91_0x364e('0x22'),a91_0x364e('0x23'))['equals'](_0x10d7f9[a91_0x364e('0x28')][a91_0x364e('0x21')]);const _0x14fd28=_0x10d7f9[a91_0x364e('0x25')]();if(_0x14fd28){_0x10d7f9[a91_0x364e('0x16')](a91_0x364e('0x11'),_0x14fd28);return _0x442add['redirect']('/account');}User_1[a91_0x364e('0x27')]['findById'](_0x10d7f9[a91_0x364e('0x6')]['id'],(_0x1d8bd6,_0x5eb7d6)=>{if(_0x1d8bd6){return _0x45741a(_0x1d8bd6);}_0x5eb7d6['password']=_0x10d7f9['body'][a91_0x364e('0x21')];_0x5eb7d6[a91_0x364e('0x2a')](_0x1d8bd6=>{if(_0x1d8bd6){return _0x45741a(_0x1d8bd6);}_0x10d7f9['flash'](a91_0x364e('0x19'),{'msg':a91_0x364e('0x39')});_0x442add[a91_0x364e('0x12')](a91_0x364e('0x2e'));});});};exports['postDeleteAccount']=(_0x545c1b,_0xa06b65,_0x420dc2)=>{User_1[a91_0x364e('0x27')][a91_0x364e('0x3a')]({'_id':_0x545c1b[a91_0x364e('0x6')]['id']},_0x5872c0=>{if(_0x5872c0){return _0x420dc2(_0x5872c0);}_0x545c1b[a91_0x364e('0x1d')]();_0x545c1b[a91_0x364e('0x16')]('info',{'msg':a91_0x364e('0x3b')});_0xa06b65[a91_0x364e('0x12')]('/');});};exports['getOauthUnlink']=(_0xca8824,_0x3eb1c4,_0x3c60e3)=>{const _0xf5148b=_0xca8824[a91_0x364e('0x3c')]['provider'];User_1[a91_0x364e('0x27')]['findById'](_0xca8824['user']['id'],(_0x57098d,_0x46dd21)=>{if(_0x57098d){return _0x3c60e3(_0x57098d);}_0x46dd21[_0xf5148b]=undefined;_0x46dd21[a91_0x364e('0x3d')]=_0x46dd21[a91_0x364e('0x3d')][a91_0x364e('0x3e')](_0x1df91d=>_0x1df91d[a91_0x364e('0x3f')]!==_0xf5148b);_0x46dd21[a91_0x364e('0x2a')](_0x57098d=>{if(_0x57098d){return _0x3c60e3(_0x57098d);}_0xca8824[a91_0x364e('0x16')](a91_0x364e('0x40'),{'msg':_0xf5148b+a91_0x364e('0x41')});_0x3eb1c4[a91_0x364e('0x12')](a91_0x364e('0x2e'));});});};exports[a91_0x364e('0x42')]=(_0x329036,_0x30acf7,_0x23fb06)=>{if(_0x329036[a91_0x364e('0x43')]()){return _0x30acf7['redirect']('/');}User_1[a91_0x364e('0x27')][a91_0x364e('0x44')]({'passwordResetToken':_0x329036[a91_0x364e('0x3c')][a91_0x364e('0x45')]})['where']('passwordResetExpires')['gt'](Date[a91_0x364e('0x46')]())[a91_0x364e('0x47')]((_0x57c14f,_0x581ba4)=>{if(_0x57c14f){return _0x23fb06(_0x57c14f);}if(!_0x581ba4){_0x329036['flash'](a91_0x364e('0x11'),{'msg':'Password\x20reset\x20token\x20is\x20invalid\x20or\x20has\x20expired.'});return _0x30acf7[a91_0x364e('0x12')]('/forgot');}_0x30acf7[a91_0x364e('0x7')](a91_0x364e('0x48'),{'title':a91_0x364e('0x49')});});};exports[a91_0x364e('0x4a')]=(_0x3e05e3,_0x4f90e7,_0x35480c)=>{_0x3e05e3[a91_0x364e('0xb')](a91_0x364e('0x21'),'Password\x20must\x20be\x20at\x20least\x204\x20characters\x20long.')[a91_0x364e('0x38')]({'min':0x4});_0x3e05e3[a91_0x364e('0xb')](a91_0x364e('0x4b'),a91_0x364e('0x4c'))[a91_0x364e('0x24')](_0x3e05e3[a91_0x364e('0x28')][a91_0x364e('0x21')]);const _0x32f7fc=_0x3e05e3[a91_0x364e('0x25')]();if(_0x32f7fc){_0x3e05e3[a91_0x364e('0x16')](a91_0x364e('0x11'),_0x32f7fc);return _0x4f90e7[a91_0x364e('0x12')](a91_0x364e('0x4d'));}async_1[a91_0x364e('0x27')]['waterfall']([function resetPassword(_0x43a41d){User_1[a91_0x364e('0x27')]['findOne']({'passwordResetToken':_0x3e05e3[a91_0x364e('0x3c')]['token']})['where'](a91_0x364e('0x4e'))['gt'](Date[a91_0x364e('0x46')]())[a91_0x364e('0x47')]((_0x19d048,_0x7e8853)=>{if(_0x19d048){return _0x35480c(_0x19d048);}if(!_0x7e8853){_0x3e05e3[a91_0x364e('0x16')]('errors',{'msg':a91_0x364e('0x4f')});return _0x4f90e7['redirect']('back');}_0x7e8853['password']=_0x3e05e3[a91_0x364e('0x28')]['password'];_0x7e8853[a91_0x364e('0x50')]=undefined;_0x7e8853['passwordResetExpires']=undefined;_0x7e8853['save'](_0x19d048=>{if(_0x19d048){return _0x35480c(_0x19d048);}_0x3e05e3[a91_0x364e('0x18')](_0x7e8853,_0x19d048=>{_0x43a41d(_0x19d048,_0x7e8853);});});});},function sendResetPasswordEmail(_0x171205,_0x4374f5){const _0xec670e=nodemailer_1[a91_0x364e('0x27')][a91_0x364e('0x51')]({'service':a91_0x364e('0x52'),'auth':{'user':process[a91_0x364e('0x53')][a91_0x364e('0x54')],'pass':process[a91_0x364e('0x53')]['SENDGRID_PASSWORD']}});const _0x560122={'to':_0x171205[a91_0x364e('0xc')],'from':a91_0x364e('0x55'),'subject':a91_0x364e('0x56'),'text':'Hello,\x0a\x0aThis\x20is\x20a\x20confirmation\x20that\x20the\x20password\x20for\x20your\x20account\x20'+_0x171205[a91_0x364e('0xc')]+a91_0x364e('0x57')};_0xec670e[a91_0x364e('0x58')](_0x560122,_0x5744ec=>{_0x3e05e3['flash']('success',{'msg':a91_0x364e('0x59')});_0x4374f5(_0x5744ec);});}],_0x5c289a=>{if(_0x5c289a){return _0x35480c(_0x5c289a);}_0x4f90e7[a91_0x364e('0x12')]('/');});};exports['getForgot']=(_0x109242,_0x1f1d9d)=>{if(_0x109242['isAuthenticated']()){return _0x1f1d9d[a91_0x364e('0x12')]('/');}_0x1f1d9d[a91_0x364e('0x7')](a91_0x364e('0x5a'),{'title':a91_0x364e('0x5b')});};exports[a91_0x364e('0x5c')]=(_0x469fc1,_0x5db35e,_0x32c255)=>{_0x469fc1['assert']('email',a91_0x364e('0x5d'))['isEmail']();_0x469fc1['sanitize'](a91_0x364e('0xc'))['normalizeEmail']({'gmail_remove_dots':![]});const _0x507f81=_0x469fc1[a91_0x364e('0x25')]();if(_0x507f81){_0x469fc1[a91_0x364e('0x16')](a91_0x364e('0x11'),_0x507f81);return _0x5db35e['redirect'](a91_0x364e('0x5e'));}async_1[a91_0x364e('0x27')][a91_0x364e('0x5f')]([function createRandomToken(_0x42106e){crypto_1[a91_0x364e('0x27')][a91_0x364e('0x60')](0x10,(_0x2559df,_0x1e7457)=>{const _0x3731a3=_0x1e7457['toString']('hex');_0x42106e(_0x2559df,_0x3731a3);});},function setRandomToken(_0x978ef8,_0x2ad357){User_1[a91_0x364e('0x27')][a91_0x364e('0x44')]({'email':_0x469fc1[a91_0x364e('0x28')][a91_0x364e('0xc')]},(_0x4ca803,_0x5aa1ff)=>{if(_0x4ca803){return _0x2ad357(_0x4ca803);}if(!_0x5aa1ff){_0x469fc1[a91_0x364e('0x16')](a91_0x364e('0x11'),{'msg':a91_0x364e('0x61')});return _0x5db35e[a91_0x364e('0x12')]('/forgot');}_0x5aa1ff[a91_0x364e('0x50')]=_0x978ef8;_0x5aa1ff['passwordResetExpires']=Date[a91_0x364e('0x46')]()+0x36ee80;_0x5aa1ff['save'](_0x4ca803=>{_0x2ad357(_0x4ca803,_0x978ef8,_0x5aa1ff);});});},function sendForgotPasswordEmail(_0x3899dd,_0xb3866b,_0x4668f4){const _0x1613a6=nodemailer_1[a91_0x364e('0x27')][a91_0x364e('0x51')]({'service':a91_0x364e('0x52'),'auth':{'user':process[a91_0x364e('0x53')]['SENDGRID_USER'],'pass':process[a91_0x364e('0x53')][a91_0x364e('0x62')]}});const _0x17bad9={'to':_0xb3866b[a91_0x364e('0xc')],'from':a91_0x364e('0x63'),'subject':a91_0x364e('0x64'),'text':a91_0x364e('0x65')+_0x469fc1[a91_0x364e('0x66')][a91_0x364e('0x67')]+'/reset/'+_0x3899dd+'\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20If\x20you\x20did\x20not\x20request\x20this,\x20please\x20ignore\x20this\x20email\x20and\x20your\x20password\x20will\x20remain\x20unchanged.\x0a'};_0x1613a6[a91_0x364e('0x58')](_0x17bad9,_0x563191=>{_0x469fc1[a91_0x364e('0x16')](a91_0x364e('0x40'),{'msg':'An\x20e-mail\x20has\x20been\x20sent\x20to\x20'+_0xb3866b['email']+a91_0x364e('0x68')});_0x4668f4(_0x563191);});}],_0x3ca97=>{if(_0x3ca97){return _0x32c255(_0x3ca97);}_0x5db35e[a91_0x364e('0x12')]('/forgot');});};
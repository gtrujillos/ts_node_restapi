var a95_0x444b=['createTransport','SendGrid','env','SENDGRID_PASSWORD','Your\x20password\x20has\x20been\x20changed','\x20has\x20just\x20been\x20changed.\x0a','Success!\x20Your\x20password\x20has\x20been\x20changed.','getForgot','account/forgot','Forgot\x20Password','postForgot','toString','hex','Account\x20with\x20that\x20email\x20address\x20does\x20not\x20exist.','/forgot','SENDGRID_USER','hackathon@starter.com','Reset\x20your\x20password\x20on\x20Hackathon\x20Starter','headers','host','An\x20e-mail\x20has\x20been\x20sent\x20to\x20','\x20with\x20further\x20instructions.','__importDefault','__esModule','defineProperty','crypto','nodemailer','passport','../models/User','getLogin','user','redirect','render','account/login','Login','postLogin','email','Email\x20is\x20not\x20valid','isEmail','assert','password','Password\x20cannot\x20be\x20blank','notEmpty','validationErrors','flash','errors','/login','default','authenticate','local','logIn','success','session','returnTo','logout','account/signup','postSignup','Password\x20must\x20be\x20at\x20least\x204\x20characters\x20long','Passwords\x20do\x20not\x20match','equals','sanitize','normalizeEmail','body','findOne','Account\x20with\x20that\x20email\x20address\x20already\x20exists.','/signup','save','getAccount','account/profile','Account\x20Management','postUpdateProfile','/account','name','profile','gender','location','website','Profile\x20information\x20has\x20been\x20updated.','postUpdatePassword','len','confirmPassword','findById','Password\x20has\x20been\x20changed.','postDeleteAccount','remove','tokens','info','\x20account\x20has\x20been\x20unlinked.','isAuthenticated','params','where','passwordResetExpires','exec','Password\x20reset\x20token\x20is\x20invalid\x20or\x20has\x20expired.','account/reset','Password\x20Reset','postReset','Password\x20must\x20be\x20at\x20least\x204\x20characters\x20long.','Passwords\x20must\x20match.','back','waterfall','token','now','passwordResetToken'];(function(_0x54da51,_0x325130){var _0x53173f=function(_0x145ae6){while(--_0x145ae6){_0x54da51['push'](_0x54da51['shift']());}};_0x53173f(++_0x325130);}(a95_0x444b,0x1b6));var a95_0x5197=function(_0x2e2651,_0x1aac60){_0x2e2651=_0x2e2651-0x0;var _0x453ff2=a95_0x444b[_0x2e2651];return _0x453ff2;};'use strict';var __importDefault=this&&this[a95_0x5197('0x0')]||function(_0x3e4d09){return _0x3e4d09&&_0x3e4d09[a95_0x5197('0x1')]?_0x3e4d09:{'default':_0x3e4d09};};Object[a95_0x5197('0x2')](exports,a95_0x5197('0x1'),{'value':!![]});const async_1=__importDefault(require('async'));const crypto_1=__importDefault(require(a95_0x5197('0x3')));const nodemailer_1=__importDefault(require(a95_0x5197('0x4')));const passport_1=__importDefault(require(a95_0x5197('0x5')));const User_1=__importDefault(require(a95_0x5197('0x6')));const request=require('express-validator');exports[a95_0x5197('0x7')]=(_0x2f32e5,_0x3de282)=>{if(_0x2f32e5[a95_0x5197('0x8')]){return _0x3de282[a95_0x5197('0x9')]('/');}_0x3de282[a95_0x5197('0xa')](a95_0x5197('0xb'),{'title':a95_0x5197('0xc')});};exports[a95_0x5197('0xd')]=(_0x47b039,_0x497d05,_0x4230fe)=>{_0x47b039['assert'](a95_0x5197('0xe'),a95_0x5197('0xf'))[a95_0x5197('0x10')]();_0x47b039[a95_0x5197('0x11')](a95_0x5197('0x12'),a95_0x5197('0x13'))[a95_0x5197('0x14')]();_0x47b039['sanitize']('email')['normalizeEmail']({'gmail_remove_dots':![]});const _0x293219=_0x47b039[a95_0x5197('0x15')]();if(_0x293219){_0x47b039[a95_0x5197('0x16')](a95_0x5197('0x17'),_0x293219);return _0x497d05[a95_0x5197('0x9')](a95_0x5197('0x18'));}passport_1[a95_0x5197('0x19')][a95_0x5197('0x1a')](a95_0x5197('0x1b'),(_0x32a1ba,_0x25b2dd,_0x37a538)=>{if(_0x32a1ba){return _0x4230fe(_0x32a1ba);}if(!_0x25b2dd){_0x47b039[a95_0x5197('0x16')]('errors',_0x37a538['message']);return _0x497d05['redirect']('/login');}_0x47b039[a95_0x5197('0x1c')](_0x25b2dd,_0x32a1ba=>{if(_0x32a1ba){return _0x4230fe(_0x32a1ba);}_0x47b039[a95_0x5197('0x16')](a95_0x5197('0x1d'),{'msg':'Success!\x20You\x20are\x20logged\x20in.'});_0x497d05['redirect'](_0x47b039[a95_0x5197('0x1e')][a95_0x5197('0x1f')]||'/');});})(_0x47b039,_0x497d05,_0x4230fe);};exports[a95_0x5197('0x20')]=(_0x2f576c,_0x5d80b8)=>{_0x2f576c['logout']();_0x5d80b8[a95_0x5197('0x9')]('/');};exports['getSignup']=(_0x410b1d,_0x572905)=>{if(_0x410b1d[a95_0x5197('0x8')]){return _0x572905['redirect']('/');}_0x572905[a95_0x5197('0xa')](a95_0x5197('0x21'),{'title':'Create\x20Account'});};exports[a95_0x5197('0x22')]=(_0x56b324,_0x578004,_0xbaaccb)=>{_0x56b324[a95_0x5197('0x11')]('email',a95_0x5197('0xf'))[a95_0x5197('0x10')]();_0x56b324[a95_0x5197('0x11')](a95_0x5197('0x12'),a95_0x5197('0x23'))['len']({'min':0x4});_0x56b324[a95_0x5197('0x11')]('confirmPassword',a95_0x5197('0x24'))[a95_0x5197('0x25')](_0x56b324['body'][a95_0x5197('0x12')]);_0x56b324[a95_0x5197('0x26')](a95_0x5197('0xe'))[a95_0x5197('0x27')]({'gmail_remove_dots':![]});const _0x2ddd24=_0x56b324[a95_0x5197('0x15')]();if(_0x2ddd24){_0x56b324['flash'](a95_0x5197('0x17'),_0x2ddd24);return _0x578004[a95_0x5197('0x9')]('/signup');}const _0x5b5968=new User_1['default']({'email':_0x56b324[a95_0x5197('0x28')][a95_0x5197('0xe')],'password':_0x56b324[a95_0x5197('0x28')][a95_0x5197('0x12')]});User_1['default'][a95_0x5197('0x29')]({'email':_0x56b324[a95_0x5197('0x28')][a95_0x5197('0xe')]},(_0x5b8e5f,_0x53c0dd)=>{if(_0x5b8e5f){return _0xbaaccb(_0x5b8e5f);}if(_0x53c0dd){_0x56b324[a95_0x5197('0x16')](a95_0x5197('0x17'),{'msg':a95_0x5197('0x2a')});return _0x578004['redirect'](a95_0x5197('0x2b'));}_0x5b5968[a95_0x5197('0x2c')](_0x5b8e5f=>{if(_0x5b8e5f){return _0xbaaccb(_0x5b8e5f);}_0x56b324[a95_0x5197('0x1c')](_0x5b5968,_0x5b8e5f=>{if(_0x5b8e5f){return _0xbaaccb(_0x5b8e5f);}_0x578004[a95_0x5197('0x9')]('/');});});});};exports[a95_0x5197('0x2d')]=(_0x2f1ef8,_0x2418a0)=>{_0x2418a0['render'](a95_0x5197('0x2e'),{'title':a95_0x5197('0x2f')});};exports[a95_0x5197('0x30')]=(_0x147927,_0x38c638,_0xc639dc)=>{_0x147927['assert'](a95_0x5197('0xe'),'Please\x20enter\x20a\x20valid\x20email\x20address.')['isEmail']();_0x147927['sanitize'](a95_0x5197('0xe'))['normalizeEmail']({'gmail_remove_dots':![]});const _0x286bc9=_0x147927[a95_0x5197('0x15')]();if(_0x286bc9){_0x147927[a95_0x5197('0x16')](a95_0x5197('0x17'),_0x286bc9);return _0x38c638[a95_0x5197('0x9')](a95_0x5197('0x31'));}User_1[a95_0x5197('0x19')]['findById'](_0x147927['user']['id'],(_0x5c1d5b,_0x53adb3)=>{if(_0x5c1d5b){return _0xc639dc(_0x5c1d5b);}_0x53adb3[a95_0x5197('0xe')]=_0x147927[a95_0x5197('0x28')][a95_0x5197('0xe')]||'';_0x53adb3['profile'][a95_0x5197('0x32')]=_0x147927[a95_0x5197('0x28')][a95_0x5197('0x32')]||'';_0x53adb3[a95_0x5197('0x33')][a95_0x5197('0x34')]=_0x147927[a95_0x5197('0x28')][a95_0x5197('0x34')]||'';_0x53adb3['profile'][a95_0x5197('0x35')]=_0x147927[a95_0x5197('0x28')]['location']||'';_0x53adb3[a95_0x5197('0x33')][a95_0x5197('0x36')]=_0x147927[a95_0x5197('0x28')]['website']||'';_0x53adb3[a95_0x5197('0x2c')](_0x5c1d5b=>{if(_0x5c1d5b){if(_0x5c1d5b['code']===0x2af8){_0x147927[a95_0x5197('0x16')](a95_0x5197('0x17'),{'msg':'The\x20email\x20address\x20you\x20have\x20entered\x20is\x20already\x20associated\x20with\x20an\x20account.'});return _0x38c638['redirect'](a95_0x5197('0x31'));}return _0xc639dc(_0x5c1d5b);}_0x147927[a95_0x5197('0x16')](a95_0x5197('0x1d'),{'msg':a95_0x5197('0x37')});_0x38c638[a95_0x5197('0x9')]('/account');});});};exports[a95_0x5197('0x38')]=(_0xf8ddc6,_0x16ecf7,_0x2f8a33)=>{_0xf8ddc6[a95_0x5197('0x11')]('password','Password\x20must\x20be\x20at\x20least\x204\x20characters\x20long')[a95_0x5197('0x39')]({'min':0x4});_0xf8ddc6[a95_0x5197('0x11')](a95_0x5197('0x3a'),a95_0x5197('0x24'))[a95_0x5197('0x25')](_0xf8ddc6[a95_0x5197('0x28')]['password']);const _0x272553=_0xf8ddc6[a95_0x5197('0x15')]();if(_0x272553){_0xf8ddc6[a95_0x5197('0x16')]('errors',_0x272553);return _0x16ecf7[a95_0x5197('0x9')]('/account');}User_1['default'][a95_0x5197('0x3b')](_0xf8ddc6[a95_0x5197('0x8')]['id'],(_0x829fd,_0xf445d)=>{if(_0x829fd){return _0x2f8a33(_0x829fd);}_0xf445d['password']=_0xf8ddc6[a95_0x5197('0x28')][a95_0x5197('0x12')];_0xf445d[a95_0x5197('0x2c')](_0x829fd=>{if(_0x829fd){return _0x2f8a33(_0x829fd);}_0xf8ddc6[a95_0x5197('0x16')](a95_0x5197('0x1d'),{'msg':a95_0x5197('0x3c')});_0x16ecf7[a95_0x5197('0x9')](a95_0x5197('0x31'));});});};exports[a95_0x5197('0x3d')]=(_0x18c9ad,_0x33b973,_0x5147c8)=>{User_1['default'][a95_0x5197('0x3e')]({'_id':_0x18c9ad['user']['id']},_0x50069c=>{if(_0x50069c){return _0x5147c8(_0x50069c);}_0x18c9ad[a95_0x5197('0x20')]();_0x18c9ad[a95_0x5197('0x16')]('info',{'msg':'Your\x20account\x20has\x20been\x20deleted.'});_0x33b973[a95_0x5197('0x9')]('/');});};exports['getOauthUnlink']=(_0x210949,_0x325ff4,_0x1c9ee9)=>{const _0x4caac9=_0x210949['params']['provider'];User_1[a95_0x5197('0x19')][a95_0x5197('0x3b')](_0x210949[a95_0x5197('0x8')]['id'],(_0x443830,_0x35e7e1)=>{if(_0x443830){return _0x1c9ee9(_0x443830);}_0x35e7e1[_0x4caac9]=undefined;_0x35e7e1[a95_0x5197('0x3f')]=_0x35e7e1[a95_0x5197('0x3f')]['filter'](_0x408b0d=>_0x408b0d['kind']!==_0x4caac9);_0x35e7e1['save'](_0x443830=>{if(_0x443830){return _0x1c9ee9(_0x443830);}_0x210949[a95_0x5197('0x16')](a95_0x5197('0x40'),{'msg':_0x4caac9+a95_0x5197('0x41')});_0x325ff4[a95_0x5197('0x9')](a95_0x5197('0x31'));});});};exports['getReset']=(_0x59823c,_0xb28aea,_0x108b1e)=>{if(_0x59823c[a95_0x5197('0x42')]()){return _0xb28aea[a95_0x5197('0x9')]('/');}User_1[a95_0x5197('0x19')]['findOne']({'passwordResetToken':_0x59823c[a95_0x5197('0x43')]['token']})[a95_0x5197('0x44')](a95_0x5197('0x45'))['gt'](Date['now']())[a95_0x5197('0x46')]((_0x3cdde5,_0xbd816a)=>{if(_0x3cdde5){return _0x108b1e(_0x3cdde5);}if(!_0xbd816a){_0x59823c[a95_0x5197('0x16')](a95_0x5197('0x17'),{'msg':a95_0x5197('0x47')});return _0xb28aea[a95_0x5197('0x9')]('/forgot');}_0xb28aea[a95_0x5197('0xa')](a95_0x5197('0x48'),{'title':a95_0x5197('0x49')});});};exports[a95_0x5197('0x4a')]=(_0xce46aa,_0x280464,_0x54f120)=>{_0xce46aa[a95_0x5197('0x11')](a95_0x5197('0x12'),a95_0x5197('0x4b'))['len']({'min':0x4});_0xce46aa['assert']('confirm',a95_0x5197('0x4c'))['equals'](_0xce46aa[a95_0x5197('0x28')][a95_0x5197('0x12')]);const _0x493b23=_0xce46aa['validationErrors']();if(_0x493b23){_0xce46aa[a95_0x5197('0x16')](a95_0x5197('0x17'),_0x493b23);return _0x280464['redirect'](a95_0x5197('0x4d'));}async_1[a95_0x5197('0x19')][a95_0x5197('0x4e')]([function resetPassword(_0x5103b7){User_1['default']['findOne']({'passwordResetToken':_0xce46aa[a95_0x5197('0x43')][a95_0x5197('0x4f')]})[a95_0x5197('0x44')]('passwordResetExpires')['gt'](Date[a95_0x5197('0x50')]())[a95_0x5197('0x46')]((_0x1d4615,_0x9c0032)=>{if(_0x1d4615){return _0x54f120(_0x1d4615);}if(!_0x9c0032){_0xce46aa[a95_0x5197('0x16')](a95_0x5197('0x17'),{'msg':a95_0x5197('0x47')});return _0x280464[a95_0x5197('0x9')]('back');}_0x9c0032['password']=_0xce46aa['body'][a95_0x5197('0x12')];_0x9c0032[a95_0x5197('0x51')]=undefined;_0x9c0032[a95_0x5197('0x45')]=undefined;_0x9c0032['save'](_0x1d4615=>{if(_0x1d4615){return _0x54f120(_0x1d4615);}_0xce46aa[a95_0x5197('0x1c')](_0x9c0032,_0x1d4615=>{_0x5103b7(_0x1d4615,_0x9c0032);});});});},function sendResetPasswordEmail(_0x5b2ecd,_0x1e537a){const _0x2cf53b=nodemailer_1[a95_0x5197('0x19')][a95_0x5197('0x52')]({'service':a95_0x5197('0x53'),'auth':{'user':process[a95_0x5197('0x54')]['SENDGRID_USER'],'pass':process[a95_0x5197('0x54')][a95_0x5197('0x55')]}});const _0x2407cb={'to':_0x5b2ecd[a95_0x5197('0xe')],'from':'express-ts@starter.com','subject':a95_0x5197('0x56'),'text':'Hello,\x0a\x0aThis\x20is\x20a\x20confirmation\x20that\x20the\x20password\x20for\x20your\x20account\x20'+_0x5b2ecd[a95_0x5197('0xe')]+a95_0x5197('0x57')};_0x2cf53b['sendMail'](_0x2407cb,_0x272fce=>{_0xce46aa['flash']('success',{'msg':a95_0x5197('0x58')});_0x1e537a(_0x272fce);});}],_0x53a7aa=>{if(_0x53a7aa){return _0x54f120(_0x53a7aa);}_0x280464['redirect']('/');});};exports[a95_0x5197('0x59')]=(_0x440543,_0x193821)=>{if(_0x440543[a95_0x5197('0x42')]()){return _0x193821[a95_0x5197('0x9')]('/');}_0x193821[a95_0x5197('0xa')](a95_0x5197('0x5a'),{'title':a95_0x5197('0x5b')});};exports[a95_0x5197('0x5c')]=(_0x199161,_0x1a1a44,_0x5ee982)=>{_0x199161['assert'](a95_0x5197('0xe'),'Please\x20enter\x20a\x20valid\x20email\x20address.')[a95_0x5197('0x10')]();_0x199161[a95_0x5197('0x26')](a95_0x5197('0xe'))[a95_0x5197('0x27')]({'gmail_remove_dots':![]});const _0x3355b9=_0x199161[a95_0x5197('0x15')]();if(_0x3355b9){_0x199161[a95_0x5197('0x16')](a95_0x5197('0x17'),_0x3355b9);return _0x1a1a44[a95_0x5197('0x9')]('/forgot');}async_1[a95_0x5197('0x19')][a95_0x5197('0x4e')]([function createRandomToken(_0x29926a){crypto_1[a95_0x5197('0x19')]['randomBytes'](0x10,(_0x27a6f5,_0x31cc32)=>{const _0x3a9673=_0x31cc32[a95_0x5197('0x5d')](a95_0x5197('0x5e'));_0x29926a(_0x27a6f5,_0x3a9673);});},function setRandomToken(_0x487dda,_0x278451){User_1[a95_0x5197('0x19')][a95_0x5197('0x29')]({'email':_0x199161[a95_0x5197('0x28')][a95_0x5197('0xe')]},(_0x5b3887,_0x5a3008)=>{if(_0x5b3887){return _0x278451(_0x5b3887);}if(!_0x5a3008){_0x199161['flash'](a95_0x5197('0x17'),{'msg':a95_0x5197('0x5f')});return _0x1a1a44[a95_0x5197('0x9')](a95_0x5197('0x60'));}_0x5a3008[a95_0x5197('0x51')]=_0x487dda;_0x5a3008[a95_0x5197('0x45')]=Date['now']()+0x36ee80;_0x5a3008['save'](_0x5b3887=>{_0x278451(_0x5b3887,_0x487dda,_0x5a3008);});});},function sendForgotPasswordEmail(_0x3a48ad,_0x59bfbc,_0x508314){const _0x3e9246=nodemailer_1[a95_0x5197('0x19')]['createTransport']({'service':a95_0x5197('0x53'),'auth':{'user':process['env'][a95_0x5197('0x61')],'pass':process['env']['SENDGRID_PASSWORD']}});const _0x16afad={'to':_0x59bfbc['email'],'from':a95_0x5197('0x62'),'subject':a95_0x5197('0x63'),'text':'You\x20are\x20receiving\x20this\x20email\x20because\x20you\x20(or\x20someone\x20else)\x20have\x20requested\x20the\x20reset\x20of\x20the\x20password\x20for\x20your\x20account.\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Please\x20click\x20on\x20the\x20following\x20link,\x20or\x20paste\x20this\x20into\x20your\x20browser\x20to\x20complete\x20the\x20process:\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20http://'+_0x199161[a95_0x5197('0x64')][a95_0x5197('0x65')]+'/reset/'+_0x3a48ad+'\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20If\x20you\x20did\x20not\x20request\x20this,\x20please\x20ignore\x20this\x20email\x20and\x20your\x20password\x20will\x20remain\x20unchanged.\x0a'};_0x3e9246['sendMail'](_0x16afad,_0x178c9b=>{_0x199161['flash'](a95_0x5197('0x40'),{'msg':a95_0x5197('0x66')+_0x59bfbc[a95_0x5197('0xe')]+a95_0x5197('0x67')});_0x508314(_0x178c9b);});}],_0xbc4bdb=>{if(_0xbc4bdb){return _0x5ee982(_0xbc4bdb);}_0x1a1a44[a95_0x5197('0x9')](a95_0x5197('0x60'));});};
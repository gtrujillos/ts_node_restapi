var a142_0x4fb4=['redirect','render','account/login','Login','postLogin','assert','Email\x20is\x20not\x20valid','isEmail','password','notEmpty','sanitize','flash','errors','/login','default','authenticate','local','logIn','Success!\x20You\x20are\x20logged\x20in.','logout','getSignup','user','Create\x20Account','postSignup','email','Password\x20must\x20be\x20at\x20least\x204\x20characters\x20long','confirmPassword','Passwords\x20do\x20not\x20match','equals','body','normalizeEmail','validationErrors','/signup','findOne','Account\x20with\x20that\x20email\x20address\x20already\x20exists.','save','getAccount','account/profile','Account\x20Management','Please\x20enter\x20a\x20valid\x20email\x20address.','/account','findById','profile','name','gender','location','website','code','The\x20email\x20address\x20you\x20have\x20entered\x20is\x20already\x20associated\x20with\x20an\x20account.','success','Profile\x20information\x20has\x20been\x20updated.','len','Password\x20has\x20been\x20changed.','postDeleteAccount','remove','Your\x20account\x20has\x20been\x20deleted.','getOauthUnlink','params','provider','tokens','filter','kind','info','\x20account\x20has\x20been\x20unlinked.','getReset','isAuthenticated','token','where','now','exec','Password\x20reset\x20token\x20is\x20invalid\x20or\x20has\x20expired.','/forgot','account/reset','Password\x20Reset','postReset','Password\x20must\x20be\x20at\x20least\x204\x20characters\x20long.','confirm','Passwords\x20must\x20match.','back','passwordResetExpires','passwordResetToken','createTransport','SendGrid','SENDGRID_USER','SENDGRID_PASSWORD','express-ts@starter.com','Your\x20password\x20has\x20been\x20changed','Hello,\x0a\x0aThis\x20is\x20a\x20confirmation\x20that\x20the\x20password\x20for\x20your\x20account\x20','sendMail','Forgot\x20Password','postForgot','randomBytes','toString','hex','Account\x20with\x20that\x20email\x20address\x20does\x20not\x20exist.','env','hackathon@starter.com','Reset\x20your\x20password\x20on\x20Hackathon\x20Starter','host','/reset/','\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20If\x20you\x20did\x20not\x20request\x20this,\x20please\x20ignore\x20this\x20email\x20and\x20your\x20password\x20will\x20remain\x20unchanged.\x0a','\x20with\x20further\x20instructions.','__importDefault','__esModule','defineProperty','nodemailer','passport','../models/User','express-validator'];(function(_0x55f01c,_0x245433){var _0x45d96b=function(_0x460e77){while(--_0x460e77){_0x55f01c['push'](_0x55f01c['shift']());}};_0x45d96b(++_0x245433);}(a142_0x4fb4,0x140));var a142_0x337f=function(_0x22b82c,_0x25d7da){_0x22b82c=_0x22b82c-0x0;var _0x1f34a7=a142_0x4fb4[_0x22b82c];return _0x1f34a7;};'use strict';var __importDefault=this&&this[a142_0x337f('0x0')]||function(_0x2ae999){return _0x2ae999&&_0x2ae999[a142_0x337f('0x1')]?_0x2ae999:{'default':_0x2ae999};};Object[a142_0x337f('0x2')](exports,a142_0x337f('0x1'),{'value':!![]});const async_1=__importDefault(require('async'));const crypto_1=__importDefault(require('crypto'));const nodemailer_1=__importDefault(require(a142_0x337f('0x3')));const passport_1=__importDefault(require(a142_0x337f('0x4')));const User_1=__importDefault(require(a142_0x337f('0x5')));const request=require(a142_0x337f('0x6'));exports['getLogin']=(_0x416317,_0x3a5e72)=>{if(_0x416317['user']){return _0x3a5e72[a142_0x337f('0x7')]('/');}_0x3a5e72[a142_0x337f('0x8')](a142_0x337f('0x9'),{'title':a142_0x337f('0xa')});};exports[a142_0x337f('0xb')]=(_0x2b57de,_0x382f8f,_0xb45f9)=>{_0x2b57de[a142_0x337f('0xc')]('email',a142_0x337f('0xd'))[a142_0x337f('0xe')]();_0x2b57de[a142_0x337f('0xc')](a142_0x337f('0xf'),'Password\x20cannot\x20be\x20blank')[a142_0x337f('0x10')]();_0x2b57de[a142_0x337f('0x11')]('email')['normalizeEmail']({'gmail_remove_dots':![]});const _0x9635b4=_0x2b57de['validationErrors']();if(_0x9635b4){_0x2b57de[a142_0x337f('0x12')](a142_0x337f('0x13'),_0x9635b4);return _0x382f8f[a142_0x337f('0x7')](a142_0x337f('0x14'));}passport_1[a142_0x337f('0x15')][a142_0x337f('0x16')](a142_0x337f('0x17'),(_0x4c2ae2,_0xd68a03,_0xfee116)=>{if(_0x4c2ae2){return _0xb45f9(_0x4c2ae2);}if(!_0xd68a03){_0x2b57de[a142_0x337f('0x12')]('errors',_0xfee116['message']);return _0x382f8f[a142_0x337f('0x7')]('/login');}_0x2b57de[a142_0x337f('0x18')](_0xd68a03,_0x4c2ae2=>{if(_0x4c2ae2){return _0xb45f9(_0x4c2ae2);}_0x2b57de['flash']('success',{'msg':a142_0x337f('0x19')});_0x382f8f[a142_0x337f('0x7')](_0x2b57de['session']['returnTo']||'/');});})(_0x2b57de,_0x382f8f,_0xb45f9);};exports[a142_0x337f('0x1a')]=(_0x4124fd,_0x2ed6e5)=>{_0x4124fd[a142_0x337f('0x1a')]();_0x2ed6e5[a142_0x337f('0x7')]('/');};exports[a142_0x337f('0x1b')]=(_0x19b357,_0x36bc73)=>{if(_0x19b357[a142_0x337f('0x1c')]){return _0x36bc73[a142_0x337f('0x7')]('/');}_0x36bc73[a142_0x337f('0x8')]('account/signup',{'title':a142_0x337f('0x1d')});};exports[a142_0x337f('0x1e')]=(_0x499bd0,_0x3c4b95,_0xa227c5)=>{_0x499bd0[a142_0x337f('0xc')](a142_0x337f('0x1f'),'Email\x20is\x20not\x20valid')[a142_0x337f('0xe')]();_0x499bd0[a142_0x337f('0xc')](a142_0x337f('0xf'),a142_0x337f('0x20'))['len']({'min':0x4});_0x499bd0[a142_0x337f('0xc')](a142_0x337f('0x21'),a142_0x337f('0x22'))[a142_0x337f('0x23')](_0x499bd0[a142_0x337f('0x24')][a142_0x337f('0xf')]);_0x499bd0[a142_0x337f('0x11')](a142_0x337f('0x1f'))[a142_0x337f('0x25')]({'gmail_remove_dots':![]});const _0x2b13e6=_0x499bd0[a142_0x337f('0x26')]();if(_0x2b13e6){_0x499bd0[a142_0x337f('0x12')](a142_0x337f('0x13'),_0x2b13e6);return _0x3c4b95[a142_0x337f('0x7')](a142_0x337f('0x27'));}const _0x4a3681=new User_1[(a142_0x337f('0x15'))]({'email':_0x499bd0['body']['email'],'password':_0x499bd0[a142_0x337f('0x24')][a142_0x337f('0xf')]});User_1[a142_0x337f('0x15')][a142_0x337f('0x28')]({'email':_0x499bd0[a142_0x337f('0x24')][a142_0x337f('0x1f')]},(_0x3636cf,_0x1986a0)=>{if(_0x3636cf){return _0xa227c5(_0x3636cf);}if(_0x1986a0){_0x499bd0['flash'](a142_0x337f('0x13'),{'msg':a142_0x337f('0x29')});return _0x3c4b95[a142_0x337f('0x7')](a142_0x337f('0x27'));}_0x4a3681[a142_0x337f('0x2a')](_0x3636cf=>{if(_0x3636cf){return _0xa227c5(_0x3636cf);}_0x499bd0[a142_0x337f('0x18')](_0x4a3681,_0x3636cf=>{if(_0x3636cf){return _0xa227c5(_0x3636cf);}_0x3c4b95[a142_0x337f('0x7')]('/');});});});};exports[a142_0x337f('0x2b')]=(_0x4f87c8,_0x285442)=>{_0x285442[a142_0x337f('0x8')](a142_0x337f('0x2c'),{'title':a142_0x337f('0x2d')});};exports['postUpdateProfile']=(_0x4e2428,_0x365cb9,_0xd08877)=>{_0x4e2428[a142_0x337f('0xc')](a142_0x337f('0x1f'),a142_0x337f('0x2e'))[a142_0x337f('0xe')]();_0x4e2428['sanitize'](a142_0x337f('0x1f'))[a142_0x337f('0x25')]({'gmail_remove_dots':![]});const _0xf0cfc=_0x4e2428[a142_0x337f('0x26')]();if(_0xf0cfc){_0x4e2428[a142_0x337f('0x12')]('errors',_0xf0cfc);return _0x365cb9['redirect'](a142_0x337f('0x2f'));}User_1['default'][a142_0x337f('0x30')](_0x4e2428[a142_0x337f('0x1c')]['id'],(_0x2b89b7,_0x1e6bfa)=>{if(_0x2b89b7){return _0xd08877(_0x2b89b7);}_0x1e6bfa[a142_0x337f('0x1f')]=_0x4e2428[a142_0x337f('0x24')][a142_0x337f('0x1f')]||'';_0x1e6bfa[a142_0x337f('0x31')][a142_0x337f('0x32')]=_0x4e2428['body'][a142_0x337f('0x32')]||'';_0x1e6bfa[a142_0x337f('0x31')][a142_0x337f('0x33')]=_0x4e2428[a142_0x337f('0x24')][a142_0x337f('0x33')]||'';_0x1e6bfa['profile'][a142_0x337f('0x34')]=_0x4e2428[a142_0x337f('0x24')][a142_0x337f('0x34')]||'';_0x1e6bfa[a142_0x337f('0x31')][a142_0x337f('0x35')]=_0x4e2428[a142_0x337f('0x24')][a142_0x337f('0x35')]||'';_0x1e6bfa[a142_0x337f('0x2a')](_0x2b89b7=>{if(_0x2b89b7){if(_0x2b89b7[a142_0x337f('0x36')]===0x2af8){_0x4e2428[a142_0x337f('0x12')](a142_0x337f('0x13'),{'msg':a142_0x337f('0x37')});return _0x365cb9[a142_0x337f('0x7')](a142_0x337f('0x2f'));}return _0xd08877(_0x2b89b7);}_0x4e2428['flash'](a142_0x337f('0x38'),{'msg':a142_0x337f('0x39')});_0x365cb9[a142_0x337f('0x7')](a142_0x337f('0x2f'));});});};exports['postUpdatePassword']=(_0x4d68bd,_0xed1c36,_0x597c3e)=>{_0x4d68bd[a142_0x337f('0xc')](a142_0x337f('0xf'),a142_0x337f('0x20'))[a142_0x337f('0x3a')]({'min':0x4});_0x4d68bd['assert'](a142_0x337f('0x21'),a142_0x337f('0x22'))[a142_0x337f('0x23')](_0x4d68bd[a142_0x337f('0x24')][a142_0x337f('0xf')]);const _0xb8f3da=_0x4d68bd['validationErrors']();if(_0xb8f3da){_0x4d68bd['flash'](a142_0x337f('0x13'),_0xb8f3da);return _0xed1c36['redirect']('/account');}User_1['default']['findById'](_0x4d68bd[a142_0x337f('0x1c')]['id'],(_0x4b2df2,_0x45a291)=>{if(_0x4b2df2){return _0x597c3e(_0x4b2df2);}_0x45a291[a142_0x337f('0xf')]=_0x4d68bd[a142_0x337f('0x24')]['password'];_0x45a291[a142_0x337f('0x2a')](_0x4b2df2=>{if(_0x4b2df2){return _0x597c3e(_0x4b2df2);}_0x4d68bd[a142_0x337f('0x12')]('success',{'msg':a142_0x337f('0x3b')});_0xed1c36['redirect'](a142_0x337f('0x2f'));});});};exports[a142_0x337f('0x3c')]=(_0x3e9c4b,_0x1f8703,_0x4ef947)=>{User_1[a142_0x337f('0x15')][a142_0x337f('0x3d')]({'_id':_0x3e9c4b[a142_0x337f('0x1c')]['id']},_0x51d85d=>{if(_0x51d85d){return _0x4ef947(_0x51d85d);}_0x3e9c4b[a142_0x337f('0x1a')]();_0x3e9c4b[a142_0x337f('0x12')]('info',{'msg':a142_0x337f('0x3e')});_0x1f8703[a142_0x337f('0x7')]('/');});};exports[a142_0x337f('0x3f')]=(_0x5c0fe2,_0x343b3e,_0x250b19)=>{const _0xe71444=_0x5c0fe2[a142_0x337f('0x40')][a142_0x337f('0x41')];User_1[a142_0x337f('0x15')][a142_0x337f('0x30')](_0x5c0fe2['user']['id'],(_0x4b3e22,_0x1126bd)=>{if(_0x4b3e22){return _0x250b19(_0x4b3e22);}_0x1126bd[_0xe71444]=undefined;_0x1126bd[a142_0x337f('0x42')]=_0x1126bd['tokens'][a142_0x337f('0x43')](_0x122534=>_0x122534[a142_0x337f('0x44')]!==_0xe71444);_0x1126bd[a142_0x337f('0x2a')](_0x4b3e22=>{if(_0x4b3e22){return _0x250b19(_0x4b3e22);}_0x5c0fe2[a142_0x337f('0x12')](a142_0x337f('0x45'),{'msg':_0xe71444+a142_0x337f('0x46')});_0x343b3e[a142_0x337f('0x7')]('/account');});});};exports[a142_0x337f('0x47')]=(_0x115d66,_0x26bc06,_0x28b75d)=>{if(_0x115d66[a142_0x337f('0x48')]()){return _0x26bc06[a142_0x337f('0x7')]('/');}User_1[a142_0x337f('0x15')]['findOne']({'passwordResetToken':_0x115d66[a142_0x337f('0x40')][a142_0x337f('0x49')]})[a142_0x337f('0x4a')]('passwordResetExpires')['gt'](Date[a142_0x337f('0x4b')]())[a142_0x337f('0x4c')]((_0x23322e,_0x8f6bcb)=>{if(_0x23322e){return _0x28b75d(_0x23322e);}if(!_0x8f6bcb){_0x115d66['flash'](a142_0x337f('0x13'),{'msg':a142_0x337f('0x4d')});return _0x26bc06[a142_0x337f('0x7')](a142_0x337f('0x4e'));}_0x26bc06[a142_0x337f('0x8')](a142_0x337f('0x4f'),{'title':a142_0x337f('0x50')});});};exports[a142_0x337f('0x51')]=(_0x467e94,_0x589392,_0x9edf6)=>{_0x467e94[a142_0x337f('0xc')](a142_0x337f('0xf'),a142_0x337f('0x52'))['len']({'min':0x4});_0x467e94[a142_0x337f('0xc')](a142_0x337f('0x53'),a142_0x337f('0x54'))[a142_0x337f('0x23')](_0x467e94[a142_0x337f('0x24')][a142_0x337f('0xf')]);const _0x3b333d=_0x467e94['validationErrors']();if(_0x3b333d){_0x467e94[a142_0x337f('0x12')](a142_0x337f('0x13'),_0x3b333d);return _0x589392['redirect'](a142_0x337f('0x55'));}async_1[a142_0x337f('0x15')]['waterfall']([function resetPassword(_0x4a8bbd){User_1[a142_0x337f('0x15')][a142_0x337f('0x28')]({'passwordResetToken':_0x467e94[a142_0x337f('0x40')]['token']})[a142_0x337f('0x4a')](a142_0x337f('0x56'))['gt'](Date[a142_0x337f('0x4b')]())[a142_0x337f('0x4c')]((_0x34a008,_0x2ac97b)=>{if(_0x34a008){return _0x9edf6(_0x34a008);}if(!_0x2ac97b){_0x467e94[a142_0x337f('0x12')]('errors',{'msg':a142_0x337f('0x4d')});return _0x589392[a142_0x337f('0x7')](a142_0x337f('0x55'));}_0x2ac97b['password']=_0x467e94[a142_0x337f('0x24')][a142_0x337f('0xf')];_0x2ac97b[a142_0x337f('0x57')]=undefined;_0x2ac97b[a142_0x337f('0x56')]=undefined;_0x2ac97b[a142_0x337f('0x2a')](_0x34a008=>{if(_0x34a008){return _0x9edf6(_0x34a008);}_0x467e94[a142_0x337f('0x18')](_0x2ac97b,_0x34a008=>{_0x4a8bbd(_0x34a008,_0x2ac97b);});});});},function sendResetPasswordEmail(_0x24e9af,_0x50db55){const _0x53b68c=nodemailer_1[a142_0x337f('0x15')][a142_0x337f('0x58')]({'service':a142_0x337f('0x59'),'auth':{'user':process['env'][a142_0x337f('0x5a')],'pass':process['env'][a142_0x337f('0x5b')]}});const _0x1541aa={'to':_0x24e9af['email'],'from':a142_0x337f('0x5c'),'subject':a142_0x337f('0x5d'),'text':a142_0x337f('0x5e')+_0x24e9af[a142_0x337f('0x1f')]+'\x20has\x20just\x20been\x20changed.\x0a'};_0x53b68c[a142_0x337f('0x5f')](_0x1541aa,_0x1a4afa=>{_0x467e94[a142_0x337f('0x12')]('success',{'msg':'Success!\x20Your\x20password\x20has\x20been\x20changed.'});_0x50db55(_0x1a4afa);});}],_0xbb0221=>{if(_0xbb0221){return _0x9edf6(_0xbb0221);}_0x589392[a142_0x337f('0x7')]('/');});};exports['getForgot']=(_0x593822,_0x3297a7)=>{if(_0x593822[a142_0x337f('0x48')]()){return _0x3297a7['redirect']('/');}_0x3297a7[a142_0x337f('0x8')]('account/forgot',{'title':a142_0x337f('0x60')});};exports[a142_0x337f('0x61')]=(_0x519a32,_0x3c8bec,_0x24781b)=>{_0x519a32[a142_0x337f('0xc')](a142_0x337f('0x1f'),a142_0x337f('0x2e'))[a142_0x337f('0xe')]();_0x519a32[a142_0x337f('0x11')](a142_0x337f('0x1f'))['normalizeEmail']({'gmail_remove_dots':![]});const _0x31ebf7=_0x519a32['validationErrors']();if(_0x31ebf7){_0x519a32[a142_0x337f('0x12')](a142_0x337f('0x13'),_0x31ebf7);return _0x3c8bec[a142_0x337f('0x7')]('/forgot');}async_1['default']['waterfall']([function createRandomToken(_0x2035e1){crypto_1['default'][a142_0x337f('0x62')](0x10,(_0x5a300a,_0x37e736)=>{const _0x519649=_0x37e736[a142_0x337f('0x63')](a142_0x337f('0x64'));_0x2035e1(_0x5a300a,_0x519649);});},function setRandomToken(_0x1ba020,_0x3f9ba1){User_1[a142_0x337f('0x15')]['findOne']({'email':_0x519a32[a142_0x337f('0x24')][a142_0x337f('0x1f')]},(_0x4c5a0c,_0x1202fe)=>{if(_0x4c5a0c){return _0x3f9ba1(_0x4c5a0c);}if(!_0x1202fe){_0x519a32['flash'](a142_0x337f('0x13'),{'msg':a142_0x337f('0x65')});return _0x3c8bec[a142_0x337f('0x7')]('/forgot');}_0x1202fe[a142_0x337f('0x57')]=_0x1ba020;_0x1202fe[a142_0x337f('0x56')]=Date[a142_0x337f('0x4b')]()+0x36ee80;_0x1202fe[a142_0x337f('0x2a')](_0x4c5a0c=>{_0x3f9ba1(_0x4c5a0c,_0x1ba020,_0x1202fe);});});},function sendForgotPasswordEmail(_0x10fb46,_0x26b6a1,_0x2c0f7b){const _0x110e73=nodemailer_1[a142_0x337f('0x15')]['createTransport']({'service':a142_0x337f('0x59'),'auth':{'user':process[a142_0x337f('0x66')][a142_0x337f('0x5a')],'pass':process['env']['SENDGRID_PASSWORD']}});const _0x5ba7fd={'to':_0x26b6a1[a142_0x337f('0x1f')],'from':a142_0x337f('0x67'),'subject':a142_0x337f('0x68'),'text':'You\x20are\x20receiving\x20this\x20email\x20because\x20you\x20(or\x20someone\x20else)\x20have\x20requested\x20the\x20reset\x20of\x20the\x20password\x20for\x20your\x20account.\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Please\x20click\x20on\x20the\x20following\x20link,\x20or\x20paste\x20this\x20into\x20your\x20browser\x20to\x20complete\x20the\x20process:\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20http://'+_0x519a32['headers'][a142_0x337f('0x69')]+a142_0x337f('0x6a')+_0x10fb46+a142_0x337f('0x6b')};_0x110e73[a142_0x337f('0x5f')](_0x5ba7fd,_0x31cef7=>{_0x519a32[a142_0x337f('0x12')](a142_0x337f('0x45'),{'msg':'An\x20e-mail\x20has\x20been\x20sent\x20to\x20'+_0x26b6a1[a142_0x337f('0x1f')]+a142_0x337f('0x6c')});_0x2c0f7b(_0x31cef7);});}],_0x2c1e8c=>{if(_0x2c1e8c){return _0x24781b(_0x2c1e8c);}_0x3c8bec[a142_0x337f('0x7')](a142_0x337f('0x4e'));});};
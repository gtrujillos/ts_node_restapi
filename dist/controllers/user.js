var a95_0x59cb=['host','/reset/','sendMail','An\x20e-mail\x20has\x20been\x20sent\x20to\x20','defineProperty','async','nodemailer','passport','express-validator','getLogin','redirect','render','assert','password','notEmpty','sanitize','email','normalizeEmail','validationErrors','flash','errors','/login','default','authenticate','local','message','success','Success!\x20You\x20are\x20logged\x20in.','session','returnTo','logout','user','account/signup','Create\x20Account','postSignup','Email\x20is\x20not\x20valid','isEmail','Password\x20must\x20be\x20at\x20least\x204\x20characters\x20long','len','confirmPassword','body','/signup','findOne','Account\x20with\x20that\x20email\x20address\x20already\x20exists.','logIn','getAccount','account/profile','postUpdateProfile','Please\x20enter\x20a\x20valid\x20email\x20address.','/account','findById','name','gender','profile','location','website','code','Profile\x20information\x20has\x20been\x20updated.','postUpdatePassword','Passwords\x20do\x20not\x20match','equals','save','Password\x20has\x20been\x20changed.','info','Your\x20account\x20has\x20been\x20deleted.','getOauthUnlink','params','tokens','filter','\x20account\x20has\x20been\x20unlinked.','getReset','isAuthenticated','token','where','passwordResetExpires','Password\x20reset\x20token\x20is\x20invalid\x20or\x20has\x20expired.','/forgot','account/reset','Password\x20must\x20be\x20at\x20least\x204\x20characters\x20long.','confirm','Passwords\x20must\x20match.','waterfall','now','exec','back','passwordResetToken','createTransport','SendGrid','env','SENDGRID_USER','SENDGRID_PASSWORD','express-ts@starter.com','Hello,\x0a\x0aThis\x20is\x20a\x20confirmation\x20that\x20the\x20password\x20for\x20your\x20account\x20','\x20has\x20just\x20been\x20changed.\x0a','Success!\x20Your\x20password\x20has\x20been\x20changed.','getForgot','account/forgot','Forgot\x20Password','postForgot','hex','hackathon@starter.com','Reset\x20your\x20password\x20on\x20Hackathon\x20Starter','You\x20are\x20receiving\x20this\x20email\x20because\x20you\x20(or\x20someone\x20else)\x20have\x20requested\x20the\x20reset\x20of\x20the\x20password\x20for\x20your\x20account.\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Please\x20click\x20on\x20the\x20following\x20link,\x20or\x20paste\x20this\x20into\x20your\x20browser\x20to\x20complete\x20the\x20process:\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20http://','headers'];(function(_0x45359c,_0x2ef2ab){var _0x28407d=function(_0x3df710){while(--_0x3df710){_0x45359c['push'](_0x45359c['shift']());}};_0x28407d(++_0x2ef2ab);}(a95_0x59cb,0x13c));var a95_0x25cc=function(_0x5699f6,_0x3ec122){_0x5699f6=_0x5699f6-0x0;var _0x3027bd=a95_0x59cb[_0x5699f6];return _0x3027bd;};'use strict';var __importDefault=this&&this['__importDefault']||function(_0x1a2c53){return _0x1a2c53&&_0x1a2c53['__esModule']?_0x1a2c53:{'default':_0x1a2c53};};Object[a95_0x25cc('0x0')](exports,'__esModule',{'value':!![]});const async_1=__importDefault(require(a95_0x25cc('0x1')));const crypto_1=__importDefault(require('crypto'));const nodemailer_1=__importDefault(require(a95_0x25cc('0x2')));const passport_1=__importDefault(require(a95_0x25cc('0x3')));const User_1=__importDefault(require('../models/User'));const request=require(a95_0x25cc('0x4'));exports[a95_0x25cc('0x5')]=(_0x1246b6,_0x4bcd66)=>{if(_0x1246b6['user']){return _0x4bcd66[a95_0x25cc('0x6')]('/');}_0x4bcd66[a95_0x25cc('0x7')]('account/login',{'title':'Login'});};exports['postLogin']=(_0x4e082c,_0x5664fb,_0x461e76)=>{_0x4e082c[a95_0x25cc('0x8')]('email','Email\x20is\x20not\x20valid')['isEmail']();_0x4e082c[a95_0x25cc('0x8')](a95_0x25cc('0x9'),'Password\x20cannot\x20be\x20blank')[a95_0x25cc('0xa')]();_0x4e082c[a95_0x25cc('0xb')](a95_0x25cc('0xc'))[a95_0x25cc('0xd')]({'gmail_remove_dots':![]});const _0x1015b8=_0x4e082c[a95_0x25cc('0xe')]();if(_0x1015b8){_0x4e082c[a95_0x25cc('0xf')](a95_0x25cc('0x10'),_0x1015b8);return _0x5664fb[a95_0x25cc('0x6')](a95_0x25cc('0x11'));}passport_1[a95_0x25cc('0x12')][a95_0x25cc('0x13')](a95_0x25cc('0x14'),(_0x2edbf3,_0x1d1c9c,_0x331a5c)=>{if(_0x2edbf3){return _0x461e76(_0x2edbf3);}if(!_0x1d1c9c){_0x4e082c[a95_0x25cc('0xf')](a95_0x25cc('0x10'),_0x331a5c[a95_0x25cc('0x15')]);return _0x5664fb['redirect']('/login');}_0x4e082c['logIn'](_0x1d1c9c,_0x2edbf3=>{if(_0x2edbf3){return _0x461e76(_0x2edbf3);}_0x4e082c[a95_0x25cc('0xf')](a95_0x25cc('0x16'),{'msg':a95_0x25cc('0x17')});_0x5664fb[a95_0x25cc('0x6')](_0x4e082c[a95_0x25cc('0x18')][a95_0x25cc('0x19')]||'/');});})(_0x4e082c,_0x5664fb,_0x461e76);};exports['logout']=(_0x251968,_0x41f817)=>{_0x251968[a95_0x25cc('0x1a')]();_0x41f817[a95_0x25cc('0x6')]('/');};exports['getSignup']=(_0x3403d8,_0x212462)=>{if(_0x3403d8[a95_0x25cc('0x1b')]){return _0x212462[a95_0x25cc('0x6')]('/');}_0x212462['render'](a95_0x25cc('0x1c'),{'title':a95_0x25cc('0x1d')});};exports[a95_0x25cc('0x1e')]=(_0x1006ff,_0x1907d5,_0x2dcf33)=>{_0x1006ff[a95_0x25cc('0x8')](a95_0x25cc('0xc'),a95_0x25cc('0x1f'))[a95_0x25cc('0x20')]();_0x1006ff[a95_0x25cc('0x8')](a95_0x25cc('0x9'),a95_0x25cc('0x21'))[a95_0x25cc('0x22')]({'min':0x4});_0x1006ff[a95_0x25cc('0x8')](a95_0x25cc('0x23'),'Passwords\x20do\x20not\x20match')['equals'](_0x1006ff[a95_0x25cc('0x24')]['password']);_0x1006ff[a95_0x25cc('0xb')](a95_0x25cc('0xc'))[a95_0x25cc('0xd')]({'gmail_remove_dots':![]});const _0x122f42=_0x1006ff['validationErrors']();if(_0x122f42){_0x1006ff[a95_0x25cc('0xf')](a95_0x25cc('0x10'),_0x122f42);return _0x1907d5[a95_0x25cc('0x6')](a95_0x25cc('0x25'));}const _0x55b7f5=new User_1['default']({'email':_0x1006ff[a95_0x25cc('0x24')][a95_0x25cc('0xc')],'password':_0x1006ff[a95_0x25cc('0x24')][a95_0x25cc('0x9')]});User_1[a95_0x25cc('0x12')][a95_0x25cc('0x26')]({'email':_0x1006ff['body'][a95_0x25cc('0xc')]},(_0x2d07a6,_0x59b7c7)=>{if(_0x2d07a6){return _0x2dcf33(_0x2d07a6);}if(_0x59b7c7){_0x1006ff[a95_0x25cc('0xf')](a95_0x25cc('0x10'),{'msg':a95_0x25cc('0x27')});return _0x1907d5[a95_0x25cc('0x6')](a95_0x25cc('0x25'));}_0x55b7f5['save'](_0x2d07a6=>{if(_0x2d07a6){return _0x2dcf33(_0x2d07a6);}_0x1006ff[a95_0x25cc('0x28')](_0x55b7f5,_0x2d07a6=>{if(_0x2d07a6){return _0x2dcf33(_0x2d07a6);}_0x1907d5[a95_0x25cc('0x6')]('/');});});});};exports[a95_0x25cc('0x29')]=(_0xf0f530,_0x50272f)=>{_0x50272f[a95_0x25cc('0x7')](a95_0x25cc('0x2a'),{'title':'Account\x20Management'});};exports[a95_0x25cc('0x2b')]=(_0x405975,_0x1dbfc8,_0x1bc5e5)=>{_0x405975[a95_0x25cc('0x8')](a95_0x25cc('0xc'),a95_0x25cc('0x2c'))[a95_0x25cc('0x20')]();_0x405975[a95_0x25cc('0xb')](a95_0x25cc('0xc'))[a95_0x25cc('0xd')]({'gmail_remove_dots':![]});const _0x5c0271=_0x405975['validationErrors']();if(_0x5c0271){_0x405975[a95_0x25cc('0xf')](a95_0x25cc('0x10'),_0x5c0271);return _0x1dbfc8[a95_0x25cc('0x6')](a95_0x25cc('0x2d'));}User_1[a95_0x25cc('0x12')][a95_0x25cc('0x2e')](_0x405975[a95_0x25cc('0x1b')]['id'],(_0x5a457d,_0x30ef09)=>{if(_0x5a457d){return _0x1bc5e5(_0x5a457d);}_0x30ef09['email']=_0x405975['body']['email']||'';_0x30ef09['profile'][a95_0x25cc('0x2f')]=_0x405975[a95_0x25cc('0x24')][a95_0x25cc('0x2f')]||'';_0x30ef09['profile']['gender']=_0x405975[a95_0x25cc('0x24')][a95_0x25cc('0x30')]||'';_0x30ef09[a95_0x25cc('0x31')]['location']=_0x405975[a95_0x25cc('0x24')][a95_0x25cc('0x32')]||'';_0x30ef09['profile'][a95_0x25cc('0x33')]=_0x405975[a95_0x25cc('0x24')][a95_0x25cc('0x33')]||'';_0x30ef09['save'](_0x5a457d=>{if(_0x5a457d){if(_0x5a457d[a95_0x25cc('0x34')]===0x2af8){_0x405975[a95_0x25cc('0xf')](a95_0x25cc('0x10'),{'msg':'The\x20email\x20address\x20you\x20have\x20entered\x20is\x20already\x20associated\x20with\x20an\x20account.'});return _0x1dbfc8[a95_0x25cc('0x6')](a95_0x25cc('0x2d'));}return _0x1bc5e5(_0x5a457d);}_0x405975[a95_0x25cc('0xf')](a95_0x25cc('0x16'),{'msg':a95_0x25cc('0x35')});_0x1dbfc8[a95_0x25cc('0x6')](a95_0x25cc('0x2d'));});});};exports[a95_0x25cc('0x36')]=(_0x52d014,_0x13678f,_0x5c3d96)=>{_0x52d014[a95_0x25cc('0x8')](a95_0x25cc('0x9'),a95_0x25cc('0x21'))[a95_0x25cc('0x22')]({'min':0x4});_0x52d014[a95_0x25cc('0x8')]('confirmPassword',a95_0x25cc('0x37'))[a95_0x25cc('0x38')](_0x52d014['body'][a95_0x25cc('0x9')]);const _0x3b72fe=_0x52d014[a95_0x25cc('0xe')]();if(_0x3b72fe){_0x52d014[a95_0x25cc('0xf')]('errors',_0x3b72fe);return _0x13678f[a95_0x25cc('0x6')](a95_0x25cc('0x2d'));}User_1[a95_0x25cc('0x12')]['findById'](_0x52d014[a95_0x25cc('0x1b')]['id'],(_0x536416,_0x5b27ef)=>{if(_0x536416){return _0x5c3d96(_0x536416);}_0x5b27ef['password']=_0x52d014[a95_0x25cc('0x24')][a95_0x25cc('0x9')];_0x5b27ef[a95_0x25cc('0x39')](_0x536416=>{if(_0x536416){return _0x5c3d96(_0x536416);}_0x52d014[a95_0x25cc('0xf')](a95_0x25cc('0x16'),{'msg':a95_0x25cc('0x3a')});_0x13678f[a95_0x25cc('0x6')](a95_0x25cc('0x2d'));});});};exports['postDeleteAccount']=(_0x374fd8,_0x4d8411,_0x1c01bd)=>{User_1[a95_0x25cc('0x12')]['remove']({'_id':_0x374fd8[a95_0x25cc('0x1b')]['id']},_0x23579c=>{if(_0x23579c){return _0x1c01bd(_0x23579c);}_0x374fd8[a95_0x25cc('0x1a')]();_0x374fd8['flash'](a95_0x25cc('0x3b'),{'msg':a95_0x25cc('0x3c')});_0x4d8411[a95_0x25cc('0x6')]('/');});};exports[a95_0x25cc('0x3d')]=(_0x22ddb0,_0x59a616,_0x47b88b)=>{const _0x32a463=_0x22ddb0[a95_0x25cc('0x3e')]['provider'];User_1[a95_0x25cc('0x12')][a95_0x25cc('0x2e')](_0x22ddb0['user']['id'],(_0x5a10f3,_0x65bd8f)=>{if(_0x5a10f3){return _0x47b88b(_0x5a10f3);}_0x65bd8f[_0x32a463]=undefined;_0x65bd8f[a95_0x25cc('0x3f')]=_0x65bd8f[a95_0x25cc('0x3f')][a95_0x25cc('0x40')](_0x4b2567=>_0x4b2567['kind']!==_0x32a463);_0x65bd8f[a95_0x25cc('0x39')](_0x5a10f3=>{if(_0x5a10f3){return _0x47b88b(_0x5a10f3);}_0x22ddb0[a95_0x25cc('0xf')]('info',{'msg':_0x32a463+a95_0x25cc('0x41')});_0x59a616[a95_0x25cc('0x6')](a95_0x25cc('0x2d'));});});};exports[a95_0x25cc('0x42')]=(_0x2f5489,_0xa3c2d2,_0x4d08dc)=>{if(_0x2f5489[a95_0x25cc('0x43')]()){return _0xa3c2d2[a95_0x25cc('0x6')]('/');}User_1[a95_0x25cc('0x12')]['findOne']({'passwordResetToken':_0x2f5489[a95_0x25cc('0x3e')][a95_0x25cc('0x44')]})[a95_0x25cc('0x45')](a95_0x25cc('0x46'))['gt'](Date['now']())['exec']((_0x45490c,_0x4e3c2c)=>{if(_0x45490c){return _0x4d08dc(_0x45490c);}if(!_0x4e3c2c){_0x2f5489[a95_0x25cc('0xf')](a95_0x25cc('0x10'),{'msg':a95_0x25cc('0x47')});return _0xa3c2d2['redirect'](a95_0x25cc('0x48'));}_0xa3c2d2[a95_0x25cc('0x7')](a95_0x25cc('0x49'),{'title':'Password\x20Reset'});});};exports['postReset']=(_0x301099,_0x45b808,_0x31ad5e)=>{_0x301099[a95_0x25cc('0x8')](a95_0x25cc('0x9'),a95_0x25cc('0x4a'))['len']({'min':0x4});_0x301099[a95_0x25cc('0x8')](a95_0x25cc('0x4b'),a95_0x25cc('0x4c'))[a95_0x25cc('0x38')](_0x301099[a95_0x25cc('0x24')]['password']);const _0x2456df=_0x301099[a95_0x25cc('0xe')]();if(_0x2456df){_0x301099[a95_0x25cc('0xf')](a95_0x25cc('0x10'),_0x2456df);return _0x45b808[a95_0x25cc('0x6')]('back');}async_1['default'][a95_0x25cc('0x4d')]([function resetPassword(_0x4c3130){User_1[a95_0x25cc('0x12')]['findOne']({'passwordResetToken':_0x301099[a95_0x25cc('0x3e')][a95_0x25cc('0x44')]})[a95_0x25cc('0x45')]('passwordResetExpires')['gt'](Date[a95_0x25cc('0x4e')]())[a95_0x25cc('0x4f')]((_0xc61fcc,_0x297189)=>{if(_0xc61fcc){return _0x31ad5e(_0xc61fcc);}if(!_0x297189){_0x301099[a95_0x25cc('0xf')](a95_0x25cc('0x10'),{'msg':'Password\x20reset\x20token\x20is\x20invalid\x20or\x20has\x20expired.'});return _0x45b808[a95_0x25cc('0x6')](a95_0x25cc('0x50'));}_0x297189[a95_0x25cc('0x9')]=_0x301099['body']['password'];_0x297189[a95_0x25cc('0x51')]=undefined;_0x297189[a95_0x25cc('0x46')]=undefined;_0x297189['save'](_0xc61fcc=>{if(_0xc61fcc){return _0x31ad5e(_0xc61fcc);}_0x301099['logIn'](_0x297189,_0xc61fcc=>{_0x4c3130(_0xc61fcc,_0x297189);});});});},function sendResetPasswordEmail(_0x5027c5,_0x2c0c34){const _0x55ccab=nodemailer_1[a95_0x25cc('0x12')][a95_0x25cc('0x52')]({'service':a95_0x25cc('0x53'),'auth':{'user':process[a95_0x25cc('0x54')][a95_0x25cc('0x55')],'pass':process['env'][a95_0x25cc('0x56')]}});const _0x58aea8={'to':_0x5027c5['email'],'from':a95_0x25cc('0x57'),'subject':'Your\x20password\x20has\x20been\x20changed','text':a95_0x25cc('0x58')+_0x5027c5[a95_0x25cc('0xc')]+a95_0x25cc('0x59')};_0x55ccab['sendMail'](_0x58aea8,_0x156256=>{_0x301099[a95_0x25cc('0xf')](a95_0x25cc('0x16'),{'msg':a95_0x25cc('0x5a')});_0x2c0c34(_0x156256);});}],_0x36229e=>{if(_0x36229e){return _0x31ad5e(_0x36229e);}_0x45b808[a95_0x25cc('0x6')]('/');});};exports[a95_0x25cc('0x5b')]=(_0x553ec6,_0x1c41d7)=>{if(_0x553ec6[a95_0x25cc('0x43')]()){return _0x1c41d7['redirect']('/');}_0x1c41d7['render'](a95_0x25cc('0x5c'),{'title':a95_0x25cc('0x5d')});};exports[a95_0x25cc('0x5e')]=(_0x449126,_0x149f7f,_0x3c944f)=>{_0x449126[a95_0x25cc('0x8')](a95_0x25cc('0xc'),a95_0x25cc('0x2c'))['isEmail']();_0x449126[a95_0x25cc('0xb')](a95_0x25cc('0xc'))[a95_0x25cc('0xd')]({'gmail_remove_dots':![]});const _0xc5d3c5=_0x449126[a95_0x25cc('0xe')]();if(_0xc5d3c5){_0x449126[a95_0x25cc('0xf')](a95_0x25cc('0x10'),_0xc5d3c5);return _0x149f7f[a95_0x25cc('0x6')](a95_0x25cc('0x48'));}async_1[a95_0x25cc('0x12')]['waterfall']([function createRandomToken(_0x4e18ea){crypto_1[a95_0x25cc('0x12')]['randomBytes'](0x10,(_0x372a86,_0x2056bd)=>{const _0x22fc6c=_0x2056bd['toString'](a95_0x25cc('0x5f'));_0x4e18ea(_0x372a86,_0x22fc6c);});},function setRandomToken(_0x16b60d,_0x2a8d65){User_1[a95_0x25cc('0x12')][a95_0x25cc('0x26')]({'email':_0x449126[a95_0x25cc('0x24')]['email']},(_0x2e72a0,_0x454ce4)=>{if(_0x2e72a0){return _0x2a8d65(_0x2e72a0);}if(!_0x454ce4){_0x449126['flash']('errors',{'msg':'Account\x20with\x20that\x20email\x20address\x20does\x20not\x20exist.'});return _0x149f7f[a95_0x25cc('0x6')]('/forgot');}_0x454ce4['passwordResetToken']=_0x16b60d;_0x454ce4[a95_0x25cc('0x46')]=Date[a95_0x25cc('0x4e')]()+0x36ee80;_0x454ce4['save'](_0x2e72a0=>{_0x2a8d65(_0x2e72a0,_0x16b60d,_0x454ce4);});});},function sendForgotPasswordEmail(_0x34d003,_0x17da98,_0xa9e50b){const _0x57efa3=nodemailer_1[a95_0x25cc('0x12')][a95_0x25cc('0x52')]({'service':a95_0x25cc('0x53'),'auth':{'user':process['env'][a95_0x25cc('0x55')],'pass':process[a95_0x25cc('0x54')]['SENDGRID_PASSWORD']}});const _0x2affa8={'to':_0x17da98['email'],'from':a95_0x25cc('0x60'),'subject':a95_0x25cc('0x61'),'text':a95_0x25cc('0x62')+_0x449126[a95_0x25cc('0x63')][a95_0x25cc('0x64')]+a95_0x25cc('0x65')+_0x34d003+'\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20If\x20you\x20did\x20not\x20request\x20this,\x20please\x20ignore\x20this\x20email\x20and\x20your\x20password\x20will\x20remain\x20unchanged.\x0a'};_0x57efa3[a95_0x25cc('0x66')](_0x2affa8,_0xbac6d0=>{_0x449126['flash'](a95_0x25cc('0x3b'),{'msg':a95_0x25cc('0x67')+_0x17da98['email']+'\x20with\x20further\x20instructions.'});_0xa9e50b(_0xbac6d0);});}],_0x1c5804=>{if(_0x1c5804){return _0x3c944f(_0x1c5804);}_0x149f7f['redirect'](a95_0x25cc('0x48'));});};
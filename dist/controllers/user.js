var a201_0x376c=['Your\x20password\x20has\x20been\x20changed','sendMail','getForgot','isAuthenticated','account/forgot','postForgot','Please\x20enter\x20a\x20valid\x20email\x20address.','randomBytes','toString','hex','Account\x20with\x20that\x20email\x20address\x20does\x20not\x20exist.','passwordResetToken','Reset\x20your\x20password\x20on\x20Hackathon\x20Starter','You\x20are\x20receiving\x20this\x20email\x20because\x20you\x20(or\x20someone\x20else)\x20have\x20requested\x20the\x20reset\x20of\x20the\x20password\x20for\x20your\x20account.\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Please\x20click\x20on\x20the\x20following\x20link,\x20or\x20paste\x20this\x20into\x20your\x20browser\x20to\x20complete\x20the\x20process:\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20http://','headers','host','\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20If\x20you\x20did\x20not\x20request\x20this,\x20please\x20ignore\x20this\x20email\x20and\x20your\x20password\x20will\x20remain\x20unchanged.\x0a','\x20with\x20further\x20instructions.','__importDefault','__esModule','async','crypto','passport','../models/User','user','redirect','account/login','Login','postLogin','email','Email\x20is\x20not\x20valid','assert','password','notEmpty','sanitize','normalizeEmail','validationErrors','flash','errors','default','authenticate','message','logIn','success','Success!\x20You\x20are\x20logged\x20in.','session','returnTo','logout','getSignup','Create\x20Account','isEmail','Password\x20must\x20be\x20at\x20least\x204\x20characters\x20long','len','confirmPassword','Passwords\x20do\x20not\x20match','equals','body','Account\x20with\x20that\x20email\x20address\x20already\x20exists.','/signup','getAccount','render','Account\x20Management','postUpdateProfile','/account','findById','name','profile','gender','location','website','save','code','The\x20email\x20address\x20you\x20have\x20entered\x20is\x20already\x20associated\x20with\x20an\x20account.','postUpdatePassword','Password\x20has\x20been\x20changed.','remove','Your\x20account\x20has\x20been\x20deleted.','params','provider','tokens','filter','kind','info','getReset','findOne','token','where','passwordResetExpires','now','exec','Password\x20reset\x20token\x20is\x20invalid\x20or\x20has\x20expired.','/forgot','Password\x20must\x20be\x20at\x20least\x204\x20characters\x20long.','confirm','Passwords\x20must\x20match.','waterfall','back','createTransport','SendGrid','env','SENDGRID_PASSWORD','express-ts@starter.com'];(function(_0x4b2d03,_0x5522c5){var _0x319cc7=function(_0x3704f6){while(--_0x3704f6){_0x4b2d03['push'](_0x4b2d03['shift']());}};_0x319cc7(++_0x5522c5);}(a201_0x376c,0x78));var a201_0x28d8=function(_0x36ba46,_0x4dd848){_0x36ba46=_0x36ba46-0x0;var _0x1ee6ce=a201_0x376c[_0x36ba46];return _0x1ee6ce;};'use strict';var __importDefault=this&&this[a201_0x28d8('0x0')]||function(_0x353a41){return _0x353a41&&_0x353a41[a201_0x28d8('0x1')]?_0x353a41:{'default':_0x353a41};};Object['defineProperty'](exports,a201_0x28d8('0x1'),{'value':!![]});const async_1=__importDefault(require(a201_0x28d8('0x2')));const crypto_1=__importDefault(require(a201_0x28d8('0x3')));const nodemailer_1=__importDefault(require('nodemailer'));const passport_1=__importDefault(require(a201_0x28d8('0x4')));const User_1=__importDefault(require(a201_0x28d8('0x5')));const request=require('express-validator');exports['getLogin']=(_0x795b29,_0x31e334)=>{if(_0x795b29[a201_0x28d8('0x6')]){return _0x31e334[a201_0x28d8('0x7')]('/');}_0x31e334['render'](a201_0x28d8('0x8'),{'title':a201_0x28d8('0x9')});};exports[a201_0x28d8('0xa')]=(_0x5e990c,_0x13142d,_0xc3c5e4)=>{_0x5e990c['assert'](a201_0x28d8('0xb'),a201_0x28d8('0xc'))['isEmail']();_0x5e990c[a201_0x28d8('0xd')](a201_0x28d8('0xe'),'Password\x20cannot\x20be\x20blank')[a201_0x28d8('0xf')]();_0x5e990c[a201_0x28d8('0x10')](a201_0x28d8('0xb'))[a201_0x28d8('0x11')]({'gmail_remove_dots':![]});const _0x3dd729=_0x5e990c[a201_0x28d8('0x12')]();if(_0x3dd729){_0x5e990c[a201_0x28d8('0x13')](a201_0x28d8('0x14'),_0x3dd729);return _0x13142d['redirect']('/login');}passport_1[a201_0x28d8('0x15')][a201_0x28d8('0x16')]('local',(_0x5cb497,_0x2d64c7,_0x3ccd58)=>{if(_0x5cb497){return _0xc3c5e4(_0x5cb497);}if(!_0x2d64c7){_0x5e990c[a201_0x28d8('0x13')](a201_0x28d8('0x14'),_0x3ccd58[a201_0x28d8('0x17')]);return _0x13142d[a201_0x28d8('0x7')]('/login');}_0x5e990c[a201_0x28d8('0x18')](_0x2d64c7,_0x5cb497=>{if(_0x5cb497){return _0xc3c5e4(_0x5cb497);}_0x5e990c[a201_0x28d8('0x13')](a201_0x28d8('0x19'),{'msg':a201_0x28d8('0x1a')});_0x13142d[a201_0x28d8('0x7')](_0x5e990c[a201_0x28d8('0x1b')][a201_0x28d8('0x1c')]||'/');});})(_0x5e990c,_0x13142d,_0xc3c5e4);};exports[a201_0x28d8('0x1d')]=(_0x359230,_0x260752)=>{_0x359230[a201_0x28d8('0x1d')]();_0x260752[a201_0x28d8('0x7')]('/');};exports[a201_0x28d8('0x1e')]=(_0x5f1c26,_0x5a38e5)=>{if(_0x5f1c26[a201_0x28d8('0x6')]){return _0x5a38e5[a201_0x28d8('0x7')]('/');}_0x5a38e5['render']('account/signup',{'title':a201_0x28d8('0x1f')});};exports['postSignup']=(_0x342fff,_0x38ad05,_0x489c6a)=>{_0x342fff[a201_0x28d8('0xd')](a201_0x28d8('0xb'),'Email\x20is\x20not\x20valid')[a201_0x28d8('0x20')]();_0x342fff['assert'](a201_0x28d8('0xe'),a201_0x28d8('0x21'))[a201_0x28d8('0x22')]({'min':0x4});_0x342fff[a201_0x28d8('0xd')](a201_0x28d8('0x23'),a201_0x28d8('0x24'))[a201_0x28d8('0x25')](_0x342fff['body']['password']);_0x342fff['sanitize']('email')[a201_0x28d8('0x11')]({'gmail_remove_dots':![]});const _0x1ca2f1=_0x342fff[a201_0x28d8('0x12')]();if(_0x1ca2f1){_0x342fff[a201_0x28d8('0x13')](a201_0x28d8('0x14'),_0x1ca2f1);return _0x38ad05['redirect']('/signup');}const _0x528543=new User_1[(a201_0x28d8('0x15'))]({'email':_0x342fff[a201_0x28d8('0x26')]['email'],'password':_0x342fff[a201_0x28d8('0x26')][a201_0x28d8('0xe')]});User_1[a201_0x28d8('0x15')]['findOne']({'email':_0x342fff[a201_0x28d8('0x26')][a201_0x28d8('0xb')]},(_0x42534e,_0xbe1da3)=>{if(_0x42534e){return _0x489c6a(_0x42534e);}if(_0xbe1da3){_0x342fff[a201_0x28d8('0x13')](a201_0x28d8('0x14'),{'msg':a201_0x28d8('0x27')});return _0x38ad05[a201_0x28d8('0x7')](a201_0x28d8('0x28'));}_0x528543['save'](_0x42534e=>{if(_0x42534e){return _0x489c6a(_0x42534e);}_0x342fff[a201_0x28d8('0x18')](_0x528543,_0x42534e=>{if(_0x42534e){return _0x489c6a(_0x42534e);}_0x38ad05[a201_0x28d8('0x7')]('/');});});});};exports[a201_0x28d8('0x29')]=(_0x218064,_0x4ca426)=>{_0x4ca426[a201_0x28d8('0x2a')]('account/profile',{'title':a201_0x28d8('0x2b')});};exports[a201_0x28d8('0x2c')]=(_0x1536b9,_0x61b1a8,_0x5f214a)=>{_0x1536b9[a201_0x28d8('0xd')](a201_0x28d8('0xb'),'Please\x20enter\x20a\x20valid\x20email\x20address.')['isEmail']();_0x1536b9['sanitize']('email')[a201_0x28d8('0x11')]({'gmail_remove_dots':![]});const _0x40ab79=_0x1536b9[a201_0x28d8('0x12')]();if(_0x40ab79){_0x1536b9[a201_0x28d8('0x13')](a201_0x28d8('0x14'),_0x40ab79);return _0x61b1a8[a201_0x28d8('0x7')](a201_0x28d8('0x2d'));}User_1[a201_0x28d8('0x15')][a201_0x28d8('0x2e')](_0x1536b9[a201_0x28d8('0x6')]['id'],(_0x92603a,_0x452bfd)=>{if(_0x92603a){return _0x5f214a(_0x92603a);}_0x452bfd['email']=_0x1536b9[a201_0x28d8('0x26')][a201_0x28d8('0xb')]||'';_0x452bfd['profile'][a201_0x28d8('0x2f')]=_0x1536b9[a201_0x28d8('0x26')][a201_0x28d8('0x2f')]||'';_0x452bfd[a201_0x28d8('0x30')]['gender']=_0x1536b9['body'][a201_0x28d8('0x31')]||'';_0x452bfd['profile'][a201_0x28d8('0x32')]=_0x1536b9[a201_0x28d8('0x26')][a201_0x28d8('0x32')]||'';_0x452bfd['profile'][a201_0x28d8('0x33')]=_0x1536b9[a201_0x28d8('0x26')][a201_0x28d8('0x33')]||'';_0x452bfd[a201_0x28d8('0x34')](_0x92603a=>{if(_0x92603a){if(_0x92603a[a201_0x28d8('0x35')]===0x2af8){_0x1536b9[a201_0x28d8('0x13')]('errors',{'msg':a201_0x28d8('0x36')});return _0x61b1a8[a201_0x28d8('0x7')](a201_0x28d8('0x2d'));}return _0x5f214a(_0x92603a);}_0x1536b9[a201_0x28d8('0x13')](a201_0x28d8('0x19'),{'msg':'Profile\x20information\x20has\x20been\x20updated.'});_0x61b1a8[a201_0x28d8('0x7')](a201_0x28d8('0x2d'));});});};exports[a201_0x28d8('0x37')]=(_0x26ac33,_0x2d91ad,_0x5763e3)=>{_0x26ac33[a201_0x28d8('0xd')](a201_0x28d8('0xe'),a201_0x28d8('0x21'))[a201_0x28d8('0x22')]({'min':0x4});_0x26ac33[a201_0x28d8('0xd')](a201_0x28d8('0x23'),a201_0x28d8('0x24'))[a201_0x28d8('0x25')](_0x26ac33['body'][a201_0x28d8('0xe')]);const _0x4f4473=_0x26ac33[a201_0x28d8('0x12')]();if(_0x4f4473){_0x26ac33['flash']('errors',_0x4f4473);return _0x2d91ad[a201_0x28d8('0x7')]('/account');}User_1[a201_0x28d8('0x15')]['findById'](_0x26ac33[a201_0x28d8('0x6')]['id'],(_0x136586,_0x152e8c)=>{if(_0x136586){return _0x5763e3(_0x136586);}_0x152e8c[a201_0x28d8('0xe')]=_0x26ac33[a201_0x28d8('0x26')][a201_0x28d8('0xe')];_0x152e8c[a201_0x28d8('0x34')](_0x136586=>{if(_0x136586){return _0x5763e3(_0x136586);}_0x26ac33[a201_0x28d8('0x13')](a201_0x28d8('0x19'),{'msg':a201_0x28d8('0x38')});_0x2d91ad['redirect'](a201_0x28d8('0x2d'));});});};exports['postDeleteAccount']=(_0x3a1876,_0x3d8233,_0x4eb940)=>{User_1[a201_0x28d8('0x15')][a201_0x28d8('0x39')]({'_id':_0x3a1876[a201_0x28d8('0x6')]['id']},_0x1d14ad=>{if(_0x1d14ad){return _0x4eb940(_0x1d14ad);}_0x3a1876['logout']();_0x3a1876['flash']('info',{'msg':a201_0x28d8('0x3a')});_0x3d8233[a201_0x28d8('0x7')]('/');});};exports['getOauthUnlink']=(_0xd2bd2c,_0x428b46,_0x4d50d3)=>{const _0x312434=_0xd2bd2c[a201_0x28d8('0x3b')][a201_0x28d8('0x3c')];User_1[a201_0x28d8('0x15')]['findById'](_0xd2bd2c[a201_0x28d8('0x6')]['id'],(_0x5adcbe,_0x477f88)=>{if(_0x5adcbe){return _0x4d50d3(_0x5adcbe);}_0x477f88[_0x312434]=undefined;_0x477f88[a201_0x28d8('0x3d')]=_0x477f88[a201_0x28d8('0x3d')][a201_0x28d8('0x3e')](_0xf191fa=>_0xf191fa[a201_0x28d8('0x3f')]!==_0x312434);_0x477f88['save'](_0x5adcbe=>{if(_0x5adcbe){return _0x4d50d3(_0x5adcbe);}_0xd2bd2c[a201_0x28d8('0x13')](a201_0x28d8('0x40'),{'msg':_0x312434+'\x20account\x20has\x20been\x20unlinked.'});_0x428b46[a201_0x28d8('0x7')](a201_0x28d8('0x2d'));});});};exports[a201_0x28d8('0x41')]=(_0x2ea0b6,_0x4bf832,_0x314672)=>{if(_0x2ea0b6['isAuthenticated']()){return _0x4bf832[a201_0x28d8('0x7')]('/');}User_1[a201_0x28d8('0x15')][a201_0x28d8('0x42')]({'passwordResetToken':_0x2ea0b6[a201_0x28d8('0x3b')][a201_0x28d8('0x43')]})[a201_0x28d8('0x44')](a201_0x28d8('0x45'))['gt'](Date[a201_0x28d8('0x46')]())[a201_0x28d8('0x47')]((_0x367ec5,_0x136908)=>{if(_0x367ec5){return _0x314672(_0x367ec5);}if(!_0x136908){_0x2ea0b6[a201_0x28d8('0x13')]('errors',{'msg':a201_0x28d8('0x48')});return _0x4bf832[a201_0x28d8('0x7')](a201_0x28d8('0x49'));}_0x4bf832['render']('account/reset',{'title':'Password\x20Reset'});});};exports['postReset']=(_0x42a2fe,_0x16064c,_0x913a3f)=>{_0x42a2fe[a201_0x28d8('0xd')](a201_0x28d8('0xe'),a201_0x28d8('0x4a'))[a201_0x28d8('0x22')]({'min':0x4});_0x42a2fe[a201_0x28d8('0xd')](a201_0x28d8('0x4b'),a201_0x28d8('0x4c'))['equals'](_0x42a2fe[a201_0x28d8('0x26')][a201_0x28d8('0xe')]);const _0x12befb=_0x42a2fe['validationErrors']();if(_0x12befb){_0x42a2fe[a201_0x28d8('0x13')]('errors',_0x12befb);return _0x16064c[a201_0x28d8('0x7')]('back');}async_1[a201_0x28d8('0x15')][a201_0x28d8('0x4d')]([function resetPassword(_0x3d2b45){User_1[a201_0x28d8('0x15')][a201_0x28d8('0x42')]({'passwordResetToken':_0x42a2fe[a201_0x28d8('0x3b')][a201_0x28d8('0x43')]})['where'](a201_0x28d8('0x45'))['gt'](Date['now']())['exec']((_0x131e36,_0x84d888)=>{if(_0x131e36){return _0x913a3f(_0x131e36);}if(!_0x84d888){_0x42a2fe[a201_0x28d8('0x13')]('errors',{'msg':a201_0x28d8('0x48')});return _0x16064c['redirect'](a201_0x28d8('0x4e'));}_0x84d888[a201_0x28d8('0xe')]=_0x42a2fe['body']['password'];_0x84d888['passwordResetToken']=undefined;_0x84d888[a201_0x28d8('0x45')]=undefined;_0x84d888[a201_0x28d8('0x34')](_0x131e36=>{if(_0x131e36){return _0x913a3f(_0x131e36);}_0x42a2fe[a201_0x28d8('0x18')](_0x84d888,_0x131e36=>{_0x3d2b45(_0x131e36,_0x84d888);});});});},function sendResetPasswordEmail(_0xea04f4,_0x1ae157){const _0x53eebc=nodemailer_1[a201_0x28d8('0x15')][a201_0x28d8('0x4f')]({'service':a201_0x28d8('0x50'),'auth':{'user':process['env']['SENDGRID_USER'],'pass':process[a201_0x28d8('0x51')][a201_0x28d8('0x52')]}});const _0x54b360={'to':_0xea04f4['email'],'from':a201_0x28d8('0x53'),'subject':a201_0x28d8('0x54'),'text':'Hello,\x0a\x0aThis\x20is\x20a\x20confirmation\x20that\x20the\x20password\x20for\x20your\x20account\x20'+_0xea04f4[a201_0x28d8('0xb')]+'\x20has\x20just\x20been\x20changed.\x0a'};_0x53eebc[a201_0x28d8('0x55')](_0x54b360,_0x5e54b9=>{_0x42a2fe[a201_0x28d8('0x13')](a201_0x28d8('0x19'),{'msg':'Success!\x20Your\x20password\x20has\x20been\x20changed.'});_0x1ae157(_0x5e54b9);});}],_0x27105a=>{if(_0x27105a){return _0x913a3f(_0x27105a);}_0x16064c[a201_0x28d8('0x7')]('/');});};exports[a201_0x28d8('0x56')]=(_0x2df8d3,_0x50d4af)=>{if(_0x2df8d3[a201_0x28d8('0x57')]()){return _0x50d4af['redirect']('/');}_0x50d4af[a201_0x28d8('0x2a')](a201_0x28d8('0x58'),{'title':'Forgot\x20Password'});};exports[a201_0x28d8('0x59')]=(_0x4e0213,_0x4a0f79,_0x372743)=>{_0x4e0213[a201_0x28d8('0xd')](a201_0x28d8('0xb'),a201_0x28d8('0x5a'))['isEmail']();_0x4e0213['sanitize'](a201_0x28d8('0xb'))['normalizeEmail']({'gmail_remove_dots':![]});const _0x2824fd=_0x4e0213[a201_0x28d8('0x12')]();if(_0x2824fd){_0x4e0213[a201_0x28d8('0x13')](a201_0x28d8('0x14'),_0x2824fd);return _0x4a0f79['redirect']('/forgot');}async_1['default'][a201_0x28d8('0x4d')]([function createRandomToken(_0x58ecd5){crypto_1[a201_0x28d8('0x15')][a201_0x28d8('0x5b')](0x10,(_0x42d4dc,_0x2b144f)=>{const _0x5b2339=_0x2b144f[a201_0x28d8('0x5c')](a201_0x28d8('0x5d'));_0x58ecd5(_0x42d4dc,_0x5b2339);});},function setRandomToken(_0x41b924,_0x26d846){User_1[a201_0x28d8('0x15')][a201_0x28d8('0x42')]({'email':_0x4e0213[a201_0x28d8('0x26')][a201_0x28d8('0xb')]},(_0x10eff6,_0x28c7bd)=>{if(_0x10eff6){return _0x26d846(_0x10eff6);}if(!_0x28c7bd){_0x4e0213[a201_0x28d8('0x13')](a201_0x28d8('0x14'),{'msg':a201_0x28d8('0x5e')});return _0x4a0f79[a201_0x28d8('0x7')](a201_0x28d8('0x49'));}_0x28c7bd[a201_0x28d8('0x5f')]=_0x41b924;_0x28c7bd['passwordResetExpires']=Date[a201_0x28d8('0x46')]()+0x36ee80;_0x28c7bd[a201_0x28d8('0x34')](_0x10eff6=>{_0x26d846(_0x10eff6,_0x41b924,_0x28c7bd);});});},function sendForgotPasswordEmail(_0x452f1e,_0x175c5f,_0x297ce0){const _0x5633cc=nodemailer_1[a201_0x28d8('0x15')][a201_0x28d8('0x4f')]({'service':a201_0x28d8('0x50'),'auth':{'user':process[a201_0x28d8('0x51')]['SENDGRID_USER'],'pass':process['env']['SENDGRID_PASSWORD']}});const _0x307adb={'to':_0x175c5f[a201_0x28d8('0xb')],'from':'hackathon@starter.com','subject':a201_0x28d8('0x60'),'text':a201_0x28d8('0x61')+_0x4e0213[a201_0x28d8('0x62')][a201_0x28d8('0x63')]+'/reset/'+_0x452f1e+a201_0x28d8('0x64')};_0x5633cc[a201_0x28d8('0x55')](_0x307adb,_0x72d0c9=>{_0x4e0213[a201_0x28d8('0x13')](a201_0x28d8('0x40'),{'msg':'An\x20e-mail\x20has\x20been\x20sent\x20to\x20'+_0x175c5f[a201_0x28d8('0xb')]+a201_0x28d8('0x65')});_0x297ce0(_0x72d0c9);});}],_0x13ea04=>{if(_0x13ea04){return _0x372743(_0x13ea04);}_0x4a0f79['redirect']('/forgot');});};
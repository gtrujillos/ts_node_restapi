var a291_0x385e=['errors','/login','default','authenticate','local','message','logIn','success','Success!\x20You\x20are\x20logged\x20in.','session','returnTo','logout','getSignup','account/signup','Create\x20Account','postSignup','password','Password\x20must\x20be\x20at\x20least\x204\x20characters\x20long','len','confirmPassword','Passwords\x20do\x20not\x20match','/signup','body','findOne','save','account/profile','Account\x20Management','postUpdateProfile','Please\x20enter\x20a\x20valid\x20email\x20address.','/account','findById','name','profile','gender','website','code','The\x20email\x20address\x20you\x20have\x20entered\x20is\x20already\x20associated\x20with\x20an\x20account.','Profile\x20information\x20has\x20been\x20updated.','postUpdatePassword','equals','Password\x20has\x20been\x20changed.','remove','Your\x20account\x20has\x20been\x20deleted.','provider','tokens','kind','info','\x20account\x20has\x20been\x20unlinked.','getReset','params','token','where','passwordResetExpires','now','/forgot','account/reset','Password\x20Reset','postReset','Password\x20must\x20be\x20at\x20least\x204\x20characters\x20long.','confirm','Passwords\x20must\x20match.','back','passwordResetToken','createTransport','SendGrid','SENDGRID_USER','env','SENDGRID_PASSWORD','express-ts@starter.com','Your\x20password\x20has\x20been\x20changed','Hello,\x0a\x0aThis\x20is\x20a\x20confirmation\x20that\x20the\x20password\x20for\x20your\x20account\x20','sendMail','Success!\x20Your\x20password\x20has\x20been\x20changed.','getForgot','isAuthenticated','account/forgot','Forgot\x20Password','postForgot','waterfall','hex','Account\x20with\x20that\x20email\x20address\x20does\x20not\x20exist.','hackathon@starter.com','Reset\x20your\x20password\x20on\x20Hackathon\x20Starter','You\x20are\x20receiving\x20this\x20email\x20because\x20you\x20(or\x20someone\x20else)\x20have\x20requested\x20the\x20reset\x20of\x20the\x20password\x20for\x20your\x20account.\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Please\x20click\x20on\x20the\x20following\x20link,\x20or\x20paste\x20this\x20into\x20your\x20browser\x20to\x20complete\x20the\x20process:\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20http://','host','/reset/','\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20If\x20you\x20did\x20not\x20request\x20this,\x20please\x20ignore\x20this\x20email\x20and\x20your\x20password\x20will\x20remain\x20unchanged.\x0a','An\x20e-mail\x20has\x20been\x20sent\x20to\x20','\x20with\x20further\x20instructions.','__importDefault','__esModule','defineProperty','async','crypto','nodemailer','getLogin','user','redirect','render','account/login','Login','assert','email','Email\x20is\x20not\x20valid','isEmail','notEmpty','sanitize','normalizeEmail','validationErrors','flash'];(function(_0x10b360,_0x5a9b53){var _0x54d465=function(_0x29f385){while(--_0x29f385){_0x10b360['push'](_0x10b360['shift']());}};_0x54d465(++_0x5a9b53);}(a291_0x385e,0x135));var a291_0x2d42=function(_0x1a195c,_0x8752c7){_0x1a195c=_0x1a195c-0x0;var _0x5dcffb=a291_0x385e[_0x1a195c];return _0x5dcffb;};'use strict';var __importDefault=this&&this[a291_0x2d42('0x0')]||function(_0x25cc4b){return _0x25cc4b&&_0x25cc4b[a291_0x2d42('0x1')]?_0x25cc4b:{'default':_0x25cc4b};};Object[a291_0x2d42('0x2')](exports,a291_0x2d42('0x1'),{'value':!![]});const async_1=__importDefault(require(a291_0x2d42('0x3')));const crypto_1=__importDefault(require(a291_0x2d42('0x4')));const nodemailer_1=__importDefault(require(a291_0x2d42('0x5')));const passport_1=__importDefault(require('passport'));const User_1=__importDefault(require('../models/User'));const request=require('express-validator');exports[a291_0x2d42('0x6')]=(_0x31fac3,_0x158c4e)=>{if(_0x31fac3[a291_0x2d42('0x7')]){return _0x158c4e[a291_0x2d42('0x8')]('/');}_0x158c4e[a291_0x2d42('0x9')](a291_0x2d42('0xa'),{'title':a291_0x2d42('0xb')});};exports['postLogin']=(_0xd3daa0,_0xaba7f0,_0x5e2568)=>{_0xd3daa0[a291_0x2d42('0xc')](a291_0x2d42('0xd'),a291_0x2d42('0xe'))[a291_0x2d42('0xf')]();_0xd3daa0['assert']('password','Password\x20cannot\x20be\x20blank')[a291_0x2d42('0x10')]();_0xd3daa0[a291_0x2d42('0x11')]('email')[a291_0x2d42('0x12')]({'gmail_remove_dots':![]});const _0x271f23=_0xd3daa0[a291_0x2d42('0x13')]();if(_0x271f23){_0xd3daa0[a291_0x2d42('0x14')](a291_0x2d42('0x15'),_0x271f23);return _0xaba7f0[a291_0x2d42('0x8')](a291_0x2d42('0x16'));}passport_1[a291_0x2d42('0x17')][a291_0x2d42('0x18')](a291_0x2d42('0x19'),(_0x1847a1,_0x5a01b2,_0x197cd8)=>{if(_0x1847a1){return _0x5e2568(_0x1847a1);}if(!_0x5a01b2){_0xd3daa0[a291_0x2d42('0x14')](a291_0x2d42('0x15'),_0x197cd8[a291_0x2d42('0x1a')]);return _0xaba7f0[a291_0x2d42('0x8')](a291_0x2d42('0x16'));}_0xd3daa0[a291_0x2d42('0x1b')](_0x5a01b2,_0x1847a1=>{if(_0x1847a1){return _0x5e2568(_0x1847a1);}_0xd3daa0[a291_0x2d42('0x14')](a291_0x2d42('0x1c'),{'msg':a291_0x2d42('0x1d')});_0xaba7f0['redirect'](_0xd3daa0[a291_0x2d42('0x1e')][a291_0x2d42('0x1f')]||'/');});})(_0xd3daa0,_0xaba7f0,_0x5e2568);};exports[a291_0x2d42('0x20')]=(_0x18b411,_0x54362e)=>{_0x18b411['logout']();_0x54362e[a291_0x2d42('0x8')]('/');};exports[a291_0x2d42('0x21')]=(_0x1c6f79,_0x1916d0)=>{if(_0x1c6f79['user']){return _0x1916d0[a291_0x2d42('0x8')]('/');}_0x1916d0[a291_0x2d42('0x9')](a291_0x2d42('0x22'),{'title':a291_0x2d42('0x23')});};exports[a291_0x2d42('0x24')]=(_0x13eae9,_0x9d39fa,_0xd4218c)=>{_0x13eae9[a291_0x2d42('0xc')]('email',a291_0x2d42('0xe'))[a291_0x2d42('0xf')]();_0x13eae9[a291_0x2d42('0xc')](a291_0x2d42('0x25'),a291_0x2d42('0x26'))[a291_0x2d42('0x27')]({'min':0x4});_0x13eae9['assert'](a291_0x2d42('0x28'),a291_0x2d42('0x29'))['equals'](_0x13eae9['body'][a291_0x2d42('0x25')]);_0x13eae9['sanitize']('email')[a291_0x2d42('0x12')]({'gmail_remove_dots':![]});const _0x390f0a=_0x13eae9[a291_0x2d42('0x13')]();if(_0x390f0a){_0x13eae9[a291_0x2d42('0x14')](a291_0x2d42('0x15'),_0x390f0a);return _0x9d39fa['redirect'](a291_0x2d42('0x2a'));}const _0x1cd88b=new User_1[(a291_0x2d42('0x17'))]({'email':_0x13eae9[a291_0x2d42('0x2b')][a291_0x2d42('0xd')],'password':_0x13eae9[a291_0x2d42('0x2b')][a291_0x2d42('0x25')]});User_1[a291_0x2d42('0x17')][a291_0x2d42('0x2c')]({'email':_0x13eae9[a291_0x2d42('0x2b')][a291_0x2d42('0xd')]},(_0x5b6282,_0x30990d)=>{if(_0x5b6282){return _0xd4218c(_0x5b6282);}if(_0x30990d){_0x13eae9[a291_0x2d42('0x14')](a291_0x2d42('0x15'),{'msg':'Account\x20with\x20that\x20email\x20address\x20already\x20exists.'});return _0x9d39fa[a291_0x2d42('0x8')]('/signup');}_0x1cd88b[a291_0x2d42('0x2d')](_0x5b6282=>{if(_0x5b6282){return _0xd4218c(_0x5b6282);}_0x13eae9[a291_0x2d42('0x1b')](_0x1cd88b,_0x5b6282=>{if(_0x5b6282){return _0xd4218c(_0x5b6282);}_0x9d39fa[a291_0x2d42('0x8')]('/');});});});};exports['getAccount']=(_0x637496,_0x4f6f07)=>{_0x4f6f07[a291_0x2d42('0x9')](a291_0x2d42('0x2e'),{'title':a291_0x2d42('0x2f')});};exports[a291_0x2d42('0x30')]=(_0x510771,_0x8243fc,_0x1bbc04)=>{_0x510771[a291_0x2d42('0xc')](a291_0x2d42('0xd'),a291_0x2d42('0x31'))[a291_0x2d42('0xf')]();_0x510771[a291_0x2d42('0x11')](a291_0x2d42('0xd'))[a291_0x2d42('0x12')]({'gmail_remove_dots':![]});const _0x4f6d4a=_0x510771['validationErrors']();if(_0x4f6d4a){_0x510771[a291_0x2d42('0x14')](a291_0x2d42('0x15'),_0x4f6d4a);return _0x8243fc['redirect'](a291_0x2d42('0x32'));}User_1[a291_0x2d42('0x17')][a291_0x2d42('0x33')](_0x510771['user']['id'],(_0x199d4b,_0x51554d)=>{if(_0x199d4b){return _0x1bbc04(_0x199d4b);}_0x51554d[a291_0x2d42('0xd')]=_0x510771[a291_0x2d42('0x2b')][a291_0x2d42('0xd')]||'';_0x51554d['profile'][a291_0x2d42('0x34')]=_0x510771[a291_0x2d42('0x2b')][a291_0x2d42('0x34')]||'';_0x51554d[a291_0x2d42('0x35')][a291_0x2d42('0x36')]=_0x510771[a291_0x2d42('0x2b')][a291_0x2d42('0x36')]||'';_0x51554d[a291_0x2d42('0x35')]['location']=_0x510771[a291_0x2d42('0x2b')]['location']||'';_0x51554d[a291_0x2d42('0x35')][a291_0x2d42('0x37')]=_0x510771[a291_0x2d42('0x2b')][a291_0x2d42('0x37')]||'';_0x51554d[a291_0x2d42('0x2d')](_0x199d4b=>{if(_0x199d4b){if(_0x199d4b[a291_0x2d42('0x38')]===0x2af8){_0x510771['flash'](a291_0x2d42('0x15'),{'msg':a291_0x2d42('0x39')});return _0x8243fc[a291_0x2d42('0x8')](a291_0x2d42('0x32'));}return _0x1bbc04(_0x199d4b);}_0x510771[a291_0x2d42('0x14')](a291_0x2d42('0x1c'),{'msg':a291_0x2d42('0x3a')});_0x8243fc['redirect'](a291_0x2d42('0x32'));});});};exports[a291_0x2d42('0x3b')]=(_0x499982,_0x4a9f0e,_0x5a69e8)=>{_0x499982[a291_0x2d42('0xc')](a291_0x2d42('0x25'),a291_0x2d42('0x26'))['len']({'min':0x4});_0x499982[a291_0x2d42('0xc')](a291_0x2d42('0x28'),a291_0x2d42('0x29'))[a291_0x2d42('0x3c')](_0x499982[a291_0x2d42('0x2b')][a291_0x2d42('0x25')]);const _0x2b80c9=_0x499982[a291_0x2d42('0x13')]();if(_0x2b80c9){_0x499982[a291_0x2d42('0x14')](a291_0x2d42('0x15'),_0x2b80c9);return _0x4a9f0e[a291_0x2d42('0x8')](a291_0x2d42('0x32'));}User_1[a291_0x2d42('0x17')]['findById'](_0x499982['user']['id'],(_0x175884,_0x22a36a)=>{if(_0x175884){return _0x5a69e8(_0x175884);}_0x22a36a[a291_0x2d42('0x25')]=_0x499982[a291_0x2d42('0x2b')][a291_0x2d42('0x25')];_0x22a36a[a291_0x2d42('0x2d')](_0x175884=>{if(_0x175884){return _0x5a69e8(_0x175884);}_0x499982[a291_0x2d42('0x14')](a291_0x2d42('0x1c'),{'msg':a291_0x2d42('0x3d')});_0x4a9f0e[a291_0x2d42('0x8')]('/account');});});};exports['postDeleteAccount']=(_0x14c7e8,_0x26e593,_0x5d487a)=>{User_1[a291_0x2d42('0x17')][a291_0x2d42('0x3e')]({'_id':_0x14c7e8[a291_0x2d42('0x7')]['id']},_0x26683b=>{if(_0x26683b){return _0x5d487a(_0x26683b);}_0x14c7e8[a291_0x2d42('0x20')]();_0x14c7e8[a291_0x2d42('0x14')]('info',{'msg':a291_0x2d42('0x3f')});_0x26e593[a291_0x2d42('0x8')]('/');});};exports['getOauthUnlink']=(_0x4a5498,_0x984de3,_0x5958b6)=>{const _0xd0a3a1=_0x4a5498['params'][a291_0x2d42('0x40')];User_1[a291_0x2d42('0x17')][a291_0x2d42('0x33')](_0x4a5498[a291_0x2d42('0x7')]['id'],(_0x149a4d,_0x49cf07)=>{if(_0x149a4d){return _0x5958b6(_0x149a4d);}_0x49cf07[_0xd0a3a1]=undefined;_0x49cf07[a291_0x2d42('0x41')]=_0x49cf07[a291_0x2d42('0x41')]['filter'](_0x58fda2=>_0x58fda2[a291_0x2d42('0x42')]!==_0xd0a3a1);_0x49cf07[a291_0x2d42('0x2d')](_0x149a4d=>{if(_0x149a4d){return _0x5958b6(_0x149a4d);}_0x4a5498[a291_0x2d42('0x14')](a291_0x2d42('0x43'),{'msg':_0xd0a3a1+a291_0x2d42('0x44')});_0x984de3[a291_0x2d42('0x8')](a291_0x2d42('0x32'));});});};exports[a291_0x2d42('0x45')]=(_0x15ed7e,_0x43ada3,_0x36bbe9)=>{if(_0x15ed7e['isAuthenticated']()){return _0x43ada3[a291_0x2d42('0x8')]('/');}User_1[a291_0x2d42('0x17')][a291_0x2d42('0x2c')]({'passwordResetToken':_0x15ed7e[a291_0x2d42('0x46')][a291_0x2d42('0x47')]})[a291_0x2d42('0x48')](a291_0x2d42('0x49'))['gt'](Date[a291_0x2d42('0x4a')]())['exec']((_0x4f915e,_0x3fa132)=>{if(_0x4f915e){return _0x36bbe9(_0x4f915e);}if(!_0x3fa132){_0x15ed7e[a291_0x2d42('0x14')](a291_0x2d42('0x15'),{'msg':'Password\x20reset\x20token\x20is\x20invalid\x20or\x20has\x20expired.'});return _0x43ada3['redirect'](a291_0x2d42('0x4b'));}_0x43ada3[a291_0x2d42('0x9')](a291_0x2d42('0x4c'),{'title':a291_0x2d42('0x4d')});});};exports[a291_0x2d42('0x4e')]=(_0x31f7be,_0x1d472d,_0x5a7ffb)=>{_0x31f7be[a291_0x2d42('0xc')](a291_0x2d42('0x25'),a291_0x2d42('0x4f'))[a291_0x2d42('0x27')]({'min':0x4});_0x31f7be[a291_0x2d42('0xc')](a291_0x2d42('0x50'),a291_0x2d42('0x51'))[a291_0x2d42('0x3c')](_0x31f7be['body'][a291_0x2d42('0x25')]);const _0x11f5c0=_0x31f7be[a291_0x2d42('0x13')]();if(_0x11f5c0){_0x31f7be[a291_0x2d42('0x14')](a291_0x2d42('0x15'),_0x11f5c0);return _0x1d472d[a291_0x2d42('0x8')](a291_0x2d42('0x52'));}async_1[a291_0x2d42('0x17')]['waterfall']([function resetPassword(_0x4810b1){User_1[a291_0x2d42('0x17')][a291_0x2d42('0x2c')]({'passwordResetToken':_0x31f7be['params'][a291_0x2d42('0x47')]})[a291_0x2d42('0x48')](a291_0x2d42('0x49'))['gt'](Date['now']())['exec']((_0x31d16f,_0x4dbda5)=>{if(_0x31d16f){return _0x5a7ffb(_0x31d16f);}if(!_0x4dbda5){_0x31f7be['flash'](a291_0x2d42('0x15'),{'msg':'Password\x20reset\x20token\x20is\x20invalid\x20or\x20has\x20expired.'});return _0x1d472d['redirect']('back');}_0x4dbda5['password']=_0x31f7be[a291_0x2d42('0x2b')]['password'];_0x4dbda5[a291_0x2d42('0x53')]=undefined;_0x4dbda5[a291_0x2d42('0x49')]=undefined;_0x4dbda5[a291_0x2d42('0x2d')](_0x31d16f=>{if(_0x31d16f){return _0x5a7ffb(_0x31d16f);}_0x31f7be[a291_0x2d42('0x1b')](_0x4dbda5,_0x31d16f=>{_0x4810b1(_0x31d16f,_0x4dbda5);});});});},function sendResetPasswordEmail(_0x20a4ef,_0x18ec14){const _0xbd6bd3=nodemailer_1[a291_0x2d42('0x17')][a291_0x2d42('0x54')]({'service':a291_0x2d42('0x55'),'auth':{'user':process['env'][a291_0x2d42('0x56')],'pass':process[a291_0x2d42('0x57')][a291_0x2d42('0x58')]}});const _0x4a363c={'to':_0x20a4ef[a291_0x2d42('0xd')],'from':a291_0x2d42('0x59'),'subject':a291_0x2d42('0x5a'),'text':a291_0x2d42('0x5b')+_0x20a4ef[a291_0x2d42('0xd')]+'\x20has\x20just\x20been\x20changed.\x0a'};_0xbd6bd3[a291_0x2d42('0x5c')](_0x4a363c,_0x2f0960=>{_0x31f7be[a291_0x2d42('0x14')]('success',{'msg':a291_0x2d42('0x5d')});_0x18ec14(_0x2f0960);});}],_0x519437=>{if(_0x519437){return _0x5a7ffb(_0x519437);}_0x1d472d[a291_0x2d42('0x8')]('/');});};exports[a291_0x2d42('0x5e')]=(_0x251d01,_0x47c9e1)=>{if(_0x251d01[a291_0x2d42('0x5f')]()){return _0x47c9e1[a291_0x2d42('0x8')]('/');}_0x47c9e1[a291_0x2d42('0x9')](a291_0x2d42('0x60'),{'title':a291_0x2d42('0x61')});};exports[a291_0x2d42('0x62')]=(_0x310e57,_0x26be92,_0x3a2f8f)=>{_0x310e57[a291_0x2d42('0xc')]('email',a291_0x2d42('0x31'))[a291_0x2d42('0xf')]();_0x310e57[a291_0x2d42('0x11')](a291_0x2d42('0xd'))[a291_0x2d42('0x12')]({'gmail_remove_dots':![]});const _0x134716=_0x310e57[a291_0x2d42('0x13')]();if(_0x134716){_0x310e57[a291_0x2d42('0x14')](a291_0x2d42('0x15'),_0x134716);return _0x26be92[a291_0x2d42('0x8')](a291_0x2d42('0x4b'));}async_1[a291_0x2d42('0x17')][a291_0x2d42('0x63')]([function createRandomToken(_0x112697){crypto_1[a291_0x2d42('0x17')]['randomBytes'](0x10,(_0x1f69b7,_0x4600cf)=>{const _0x33a3ec=_0x4600cf['toString'](a291_0x2d42('0x64'));_0x112697(_0x1f69b7,_0x33a3ec);});},function setRandomToken(_0x2bc4e4,_0x4e9b77){User_1[a291_0x2d42('0x17')][a291_0x2d42('0x2c')]({'email':_0x310e57[a291_0x2d42('0x2b')][a291_0x2d42('0xd')]},(_0x2a71d2,_0x994d2d)=>{if(_0x2a71d2){return _0x4e9b77(_0x2a71d2);}if(!_0x994d2d){_0x310e57[a291_0x2d42('0x14')](a291_0x2d42('0x15'),{'msg':a291_0x2d42('0x65')});return _0x26be92[a291_0x2d42('0x8')](a291_0x2d42('0x4b'));}_0x994d2d[a291_0x2d42('0x53')]=_0x2bc4e4;_0x994d2d[a291_0x2d42('0x49')]=Date[a291_0x2d42('0x4a')]()+0x36ee80;_0x994d2d['save'](_0x2a71d2=>{_0x4e9b77(_0x2a71d2,_0x2bc4e4,_0x994d2d);});});},function sendForgotPasswordEmail(_0x5d942c,_0x556095,_0xc513c0){const _0x2ce16f=nodemailer_1[a291_0x2d42('0x17')][a291_0x2d42('0x54')]({'service':a291_0x2d42('0x55'),'auth':{'user':process['env'][a291_0x2d42('0x56')],'pass':process[a291_0x2d42('0x57')]['SENDGRID_PASSWORD']}});const _0xf8d621={'to':_0x556095['email'],'from':a291_0x2d42('0x66'),'subject':a291_0x2d42('0x67'),'text':a291_0x2d42('0x68')+_0x310e57['headers'][a291_0x2d42('0x69')]+a291_0x2d42('0x6a')+_0x5d942c+a291_0x2d42('0x6b')};_0x2ce16f[a291_0x2d42('0x5c')](_0xf8d621,_0x17e549=>{_0x310e57['flash'](a291_0x2d42('0x43'),{'msg':a291_0x2d42('0x6c')+_0x556095[a291_0x2d42('0xd')]+a291_0x2d42('0x6d')});_0xc513c0(_0x17e549);});}],_0x1c7e77=>{if(_0x1c7e77){return _0x3a2f8f(_0x1c7e77);}_0x26be92[a291_0x2d42('0x8')](a291_0x2d42('0x4b'));});};
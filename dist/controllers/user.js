var a95_0x1fea=['exec','/forgot','Password\x20Reset','postReset','Password\x20must\x20be\x20at\x20least\x204\x20characters\x20long.','confirm','Passwords\x20must\x20match.','back','waterfall','token','passwordResetToken','createTransport','SendGrid','env','SENDGRID_PASSWORD','Hello,\x0a\x0aThis\x20is\x20a\x20confirmation\x20that\x20the\x20password\x20for\x20your\x20account\x20','\x20has\x20just\x20been\x20changed.\x0a','getForgot','account/forgot','Please\x20enter\x20a\x20valid\x20email\x20address.','randomBytes','hex','SENDGRID_USER','hackathon@starter.com','Reset\x20your\x20password\x20on\x20Hackathon\x20Starter','You\x20are\x20receiving\x20this\x20email\x20because\x20you\x20(or\x20someone\x20else)\x20have\x20requested\x20the\x20reset\x20of\x20the\x20password\x20for\x20your\x20account.\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Please\x20click\x20on\x20the\x20following\x20link,\x20or\x20paste\x20this\x20into\x20your\x20browser\x20to\x20complete\x20the\x20process:\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20http://','headers','host','\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20If\x20you\x20did\x20not\x20request\x20this,\x20please\x20ignore\x20this\x20email\x20and\x20your\x20password\x20will\x20remain\x20unchanged.\x0a','sendMail','An\x20e-mail\x20has\x20been\x20sent\x20to\x20','\x20with\x20further\x20instructions.','__esModule','defineProperty','async','crypto','passport','../models/User','getLogin','user','render','account/login','Login','postLogin','Email\x20is\x20not\x20valid','isEmail','assert','Password\x20cannot\x20be\x20blank','notEmpty','sanitize','email','normalizeEmail','flash','/login','default','authenticate','local','errors','message','logIn','success','redirect','session','returnTo','logout','getSignup','account/signup','Create\x20Account','postSignup','Password\x20must\x20be\x20at\x20least\x204\x20characters\x20long','len','equals','password','validationErrors','/signup','body','getAccount','account/profile','Account\x20Management','postUpdateProfile','/account','findById','profile','name','location','website','save','The\x20email\x20address\x20you\x20have\x20entered\x20is\x20already\x20associated\x20with\x20an\x20account.','Profile\x20information\x20has\x20been\x20updated.','postUpdatePassword','confirmPassword','Passwords\x20do\x20not\x20match','Password\x20has\x20been\x20changed.','postDeleteAccount','remove','info','Your\x20account\x20has\x20been\x20deleted.','getOauthUnlink','params','provider','tokens','filter','kind','\x20account\x20has\x20been\x20unlinked.','getReset','isAuthenticated','findOne','where','passwordResetExpires','now'];(function(_0x263920,_0x5129d9){var _0x419bef=function(_0x3823fe){while(--_0x3823fe){_0x263920['push'](_0x263920['shift']());}};_0x419bef(++_0x5129d9);}(a95_0x1fea,0xfc));var a95_0x253c=function(_0x34e426,_0x44d612){_0x34e426=_0x34e426-0x0;var _0x5cf83d=a95_0x1fea[_0x34e426];return _0x5cf83d;};'use strict';var __importDefault=this&&this['__importDefault']||function(_0x41cb2b){return _0x41cb2b&&_0x41cb2b[a95_0x253c('0x0')]?_0x41cb2b:{'default':_0x41cb2b};};Object[a95_0x253c('0x1')](exports,a95_0x253c('0x0'),{'value':!![]});const async_1=__importDefault(require(a95_0x253c('0x2')));const crypto_1=__importDefault(require(a95_0x253c('0x3')));const nodemailer_1=__importDefault(require('nodemailer'));const passport_1=__importDefault(require(a95_0x253c('0x4')));const User_1=__importDefault(require(a95_0x253c('0x5')));const request=require('express-validator');exports[a95_0x253c('0x6')]=(_0x4341a7,_0x364ed5)=>{if(_0x4341a7[a95_0x253c('0x7')]){return _0x364ed5['redirect']('/');}_0x364ed5[a95_0x253c('0x8')](a95_0x253c('0x9'),{'title':a95_0x253c('0xa')});};exports[a95_0x253c('0xb')]=(_0x2078f4,_0x5e55c7,_0x4b1287)=>{_0x2078f4['assert']('email',a95_0x253c('0xc'))[a95_0x253c('0xd')]();_0x2078f4[a95_0x253c('0xe')]('password',a95_0x253c('0xf'))[a95_0x253c('0x10')]();_0x2078f4[a95_0x253c('0x11')](a95_0x253c('0x12'))[a95_0x253c('0x13')]({'gmail_remove_dots':![]});const _0x1b7881=_0x2078f4['validationErrors']();if(_0x1b7881){_0x2078f4[a95_0x253c('0x14')]('errors',_0x1b7881);return _0x5e55c7['redirect'](a95_0x253c('0x15'));}passport_1[a95_0x253c('0x16')][a95_0x253c('0x17')](a95_0x253c('0x18'),(_0x55ee7b,_0x31d817,_0x29271e)=>{if(_0x55ee7b){return _0x4b1287(_0x55ee7b);}if(!_0x31d817){_0x2078f4['flash'](a95_0x253c('0x19'),_0x29271e[a95_0x253c('0x1a')]);return _0x5e55c7['redirect'](a95_0x253c('0x15'));}_0x2078f4[a95_0x253c('0x1b')](_0x31d817,_0x55ee7b=>{if(_0x55ee7b){return _0x4b1287(_0x55ee7b);}_0x2078f4['flash'](a95_0x253c('0x1c'),{'msg':'Success!\x20You\x20are\x20logged\x20in.'});_0x5e55c7[a95_0x253c('0x1d')](_0x2078f4[a95_0x253c('0x1e')][a95_0x253c('0x1f')]||'/');});})(_0x2078f4,_0x5e55c7,_0x4b1287);};exports[a95_0x253c('0x20')]=(_0x29c98c,_0x4a977c)=>{_0x29c98c[a95_0x253c('0x20')]();_0x4a977c['redirect']('/');};exports[a95_0x253c('0x21')]=(_0x555c8e,_0x56a54e)=>{if(_0x555c8e[a95_0x253c('0x7')]){return _0x56a54e['redirect']('/');}_0x56a54e[a95_0x253c('0x8')](a95_0x253c('0x22'),{'title':a95_0x253c('0x23')});};exports[a95_0x253c('0x24')]=(_0x44bbac,_0x41ce91,_0x133662)=>{_0x44bbac[a95_0x253c('0xe')]('email',a95_0x253c('0xc'))['isEmail']();_0x44bbac[a95_0x253c('0xe')]('password',a95_0x253c('0x25'))[a95_0x253c('0x26')]({'min':0x4});_0x44bbac[a95_0x253c('0xe')]('confirmPassword','Passwords\x20do\x20not\x20match')[a95_0x253c('0x27')](_0x44bbac['body'][a95_0x253c('0x28')]);_0x44bbac[a95_0x253c('0x11')](a95_0x253c('0x12'))[a95_0x253c('0x13')]({'gmail_remove_dots':![]});const _0x429311=_0x44bbac[a95_0x253c('0x29')]();if(_0x429311){_0x44bbac[a95_0x253c('0x14')](a95_0x253c('0x19'),_0x429311);return _0x41ce91['redirect'](a95_0x253c('0x2a'));}const _0x5cbbe8=new User_1[(a95_0x253c('0x16'))]({'email':_0x44bbac[a95_0x253c('0x2b')]['email'],'password':_0x44bbac['body'][a95_0x253c('0x28')]});User_1[a95_0x253c('0x16')]['findOne']({'email':_0x44bbac['body'][a95_0x253c('0x12')]},(_0x46d98b,_0x2d421d)=>{if(_0x46d98b){return _0x133662(_0x46d98b);}if(_0x2d421d){_0x44bbac[a95_0x253c('0x14')](a95_0x253c('0x19'),{'msg':'Account\x20with\x20that\x20email\x20address\x20already\x20exists.'});return _0x41ce91['redirect']('/signup');}_0x5cbbe8['save'](_0x46d98b=>{if(_0x46d98b){return _0x133662(_0x46d98b);}_0x44bbac[a95_0x253c('0x1b')](_0x5cbbe8,_0x46d98b=>{if(_0x46d98b){return _0x133662(_0x46d98b);}_0x41ce91[a95_0x253c('0x1d')]('/');});});});};exports[a95_0x253c('0x2c')]=(_0x4f8d85,_0x39a253)=>{_0x39a253[a95_0x253c('0x8')](a95_0x253c('0x2d'),{'title':a95_0x253c('0x2e')});};exports[a95_0x253c('0x2f')]=(_0x500ed7,_0x4185da,_0x1c2e05)=>{_0x500ed7['assert'](a95_0x253c('0x12'),'Please\x20enter\x20a\x20valid\x20email\x20address.')[a95_0x253c('0xd')]();_0x500ed7['sanitize'](a95_0x253c('0x12'))[a95_0x253c('0x13')]({'gmail_remove_dots':![]});const _0x44be03=_0x500ed7[a95_0x253c('0x29')]();if(_0x44be03){_0x500ed7['flash']('errors',_0x44be03);return _0x4185da[a95_0x253c('0x1d')](a95_0x253c('0x30'));}User_1[a95_0x253c('0x16')][a95_0x253c('0x31')](_0x500ed7[a95_0x253c('0x7')]['id'],(_0x5ccf1f,_0x2d0518)=>{if(_0x5ccf1f){return _0x1c2e05(_0x5ccf1f);}_0x2d0518[a95_0x253c('0x12')]=_0x500ed7[a95_0x253c('0x2b')][a95_0x253c('0x12')]||'';_0x2d0518[a95_0x253c('0x32')]['name']=_0x500ed7[a95_0x253c('0x2b')][a95_0x253c('0x33')]||'';_0x2d0518[a95_0x253c('0x32')]['gender']=_0x500ed7[a95_0x253c('0x2b')]['gender']||'';_0x2d0518['profile'][a95_0x253c('0x34')]=_0x500ed7[a95_0x253c('0x2b')][a95_0x253c('0x34')]||'';_0x2d0518[a95_0x253c('0x32')]['website']=_0x500ed7[a95_0x253c('0x2b')][a95_0x253c('0x35')]||'';_0x2d0518[a95_0x253c('0x36')](_0x5ccf1f=>{if(_0x5ccf1f){if(_0x5ccf1f['code']===0x2af8){_0x500ed7[a95_0x253c('0x14')](a95_0x253c('0x19'),{'msg':a95_0x253c('0x37')});return _0x4185da[a95_0x253c('0x1d')](a95_0x253c('0x30'));}return _0x1c2e05(_0x5ccf1f);}_0x500ed7[a95_0x253c('0x14')](a95_0x253c('0x1c'),{'msg':a95_0x253c('0x38')});_0x4185da['redirect'](a95_0x253c('0x30'));});});};exports[a95_0x253c('0x39')]=(_0x581c9c,_0x55bb49,_0x4ebe9f)=>{_0x581c9c[a95_0x253c('0xe')](a95_0x253c('0x28'),a95_0x253c('0x25'))[a95_0x253c('0x26')]({'min':0x4});_0x581c9c[a95_0x253c('0xe')](a95_0x253c('0x3a'),a95_0x253c('0x3b'))[a95_0x253c('0x27')](_0x581c9c[a95_0x253c('0x2b')][a95_0x253c('0x28')]);const _0x55e2a3=_0x581c9c[a95_0x253c('0x29')]();if(_0x55e2a3){_0x581c9c['flash'](a95_0x253c('0x19'),_0x55e2a3);return _0x55bb49['redirect'](a95_0x253c('0x30'));}User_1[a95_0x253c('0x16')][a95_0x253c('0x31')](_0x581c9c['user']['id'],(_0x42470d,_0x73be73)=>{if(_0x42470d){return _0x4ebe9f(_0x42470d);}_0x73be73['password']=_0x581c9c[a95_0x253c('0x2b')]['password'];_0x73be73['save'](_0x42470d=>{if(_0x42470d){return _0x4ebe9f(_0x42470d);}_0x581c9c['flash']('success',{'msg':a95_0x253c('0x3c')});_0x55bb49[a95_0x253c('0x1d')]('/account');});});};exports[a95_0x253c('0x3d')]=(_0x2f2528,_0x4514c1,_0x275c6d)=>{User_1[a95_0x253c('0x16')][a95_0x253c('0x3e')]({'_id':_0x2f2528[a95_0x253c('0x7')]['id']},_0x1ef60a=>{if(_0x1ef60a){return _0x275c6d(_0x1ef60a);}_0x2f2528[a95_0x253c('0x20')]();_0x2f2528['flash'](a95_0x253c('0x3f'),{'msg':a95_0x253c('0x40')});_0x4514c1[a95_0x253c('0x1d')]('/');});};exports[a95_0x253c('0x41')]=(_0x580fda,_0x14c190,_0x2d5dd1)=>{const _0xf4a745=_0x580fda[a95_0x253c('0x42')][a95_0x253c('0x43')];User_1[a95_0x253c('0x16')][a95_0x253c('0x31')](_0x580fda[a95_0x253c('0x7')]['id'],(_0x1411f0,_0x20da98)=>{if(_0x1411f0){return _0x2d5dd1(_0x1411f0);}_0x20da98[_0xf4a745]=undefined;_0x20da98[a95_0x253c('0x44')]=_0x20da98['tokens'][a95_0x253c('0x45')](_0x4e00ab=>_0x4e00ab[a95_0x253c('0x46')]!==_0xf4a745);_0x20da98[a95_0x253c('0x36')](_0x1411f0=>{if(_0x1411f0){return _0x2d5dd1(_0x1411f0);}_0x580fda[a95_0x253c('0x14')](a95_0x253c('0x3f'),{'msg':_0xf4a745+a95_0x253c('0x47')});_0x14c190['redirect'](a95_0x253c('0x30'));});});};exports[a95_0x253c('0x48')]=(_0x5adc3a,_0x5a6b58,_0x3dd1b7)=>{if(_0x5adc3a[a95_0x253c('0x49')]()){return _0x5a6b58[a95_0x253c('0x1d')]('/');}User_1[a95_0x253c('0x16')][a95_0x253c('0x4a')]({'passwordResetToken':_0x5adc3a[a95_0x253c('0x42')]['token']})[a95_0x253c('0x4b')](a95_0x253c('0x4c'))['gt'](Date[a95_0x253c('0x4d')]())[a95_0x253c('0x4e')]((_0x10cee4,_0x138294)=>{if(_0x10cee4){return _0x3dd1b7(_0x10cee4);}if(!_0x138294){_0x5adc3a[a95_0x253c('0x14')](a95_0x253c('0x19'),{'msg':'Password\x20reset\x20token\x20is\x20invalid\x20or\x20has\x20expired.'});return _0x5a6b58[a95_0x253c('0x1d')](a95_0x253c('0x4f'));}_0x5a6b58[a95_0x253c('0x8')]('account/reset',{'title':a95_0x253c('0x50')});});};exports[a95_0x253c('0x51')]=(_0x371dde,_0x2f8183,_0xd7d5e)=>{_0x371dde[a95_0x253c('0xe')](a95_0x253c('0x28'),a95_0x253c('0x52'))[a95_0x253c('0x26')]({'min':0x4});_0x371dde['assert'](a95_0x253c('0x53'),a95_0x253c('0x54'))[a95_0x253c('0x27')](_0x371dde[a95_0x253c('0x2b')][a95_0x253c('0x28')]);const _0x204d24=_0x371dde[a95_0x253c('0x29')]();if(_0x204d24){_0x371dde[a95_0x253c('0x14')]('errors',_0x204d24);return _0x2f8183[a95_0x253c('0x1d')](a95_0x253c('0x55'));}async_1[a95_0x253c('0x16')][a95_0x253c('0x56')]([function resetPassword(_0x4d8e66){User_1[a95_0x253c('0x16')]['findOne']({'passwordResetToken':_0x371dde[a95_0x253c('0x42')][a95_0x253c('0x57')]})[a95_0x253c('0x4b')](a95_0x253c('0x4c'))['gt'](Date[a95_0x253c('0x4d')]())['exec']((_0x20ab6c,_0x4e75a0)=>{if(_0x20ab6c){return _0xd7d5e(_0x20ab6c);}if(!_0x4e75a0){_0x371dde[a95_0x253c('0x14')](a95_0x253c('0x19'),{'msg':'Password\x20reset\x20token\x20is\x20invalid\x20or\x20has\x20expired.'});return _0x2f8183['redirect'](a95_0x253c('0x55'));}_0x4e75a0[a95_0x253c('0x28')]=_0x371dde[a95_0x253c('0x2b')][a95_0x253c('0x28')];_0x4e75a0[a95_0x253c('0x58')]=undefined;_0x4e75a0[a95_0x253c('0x4c')]=undefined;_0x4e75a0[a95_0x253c('0x36')](_0x20ab6c=>{if(_0x20ab6c){return _0xd7d5e(_0x20ab6c);}_0x371dde[a95_0x253c('0x1b')](_0x4e75a0,_0x20ab6c=>{_0x4d8e66(_0x20ab6c,_0x4e75a0);});});});},function sendResetPasswordEmail(_0xa10366,_0x56d2e0){const _0x17fb36=nodemailer_1['default'][a95_0x253c('0x59')]({'service':a95_0x253c('0x5a'),'auth':{'user':process[a95_0x253c('0x5b')]['SENDGRID_USER'],'pass':process[a95_0x253c('0x5b')][a95_0x253c('0x5c')]}});const _0x29b18b={'to':_0xa10366[a95_0x253c('0x12')],'from':'express-ts@starter.com','subject':'Your\x20password\x20has\x20been\x20changed','text':a95_0x253c('0x5d')+_0xa10366[a95_0x253c('0x12')]+a95_0x253c('0x5e')};_0x17fb36['sendMail'](_0x29b18b,_0x2c87d0=>{_0x371dde[a95_0x253c('0x14')](a95_0x253c('0x1c'),{'msg':'Success!\x20Your\x20password\x20has\x20been\x20changed.'});_0x56d2e0(_0x2c87d0);});}],_0x331336=>{if(_0x331336){return _0xd7d5e(_0x331336);}_0x2f8183[a95_0x253c('0x1d')]('/');});};exports[a95_0x253c('0x5f')]=(_0xbd45f2,_0x4d6928)=>{if(_0xbd45f2[a95_0x253c('0x49')]()){return _0x4d6928[a95_0x253c('0x1d')]('/');}_0x4d6928['render'](a95_0x253c('0x60'),{'title':'Forgot\x20Password'});};exports['postForgot']=(_0x4ea724,_0x1dcf2f,_0x3486d2)=>{_0x4ea724[a95_0x253c('0xe')]('email',a95_0x253c('0x61'))['isEmail']();_0x4ea724[a95_0x253c('0x11')](a95_0x253c('0x12'))['normalizeEmail']({'gmail_remove_dots':![]});const _0x531962=_0x4ea724[a95_0x253c('0x29')]();if(_0x531962){_0x4ea724[a95_0x253c('0x14')](a95_0x253c('0x19'),_0x531962);return _0x1dcf2f['redirect'](a95_0x253c('0x4f'));}async_1[a95_0x253c('0x16')]['waterfall']([function createRandomToken(_0x4c3ee6){crypto_1[a95_0x253c('0x16')][a95_0x253c('0x62')](0x10,(_0x1a0ebe,_0x11584f)=>{const _0x5994d3=_0x11584f['toString'](a95_0x253c('0x63'));_0x4c3ee6(_0x1a0ebe,_0x5994d3);});},function setRandomToken(_0x1ec26d,_0x1900e0){User_1['default'][a95_0x253c('0x4a')]({'email':_0x4ea724[a95_0x253c('0x2b')][a95_0x253c('0x12')]},(_0x3c193d,_0x1960fb)=>{if(_0x3c193d){return _0x1900e0(_0x3c193d);}if(!_0x1960fb){_0x4ea724[a95_0x253c('0x14')](a95_0x253c('0x19'),{'msg':'Account\x20with\x20that\x20email\x20address\x20does\x20not\x20exist.'});return _0x1dcf2f[a95_0x253c('0x1d')](a95_0x253c('0x4f'));}_0x1960fb[a95_0x253c('0x58')]=_0x1ec26d;_0x1960fb[a95_0x253c('0x4c')]=Date['now']()+0x36ee80;_0x1960fb[a95_0x253c('0x36')](_0x3c193d=>{_0x1900e0(_0x3c193d,_0x1ec26d,_0x1960fb);});});},function sendForgotPasswordEmail(_0x2dacc8,_0x345069,_0x4875fa){const _0x590951=nodemailer_1[a95_0x253c('0x16')][a95_0x253c('0x59')]({'service':a95_0x253c('0x5a'),'auth':{'user':process[a95_0x253c('0x5b')][a95_0x253c('0x64')],'pass':process[a95_0x253c('0x5b')][a95_0x253c('0x5c')]}});const _0x54bb77={'to':_0x345069[a95_0x253c('0x12')],'from':a95_0x253c('0x65'),'subject':a95_0x253c('0x66'),'text':a95_0x253c('0x67')+_0x4ea724[a95_0x253c('0x68')][a95_0x253c('0x69')]+'/reset/'+_0x2dacc8+a95_0x253c('0x6a')};_0x590951[a95_0x253c('0x6b')](_0x54bb77,_0x72af42=>{_0x4ea724[a95_0x253c('0x14')](a95_0x253c('0x3f'),{'msg':a95_0x253c('0x6c')+_0x345069[a95_0x253c('0x12')]+a95_0x253c('0x6d')});_0x4875fa(_0x72af42);});}],_0x16fb84=>{if(_0x16fb84){return _0x3486d2(_0x16fb84);}_0x1dcf2f[a95_0x253c('0x1d')](a95_0x253c('0x4f'));});};
var a201_0x554c=['errors','default','flash','/login','logIn','success','Success!\x20You\x20are\x20logged\x20in.','session','returnTo','logout','getSignup','account/signup','Create\x20Account','email','confirmPassword','Passwords\x20do\x20not\x20match','equals','body','normalizeEmail','/signup','findOne','Account\x20with\x20that\x20email\x20address\x20already\x20exists.','save','getAccount','account/profile','Please\x20enter\x20a\x20valid\x20email\x20address.','/account','profile','name','gender','location','website','code','Profile\x20information\x20has\x20been\x20updated.','postUpdatePassword','findById','Password\x20has\x20been\x20changed.','postDeleteAccount','info','Your\x20account\x20has\x20been\x20deleted.','params','provider','tokens','\x20account\x20has\x20been\x20unlinked.','getReset','isAuthenticated','where','passwordResetExpires','now','exec','Password\x20reset\x20token\x20is\x20invalid\x20or\x20has\x20expired.','account/reset','postReset','len','confirm','waterfall','token','back','passwordResetToken','createTransport','SendGrid','env','SENDGRID_USER','SENDGRID_PASSWORD','express-ts@starter.com','Your\x20password\x20has\x20been\x20changed','\x20has\x20just\x20been\x20changed.\x0a','sendMail','Success!\x20Your\x20password\x20has\x20been\x20changed.','getForgot','/forgot','randomBytes','toString','Account\x20with\x20that\x20email\x20address\x20does\x20not\x20exist.','hackathon@starter.com','Reset\x20your\x20password\x20on\x20Hackathon\x20Starter','headers','host','/reset/','\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20If\x20you\x20did\x20not\x20request\x20this,\x20please\x20ignore\x20this\x20email\x20and\x20your\x20password\x20will\x20remain\x20unchanged.\x0a','An\x20e-mail\x20has\x20been\x20sent\x20to\x20','__importDefault','defineProperty','__esModule','async','nodemailer','../models/User','getLogin','user','redirect','render','account/login','postLogin','assert','isEmail','password','notEmpty','sanitize','validationErrors'];(function(_0x2d8f05,_0x4b81bb){var _0x4d74cb=function(_0x32719f){while(--_0x32719f){_0x2d8f05['push'](_0x2d8f05['shift']());}};_0x4d74cb(++_0x4b81bb);}(a201_0x554c,0x17a));var a201_0x51a1=function(_0x46b35b,_0x4577e5){_0x46b35b=_0x46b35b-0x0;var _0x17c017=a201_0x554c[_0x46b35b];return _0x17c017;};'use strict';var __importDefault=this&&this[a201_0x51a1('0x0')]||function(_0x24e256){return _0x24e256&&_0x24e256['__esModule']?_0x24e256:{'default':_0x24e256};};Object[a201_0x51a1('0x1')](exports,a201_0x51a1('0x2'),{'value':!![]});const async_1=__importDefault(require(a201_0x51a1('0x3')));const crypto_1=__importDefault(require('crypto'));const nodemailer_1=__importDefault(require(a201_0x51a1('0x4')));const passport_1=__importDefault(require('passport'));const User_1=__importDefault(require(a201_0x51a1('0x5')));const request=require('express-validator');exports[a201_0x51a1('0x6')]=(_0x3bf802,_0x535dcf)=>{if(_0x3bf802[a201_0x51a1('0x7')]){return _0x535dcf[a201_0x51a1('0x8')]('/');}_0x535dcf[a201_0x51a1('0x9')](a201_0x51a1('0xa'),{'title':'Login'});};exports[a201_0x51a1('0xb')]=(_0x5ac413,_0x4bde5c,_0x580bd9)=>{_0x5ac413[a201_0x51a1('0xc')]('email','Email\x20is\x20not\x20valid')[a201_0x51a1('0xd')]();_0x5ac413['assert'](a201_0x51a1('0xe'),'Password\x20cannot\x20be\x20blank')[a201_0x51a1('0xf')]();_0x5ac413[a201_0x51a1('0x10')]('email')['normalizeEmail']({'gmail_remove_dots':![]});const _0x356ea5=_0x5ac413[a201_0x51a1('0x11')]();if(_0x356ea5){_0x5ac413['flash'](a201_0x51a1('0x12'),_0x356ea5);return _0x4bde5c[a201_0x51a1('0x8')]('/login');}passport_1[a201_0x51a1('0x13')]['authenticate']('local',(_0x1d8382,_0x42152f,_0x496120)=>{if(_0x1d8382){return _0x580bd9(_0x1d8382);}if(!_0x42152f){_0x5ac413[a201_0x51a1('0x14')](a201_0x51a1('0x12'),_0x496120['message']);return _0x4bde5c[a201_0x51a1('0x8')](a201_0x51a1('0x15'));}_0x5ac413[a201_0x51a1('0x16')](_0x42152f,_0x1d8382=>{if(_0x1d8382){return _0x580bd9(_0x1d8382);}_0x5ac413[a201_0x51a1('0x14')](a201_0x51a1('0x17'),{'msg':a201_0x51a1('0x18')});_0x4bde5c[a201_0x51a1('0x8')](_0x5ac413[a201_0x51a1('0x19')][a201_0x51a1('0x1a')]||'/');});})(_0x5ac413,_0x4bde5c,_0x580bd9);};exports[a201_0x51a1('0x1b')]=(_0x51b063,_0x5ba1c8)=>{_0x51b063[a201_0x51a1('0x1b')]();_0x5ba1c8[a201_0x51a1('0x8')]('/');};exports[a201_0x51a1('0x1c')]=(_0x509a97,_0x477ee8)=>{if(_0x509a97[a201_0x51a1('0x7')]){return _0x477ee8[a201_0x51a1('0x8')]('/');}_0x477ee8[a201_0x51a1('0x9')](a201_0x51a1('0x1d'),{'title':a201_0x51a1('0x1e')});};exports['postSignup']=(_0x4f2b3e,_0x5d575,_0x7bb881)=>{_0x4f2b3e['assert'](a201_0x51a1('0x1f'),'Email\x20is\x20not\x20valid')[a201_0x51a1('0xd')]();_0x4f2b3e[a201_0x51a1('0xc')](a201_0x51a1('0xe'),'Password\x20must\x20be\x20at\x20least\x204\x20characters\x20long')['len']({'min':0x4});_0x4f2b3e[a201_0x51a1('0xc')](a201_0x51a1('0x20'),a201_0x51a1('0x21'))[a201_0x51a1('0x22')](_0x4f2b3e[a201_0x51a1('0x23')]['password']);_0x4f2b3e[a201_0x51a1('0x10')]('email')[a201_0x51a1('0x24')]({'gmail_remove_dots':![]});const _0x5708bf=_0x4f2b3e[a201_0x51a1('0x11')]();if(_0x5708bf){_0x4f2b3e[a201_0x51a1('0x14')](a201_0x51a1('0x12'),_0x5708bf);return _0x5d575[a201_0x51a1('0x8')](a201_0x51a1('0x25'));}const _0x23d22f=new User_1[(a201_0x51a1('0x13'))]({'email':_0x4f2b3e[a201_0x51a1('0x23')]['email'],'password':_0x4f2b3e[a201_0x51a1('0x23')][a201_0x51a1('0xe')]});User_1['default'][a201_0x51a1('0x26')]({'email':_0x4f2b3e[a201_0x51a1('0x23')]['email']},(_0x5d3a5c,_0xe46746)=>{if(_0x5d3a5c){return _0x7bb881(_0x5d3a5c);}if(_0xe46746){_0x4f2b3e[a201_0x51a1('0x14')]('errors',{'msg':a201_0x51a1('0x27')});return _0x5d575[a201_0x51a1('0x8')](a201_0x51a1('0x25'));}_0x23d22f[a201_0x51a1('0x28')](_0x5d3a5c=>{if(_0x5d3a5c){return _0x7bb881(_0x5d3a5c);}_0x4f2b3e['logIn'](_0x23d22f,_0x5d3a5c=>{if(_0x5d3a5c){return _0x7bb881(_0x5d3a5c);}_0x5d575['redirect']('/');});});});};exports[a201_0x51a1('0x29')]=(_0x1cc641,_0x5363b8)=>{_0x5363b8[a201_0x51a1('0x9')](a201_0x51a1('0x2a'),{'title':'Account\x20Management'});};exports['postUpdateProfile']=(_0x30974d,_0x3306e8,_0x44b8a2)=>{_0x30974d['assert'](a201_0x51a1('0x1f'),a201_0x51a1('0x2b'))['isEmail']();_0x30974d[a201_0x51a1('0x10')]('email')[a201_0x51a1('0x24')]({'gmail_remove_dots':![]});const _0x57463d=_0x30974d[a201_0x51a1('0x11')]();if(_0x57463d){_0x30974d['flash']('errors',_0x57463d);return _0x3306e8[a201_0x51a1('0x8')](a201_0x51a1('0x2c'));}User_1[a201_0x51a1('0x13')]['findById'](_0x30974d[a201_0x51a1('0x7')]['id'],(_0x11ec6f,_0x43fe12)=>{if(_0x11ec6f){return _0x44b8a2(_0x11ec6f);}_0x43fe12['email']=_0x30974d['body'][a201_0x51a1('0x1f')]||'';_0x43fe12[a201_0x51a1('0x2d')][a201_0x51a1('0x2e')]=_0x30974d['body'][a201_0x51a1('0x2e')]||'';_0x43fe12[a201_0x51a1('0x2d')][a201_0x51a1('0x2f')]=_0x30974d['body'][a201_0x51a1('0x2f')]||'';_0x43fe12[a201_0x51a1('0x2d')][a201_0x51a1('0x30')]=_0x30974d[a201_0x51a1('0x23')][a201_0x51a1('0x30')]||'';_0x43fe12[a201_0x51a1('0x2d')][a201_0x51a1('0x31')]=_0x30974d['body'][a201_0x51a1('0x31')]||'';_0x43fe12[a201_0x51a1('0x28')](_0x11ec6f=>{if(_0x11ec6f){if(_0x11ec6f[a201_0x51a1('0x32')]===0x2af8){_0x30974d['flash'](a201_0x51a1('0x12'),{'msg':'The\x20email\x20address\x20you\x20have\x20entered\x20is\x20already\x20associated\x20with\x20an\x20account.'});return _0x3306e8[a201_0x51a1('0x8')](a201_0x51a1('0x2c'));}return _0x44b8a2(_0x11ec6f);}_0x30974d[a201_0x51a1('0x14')](a201_0x51a1('0x17'),{'msg':a201_0x51a1('0x33')});_0x3306e8[a201_0x51a1('0x8')]('/account');});});};exports[a201_0x51a1('0x34')]=(_0x439432,_0x366074,_0x114fe6)=>{_0x439432['assert'](a201_0x51a1('0xe'),'Password\x20must\x20be\x20at\x20least\x204\x20characters\x20long')['len']({'min':0x4});_0x439432[a201_0x51a1('0xc')]('confirmPassword',a201_0x51a1('0x21'))[a201_0x51a1('0x22')](_0x439432[a201_0x51a1('0x23')][a201_0x51a1('0xe')]);const _0x14691a=_0x439432[a201_0x51a1('0x11')]();if(_0x14691a){_0x439432[a201_0x51a1('0x14')](a201_0x51a1('0x12'),_0x14691a);return _0x366074[a201_0x51a1('0x8')](a201_0x51a1('0x2c'));}User_1[a201_0x51a1('0x13')][a201_0x51a1('0x35')](_0x439432['user']['id'],(_0x3d8549,_0x59da82)=>{if(_0x3d8549){return _0x114fe6(_0x3d8549);}_0x59da82['password']=_0x439432[a201_0x51a1('0x23')][a201_0x51a1('0xe')];_0x59da82['save'](_0x3d8549=>{if(_0x3d8549){return _0x114fe6(_0x3d8549);}_0x439432[a201_0x51a1('0x14')](a201_0x51a1('0x17'),{'msg':a201_0x51a1('0x36')});_0x366074[a201_0x51a1('0x8')](a201_0x51a1('0x2c'));});});};exports[a201_0x51a1('0x37')]=(_0x2e320f,_0xa23c8f,_0x16e0c4)=>{User_1[a201_0x51a1('0x13')]['remove']({'_id':_0x2e320f[a201_0x51a1('0x7')]['id']},_0xdb3648=>{if(_0xdb3648){return _0x16e0c4(_0xdb3648);}_0x2e320f[a201_0x51a1('0x1b')]();_0x2e320f[a201_0x51a1('0x14')](a201_0x51a1('0x38'),{'msg':a201_0x51a1('0x39')});_0xa23c8f[a201_0x51a1('0x8')]('/');});};exports['getOauthUnlink']=(_0x2860e3,_0x18eb03,_0x417a38)=>{const _0x29ea32=_0x2860e3[a201_0x51a1('0x3a')][a201_0x51a1('0x3b')];User_1[a201_0x51a1('0x13')][a201_0x51a1('0x35')](_0x2860e3[a201_0x51a1('0x7')]['id'],(_0x36d1b3,_0x407ba6)=>{if(_0x36d1b3){return _0x417a38(_0x36d1b3);}_0x407ba6[_0x29ea32]=undefined;_0x407ba6[a201_0x51a1('0x3c')]=_0x407ba6['tokens']['filter'](_0x4c2aa6=>_0x4c2aa6['kind']!==_0x29ea32);_0x407ba6[a201_0x51a1('0x28')](_0x36d1b3=>{if(_0x36d1b3){return _0x417a38(_0x36d1b3);}_0x2860e3[a201_0x51a1('0x14')](a201_0x51a1('0x38'),{'msg':_0x29ea32+a201_0x51a1('0x3d')});_0x18eb03['redirect'](a201_0x51a1('0x2c'));});});};exports[a201_0x51a1('0x3e')]=(_0x4750de,_0x4cdad9,_0x29becf)=>{if(_0x4750de[a201_0x51a1('0x3f')]()){return _0x4cdad9[a201_0x51a1('0x8')]('/');}User_1['default'][a201_0x51a1('0x26')]({'passwordResetToken':_0x4750de['params']['token']})[a201_0x51a1('0x40')](a201_0x51a1('0x41'))['gt'](Date[a201_0x51a1('0x42')]())[a201_0x51a1('0x43')]((_0x16faab,_0x65ce7e)=>{if(_0x16faab){return _0x29becf(_0x16faab);}if(!_0x65ce7e){_0x4750de[a201_0x51a1('0x14')]('errors',{'msg':a201_0x51a1('0x44')});return _0x4cdad9['redirect']('/forgot');}_0x4cdad9[a201_0x51a1('0x9')](a201_0x51a1('0x45'),{'title':'Password\x20Reset'});});};exports[a201_0x51a1('0x46')]=(_0xd382bd,_0x7542e3,_0x4150c9)=>{_0xd382bd[a201_0x51a1('0xc')](a201_0x51a1('0xe'),'Password\x20must\x20be\x20at\x20least\x204\x20characters\x20long.')[a201_0x51a1('0x47')]({'min':0x4});_0xd382bd['assert'](a201_0x51a1('0x48'),'Passwords\x20must\x20match.')['equals'](_0xd382bd['body'][a201_0x51a1('0xe')]);const _0x1c4a88=_0xd382bd[a201_0x51a1('0x11')]();if(_0x1c4a88){_0xd382bd[a201_0x51a1('0x14')](a201_0x51a1('0x12'),_0x1c4a88);return _0x7542e3['redirect']('back');}async_1[a201_0x51a1('0x13')][a201_0x51a1('0x49')]([function resetPassword(_0x47f6e1){User_1[a201_0x51a1('0x13')][a201_0x51a1('0x26')]({'passwordResetToken':_0xd382bd[a201_0x51a1('0x3a')][a201_0x51a1('0x4a')]})[a201_0x51a1('0x40')](a201_0x51a1('0x41'))['gt'](Date[a201_0x51a1('0x42')]())[a201_0x51a1('0x43')]((_0x1aeeca,_0x13dc15)=>{if(_0x1aeeca){return _0x4150c9(_0x1aeeca);}if(!_0x13dc15){_0xd382bd[a201_0x51a1('0x14')](a201_0x51a1('0x12'),{'msg':a201_0x51a1('0x44')});return _0x7542e3[a201_0x51a1('0x8')](a201_0x51a1('0x4b'));}_0x13dc15[a201_0x51a1('0xe')]=_0xd382bd[a201_0x51a1('0x23')][a201_0x51a1('0xe')];_0x13dc15[a201_0x51a1('0x4c')]=undefined;_0x13dc15[a201_0x51a1('0x41')]=undefined;_0x13dc15['save'](_0x1aeeca=>{if(_0x1aeeca){return _0x4150c9(_0x1aeeca);}_0xd382bd['logIn'](_0x13dc15,_0x1aeeca=>{_0x47f6e1(_0x1aeeca,_0x13dc15);});});});},function sendResetPasswordEmail(_0x59bcc4,_0x2e4021){const _0x1478a7=nodemailer_1['default'][a201_0x51a1('0x4d')]({'service':a201_0x51a1('0x4e'),'auth':{'user':process[a201_0x51a1('0x4f')][a201_0x51a1('0x50')],'pass':process['env'][a201_0x51a1('0x51')]}});const _0x41dd03={'to':_0x59bcc4[a201_0x51a1('0x1f')],'from':a201_0x51a1('0x52'),'subject':a201_0x51a1('0x53'),'text':'Hello,\x0a\x0aThis\x20is\x20a\x20confirmation\x20that\x20the\x20password\x20for\x20your\x20account\x20'+_0x59bcc4['email']+a201_0x51a1('0x54')};_0x1478a7[a201_0x51a1('0x55')](_0x41dd03,_0xbb7a55=>{_0xd382bd[a201_0x51a1('0x14')](a201_0x51a1('0x17'),{'msg':a201_0x51a1('0x56')});_0x2e4021(_0xbb7a55);});}],_0x153cc6=>{if(_0x153cc6){return _0x4150c9(_0x153cc6);}_0x7542e3[a201_0x51a1('0x8')]('/');});};exports[a201_0x51a1('0x57')]=(_0x2e77a6,_0x548d57)=>{if(_0x2e77a6[a201_0x51a1('0x3f')]()){return _0x548d57[a201_0x51a1('0x8')]('/');}_0x548d57[a201_0x51a1('0x9')]('account/forgot',{'title':'Forgot\x20Password'});};exports['postForgot']=(_0x436736,_0x3df209,_0x35d7f8)=>{_0x436736[a201_0x51a1('0xc')](a201_0x51a1('0x1f'),a201_0x51a1('0x2b'))[a201_0x51a1('0xd')]();_0x436736[a201_0x51a1('0x10')](a201_0x51a1('0x1f'))[a201_0x51a1('0x24')]({'gmail_remove_dots':![]});const _0x54115d=_0x436736[a201_0x51a1('0x11')]();if(_0x54115d){_0x436736[a201_0x51a1('0x14')]('errors',_0x54115d);return _0x3df209[a201_0x51a1('0x8')](a201_0x51a1('0x58'));}async_1[a201_0x51a1('0x13')]['waterfall']([function createRandomToken(_0x360570){crypto_1[a201_0x51a1('0x13')][a201_0x51a1('0x59')](0x10,(_0x1306ad,_0x1ee5f1)=>{const _0x2fb840=_0x1ee5f1[a201_0x51a1('0x5a')]('hex');_0x360570(_0x1306ad,_0x2fb840);});},function setRandomToken(_0x212990,_0x15734d){User_1[a201_0x51a1('0x13')][a201_0x51a1('0x26')]({'email':_0x436736['body'][a201_0x51a1('0x1f')]},(_0x45a9ce,_0x4a216b)=>{if(_0x45a9ce){return _0x15734d(_0x45a9ce);}if(!_0x4a216b){_0x436736[a201_0x51a1('0x14')]('errors',{'msg':a201_0x51a1('0x5b')});return _0x3df209[a201_0x51a1('0x8')](a201_0x51a1('0x58'));}_0x4a216b['passwordResetToken']=_0x212990;_0x4a216b[a201_0x51a1('0x41')]=Date[a201_0x51a1('0x42')]()+0x36ee80;_0x4a216b[a201_0x51a1('0x28')](_0x45a9ce=>{_0x15734d(_0x45a9ce,_0x212990,_0x4a216b);});});},function sendForgotPasswordEmail(_0x4aa7bc,_0x49e6a6,_0x3336bf){const _0x5d4ab1=nodemailer_1[a201_0x51a1('0x13')][a201_0x51a1('0x4d')]({'service':'SendGrid','auth':{'user':process[a201_0x51a1('0x4f')]['SENDGRID_USER'],'pass':process['env'][a201_0x51a1('0x51')]}});const _0x908141={'to':_0x49e6a6[a201_0x51a1('0x1f')],'from':a201_0x51a1('0x5c'),'subject':a201_0x51a1('0x5d'),'text':'You\x20are\x20receiving\x20this\x20email\x20because\x20you\x20(or\x20someone\x20else)\x20have\x20requested\x20the\x20reset\x20of\x20the\x20password\x20for\x20your\x20account.\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Please\x20click\x20on\x20the\x20following\x20link,\x20or\x20paste\x20this\x20into\x20your\x20browser\x20to\x20complete\x20the\x20process:\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20http://'+_0x436736[a201_0x51a1('0x5e')][a201_0x51a1('0x5f')]+a201_0x51a1('0x60')+_0x4aa7bc+a201_0x51a1('0x61')};_0x5d4ab1[a201_0x51a1('0x55')](_0x908141,_0x2c50ce=>{_0x436736[a201_0x51a1('0x14')](a201_0x51a1('0x38'),{'msg':a201_0x51a1('0x62')+_0x49e6a6[a201_0x51a1('0x1f')]+'\x20with\x20further\x20instructions.'});_0x3336bf(_0x2c50ce);});}],_0x39462c=>{if(_0x39462c){return _0x35d7f8(_0x39462c);}_0x3df209[a201_0x51a1('0x8')](a201_0x51a1('0x58'));});};
var a201_0x2d9e=['password','sanitize','normalizeEmail','errors','/login','local','flash','message','success','Success!\x20You\x20are\x20logged\x20in.','session','returnTo','logout','getSignup','user','postSignup','Password\x20must\x20be\x20at\x20least\x204\x20characters\x20long','len','Passwords\x20do\x20not\x20match','equals','body','validationErrors','/signup','default','findOne','Account\x20with\x20that\x20email\x20address\x20already\x20exists.','save','getAccount','account/profile','Account\x20Management','profile','name','gender','location','website','code','/account','confirmPassword','findById','Password\x20has\x20been\x20changed.','remove','info','getOauthUnlink','params','tokens','filter','kind','\x20account\x20has\x20been\x20unlinked.','isAuthenticated','token','where','now','exec','/forgot','account/reset','Password\x20Reset','postReset','Password\x20must\x20be\x20at\x20least\x204\x20characters\x20long.','confirm','passwordResetExpires','back','passwordResetToken','SendGrid','env','SENDGRID_USER','SENDGRID_PASSWORD','express-ts@starter.com','Your\x20password\x20has\x20been\x20changed','Hello,\x0a\x0aThis\x20is\x20a\x20confirmation\x20that\x20the\x20password\x20for\x20your\x20account\x20','\x20has\x20just\x20been\x20changed.\x0a','sendMail','getForgot','account/forgot','Forgot\x20Password','waterfall','randomBytes','hex','createTransport','Reset\x20your\x20password\x20on\x20Hackathon\x20Starter','You\x20are\x20receiving\x20this\x20email\x20because\x20you\x20(or\x20someone\x20else)\x20have\x20requested\x20the\x20reset\x20of\x20the\x20password\x20for\x20your\x20account.\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Please\x20click\x20on\x20the\x20following\x20link,\x20or\x20paste\x20this\x20into\x20your\x20browser\x20to\x20complete\x20the\x20process:\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20http://','host','/reset/','\x20with\x20further\x20instructions.','__importDefault','defineProperty','__esModule','async','crypto','passport','../models/User','express-validator','getLogin','redirect','render','account/login','Login','assert','email','Email\x20is\x20not\x20valid','isEmail'];(function(_0x413ab7,_0xa009ec){var _0x3cdd70=function(_0xa84ca8){while(--_0xa84ca8){_0x413ab7['push'](_0x413ab7['shift']());}};_0x3cdd70(++_0xa009ec);}(a201_0x2d9e,0x17f));var a201_0xcbad=function(_0x9708e8,_0x4ee741){_0x9708e8=_0x9708e8-0x0;var _0x270399=a201_0x2d9e[_0x9708e8];return _0x270399;};'use strict';var __importDefault=this&&this[a201_0xcbad('0x0')]||function(_0xb0c013){return _0xb0c013&&_0xb0c013['__esModule']?_0xb0c013:{'default':_0xb0c013};};Object[a201_0xcbad('0x1')](exports,a201_0xcbad('0x2'),{'value':!![]});const async_1=__importDefault(require(a201_0xcbad('0x3')));const crypto_1=__importDefault(require(a201_0xcbad('0x4')));const nodemailer_1=__importDefault(require('nodemailer'));const passport_1=__importDefault(require(a201_0xcbad('0x5')));const User_1=__importDefault(require(a201_0xcbad('0x6')));const request=require(a201_0xcbad('0x7'));exports[a201_0xcbad('0x8')]=(_0x444fb8,_0x559af1)=>{if(_0x444fb8['user']){return _0x559af1[a201_0xcbad('0x9')]('/');}_0x559af1[a201_0xcbad('0xa')](a201_0xcbad('0xb'),{'title':a201_0xcbad('0xc')});};exports['postLogin']=(_0x52cf78,_0x2c5850,_0x382ffc)=>{_0x52cf78[a201_0xcbad('0xd')](a201_0xcbad('0xe'),a201_0xcbad('0xf'))[a201_0xcbad('0x10')]();_0x52cf78[a201_0xcbad('0xd')](a201_0xcbad('0x11'),'Password\x20cannot\x20be\x20blank')['notEmpty']();_0x52cf78[a201_0xcbad('0x12')]('email')[a201_0xcbad('0x13')]({'gmail_remove_dots':![]});const _0x55ac16=_0x52cf78['validationErrors']();if(_0x55ac16){_0x52cf78['flash'](a201_0xcbad('0x14'),_0x55ac16);return _0x2c5850[a201_0xcbad('0x9')](a201_0xcbad('0x15'));}passport_1['default']['authenticate'](a201_0xcbad('0x16'),(_0x3345a5,_0x4b716f,_0x8cbd13)=>{if(_0x3345a5){return _0x382ffc(_0x3345a5);}if(!_0x4b716f){_0x52cf78[a201_0xcbad('0x17')](a201_0xcbad('0x14'),_0x8cbd13[a201_0xcbad('0x18')]);return _0x2c5850['redirect'](a201_0xcbad('0x15'));}_0x52cf78['logIn'](_0x4b716f,_0x3345a5=>{if(_0x3345a5){return _0x382ffc(_0x3345a5);}_0x52cf78[a201_0xcbad('0x17')](a201_0xcbad('0x19'),{'msg':a201_0xcbad('0x1a')});_0x2c5850['redirect'](_0x52cf78[a201_0xcbad('0x1b')][a201_0xcbad('0x1c')]||'/');});})(_0x52cf78,_0x2c5850,_0x382ffc);};exports[a201_0xcbad('0x1d')]=(_0x12d546,_0x4d97df)=>{_0x12d546['logout']();_0x4d97df['redirect']('/');};exports[a201_0xcbad('0x1e')]=(_0x58d583,_0x45a1f7)=>{if(_0x58d583[a201_0xcbad('0x1f')]){return _0x45a1f7[a201_0xcbad('0x9')]('/');}_0x45a1f7[a201_0xcbad('0xa')]('account/signup',{'title':'Create\x20Account'});};exports[a201_0xcbad('0x20')]=(_0x2aba1c,_0x2ffec9,_0x3e9dc8)=>{_0x2aba1c['assert'](a201_0xcbad('0xe'),a201_0xcbad('0xf'))['isEmail']();_0x2aba1c[a201_0xcbad('0xd')](a201_0xcbad('0x11'),a201_0xcbad('0x21'))[a201_0xcbad('0x22')]({'min':0x4});_0x2aba1c[a201_0xcbad('0xd')]('confirmPassword',a201_0xcbad('0x23'))[a201_0xcbad('0x24')](_0x2aba1c[a201_0xcbad('0x25')][a201_0xcbad('0x11')]);_0x2aba1c[a201_0xcbad('0x12')]('email')['normalizeEmail']({'gmail_remove_dots':![]});const _0x4a10a7=_0x2aba1c[a201_0xcbad('0x26')]();if(_0x4a10a7){_0x2aba1c[a201_0xcbad('0x17')](a201_0xcbad('0x14'),_0x4a10a7);return _0x2ffec9[a201_0xcbad('0x9')](a201_0xcbad('0x27'));}const _0xd992b4=new User_1['default']({'email':_0x2aba1c[a201_0xcbad('0x25')][a201_0xcbad('0xe')],'password':_0x2aba1c[a201_0xcbad('0x25')]['password']});User_1[a201_0xcbad('0x28')][a201_0xcbad('0x29')]({'email':_0x2aba1c[a201_0xcbad('0x25')][a201_0xcbad('0xe')]},(_0x2377d0,_0x36ea80)=>{if(_0x2377d0){return _0x3e9dc8(_0x2377d0);}if(_0x36ea80){_0x2aba1c[a201_0xcbad('0x17')](a201_0xcbad('0x14'),{'msg':a201_0xcbad('0x2a')});return _0x2ffec9[a201_0xcbad('0x9')](a201_0xcbad('0x27'));}_0xd992b4[a201_0xcbad('0x2b')](_0x2377d0=>{if(_0x2377d0){return _0x3e9dc8(_0x2377d0);}_0x2aba1c['logIn'](_0xd992b4,_0x2377d0=>{if(_0x2377d0){return _0x3e9dc8(_0x2377d0);}_0x2ffec9['redirect']('/');});});});};exports[a201_0xcbad('0x2c')]=(_0x37b1d7,_0x31da51)=>{_0x31da51['render'](a201_0xcbad('0x2d'),{'title':a201_0xcbad('0x2e')});};exports['postUpdateProfile']=(_0x515d74,_0x5a4a59,_0x1dfc7c)=>{_0x515d74[a201_0xcbad('0xd')]('email','Please\x20enter\x20a\x20valid\x20email\x20address.')[a201_0xcbad('0x10')]();_0x515d74[a201_0xcbad('0x12')](a201_0xcbad('0xe'))['normalizeEmail']({'gmail_remove_dots':![]});const _0x27d2f8=_0x515d74[a201_0xcbad('0x26')]();if(_0x27d2f8){_0x515d74[a201_0xcbad('0x17')](a201_0xcbad('0x14'),_0x27d2f8);return _0x5a4a59[a201_0xcbad('0x9')]('/account');}User_1[a201_0xcbad('0x28')]['findById'](_0x515d74[a201_0xcbad('0x1f')]['id'],(_0x914450,_0x4ce72e)=>{if(_0x914450){return _0x1dfc7c(_0x914450);}_0x4ce72e[a201_0xcbad('0xe')]=_0x515d74[a201_0xcbad('0x25')]['email']||'';_0x4ce72e[a201_0xcbad('0x2f')][a201_0xcbad('0x30')]=_0x515d74[a201_0xcbad('0x25')]['name']||'';_0x4ce72e['profile']['gender']=_0x515d74[a201_0xcbad('0x25')][a201_0xcbad('0x31')]||'';_0x4ce72e[a201_0xcbad('0x2f')]['location']=_0x515d74[a201_0xcbad('0x25')][a201_0xcbad('0x32')]||'';_0x4ce72e[a201_0xcbad('0x2f')][a201_0xcbad('0x33')]=_0x515d74[a201_0xcbad('0x25')]['website']||'';_0x4ce72e[a201_0xcbad('0x2b')](_0x914450=>{if(_0x914450){if(_0x914450[a201_0xcbad('0x34')]===0x2af8){_0x515d74[a201_0xcbad('0x17')](a201_0xcbad('0x14'),{'msg':'The\x20email\x20address\x20you\x20have\x20entered\x20is\x20already\x20associated\x20with\x20an\x20account.'});return _0x5a4a59[a201_0xcbad('0x9')](a201_0xcbad('0x35'));}return _0x1dfc7c(_0x914450);}_0x515d74['flash'](a201_0xcbad('0x19'),{'msg':'Profile\x20information\x20has\x20been\x20updated.'});_0x5a4a59[a201_0xcbad('0x9')](a201_0xcbad('0x35'));});});};exports['postUpdatePassword']=(_0x4fccce,_0x43ff71,_0x32283e)=>{_0x4fccce[a201_0xcbad('0xd')](a201_0xcbad('0x11'),a201_0xcbad('0x21'))[a201_0xcbad('0x22')]({'min':0x4});_0x4fccce[a201_0xcbad('0xd')](a201_0xcbad('0x36'),a201_0xcbad('0x23'))[a201_0xcbad('0x24')](_0x4fccce[a201_0xcbad('0x25')][a201_0xcbad('0x11')]);const _0x30ab62=_0x4fccce['validationErrors']();if(_0x30ab62){_0x4fccce[a201_0xcbad('0x17')]('errors',_0x30ab62);return _0x43ff71[a201_0xcbad('0x9')](a201_0xcbad('0x35'));}User_1[a201_0xcbad('0x28')][a201_0xcbad('0x37')](_0x4fccce[a201_0xcbad('0x1f')]['id'],(_0x31ef69,_0x1cada5)=>{if(_0x31ef69){return _0x32283e(_0x31ef69);}_0x1cada5[a201_0xcbad('0x11')]=_0x4fccce['body'][a201_0xcbad('0x11')];_0x1cada5[a201_0xcbad('0x2b')](_0x31ef69=>{if(_0x31ef69){return _0x32283e(_0x31ef69);}_0x4fccce[a201_0xcbad('0x17')](a201_0xcbad('0x19'),{'msg':a201_0xcbad('0x38')});_0x43ff71[a201_0xcbad('0x9')](a201_0xcbad('0x35'));});});};exports['postDeleteAccount']=(_0x3eda9c,_0x3c23b7,_0xc17e28)=>{User_1[a201_0xcbad('0x28')][a201_0xcbad('0x39')]({'_id':_0x3eda9c[a201_0xcbad('0x1f')]['id']},_0x2e7c0a=>{if(_0x2e7c0a){return _0xc17e28(_0x2e7c0a);}_0x3eda9c[a201_0xcbad('0x1d')]();_0x3eda9c[a201_0xcbad('0x17')](a201_0xcbad('0x3a'),{'msg':'Your\x20account\x20has\x20been\x20deleted.'});_0x3c23b7[a201_0xcbad('0x9')]('/');});};exports[a201_0xcbad('0x3b')]=(_0x4a9148,_0x4cb736,_0x72a944)=>{const _0x29e4d7=_0x4a9148[a201_0xcbad('0x3c')]['provider'];User_1[a201_0xcbad('0x28')][a201_0xcbad('0x37')](_0x4a9148[a201_0xcbad('0x1f')]['id'],(_0x46e81c,_0x2a7751)=>{if(_0x46e81c){return _0x72a944(_0x46e81c);}_0x2a7751[_0x29e4d7]=undefined;_0x2a7751[a201_0xcbad('0x3d')]=_0x2a7751[a201_0xcbad('0x3d')][a201_0xcbad('0x3e')](_0x504c92=>_0x504c92[a201_0xcbad('0x3f')]!==_0x29e4d7);_0x2a7751['save'](_0x46e81c=>{if(_0x46e81c){return _0x72a944(_0x46e81c);}_0x4a9148['flash'](a201_0xcbad('0x3a'),{'msg':_0x29e4d7+a201_0xcbad('0x40')});_0x4cb736[a201_0xcbad('0x9')](a201_0xcbad('0x35'));});});};exports['getReset']=(_0x2c4686,_0x4c275b,_0x47ee4c)=>{if(_0x2c4686[a201_0xcbad('0x41')]()){return _0x4c275b[a201_0xcbad('0x9')]('/');}User_1['default'][a201_0xcbad('0x29')]({'passwordResetToken':_0x2c4686[a201_0xcbad('0x3c')][a201_0xcbad('0x42')]})[a201_0xcbad('0x43')]('passwordResetExpires')['gt'](Date[a201_0xcbad('0x44')]())[a201_0xcbad('0x45')]((_0x402183,_0x11b4e1)=>{if(_0x402183){return _0x47ee4c(_0x402183);}if(!_0x11b4e1){_0x2c4686[a201_0xcbad('0x17')](a201_0xcbad('0x14'),{'msg':'Password\x20reset\x20token\x20is\x20invalid\x20or\x20has\x20expired.'});return _0x4c275b[a201_0xcbad('0x9')](a201_0xcbad('0x46'));}_0x4c275b[a201_0xcbad('0xa')](a201_0xcbad('0x47'),{'title':a201_0xcbad('0x48')});});};exports[a201_0xcbad('0x49')]=(_0x5bf3fa,_0x2a2f94,_0x2f558e)=>{_0x5bf3fa['assert'](a201_0xcbad('0x11'),a201_0xcbad('0x4a'))['len']({'min':0x4});_0x5bf3fa[a201_0xcbad('0xd')](a201_0xcbad('0x4b'),'Passwords\x20must\x20match.')[a201_0xcbad('0x24')](_0x5bf3fa['body'][a201_0xcbad('0x11')]);const _0xc008e5=_0x5bf3fa[a201_0xcbad('0x26')]();if(_0xc008e5){_0x5bf3fa['flash'](a201_0xcbad('0x14'),_0xc008e5);return _0x2a2f94[a201_0xcbad('0x9')]('back');}async_1[a201_0xcbad('0x28')]['waterfall']([function resetPassword(_0x4860ba){User_1[a201_0xcbad('0x28')][a201_0xcbad('0x29')]({'passwordResetToken':_0x5bf3fa['params'][a201_0xcbad('0x42')]})[a201_0xcbad('0x43')](a201_0xcbad('0x4c'))['gt'](Date[a201_0xcbad('0x44')]())['exec']((_0x3402e3,_0x27035c)=>{if(_0x3402e3){return _0x2f558e(_0x3402e3);}if(!_0x27035c){_0x5bf3fa['flash'](a201_0xcbad('0x14'),{'msg':'Password\x20reset\x20token\x20is\x20invalid\x20or\x20has\x20expired.'});return _0x2a2f94[a201_0xcbad('0x9')](a201_0xcbad('0x4d'));}_0x27035c[a201_0xcbad('0x11')]=_0x5bf3fa[a201_0xcbad('0x25')][a201_0xcbad('0x11')];_0x27035c[a201_0xcbad('0x4e')]=undefined;_0x27035c[a201_0xcbad('0x4c')]=undefined;_0x27035c[a201_0xcbad('0x2b')](_0x3402e3=>{if(_0x3402e3){return _0x2f558e(_0x3402e3);}_0x5bf3fa['logIn'](_0x27035c,_0x3402e3=>{_0x4860ba(_0x3402e3,_0x27035c);});});});},function sendResetPasswordEmail(_0x217c0f,_0xc223ec){const _0x5de822=nodemailer_1[a201_0xcbad('0x28')]['createTransport']({'service':a201_0xcbad('0x4f'),'auth':{'user':process[a201_0xcbad('0x50')][a201_0xcbad('0x51')],'pass':process[a201_0xcbad('0x50')][a201_0xcbad('0x52')]}});const _0x514df2={'to':_0x217c0f['email'],'from':a201_0xcbad('0x53'),'subject':a201_0xcbad('0x54'),'text':a201_0xcbad('0x55')+_0x217c0f[a201_0xcbad('0xe')]+a201_0xcbad('0x56')};_0x5de822[a201_0xcbad('0x57')](_0x514df2,_0x8be38f=>{_0x5bf3fa['flash'](a201_0xcbad('0x19'),{'msg':'Success!\x20Your\x20password\x20has\x20been\x20changed.'});_0xc223ec(_0x8be38f);});}],_0x39883d=>{if(_0x39883d){return _0x2f558e(_0x39883d);}_0x2a2f94[a201_0xcbad('0x9')]('/');});};exports[a201_0xcbad('0x58')]=(_0x293a75,_0x330bfc)=>{if(_0x293a75[a201_0xcbad('0x41')]()){return _0x330bfc[a201_0xcbad('0x9')]('/');}_0x330bfc[a201_0xcbad('0xa')](a201_0xcbad('0x59'),{'title':a201_0xcbad('0x5a')});};exports['postForgot']=(_0xf528be,_0x281b63,_0x23e20b)=>{_0xf528be['assert'](a201_0xcbad('0xe'),'Please\x20enter\x20a\x20valid\x20email\x20address.')['isEmail']();_0xf528be[a201_0xcbad('0x12')](a201_0xcbad('0xe'))['normalizeEmail']({'gmail_remove_dots':![]});const _0x26851a=_0xf528be[a201_0xcbad('0x26')]();if(_0x26851a){_0xf528be[a201_0xcbad('0x17')]('errors',_0x26851a);return _0x281b63[a201_0xcbad('0x9')]('/forgot');}async_1[a201_0xcbad('0x28')][a201_0xcbad('0x5b')]([function createRandomToken(_0x441300){crypto_1[a201_0xcbad('0x28')][a201_0xcbad('0x5c')](0x10,(_0x1edaa4,_0x38ce51)=>{const _0x4c4676=_0x38ce51['toString'](a201_0xcbad('0x5d'));_0x441300(_0x1edaa4,_0x4c4676);});},function setRandomToken(_0x4fb5f2,_0x2e1f13){User_1[a201_0xcbad('0x28')][a201_0xcbad('0x29')]({'email':_0xf528be[a201_0xcbad('0x25')][a201_0xcbad('0xe')]},(_0x323bfb,_0x1d0b44)=>{if(_0x323bfb){return _0x2e1f13(_0x323bfb);}if(!_0x1d0b44){_0xf528be[a201_0xcbad('0x17')](a201_0xcbad('0x14'),{'msg':'Account\x20with\x20that\x20email\x20address\x20does\x20not\x20exist.'});return _0x281b63['redirect'](a201_0xcbad('0x46'));}_0x1d0b44[a201_0xcbad('0x4e')]=_0x4fb5f2;_0x1d0b44[a201_0xcbad('0x4c')]=Date[a201_0xcbad('0x44')]()+0x36ee80;_0x1d0b44['save'](_0x323bfb=>{_0x2e1f13(_0x323bfb,_0x4fb5f2,_0x1d0b44);});});},function sendForgotPasswordEmail(_0x391951,_0x17a9e8,_0x3415b2){const _0x3fc73e=nodemailer_1[a201_0xcbad('0x28')][a201_0xcbad('0x5e')]({'service':'SendGrid','auth':{'user':process[a201_0xcbad('0x50')][a201_0xcbad('0x51')],'pass':process['env'][a201_0xcbad('0x52')]}});const _0x465f08={'to':_0x17a9e8[a201_0xcbad('0xe')],'from':'hackathon@starter.com','subject':a201_0xcbad('0x5f'),'text':a201_0xcbad('0x60')+_0xf528be['headers'][a201_0xcbad('0x61')]+a201_0xcbad('0x62')+_0x391951+'\x0a\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20If\x20you\x20did\x20not\x20request\x20this,\x20please\x20ignore\x20this\x20email\x20and\x20your\x20password\x20will\x20remain\x20unchanged.\x0a'};_0x3fc73e['sendMail'](_0x465f08,_0x1e06a7=>{_0xf528be[a201_0xcbad('0x17')]('info',{'msg':'An\x20e-mail\x20has\x20been\x20sent\x20to\x20'+_0x17a9e8[a201_0xcbad('0xe')]+a201_0xcbad('0x63')});_0x3415b2(_0x1e06a7);});}],_0x3d7782=>{if(_0x3d7782){return _0x23e20b(_0x3d7782);}_0x281b63[a201_0xcbad('0x9')](a201_0xcbad('0x46'));});};
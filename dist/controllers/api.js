var a92_0x2eb4=['YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))','getPassCountingByHour','endDate','DATE_FORMAT','%Y-%m-%d\x20%H:00','total','HOUR','DAY','getFacebook','user','tokens','kind','setAccessToken','accessToken','facebook','api/facebook','Facebook\x20API','defineProperty','__esModule','fbgraph','ftp','sequelize','setSequelize','render','api/index','API\x20Examples','syncFtp','connecting','default','log','list','Downloading:\x20','name','endsWith','models','findOrCreate','spread','push','json','error','connect','ipd','downloadFtp','reportFiles','findOne','then','get','colombia/','fileName','end','media/','.txt','pipe','createWriteStream','status','save','ftp.vivotek.com','processFtp','readFile','Data','CountingInfo','Out','parse','create','passes','findAll','countingDate','ASC','query','month','startDate','col','amount','gte','params','direction','literal'];(function(_0x241a0e,_0x1a6a15){var _0xa78a48=function(_0x1ce7f2){while(--_0x1ce7f2){_0x241a0e['push'](_0x241a0e['shift']());}};_0xa78a48(++_0x1a6a15);}(a92_0x2eb4,0x1df));var a92_0x6bcb=function(_0x5bfda2,_0xdad8de){_0x5bfda2=_0x5bfda2-0x0;var _0x1b7edd=a92_0x2eb4[_0x5bfda2];return _0x1b7edd;};'use strict';var __importDefault=this&&this['__importDefault']||function(_0xe9dc4e){return _0xe9dc4e&&_0xe9dc4e['__esModule']?_0xe9dc4e:{'default':_0xe9dc4e};};Object[a92_0x6bcb('0x0')](exports,a92_0x6bcb('0x1'),{'value':!![]});const fbgraph_1=__importDefault(require(a92_0x6bcb('0x2')));const ftp_1=__importDefault(require(a92_0x6bcb('0x3')));const fs_1=__importDefault(require('fs'));function setSequelize(_0x371576){exports[a92_0x6bcb('0x4')]=_0x371576;}exports[a92_0x6bcb('0x5')]=setSequelize;exports['getApi']=(_0x4b7276,_0x3b8d3e)=>{_0x3b8d3e[a92_0x6bcb('0x6')](a92_0x6bcb('0x7'),{'title':a92_0x6bcb('0x8')});};exports[a92_0x6bcb('0x9')]=(_0x17393d,_0x4e094a)=>{console['log'](a92_0x6bcb('0xa'));const _0x5796f5=[];const _0x31ace0=new ftp_1[(a92_0x6bcb('0xb'))]();_0x31ace0['on']('ready',function(){console[a92_0x6bcb('0xc')]('connected');_0x31ace0[a92_0x6bcb('0xd')]('colombia',![],function(_0x3cc8c3,_0x2a0ca9){if(_0x3cc8c3){}else{for(const _0x1c64b1 of _0x2a0ca9){console[a92_0x6bcb('0xc')](a92_0x6bcb('0xe')+_0x1c64b1[a92_0x6bcb('0xf')]);if(_0x1c64b1[a92_0x6bcb('0xf')][a92_0x6bcb('0x10')]('json')){exports[a92_0x6bcb('0x4')][a92_0x6bcb('0x11')]['reportFiles'][a92_0x6bcb('0x12')]({'where':{'fileName':_0x1c64b1[a92_0x6bcb('0xf')]}})[a92_0x6bcb('0x13')]((_0x12b7e5,_0x36025e)=>{if(_0x36025e){console[a92_0x6bcb('0xc')](_0x1c64b1[a92_0x6bcb('0xf')]);_0x5796f5[a92_0x6bcb('0x14')](_0x12b7e5);}});}}}_0x4e094a[a92_0x6bcb('0x15')]({'data':_0x5796f5});});});_0x31ace0['on'](a92_0x6bcb('0x16'),function(_0x2c9c06){_0x4e094a[a92_0x6bcb('0x15')]({'message':_0x2c9c06});});_0x31ace0[a92_0x6bcb('0x17')]({'host':'ftp.vivotek.com','port':0x15,'user':'ipd','password':a92_0x6bcb('0x18')});};exports[a92_0x6bcb('0x19')]=(_0x2fb856,_0x2ff19a)=>{exports[a92_0x6bcb('0x4')][a92_0x6bcb('0x11')][a92_0x6bcb('0x1a')][a92_0x6bcb('0x1b')]({'where':{'status':null}})[a92_0x6bcb('0x1c')](_0x213dca=>{if(_0x213dca){const _0x4d62fc=new ftp_1['default']();_0x4d62fc['on']('ready',function(){console[a92_0x6bcb('0xc')]('connected:'+_0x213dca['fileName']);_0x4d62fc[a92_0x6bcb('0x1d')](a92_0x6bcb('0x1e')+_0x213dca[a92_0x6bcb('0x1f')],function(_0x5404a3,_0x525156){_0x4d62fc[a92_0x6bcb('0x20')]();if(_0x5404a3){}else{const _0x100961=a92_0x6bcb('0x21')+_0x213dca[a92_0x6bcb('0x1f')]+a92_0x6bcb('0x22');_0x525156[a92_0x6bcb('0x23')](fs_1[a92_0x6bcb('0xb')][a92_0x6bcb('0x24')](_0x100961));_0x213dca[a92_0x6bcb('0x25')]=0x1;_0x213dca[a92_0x6bcb('0x26')]();console[a92_0x6bcb('0xc')]('Downloaded:\x20'+_0x213dca[a92_0x6bcb('0x1f')]);}});});_0x4d62fc['on']('error',function(_0x39024a){_0x2ff19a[a92_0x6bcb('0x15')]({'message':_0x39024a});});_0x4d62fc[a92_0x6bcb('0x17')]({'host':a92_0x6bcb('0x27'),'port':0x15,'user':a92_0x6bcb('0x18'),'password':'ipd'});_0x2ff19a[a92_0x6bcb('0x15')]({'data':_0x213dca['fileName']});}else{_0x2ff19a[a92_0x6bcb('0x15')]({'data':[]});}});};exports[a92_0x6bcb('0x28')]=(_0x232efe,_0xbda95b)=>{exports[a92_0x6bcb('0x4')]['models'][a92_0x6bcb('0x1a')][a92_0x6bcb('0x1b')]({'where':{'status':0x1}})[a92_0x6bcb('0x1c')](_0x46ce01=>{if(_0x46ce01){const _0x1443db=a92_0x6bcb('0x21')+_0x46ce01[a92_0x6bcb('0x1f')]+a92_0x6bcb('0x22');fs_1[a92_0x6bcb('0xb')][a92_0x6bcb('0x29')](_0x1443db,'utf8',function(_0x463482,_0x274bad){if(_0x463482){_0x46ce01['status']=null;}else{try{const _0x35eb2c=JSON['parse'](_0x274bad);for(const _0xce975b of _0x35eb2c[a92_0x6bcb('0x2a')][0x0][a92_0x6bcb('0x2b')]){const _0x38f41b=_0xce975b['In'];const _0x13fc57=_0xce975b[a92_0x6bcb('0x2c')];const _0x230fb9=Date[a92_0x6bcb('0x2d')](_0xce975b['EndTime']);if(_0x38f41b>0x0){exports[a92_0x6bcb('0x4')][a92_0x6bcb('0x11')]['passes'][a92_0x6bcb('0x2e')]({'reportFileId':_0x46ce01['id'],'amount':_0x38f41b,'countingDate':_0x230fb9});}if(_0x13fc57>0x0){exports[a92_0x6bcb('0x4')]['models'][a92_0x6bcb('0x2f')][a92_0x6bcb('0x2e')]({'reportFileId':_0x46ce01['id'],'amount':_0x13fc57*-0x1,'countingDate':_0x230fb9});}}_0x46ce01[a92_0x6bcb('0x25')]=0x2;}catch(_0x413893){_0x46ce01[a92_0x6bcb('0x25')]=null;}}_0x46ce01[a92_0x6bcb('0x26')]();});_0xbda95b[a92_0x6bcb('0x15')]({'data':_0x46ce01['fileName']});}else{_0xbda95b[a92_0x6bcb('0x15')]({'data':[]});}});};exports['getPassCounting']=(_0x1e5b45,_0x4c1a1a)=>{exports[a92_0x6bcb('0x4')][a92_0x6bcb('0x11')]['passes'][a92_0x6bcb('0x30')]({'where':{'amount':{[exports[a92_0x6bcb('0x4')]['Op']['gt']]:0x0}},'order':[[a92_0x6bcb('0x31'),a92_0x6bcb('0x32')]]})[a92_0x6bcb('0x1c')](_0x2b8e0c=>{_0x4c1a1a['json']({'data':_0x2b8e0c});});};exports['getPassCountingByDay']=(_0x102c77,_0x4fce81)=>{const _0x50770b=_0x102c77[a92_0x6bcb('0x33')][a92_0x6bcb('0x34')];const _0x434b29=_0x102c77[a92_0x6bcb('0x33')][a92_0x6bcb('0x35')];const _0x4480b0=_0x102c77[a92_0x6bcb('0x33')]['endDate'];exports['sequelize'][a92_0x6bcb('0x11')][a92_0x6bcb('0x2f')][a92_0x6bcb('0x30')]({'attributes':[a92_0x6bcb('0x31'),[exports[a92_0x6bcb('0x4')]['fn']('sum',exports[a92_0x6bcb('0x4')][a92_0x6bcb('0x36')](a92_0x6bcb('0x37'))),'total']],'where':{'countingDate':{[exports[a92_0x6bcb('0x4')]['Op'][a92_0x6bcb('0x38')]]:_0x434b29,[exports[a92_0x6bcb('0x4')]['Op']['lt']]:_0x4480b0},'amount':_0x102c77[a92_0x6bcb('0x39')][a92_0x6bcb('0x3a')]=='in'?{[exports[a92_0x6bcb('0x4')]['Op']['gt']]:0x0}:{[exports[a92_0x6bcb('0x4')]['Op']['lt']]:0x0}},'group':[exports[a92_0x6bcb('0x4')][a92_0x6bcb('0x3b')](a92_0x6bcb('0x3c'))],'order':[['countingDate','ASC']]})[a92_0x6bcb('0x1c')](_0x1014ee=>{_0x4fce81['json']({'data':_0x1014ee});});};exports[a92_0x6bcb('0x3d')]=(_0x1808ca,_0x3cd1c3)=>{const _0x507a1b=_0x1808ca[a92_0x6bcb('0x33')][a92_0x6bcb('0x34')];const _0x5c6281=_0x1808ca[a92_0x6bcb('0x33')][a92_0x6bcb('0x35')];const _0x5b2371=_0x1808ca[a92_0x6bcb('0x33')][a92_0x6bcb('0x3e')];exports[a92_0x6bcb('0x4')][a92_0x6bcb('0x11')][a92_0x6bcb('0x2f')]['findAll']({'attributes':[a92_0x6bcb('0x31'),[exports['sequelize']['fn'](a92_0x6bcb('0x3f'),exports[a92_0x6bcb('0x4')][a92_0x6bcb('0x36')](a92_0x6bcb('0x31')),a92_0x6bcb('0x40')),'countingDateShort'],[exports[a92_0x6bcb('0x4')]['fn']('sum',exports['sequelize'][a92_0x6bcb('0x36')](a92_0x6bcb('0x37'))),a92_0x6bcb('0x41')]],'where':{'countingDate':{[exports[a92_0x6bcb('0x4')]['Op']['gte']]:_0x5c6281,[exports[a92_0x6bcb('0x4')]['Op']['lt']]:_0x5b2371},'amount':_0x1808ca[a92_0x6bcb('0x39')][a92_0x6bcb('0x3a')]=='in'?{[exports['sequelize']['Op']['gt']]:0x0}:{[exports[a92_0x6bcb('0x4')]['Op']['lt']]:0x0}},'group':[exports[a92_0x6bcb('0x4')]['fn'](a92_0x6bcb('0x42'),exports[a92_0x6bcb('0x4')][a92_0x6bcb('0x36')](a92_0x6bcb('0x31'))),exports['sequelize']['fn'](a92_0x6bcb('0x43'),exports[a92_0x6bcb('0x4')][a92_0x6bcb('0x36')](a92_0x6bcb('0x31'))),exports['sequelize']['fn']('MONTH',exports[a92_0x6bcb('0x4')]['col'](a92_0x6bcb('0x31'))),exports[a92_0x6bcb('0x4')]['fn']('YEAR',exports[a92_0x6bcb('0x4')][a92_0x6bcb('0x36')]('countingDate'))],'order':[['countingDate',a92_0x6bcb('0x32')]]})[a92_0x6bcb('0x1c')](_0x1db444=>{_0x3cd1c3[a92_0x6bcb('0x15')]({'data':_0x1db444});});};exports[a92_0x6bcb('0x44')]=(_0x522b3c,_0x1fe853,_0x4ca848)=>{const _0x213858=_0x522b3c[a92_0x6bcb('0x45')][a92_0x6bcb('0x46')]['find'](_0x213858=>_0x213858[a92_0x6bcb('0x47')]==='facebook');fbgraph_1[a92_0x6bcb('0xb')][a92_0x6bcb('0x48')](_0x213858[a92_0x6bcb('0x49')]);fbgraph_1['default']['get'](_0x522b3c[a92_0x6bcb('0x45')][a92_0x6bcb('0x4a')]+'?fields=id,name,email,first_name,last_name,gender,link,locale,timezone',(_0x232597,_0x4d4d56)=>{if(_0x232597){return _0x4ca848(_0x232597);}_0x1fe853[a92_0x6bcb('0x6')](a92_0x6bcb('0x4b'),{'title':a92_0x6bcb('0x4c'),'profile':_0x4d4d56});});};
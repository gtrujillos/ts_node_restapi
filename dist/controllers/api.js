var a198_0x11b5=['direction','literal','YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))','DATE_FORMAT','col','%Y-%m-%d\x20%H:00','countingDateShort','sum','DAY','MONTH','getFacebook','tokens','find','kind','facebook','setAccessToken','accessToken','user','Facebook\x20API','__esModule','fbgraph','ftp','getApi','render','api/index','API\x20Examples','syncFtp','log','connecting','default','ready','connected','list','colombia','Downloading:\x20','endsWith','json','sequelize','models','reportFiles','findOrCreate','spread','name','error','connect','ftp.vivotek.com','ipd','downloadFtp','findOne','then','connected:','fileName','get','end','media/','.txt','createWriteStream','status','save','Downloaded:\x20','processFtp','readFile','parse','CountingInfo','Out','passes','create','countingDate','ASC','month','query','startDate','endDate','findAll','amount','total','gte','params'];(function(_0x4a6681,_0x13ce98){var _0x52dd3c=function(_0x21ddd1){while(--_0x21ddd1){_0x4a6681['push'](_0x4a6681['shift']());}};_0x52dd3c(++_0x13ce98);}(a198_0x11b5,0x14b));var a198_0x3ec7=function(_0x8469ef,_0x225ef0){_0x8469ef=_0x8469ef-0x0;var _0x317b21=a198_0x11b5[_0x8469ef];return _0x317b21;};'use strict';var __importDefault=this&&this['__importDefault']||function(_0x21fa6e){return _0x21fa6e&&_0x21fa6e[a198_0x3ec7('0x0')]?_0x21fa6e:{'default':_0x21fa6e};};Object['defineProperty'](exports,a198_0x3ec7('0x0'),{'value':!![]});const fbgraph_1=__importDefault(require(a198_0x3ec7('0x1')));const ftp_1=__importDefault(require(a198_0x3ec7('0x2')));const fs_1=__importDefault(require('fs'));function setSequelize(_0x1cb930){exports['sequelize']=_0x1cb930;}exports['setSequelize']=setSequelize;exports[a198_0x3ec7('0x3')]=(_0x2bc2be,_0x353ffc)=>{_0x353ffc[a198_0x3ec7('0x4')](a198_0x3ec7('0x5'),{'title':a198_0x3ec7('0x6')});};exports[a198_0x3ec7('0x7')]=(_0x2e1d83,_0x2a12e0)=>{console[a198_0x3ec7('0x8')](a198_0x3ec7('0x9'));const _0x3ecbb0=[];const _0x1cd66f=new ftp_1[(a198_0x3ec7('0xa'))]();_0x1cd66f['on'](a198_0x3ec7('0xb'),function(){console[a198_0x3ec7('0x8')](a198_0x3ec7('0xc'));_0x1cd66f[a198_0x3ec7('0xd')](a198_0x3ec7('0xe'),![],function(_0xccd60d,_0x21ad47){if(_0xccd60d){}else{for(const _0xbde4d2 of _0x21ad47){console[a198_0x3ec7('0x8')](a198_0x3ec7('0xf')+_0xbde4d2['name']);if(_0xbde4d2['name'][a198_0x3ec7('0x10')](a198_0x3ec7('0x11'))){exports[a198_0x3ec7('0x12')][a198_0x3ec7('0x13')][a198_0x3ec7('0x14')][a198_0x3ec7('0x15')]({'where':{'fileName':_0xbde4d2['name']}})[a198_0x3ec7('0x16')]((_0x5d1e53,_0x2b2914)=>{if(_0x2b2914){console['log'](_0xbde4d2[a198_0x3ec7('0x17')]);_0x3ecbb0['push'](_0x5d1e53);}});}}}_0x2a12e0[a198_0x3ec7('0x11')]({'data':_0x3ecbb0});});});_0x1cd66f['on'](a198_0x3ec7('0x18'),function(_0x31d80b){_0x2a12e0['json']({'message':_0x31d80b});});_0x1cd66f[a198_0x3ec7('0x19')]({'host':a198_0x3ec7('0x1a'),'port':0x15,'user':a198_0x3ec7('0x1b'),'password':a198_0x3ec7('0x1b')});};exports[a198_0x3ec7('0x1c')]=(_0x26762f,_0x420939)=>{exports[a198_0x3ec7('0x12')][a198_0x3ec7('0x13')][a198_0x3ec7('0x14')][a198_0x3ec7('0x1d')]({'where':{'status':null}})[a198_0x3ec7('0x1e')](_0x316477=>{if(_0x316477){const _0x379f5f=new ftp_1[(a198_0x3ec7('0xa'))]();_0x379f5f['on']('ready',function(){console['log'](a198_0x3ec7('0x1f')+_0x316477[a198_0x3ec7('0x20')]);_0x379f5f[a198_0x3ec7('0x21')]('colombia/'+_0x316477[a198_0x3ec7('0x20')],function(_0xa4111e,_0x422dbc){_0x379f5f[a198_0x3ec7('0x22')]();if(_0xa4111e){}else{const _0x532164=a198_0x3ec7('0x23')+_0x316477[a198_0x3ec7('0x20')]+a198_0x3ec7('0x24');_0x422dbc['pipe'](fs_1[a198_0x3ec7('0xa')][a198_0x3ec7('0x25')](_0x532164));_0x316477[a198_0x3ec7('0x26')]=0x1;_0x316477[a198_0x3ec7('0x27')]();console[a198_0x3ec7('0x8')](a198_0x3ec7('0x28')+_0x316477[a198_0x3ec7('0x20')]);}});});_0x379f5f['on'](a198_0x3ec7('0x18'),function(_0x3c50e0){_0x420939[a198_0x3ec7('0x11')]({'message':_0x3c50e0});});_0x379f5f[a198_0x3ec7('0x19')]({'host':a198_0x3ec7('0x1a'),'port':0x15,'user':a198_0x3ec7('0x1b'),'password':a198_0x3ec7('0x1b')});_0x420939[a198_0x3ec7('0x11')]({'data':_0x316477[a198_0x3ec7('0x20')]});}else{_0x420939[a198_0x3ec7('0x11')]({'data':[]});}});};exports[a198_0x3ec7('0x29')]=(_0x41db10,_0x47a4e7)=>{exports[a198_0x3ec7('0x12')]['models']['reportFiles']['findOne']({'where':{'status':0x1}})[a198_0x3ec7('0x1e')](_0x17a237=>{if(_0x17a237){const _0x34ba91=a198_0x3ec7('0x23')+_0x17a237[a198_0x3ec7('0x20')]+a198_0x3ec7('0x24');fs_1[a198_0x3ec7('0xa')][a198_0x3ec7('0x2a')](_0x34ba91,'utf8',function(_0x24947a,_0x542833){if(_0x24947a){_0x17a237['status']=null;}else{try{const _0x19887b=JSON[a198_0x3ec7('0x2b')](_0x542833);for(const _0x6eaeea of _0x19887b['Data'][0x0][a198_0x3ec7('0x2c')]){const _0x55576=_0x6eaeea['In'];const _0x4ca732=_0x6eaeea[a198_0x3ec7('0x2d')];const _0x5075ae=Date[a198_0x3ec7('0x2b')](_0x6eaeea['EndTime']);if(_0x55576>0x0){exports[a198_0x3ec7('0x12')][a198_0x3ec7('0x13')][a198_0x3ec7('0x2e')][a198_0x3ec7('0x2f')]({'reportFileId':_0x17a237['id'],'amount':_0x55576,'countingDate':_0x5075ae});}if(_0x4ca732>0x0){exports[a198_0x3ec7('0x12')]['models'][a198_0x3ec7('0x2e')][a198_0x3ec7('0x2f')]({'reportFileId':_0x17a237['id'],'amount':_0x4ca732*-0x1,'countingDate':_0x5075ae});}}_0x17a237['status']=0x2;}catch(_0x23e891){_0x17a237[a198_0x3ec7('0x26')]=null;}}_0x17a237[a198_0x3ec7('0x27')]();});_0x47a4e7['json']({'data':_0x17a237[a198_0x3ec7('0x20')]});}else{_0x47a4e7[a198_0x3ec7('0x11')]({'data':[]});}});};exports['getPassCounting']=(_0x2f7131,_0x5ccda8)=>{exports[a198_0x3ec7('0x12')]['models'][a198_0x3ec7('0x2e')]['findAll']({'where':{'amount':{[exports[a198_0x3ec7('0x12')]['Op']['gt']]:0x0}},'order':[[a198_0x3ec7('0x30'),a198_0x3ec7('0x31')]]})['then'](_0x4e2f94=>{_0x5ccda8[a198_0x3ec7('0x11')]({'data':_0x4e2f94});});};exports['getPassCountingByDay']=(_0x194e2e,_0x9d2d6e)=>{const _0x3c768d=_0x194e2e['query'][a198_0x3ec7('0x32')];const _0x26bdd7=_0x194e2e[a198_0x3ec7('0x33')][a198_0x3ec7('0x34')];const _0x478cc0=_0x194e2e[a198_0x3ec7('0x33')][a198_0x3ec7('0x35')];exports[a198_0x3ec7('0x12')][a198_0x3ec7('0x13')][a198_0x3ec7('0x2e')][a198_0x3ec7('0x36')]({'attributes':['countingDate',[exports[a198_0x3ec7('0x12')]['fn']('sum',exports[a198_0x3ec7('0x12')]['col'](a198_0x3ec7('0x37'))),a198_0x3ec7('0x38')]],'where':{'countingDate':{[exports[a198_0x3ec7('0x12')]['Op'][a198_0x3ec7('0x39')]]:_0x26bdd7,[exports['sequelize']['Op']['lt']]:_0x478cc0},'amount':_0x194e2e[a198_0x3ec7('0x3a')][a198_0x3ec7('0x3b')]=='in'?{[exports[a198_0x3ec7('0x12')]['Op']['gt']]:0x0}:{[exports['sequelize']['Op']['lt']]:0x0}},'group':[exports['sequelize'][a198_0x3ec7('0x3c')](a198_0x3ec7('0x3d'))],'order':[[a198_0x3ec7('0x30'),'ASC']]})[a198_0x3ec7('0x1e')](_0x39478f=>{_0x9d2d6e[a198_0x3ec7('0x11')]({'data':_0x39478f});});};exports['getPassCountingByHour']=(_0x21d29c,_0x415ec0)=>{const _0x3a22ec=_0x21d29c[a198_0x3ec7('0x33')][a198_0x3ec7('0x32')];const _0x285feb=_0x21d29c['query'][a198_0x3ec7('0x34')];const _0x577fbd=_0x21d29c[a198_0x3ec7('0x33')]['endDate'];exports['sequelize']['models'][a198_0x3ec7('0x2e')][a198_0x3ec7('0x36')]({'attributes':['countingDate',[exports['sequelize']['fn'](a198_0x3ec7('0x3e'),exports[a198_0x3ec7('0x12')][a198_0x3ec7('0x3f')]('countingDate'),a198_0x3ec7('0x40')),a198_0x3ec7('0x41')],[exports[a198_0x3ec7('0x12')]['fn'](a198_0x3ec7('0x42'),exports[a198_0x3ec7('0x12')][a198_0x3ec7('0x3f')](a198_0x3ec7('0x37'))),a198_0x3ec7('0x38')]],'where':{'countingDate':{[exports[a198_0x3ec7('0x12')]['Op'][a198_0x3ec7('0x39')]]:_0x285feb,[exports['sequelize']['Op']['lt']]:_0x577fbd},'amount':_0x21d29c[a198_0x3ec7('0x3a')][a198_0x3ec7('0x3b')]=='in'?{[exports[a198_0x3ec7('0x12')]['Op']['gt']]:0x0}:{[exports[a198_0x3ec7('0x12')]['Op']['lt']]:0x0}},'group':[exports[a198_0x3ec7('0x12')]['fn']('HOUR',exports[a198_0x3ec7('0x12')][a198_0x3ec7('0x3f')]('countingDate')),exports[a198_0x3ec7('0x12')]['fn'](a198_0x3ec7('0x43'),exports[a198_0x3ec7('0x12')][a198_0x3ec7('0x3f')]('countingDate')),exports[a198_0x3ec7('0x12')]['fn'](a198_0x3ec7('0x44'),exports[a198_0x3ec7('0x12')][a198_0x3ec7('0x3f')](a198_0x3ec7('0x30'))),exports[a198_0x3ec7('0x12')]['fn']('YEAR',exports[a198_0x3ec7('0x12')][a198_0x3ec7('0x3f')]('countingDate'))],'order':[['countingDate',a198_0x3ec7('0x31')]]})[a198_0x3ec7('0x1e')](_0x4af3fb=>{_0x415ec0[a198_0x3ec7('0x11')]({'data':_0x4af3fb});});};exports[a198_0x3ec7('0x45')]=(_0x3a3220,_0x7692ad,_0x2b6932)=>{const _0x29fd00=_0x3a3220['user'][a198_0x3ec7('0x46')][a198_0x3ec7('0x47')](_0x29fd00=>_0x29fd00[a198_0x3ec7('0x48')]===a198_0x3ec7('0x49'));fbgraph_1[a198_0x3ec7('0xa')][a198_0x3ec7('0x4a')](_0x29fd00[a198_0x3ec7('0x4b')]);fbgraph_1[a198_0x3ec7('0xa')][a198_0x3ec7('0x21')](_0x3a3220[a198_0x3ec7('0x4c')][a198_0x3ec7('0x49')]+'?fields=id,name,email,first_name,last_name,gender,link,locale,timezone',(_0x2f3d1e,_0x25379f)=>{if(_0x2f3d1e){return _0x2b6932(_0x2f3d1e);}_0x7692ad[a198_0x3ec7('0x4')]('api/facebook',{'title':a198_0x3ec7('0x4d'),'profile':_0x25379f});});};
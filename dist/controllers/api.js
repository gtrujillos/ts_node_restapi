var a88_0x645d=['media/','readFile','utf8','parse','Data','CountingInfo','Out','passes','create','getPassCounting','findAll','countingDate','ASC','then','getPassCountingByDay','query','month','startDate','sum','amount','params','direction','literal','getPassCountingByHour','endDate','DATE_FORMAT','col','%Y-%m-%d\x20%H:00','countingDateShort','total','gte','HOUR','DAY','MONTH','getFacebook','user','find','facebook','accessToken','get','?fields=id,name,email,first_name,last_name,gender,link,locale,timezone','render','api/facebook','__importDefault','__esModule','defineProperty','fbgraph','setSequelize','getApi','API\x20Examples','syncFtp','log','default','ready','connected','list','colombia','Downloading:\x20','name','json','models','reportFiles','spread','push','error','ftp.vivotek.com','downloadFtp','sequelize','findOne','fileName','end','.txt','pipe','status','save','Downloaded:\x20','connect','ipd'];(function(_0x48f4d5,_0x29fd3e){var _0x4141e5=function(_0x173cea){while(--_0x173cea){_0x48f4d5['push'](_0x48f4d5['shift']());}};_0x4141e5(++_0x29fd3e);}(a88_0x645d,0x79));var a88_0x2ea5=function(_0x3a6db0,_0x3e72ea){_0x3a6db0=_0x3a6db0-0x0;var _0x23761a=a88_0x645d[_0x3a6db0];return _0x23761a;};'use strict';var __importDefault=this&&this[a88_0x2ea5('0x0')]||function(_0x1d0e00){return _0x1d0e00&&_0x1d0e00[a88_0x2ea5('0x1')]?_0x1d0e00:{'default':_0x1d0e00};};Object[a88_0x2ea5('0x2')](exports,a88_0x2ea5('0x1'),{'value':!![]});const fbgraph_1=__importDefault(require(a88_0x2ea5('0x3')));const ftp_1=__importDefault(require('ftp'));const fs_1=__importDefault(require('fs'));function setSequelize(_0x20078d){exports['sequelize']=_0x20078d;}exports[a88_0x2ea5('0x4')]=setSequelize;exports[a88_0x2ea5('0x5')]=(_0x17ffe1,_0x17c535)=>{_0x17c535['render']('api/index',{'title':a88_0x2ea5('0x6')});};exports[a88_0x2ea5('0x7')]=(_0x14c83e,_0x15b095)=>{console[a88_0x2ea5('0x8')]('connecting');const _0x754f80=[];const _0x3d9558=new ftp_1[(a88_0x2ea5('0x9'))]();_0x3d9558['on'](a88_0x2ea5('0xa'),function(){console[a88_0x2ea5('0x8')](a88_0x2ea5('0xb'));_0x3d9558[a88_0x2ea5('0xc')](a88_0x2ea5('0xd'),![],function(_0x5ba90a,_0x799fab){if(_0x5ba90a){}else{for(const _0x1be282 of _0x799fab){console[a88_0x2ea5('0x8')](a88_0x2ea5('0xe')+_0x1be282['name']);if(_0x1be282[a88_0x2ea5('0xf')]['endsWith'](a88_0x2ea5('0x10'))){exports['sequelize'][a88_0x2ea5('0x11')][a88_0x2ea5('0x12')]['findOrCreate']({'where':{'fileName':_0x1be282['name']}})[a88_0x2ea5('0x13')]((_0x1c1ab9,_0x82f834)=>{if(_0x82f834){console['log'](_0x1be282['name']);_0x754f80[a88_0x2ea5('0x14')](_0x1c1ab9);}});}}}_0x15b095[a88_0x2ea5('0x10')]({'data':_0x754f80});});});_0x3d9558['on'](a88_0x2ea5('0x15'),function(_0x5e2938){_0x15b095[a88_0x2ea5('0x10')]({'message':_0x5e2938});});_0x3d9558['connect']({'host':a88_0x2ea5('0x16'),'port':0x15,'user':'ipd','password':'ipd'});};exports[a88_0x2ea5('0x17')]=(_0x237df0,_0x4245e0)=>{exports[a88_0x2ea5('0x18')][a88_0x2ea5('0x11')][a88_0x2ea5('0x12')][a88_0x2ea5('0x19')]({'where':{'status':null}})['then'](_0x1c8f64=>{if(_0x1c8f64){const _0x406f74=new ftp_1[(a88_0x2ea5('0x9'))]();_0x406f74['on'](a88_0x2ea5('0xa'),function(){console[a88_0x2ea5('0x8')]('connected:'+_0x1c8f64[a88_0x2ea5('0x1a')]);_0x406f74['get']('colombia/'+_0x1c8f64[a88_0x2ea5('0x1a')],function(_0x4c27ca,_0x1abea1){_0x406f74[a88_0x2ea5('0x1b')]();if(_0x4c27ca){}else{const _0x310d98='media/'+_0x1c8f64[a88_0x2ea5('0x1a')]+a88_0x2ea5('0x1c');_0x1abea1[a88_0x2ea5('0x1d')](fs_1[a88_0x2ea5('0x9')]['createWriteStream'](_0x310d98));_0x1c8f64[a88_0x2ea5('0x1e')]=0x1;_0x1c8f64[a88_0x2ea5('0x1f')]();console[a88_0x2ea5('0x8')](a88_0x2ea5('0x20')+_0x1c8f64[a88_0x2ea5('0x1a')]);}});});_0x406f74['on'](a88_0x2ea5('0x15'),function(_0x43cd9d){_0x4245e0['json']({'message':_0x43cd9d});});_0x406f74[a88_0x2ea5('0x21')]({'host':a88_0x2ea5('0x16'),'port':0x15,'user':a88_0x2ea5('0x22'),'password':a88_0x2ea5('0x22')});_0x4245e0[a88_0x2ea5('0x10')]({'data':_0x1c8f64[a88_0x2ea5('0x1a')]});}else{_0x4245e0['json']({'data':[]});}});};exports['processFtp']=(_0x3c5b63,_0x5d1b75)=>{exports[a88_0x2ea5('0x18')][a88_0x2ea5('0x11')]['reportFiles'][a88_0x2ea5('0x19')]({'where':{'status':0x1}})['then'](_0x313db1=>{if(_0x313db1){const _0x4ccf6b=a88_0x2ea5('0x23')+_0x313db1[a88_0x2ea5('0x1a')]+a88_0x2ea5('0x1c');fs_1[a88_0x2ea5('0x9')][a88_0x2ea5('0x24')](_0x4ccf6b,a88_0x2ea5('0x25'),function(_0x4ca978,_0x497341){if(_0x4ca978){_0x313db1[a88_0x2ea5('0x1e')]=null;}else{try{const _0x495cc8=JSON[a88_0x2ea5('0x26')](_0x497341);for(const _0x520243 of _0x495cc8[a88_0x2ea5('0x27')][0x0][a88_0x2ea5('0x28')]){const _0x110ac9=_0x520243['In'];const _0x4c8428=_0x520243[a88_0x2ea5('0x29')];const _0x129780=Date[a88_0x2ea5('0x26')](_0x520243['EndTime']);if(_0x110ac9>0x0){exports['sequelize'][a88_0x2ea5('0x11')][a88_0x2ea5('0x2a')][a88_0x2ea5('0x2b')]({'reportFileId':_0x313db1['id'],'amount':_0x110ac9,'countingDate':_0x129780});}if(_0x4c8428>0x0){exports['sequelize'][a88_0x2ea5('0x11')][a88_0x2ea5('0x2a')]['create']({'reportFileId':_0x313db1['id'],'amount':_0x4c8428*-0x1,'countingDate':_0x129780});}}_0x313db1[a88_0x2ea5('0x1e')]=0x2;}catch(_0x15261b){_0x313db1['status']=null;}}_0x313db1[a88_0x2ea5('0x1f')]();});_0x5d1b75['json']({'data':_0x313db1[a88_0x2ea5('0x1a')]});}else{_0x5d1b75[a88_0x2ea5('0x10')]({'data':[]});}});};exports[a88_0x2ea5('0x2c')]=(_0x2973b2,_0x3c95ef)=>{exports[a88_0x2ea5('0x18')][a88_0x2ea5('0x11')][a88_0x2ea5('0x2a')][a88_0x2ea5('0x2d')]({'where':{'amount':{[exports[a88_0x2ea5('0x18')]['Op']['gt']]:0x0}},'order':[[a88_0x2ea5('0x2e'),a88_0x2ea5('0x2f')]]})[a88_0x2ea5('0x30')](_0x26b6c0=>{_0x3c95ef[a88_0x2ea5('0x10')]({'data':_0x26b6c0});});};exports[a88_0x2ea5('0x31')]=(_0x2c9f18,_0x578726)=>{const _0x40ab9c=_0x2c9f18[a88_0x2ea5('0x32')][a88_0x2ea5('0x33')];const _0xb84a47=_0x2c9f18[a88_0x2ea5('0x32')][a88_0x2ea5('0x34')];const _0x58a431=_0x2c9f18[a88_0x2ea5('0x32')]['endDate'];exports[a88_0x2ea5('0x18')]['models'][a88_0x2ea5('0x2a')][a88_0x2ea5('0x2d')]({'attributes':[a88_0x2ea5('0x2e'),[exports['sequelize']['fn'](a88_0x2ea5('0x35'),exports[a88_0x2ea5('0x18')]['col'](a88_0x2ea5('0x36'))),'total']],'where':{'countingDate':{[exports[a88_0x2ea5('0x18')]['Op']['gte']]:_0xb84a47,[exports[a88_0x2ea5('0x18')]['Op']['lt']]:_0x58a431},'amount':_0x2c9f18[a88_0x2ea5('0x37')][a88_0x2ea5('0x38')]=='in'?{[exports[a88_0x2ea5('0x18')]['Op']['gt']]:0x0}:{[exports[a88_0x2ea5('0x18')]['Op']['lt']]:0x0}},'group':[exports['sequelize'][a88_0x2ea5('0x39')]('YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))')],'order':[['countingDate',a88_0x2ea5('0x2f')]]})['then'](_0x584f0d=>{_0x578726[a88_0x2ea5('0x10')]({'data':_0x584f0d});});};exports[a88_0x2ea5('0x3a')]=(_0x4b5f44,_0x4093e4)=>{const _0x53a5fb=_0x4b5f44['query'][a88_0x2ea5('0x33')];const _0x5d7fe9=_0x4b5f44['query'][a88_0x2ea5('0x34')];const _0x179653=_0x4b5f44[a88_0x2ea5('0x32')][a88_0x2ea5('0x3b')];exports['sequelize'][a88_0x2ea5('0x11')][a88_0x2ea5('0x2a')]['findAll']({'attributes':[a88_0x2ea5('0x2e'),[exports[a88_0x2ea5('0x18')]['fn'](a88_0x2ea5('0x3c'),exports[a88_0x2ea5('0x18')][a88_0x2ea5('0x3d')]('countingDate'),a88_0x2ea5('0x3e')),a88_0x2ea5('0x3f')],[exports['sequelize']['fn'](a88_0x2ea5('0x35'),exports[a88_0x2ea5('0x18')]['col'](a88_0x2ea5('0x36'))),a88_0x2ea5('0x40')]],'where':{'countingDate':{[exports[a88_0x2ea5('0x18')]['Op'][a88_0x2ea5('0x41')]]:_0x5d7fe9,[exports[a88_0x2ea5('0x18')]['Op']['lt']]:_0x179653},'amount':_0x4b5f44[a88_0x2ea5('0x37')][a88_0x2ea5('0x38')]=='in'?{[exports[a88_0x2ea5('0x18')]['Op']['gt']]:0x0}:{[exports[a88_0x2ea5('0x18')]['Op']['lt']]:0x0}},'group':[exports[a88_0x2ea5('0x18')]['fn'](a88_0x2ea5('0x42'),exports[a88_0x2ea5('0x18')][a88_0x2ea5('0x3d')](a88_0x2ea5('0x2e'))),exports[a88_0x2ea5('0x18')]['fn'](a88_0x2ea5('0x43'),exports['sequelize']['col']('countingDate')),exports[a88_0x2ea5('0x18')]['fn'](a88_0x2ea5('0x44'),exports[a88_0x2ea5('0x18')][a88_0x2ea5('0x3d')](a88_0x2ea5('0x2e'))),exports[a88_0x2ea5('0x18')]['fn']('YEAR',exports[a88_0x2ea5('0x18')]['col'](a88_0x2ea5('0x2e')))],'order':[[a88_0x2ea5('0x2e'),'ASC']]})['then'](_0x5089d1=>{_0x4093e4[a88_0x2ea5('0x10')]({'data':_0x5089d1});});};exports[a88_0x2ea5('0x45')]=(_0x4eca43,_0x3e1daf,_0x225194)=>{const _0x3ab53a=_0x4eca43[a88_0x2ea5('0x46')]['tokens'][a88_0x2ea5('0x47')](_0x3ab53a=>_0x3ab53a['kind']===a88_0x2ea5('0x48'));fbgraph_1[a88_0x2ea5('0x9')]['setAccessToken'](_0x3ab53a[a88_0x2ea5('0x49')]);fbgraph_1[a88_0x2ea5('0x9')][a88_0x2ea5('0x4a')](_0x4eca43[a88_0x2ea5('0x46')][a88_0x2ea5('0x48')]+a88_0x2ea5('0x4b'),(_0x33a554,_0x5049e0)=>{if(_0x33a554){return _0x225194(_0x33a554);}_0x3e1daf[a88_0x2ea5('0x4c')](a88_0x2ea5('0x4d'),{'title':'Facebook\x20API','profile':_0x5049e0});});};
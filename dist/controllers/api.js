var a92_0x7cb4=['syncFtp','log','connecting','default','ready','connected','list','colombia','Downloading:\x20','name','json','models','reportFiles','findOrCreate','spread','push','error','connect','ftp.vivotek.com','ipd','downloadFtp','sequelize','then','connected:','fileName','get','colombia/','end','media/','pipe','status','Downloaded:\x20','findOne','.txt','readFile','Data','CountingInfo','Out','EndTime','passes','create','save','getPassCounting','findAll','countingDate','ASC','getPassCountingByDay','query','endDate','amount','total','gte','direction','month','startDate','DATE_FORMAT','col','%Y-%m-%d\x20%H:00','countingDateShort','params','HOUR','DAY','MONTH','getFacebook','user','tokens','find','facebook','setAccessToken','?fields=id,name,email,first_name,last_name,gender,link,locale,timezone','api/facebook','Facebook\x20API','__importDefault','__esModule','defineProperty','ftp','setSequelize','getApi','render','api/index','API\x20Examples'];(function(_0x183835,_0x1251ec){var _0x2c910a=function(_0x4de6fe){while(--_0x4de6fe){_0x183835['push'](_0x183835['shift']());}};_0x2c910a(++_0x1251ec);}(a92_0x7cb4,0x99));var a92_0xdd81=function(_0x4e89b3,_0x54f715){_0x4e89b3=_0x4e89b3-0x0;var _0x39f34f=a92_0x7cb4[_0x4e89b3];return _0x39f34f;};'use strict';var __importDefault=this&&this[a92_0xdd81('0x0')]||function(_0x16d532){return _0x16d532&&_0x16d532[a92_0xdd81('0x1')]?_0x16d532:{'default':_0x16d532};};Object[a92_0xdd81('0x2')](exports,a92_0xdd81('0x1'),{'value':!![]});const fbgraph_1=__importDefault(require('fbgraph'));const ftp_1=__importDefault(require(a92_0xdd81('0x3')));const fs_1=__importDefault(require('fs'));function setSequelize(_0x1e6d31){exports['sequelize']=_0x1e6d31;}exports[a92_0xdd81('0x4')]=setSequelize;exports[a92_0xdd81('0x5')]=(_0x32283f,_0x37d013)=>{_0x37d013[a92_0xdd81('0x6')](a92_0xdd81('0x7'),{'title':a92_0xdd81('0x8')});};exports[a92_0xdd81('0x9')]=(_0x22b308,_0x317e23)=>{console[a92_0xdd81('0xa')](a92_0xdd81('0xb'));const _0x2ab193=[];const _0x4852c1=new ftp_1[(a92_0xdd81('0xc'))]();_0x4852c1['on'](a92_0xdd81('0xd'),function(){console['log'](a92_0xdd81('0xe'));_0x4852c1[a92_0xdd81('0xf')](a92_0xdd81('0x10'),![],function(_0x434b93,_0x510e5d){if(_0x434b93){}else{for(const _0x2c7d49 of _0x510e5d){console[a92_0xdd81('0xa')](a92_0xdd81('0x11')+_0x2c7d49['name']);if(_0x2c7d49[a92_0xdd81('0x12')]['endsWith'](a92_0xdd81('0x13'))){exports['sequelize'][a92_0xdd81('0x14')][a92_0xdd81('0x15')][a92_0xdd81('0x16')]({'where':{'fileName':_0x2c7d49[a92_0xdd81('0x12')]}})[a92_0xdd81('0x17')]((_0x2758c7,_0x466c7e)=>{if(_0x466c7e){console[a92_0xdd81('0xa')](_0x2c7d49[a92_0xdd81('0x12')]);_0x2ab193[a92_0xdd81('0x18')](_0x2758c7);}});}}}_0x317e23[a92_0xdd81('0x13')]({'data':_0x2ab193});});});_0x4852c1['on'](a92_0xdd81('0x19'),function(_0x943b74){_0x317e23['json']({'message':_0x943b74});});_0x4852c1[a92_0xdd81('0x1a')]({'host':a92_0xdd81('0x1b'),'port':0x15,'user':a92_0xdd81('0x1c'),'password':a92_0xdd81('0x1c')});};exports[a92_0xdd81('0x1d')]=(_0x2afd7c,_0x56b44d)=>{exports[a92_0xdd81('0x1e')][a92_0xdd81('0x14')][a92_0xdd81('0x15')]['findOne']({'where':{'status':null}})[a92_0xdd81('0x1f')](_0x4e3f17=>{if(_0x4e3f17){const _0x4744c2=new ftp_1['default']();_0x4744c2['on'](a92_0xdd81('0xd'),function(){console[a92_0xdd81('0xa')](a92_0xdd81('0x20')+_0x4e3f17[a92_0xdd81('0x21')]);_0x4744c2[a92_0xdd81('0x22')](a92_0xdd81('0x23')+_0x4e3f17['fileName'],function(_0x17ddaf,_0x1710ed){_0x4744c2[a92_0xdd81('0x24')]();if(_0x17ddaf){}else{const _0x7f6c8f=a92_0xdd81('0x25')+_0x4e3f17[a92_0xdd81('0x21')]+'.txt';_0x1710ed[a92_0xdd81('0x26')](fs_1[a92_0xdd81('0xc')]['createWriteStream'](_0x7f6c8f));_0x4e3f17[a92_0xdd81('0x27')]=0x1;_0x4e3f17['save']();console['log'](a92_0xdd81('0x28')+_0x4e3f17[a92_0xdd81('0x21')]);}});});_0x4744c2['on'](a92_0xdd81('0x19'),function(_0x357630){_0x56b44d[a92_0xdd81('0x13')]({'message':_0x357630});});_0x4744c2[a92_0xdd81('0x1a')]({'host':a92_0xdd81('0x1b'),'port':0x15,'user':a92_0xdd81('0x1c'),'password':a92_0xdd81('0x1c')});_0x56b44d[a92_0xdd81('0x13')]({'data':_0x4e3f17[a92_0xdd81('0x21')]});}else{_0x56b44d[a92_0xdd81('0x13')]({'data':[]});}});};exports['processFtp']=(_0x28a416,_0x946f23)=>{exports[a92_0xdd81('0x1e')][a92_0xdd81('0x14')]['reportFiles'][a92_0xdd81('0x29')]({'where':{'status':0x1}})[a92_0xdd81('0x1f')](_0x40b0a1=>{if(_0x40b0a1){const _0x1a0d26=a92_0xdd81('0x25')+_0x40b0a1[a92_0xdd81('0x21')]+a92_0xdd81('0x2a');fs_1[a92_0xdd81('0xc')][a92_0xdd81('0x2b')](_0x1a0d26,'utf8',function(_0x382877,_0x58f150){if(_0x382877){_0x40b0a1['status']=null;}else{try{const _0x16edfd=JSON['parse'](_0x58f150);for(const _0x26e3d0 of _0x16edfd[a92_0xdd81('0x2c')][0x0][a92_0xdd81('0x2d')]){const _0x15d60a=_0x26e3d0['In'];const _0xb1d8ff=_0x26e3d0[a92_0xdd81('0x2e')];const _0x452d3b=Date['parse'](_0x26e3d0[a92_0xdd81('0x2f')]);if(_0x15d60a>0x0){exports[a92_0xdd81('0x1e')][a92_0xdd81('0x14')][a92_0xdd81('0x30')][a92_0xdd81('0x31')]({'reportFileId':_0x40b0a1['id'],'amount':_0x15d60a,'countingDate':_0x452d3b});}if(_0xb1d8ff>0x0){exports['sequelize'][a92_0xdd81('0x14')][a92_0xdd81('0x30')][a92_0xdd81('0x31')]({'reportFileId':_0x40b0a1['id'],'amount':_0xb1d8ff*-0x1,'countingDate':_0x452d3b});}}_0x40b0a1[a92_0xdd81('0x27')]=0x2;}catch(_0x4afa37){_0x40b0a1[a92_0xdd81('0x27')]=null;}}_0x40b0a1[a92_0xdd81('0x32')]();});_0x946f23[a92_0xdd81('0x13')]({'data':_0x40b0a1[a92_0xdd81('0x21')]});}else{_0x946f23['json']({'data':[]});}});};exports[a92_0xdd81('0x33')]=(_0x7064cf,_0xa14cbc)=>{exports[a92_0xdd81('0x1e')][a92_0xdd81('0x14')][a92_0xdd81('0x30')][a92_0xdd81('0x34')]({'where':{'amount':{[exports['sequelize']['Op']['gt']]:0x0}},'order':[[a92_0xdd81('0x35'),a92_0xdd81('0x36')]]})[a92_0xdd81('0x1f')](_0x34fc1d=>{_0xa14cbc[a92_0xdd81('0x13')]({'data':_0x34fc1d});});};exports[a92_0xdd81('0x37')]=(_0x5573e6,_0x226469)=>{const _0x300747=_0x5573e6[a92_0xdd81('0x38')]['month'];const _0x4f0606=_0x5573e6[a92_0xdd81('0x38')]['startDate'];const _0x3741a4=_0x5573e6[a92_0xdd81('0x38')][a92_0xdd81('0x39')];exports['sequelize']['models'][a92_0xdd81('0x30')][a92_0xdd81('0x34')]({'attributes':[a92_0xdd81('0x35'),[exports['sequelize']['fn']('sum',exports[a92_0xdd81('0x1e')]['col'](a92_0xdd81('0x3a'))),a92_0xdd81('0x3b')]],'where':{'countingDate':{[exports[a92_0xdd81('0x1e')]['Op'][a92_0xdd81('0x3c')]]:_0x4f0606,[exports['sequelize']['Op']['lt']]:_0x3741a4},'amount':_0x5573e6['params'][a92_0xdd81('0x3d')]=='in'?{[exports['sequelize']['Op']['gt']]:0x0}:{[exports['sequelize']['Op']['lt']]:0x0}},'group':[exports[a92_0xdd81('0x1e')]['literal']('YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))')],'order':[[a92_0xdd81('0x35'),a92_0xdd81('0x36')]]})[a92_0xdd81('0x1f')](_0x327802=>{_0x226469[a92_0xdd81('0x13')]({'data':_0x327802});});};exports['getPassCountingByHour']=(_0x14cefd,_0x54c505)=>{const _0x495722=_0x14cefd[a92_0xdd81('0x38')][a92_0xdd81('0x3e')];const _0x5b9111=_0x14cefd['query'][a92_0xdd81('0x3f')];const _0x26bbca=_0x14cefd[a92_0xdd81('0x38')][a92_0xdd81('0x39')];exports['sequelize'][a92_0xdd81('0x14')]['passes']['findAll']({'attributes':[a92_0xdd81('0x35'),[exports[a92_0xdd81('0x1e')]['fn'](a92_0xdd81('0x40'),exports['sequelize'][a92_0xdd81('0x41')]('countingDate'),a92_0xdd81('0x42')),a92_0xdd81('0x43')],[exports[a92_0xdd81('0x1e')]['fn']('sum',exports[a92_0xdd81('0x1e')][a92_0xdd81('0x41')]('amount')),a92_0xdd81('0x3b')]],'where':{'countingDate':{[exports[a92_0xdd81('0x1e')]['Op']['gte']]:_0x5b9111,[exports[a92_0xdd81('0x1e')]['Op']['lt']]:_0x26bbca},'amount':_0x14cefd[a92_0xdd81('0x44')][a92_0xdd81('0x3d')]=='in'?{[exports[a92_0xdd81('0x1e')]['Op']['gt']]:0x0}:{[exports[a92_0xdd81('0x1e')]['Op']['lt']]:0x0}},'group':[exports[a92_0xdd81('0x1e')]['fn'](a92_0xdd81('0x45'),exports[a92_0xdd81('0x1e')][a92_0xdd81('0x41')](a92_0xdd81('0x35'))),exports[a92_0xdd81('0x1e')]['fn'](a92_0xdd81('0x46'),exports[a92_0xdd81('0x1e')][a92_0xdd81('0x41')](a92_0xdd81('0x35'))),exports['sequelize']['fn'](a92_0xdd81('0x47'),exports[a92_0xdd81('0x1e')][a92_0xdd81('0x41')](a92_0xdd81('0x35'))),exports[a92_0xdd81('0x1e')]['fn']('YEAR',exports['sequelize'][a92_0xdd81('0x41')](a92_0xdd81('0x35')))],'order':[[a92_0xdd81('0x35'),a92_0xdd81('0x36')]]})[a92_0xdd81('0x1f')](_0x602f10=>{_0x54c505['json']({'data':_0x602f10});});};exports[a92_0xdd81('0x48')]=(_0x430c1e,_0x14f320,_0x2c32d6)=>{const _0x5ce483=_0x430c1e[a92_0xdd81('0x49')][a92_0xdd81('0x4a')][a92_0xdd81('0x4b')](_0x5ce483=>_0x5ce483['kind']===a92_0xdd81('0x4c'));fbgraph_1[a92_0xdd81('0xc')][a92_0xdd81('0x4d')](_0x5ce483['accessToken']);fbgraph_1['default'][a92_0xdd81('0x22')](_0x430c1e[a92_0xdd81('0x49')][a92_0xdd81('0x4c')]+a92_0xdd81('0x4e'),(_0x1a2979,_0x2bd08a)=>{if(_0x1a2979){return _0x2c32d6(_0x1a2979);}_0x14f320['render'](a92_0xdd81('0x4f'),{'title':a92_0xdd81('0x50'),'profile':_0x2bd08a});});};
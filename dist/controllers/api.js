var a92_0x32d6=['media/','.txt','pipe','createWriteStream','status','save','processFtp','parse','Out','passes','create','getPassCounting','findAll','ASC','getPassCountingByDay','query','month','startDate','countingDate','sum','col','amount','gte','params','literal','YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))','endDate','%Y-%m-%d\x20%H:00','countingDateShort','total','direction','HOUR','DAY','MONTH','YEAR','tokens','kind','facebook','setAccessToken','user','api/facebook','Facebook\x20API','__importDefault','__esModule','ftp','setSequelize','getApi','render','API\x20Examples','syncFtp','log','default','ready','connected','list','colombia','name','json','sequelize','models','reportFiles','findOrCreate','spread','error','connect','ftp.vivotek.com','ipd','downloadFtp','findOne','then','connected:','fileName','get','colombia/','end'];(function(_0x5646fe,_0x81c913){var _0x1f411c=function(_0x3778b6){while(--_0x3778b6){_0x5646fe['push'](_0x5646fe['shift']());}};_0x1f411c(++_0x81c913);}(a92_0x32d6,0x1a1));var a92_0xe587=function(_0xc10096,_0x5ad02f){_0xc10096=_0xc10096-0x0;var _0x39dc33=a92_0x32d6[_0xc10096];return _0x39dc33;};'use strict';var __importDefault=this&&this[a92_0xe587('0x0')]||function(_0x84c1fd){return _0x84c1fd&&_0x84c1fd['__esModule']?_0x84c1fd:{'default':_0x84c1fd};};Object['defineProperty'](exports,a92_0xe587('0x1'),{'value':!![]});const fbgraph_1=__importDefault(require('fbgraph'));const ftp_1=__importDefault(require(a92_0xe587('0x2')));const fs_1=__importDefault(require('fs'));function setSequelize(_0x2d5d02){exports['sequelize']=_0x2d5d02;}exports[a92_0xe587('0x3')]=setSequelize;exports[a92_0xe587('0x4')]=(_0x22147d,_0x187a59)=>{_0x187a59[a92_0xe587('0x5')]('api/index',{'title':a92_0xe587('0x6')});};exports[a92_0xe587('0x7')]=(_0x1b51f9,_0x34be48)=>{console[a92_0xe587('0x8')]('connecting');const _0x253ea7=[];const _0x5bb872=new ftp_1[(a92_0xe587('0x9'))]();_0x5bb872['on'](a92_0xe587('0xa'),function(){console[a92_0xe587('0x8')](a92_0xe587('0xb'));_0x5bb872[a92_0xe587('0xc')](a92_0xe587('0xd'),![],function(_0x4ef284,_0x10c04f){if(_0x4ef284){}else{for(const _0x55a018 of _0x10c04f){console['log']('Downloading:\x20'+_0x55a018[a92_0xe587('0xe')]);if(_0x55a018[a92_0xe587('0xe')]['endsWith'](a92_0xe587('0xf'))){exports[a92_0xe587('0x10')][a92_0xe587('0x11')][a92_0xe587('0x12')][a92_0xe587('0x13')]({'where':{'fileName':_0x55a018[a92_0xe587('0xe')]}})[a92_0xe587('0x14')]((_0xa5374c,_0x12b1d4)=>{if(_0x12b1d4){console[a92_0xe587('0x8')](_0x55a018['name']);_0x253ea7['push'](_0xa5374c);}});}}}_0x34be48[a92_0xe587('0xf')]({'data':_0x253ea7});});});_0x5bb872['on'](a92_0xe587('0x15'),function(_0x48495c){_0x34be48['json']({'message':_0x48495c});});_0x5bb872[a92_0xe587('0x16')]({'host':a92_0xe587('0x17'),'port':0x15,'user':a92_0xe587('0x18'),'password':a92_0xe587('0x18')});};exports[a92_0xe587('0x19')]=(_0x372773,_0x2e9beb)=>{exports[a92_0xe587('0x10')]['models'][a92_0xe587('0x12')][a92_0xe587('0x1a')]({'where':{'status':null}})[a92_0xe587('0x1b')](_0x2a96d2=>{if(_0x2a96d2){const _0x925d50=new ftp_1[(a92_0xe587('0x9'))]();_0x925d50['on'](a92_0xe587('0xa'),function(){console[a92_0xe587('0x8')](a92_0xe587('0x1c')+_0x2a96d2[a92_0xe587('0x1d')]);_0x925d50[a92_0xe587('0x1e')](a92_0xe587('0x1f')+_0x2a96d2['fileName'],function(_0x385b16,_0x355e40){_0x925d50[a92_0xe587('0x20')]();if(_0x385b16){}else{const _0x3e9a78=a92_0xe587('0x21')+_0x2a96d2['fileName']+a92_0xe587('0x22');_0x355e40[a92_0xe587('0x23')](fs_1[a92_0xe587('0x9')][a92_0xe587('0x24')](_0x3e9a78));_0x2a96d2[a92_0xe587('0x25')]=0x1;_0x2a96d2[a92_0xe587('0x26')]();console[a92_0xe587('0x8')]('Downloaded:\x20'+_0x2a96d2[a92_0xe587('0x1d')]);}});});_0x925d50['on']('error',function(_0x5ac699){_0x2e9beb[a92_0xe587('0xf')]({'message':_0x5ac699});});_0x925d50[a92_0xe587('0x16')]({'host':'ftp.vivotek.com','port':0x15,'user':a92_0xe587('0x18'),'password':'ipd'});_0x2e9beb[a92_0xe587('0xf')]({'data':_0x2a96d2[a92_0xe587('0x1d')]});}else{_0x2e9beb[a92_0xe587('0xf')]({'data':[]});}});};exports[a92_0xe587('0x27')]=(_0x4af8d1,_0x4830ee)=>{exports[a92_0xe587('0x10')][a92_0xe587('0x11')][a92_0xe587('0x12')][a92_0xe587('0x1a')]({'where':{'status':0x1}})['then'](_0x362f62=>{if(_0x362f62){const _0x3be2fb=a92_0xe587('0x21')+_0x362f62[a92_0xe587('0x1d')]+a92_0xe587('0x22');fs_1[a92_0xe587('0x9')]['readFile'](_0x3be2fb,'utf8',function(_0x38806d,_0x14c4d1){if(_0x38806d){_0x362f62[a92_0xe587('0x25')]=null;}else{try{const _0x56bf8c=JSON[a92_0xe587('0x28')](_0x14c4d1);for(const _0x38b5d1 of _0x56bf8c['Data'][0x0]['CountingInfo']){const _0x57d568=_0x38b5d1['In'];const _0x556915=_0x38b5d1[a92_0xe587('0x29')];const _0xf38100=Date['parse'](_0x38b5d1['EndTime']);if(_0x57d568>0x0){exports[a92_0xe587('0x10')][a92_0xe587('0x11')][a92_0xe587('0x2a')][a92_0xe587('0x2b')]({'reportFileId':_0x362f62['id'],'amount':_0x57d568,'countingDate':_0xf38100});}if(_0x556915>0x0){exports[a92_0xe587('0x10')][a92_0xe587('0x11')]['passes']['create']({'reportFileId':_0x362f62['id'],'amount':_0x556915*-0x1,'countingDate':_0xf38100});}}_0x362f62[a92_0xe587('0x25')]=0x2;}catch(_0x496470){_0x362f62[a92_0xe587('0x25')]=null;}}_0x362f62[a92_0xe587('0x26')]();});_0x4830ee[a92_0xe587('0xf')]({'data':_0x362f62[a92_0xe587('0x1d')]});}else{_0x4830ee[a92_0xe587('0xf')]({'data':[]});}});};exports[a92_0xe587('0x2c')]=(_0xafc9fc,_0x2e90df)=>{exports[a92_0xe587('0x10')]['models'][a92_0xe587('0x2a')][a92_0xe587('0x2d')]({'where':{'amount':{[exports[a92_0xe587('0x10')]['Op']['gt']]:0x0}},'order':[['countingDate',a92_0xe587('0x2e')]]})[a92_0xe587('0x1b')](_0x574d8e=>{_0x2e90df[a92_0xe587('0xf')]({'data':_0x574d8e});});};exports[a92_0xe587('0x2f')]=(_0x1ff2c4,_0x3328c8)=>{const _0x78b65f=_0x1ff2c4[a92_0xe587('0x30')][a92_0xe587('0x31')];const _0x12d518=_0x1ff2c4['query'][a92_0xe587('0x32')];const _0x310c9b=_0x1ff2c4['query']['endDate'];exports[a92_0xe587('0x10')][a92_0xe587('0x11')][a92_0xe587('0x2a')][a92_0xe587('0x2d')]({'attributes':[a92_0xe587('0x33'),[exports[a92_0xe587('0x10')]['fn'](a92_0xe587('0x34'),exports[a92_0xe587('0x10')][a92_0xe587('0x35')](a92_0xe587('0x36'))),'total']],'where':{'countingDate':{[exports['sequelize']['Op'][a92_0xe587('0x37')]]:_0x12d518,[exports[a92_0xe587('0x10')]['Op']['lt']]:_0x310c9b},'amount':_0x1ff2c4[a92_0xe587('0x38')]['direction']=='in'?{[exports[a92_0xe587('0x10')]['Op']['gt']]:0x0}:{[exports['sequelize']['Op']['lt']]:0x0}},'group':[exports[a92_0xe587('0x10')][a92_0xe587('0x39')](a92_0xe587('0x3a'))],'order':[[a92_0xe587('0x33'),a92_0xe587('0x2e')]]})['then'](_0x59794d=>{_0x3328c8[a92_0xe587('0xf')]({'data':_0x59794d});});};exports['getPassCountingByHour']=(_0x2e2998,_0x56e185)=>{const _0x5b0e7c=_0x2e2998['query'][a92_0xe587('0x31')];const _0x1829d5=_0x2e2998['query']['startDate'];const _0x4de11e=_0x2e2998[a92_0xe587('0x30')][a92_0xe587('0x3b')];exports[a92_0xe587('0x10')]['models'][a92_0xe587('0x2a')][a92_0xe587('0x2d')]({'attributes':['countingDate',[exports[a92_0xe587('0x10')]['fn']('DATE_FORMAT',exports[a92_0xe587('0x10')][a92_0xe587('0x35')](a92_0xe587('0x33')),a92_0xe587('0x3c')),a92_0xe587('0x3d')],[exports[a92_0xe587('0x10')]['fn'](a92_0xe587('0x34'),exports[a92_0xe587('0x10')][a92_0xe587('0x35')]('amount')),a92_0xe587('0x3e')]],'where':{'countingDate':{[exports[a92_0xe587('0x10')]['Op'][a92_0xe587('0x37')]]:_0x1829d5,[exports[a92_0xe587('0x10')]['Op']['lt']]:_0x4de11e},'amount':_0x2e2998[a92_0xe587('0x38')][a92_0xe587('0x3f')]=='in'?{[exports['sequelize']['Op']['gt']]:0x0}:{[exports['sequelize']['Op']['lt']]:0x0}},'group':[exports['sequelize']['fn'](a92_0xe587('0x40'),exports['sequelize']['col'](a92_0xe587('0x33'))),exports['sequelize']['fn'](a92_0xe587('0x41'),exports['sequelize'][a92_0xe587('0x35')](a92_0xe587('0x33'))),exports[a92_0xe587('0x10')]['fn'](a92_0xe587('0x42'),exports[a92_0xe587('0x10')][a92_0xe587('0x35')](a92_0xe587('0x33'))),exports['sequelize']['fn'](a92_0xe587('0x43'),exports[a92_0xe587('0x10')][a92_0xe587('0x35')]('countingDate'))],'order':[[a92_0xe587('0x33'),a92_0xe587('0x2e')]]})[a92_0xe587('0x1b')](_0x324d54=>{_0x56e185[a92_0xe587('0xf')]({'data':_0x324d54});});};exports['getFacebook']=(_0x499ec8,_0x39895b,_0x5c37b4)=>{const _0x22ef15=_0x499ec8['user'][a92_0xe587('0x44')]['find'](_0x22ef15=>_0x22ef15[a92_0xe587('0x45')]===a92_0xe587('0x46'));fbgraph_1[a92_0xe587('0x9')][a92_0xe587('0x47')](_0x22ef15['accessToken']);fbgraph_1[a92_0xe587('0x9')][a92_0xe587('0x1e')](_0x499ec8[a92_0xe587('0x48')]['facebook']+'?fields=id,name,email,first_name,last_name,gender,link,locale,timezone',(_0x1165df,_0x2922d7)=>{if(_0x1165df){return _0x5c37b4(_0x1165df);}_0x39895b[a92_0xe587('0x5')](a92_0xe587('0x49'),{'title':a92_0xe587('0x4a'),'profile':_0x2922d7});});};
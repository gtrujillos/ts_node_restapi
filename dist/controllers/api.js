var a198_0x58af=['findOne','then','connected:','fileName','get','colombia/','end','media/','.txt','pipe','status','Downloaded:\x20','processFtp','utf8','Data','CountingInfo','Out','parse','EndTime','create','passes','save','getPassCounting','countingDate','getPassCountingByDay','query','startDate','endDate','findAll','sum','col','amount','gte','params','direction','YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))','ASC','getPassCountingByHour','month','DATE_FORMAT','%Y-%m-%d\x20%H:00','countingDateShort','total','HOUR','DAY','MONTH','YEAR','getFacebook','user','find','kind','facebook','setAccessToken','accessToken','api/facebook','Facebook\x20API','__importDefault','defineProperty','__esModule','ftp','sequelize','setSequelize','getApi','render','api/index','API\x20Examples','log','connecting','default','ready','list','name','endsWith','models','reportFiles','findOrCreate','spread','json','error','connect','ftp.vivotek.com','ipd','downloadFtp'];(function(_0xddf6e,_0x358c52){var _0x5f1f86=function(_0x3cafd2){while(--_0x3cafd2){_0xddf6e['push'](_0xddf6e['shift']());}};_0x5f1f86(++_0x358c52);}(a198_0x58af,0xde));var a198_0x48ad=function(_0x5aa41b,_0x1d631c){_0x5aa41b=_0x5aa41b-0x0;var _0x55a2f8=a198_0x58af[_0x5aa41b];return _0x55a2f8;};'use strict';var __importDefault=this&&this[a198_0x48ad('0x0')]||function(_0x52d3f2){return _0x52d3f2&&_0x52d3f2['__esModule']?_0x52d3f2:{'default':_0x52d3f2};};Object[a198_0x48ad('0x1')](exports,a198_0x48ad('0x2'),{'value':!![]});const fbgraph_1=__importDefault(require('fbgraph'));const ftp_1=__importDefault(require(a198_0x48ad('0x3')));const fs_1=__importDefault(require('fs'));function setSequelize(_0x3c040b){exports[a198_0x48ad('0x4')]=_0x3c040b;}exports[a198_0x48ad('0x5')]=setSequelize;exports[a198_0x48ad('0x6')]=(_0x57d49b,_0xd3f2a4)=>{_0xd3f2a4[a198_0x48ad('0x7')](a198_0x48ad('0x8'),{'title':a198_0x48ad('0x9')});};exports['syncFtp']=(_0x5d5b86,_0x3c1885)=>{console[a198_0x48ad('0xa')](a198_0x48ad('0xb'));const _0x235ca6=[];const _0x4a2886=new ftp_1[(a198_0x48ad('0xc'))]();_0x4a2886['on'](a198_0x48ad('0xd'),function(){console[a198_0x48ad('0xa')]('connected');_0x4a2886[a198_0x48ad('0xe')]('colombia',![],function(_0xd46c3f,_0x13fed0){if(_0xd46c3f){}else{for(const _0x31049e of _0x13fed0){console[a198_0x48ad('0xa')]('Downloading:\x20'+_0x31049e[a198_0x48ad('0xf')]);if(_0x31049e[a198_0x48ad('0xf')][a198_0x48ad('0x10')]('json')){exports['sequelize'][a198_0x48ad('0x11')][a198_0x48ad('0x12')][a198_0x48ad('0x13')]({'where':{'fileName':_0x31049e[a198_0x48ad('0xf')]}})[a198_0x48ad('0x14')]((_0x47f799,_0x13fcd2)=>{if(_0x13fcd2){console['log'](_0x31049e[a198_0x48ad('0xf')]);_0x235ca6['push'](_0x47f799);}});}}}_0x3c1885[a198_0x48ad('0x15')]({'data':_0x235ca6});});});_0x4a2886['on'](a198_0x48ad('0x16'),function(_0x12ac9b){_0x3c1885['json']({'message':_0x12ac9b});});_0x4a2886[a198_0x48ad('0x17')]({'host':a198_0x48ad('0x18'),'port':0x15,'user':a198_0x48ad('0x19'),'password':'ipd'});};exports[a198_0x48ad('0x1a')]=(_0x596897,_0x130bff)=>{exports[a198_0x48ad('0x4')][a198_0x48ad('0x11')]['reportFiles'][a198_0x48ad('0x1b')]({'where':{'status':null}})[a198_0x48ad('0x1c')](_0x297fc2=>{if(_0x297fc2){const _0x1fd66b=new ftp_1['default']();_0x1fd66b['on']('ready',function(){console[a198_0x48ad('0xa')](a198_0x48ad('0x1d')+_0x297fc2[a198_0x48ad('0x1e')]);_0x1fd66b[a198_0x48ad('0x1f')](a198_0x48ad('0x20')+_0x297fc2[a198_0x48ad('0x1e')],function(_0x28a334,_0xdbe2a1){_0x1fd66b[a198_0x48ad('0x21')]();if(_0x28a334){}else{const _0x301a2a=a198_0x48ad('0x22')+_0x297fc2[a198_0x48ad('0x1e')]+a198_0x48ad('0x23');_0xdbe2a1[a198_0x48ad('0x24')](fs_1['default']['createWriteStream'](_0x301a2a));_0x297fc2[a198_0x48ad('0x25')]=0x1;_0x297fc2['save']();console['log'](a198_0x48ad('0x26')+_0x297fc2['fileName']);}});});_0x1fd66b['on'](a198_0x48ad('0x16'),function(_0x80bf){_0x130bff[a198_0x48ad('0x15')]({'message':_0x80bf});});_0x1fd66b['connect']({'host':'ftp.vivotek.com','port':0x15,'user':'ipd','password':a198_0x48ad('0x19')});_0x130bff[a198_0x48ad('0x15')]({'data':_0x297fc2[a198_0x48ad('0x1e')]});}else{_0x130bff[a198_0x48ad('0x15')]({'data':[]});}});};exports[a198_0x48ad('0x27')]=(_0x1b8cf6,_0x2e6ec9)=>{exports[a198_0x48ad('0x4')][a198_0x48ad('0x11')][a198_0x48ad('0x12')][a198_0x48ad('0x1b')]({'where':{'status':0x1}})[a198_0x48ad('0x1c')](_0x491bd4=>{if(_0x491bd4){const _0x499163=a198_0x48ad('0x22')+_0x491bd4[a198_0x48ad('0x1e')]+a198_0x48ad('0x23');fs_1[a198_0x48ad('0xc')]['readFile'](_0x499163,a198_0x48ad('0x28'),function(_0x2fb1f7,_0x979b48){if(_0x2fb1f7){_0x491bd4[a198_0x48ad('0x25')]=null;}else{try{const _0x187cce=JSON['parse'](_0x979b48);for(const _0x35ee5d of _0x187cce[a198_0x48ad('0x29')][0x0][a198_0x48ad('0x2a')]){const _0x93237d=_0x35ee5d['In'];const _0x2cd42f=_0x35ee5d[a198_0x48ad('0x2b')];const _0x3ce947=Date[a198_0x48ad('0x2c')](_0x35ee5d[a198_0x48ad('0x2d')]);if(_0x93237d>0x0){exports[a198_0x48ad('0x4')][a198_0x48ad('0x11')]['passes'][a198_0x48ad('0x2e')]({'reportFileId':_0x491bd4['id'],'amount':_0x93237d,'countingDate':_0x3ce947});}if(_0x2cd42f>0x0){exports[a198_0x48ad('0x4')][a198_0x48ad('0x11')][a198_0x48ad('0x2f')][a198_0x48ad('0x2e')]({'reportFileId':_0x491bd4['id'],'amount':_0x2cd42f*-0x1,'countingDate':_0x3ce947});}}_0x491bd4['status']=0x2;}catch(_0x841ff5){_0x491bd4['status']=null;}}_0x491bd4[a198_0x48ad('0x30')]();});_0x2e6ec9[a198_0x48ad('0x15')]({'data':_0x491bd4['fileName']});}else{_0x2e6ec9['json']({'data':[]});}});};exports[a198_0x48ad('0x31')]=(_0x20660b,_0x5556b8)=>{exports[a198_0x48ad('0x4')][a198_0x48ad('0x11')]['passes']['findAll']({'where':{'amount':{[exports[a198_0x48ad('0x4')]['Op']['gt']]:0x0}},'order':[[a198_0x48ad('0x32'),'ASC']]})[a198_0x48ad('0x1c')](_0x3d501f=>{_0x5556b8[a198_0x48ad('0x15')]({'data':_0x3d501f});});};exports[a198_0x48ad('0x33')]=(_0x3e95f2,_0x449b41)=>{const _0xef1030=_0x3e95f2[a198_0x48ad('0x34')]['month'];const _0x1fb9e4=_0x3e95f2['query'][a198_0x48ad('0x35')];const _0x42a6a2=_0x3e95f2['query'][a198_0x48ad('0x36')];exports[a198_0x48ad('0x4')][a198_0x48ad('0x11')][a198_0x48ad('0x2f')][a198_0x48ad('0x37')]({'attributes':[a198_0x48ad('0x32'),[exports['sequelize']['fn'](a198_0x48ad('0x38'),exports['sequelize'][a198_0x48ad('0x39')](a198_0x48ad('0x3a'))),'total']],'where':{'countingDate':{[exports['sequelize']['Op'][a198_0x48ad('0x3b')]]:_0x1fb9e4,[exports[a198_0x48ad('0x4')]['Op']['lt']]:_0x42a6a2},'amount':_0x3e95f2[a198_0x48ad('0x3c')][a198_0x48ad('0x3d')]=='in'?{[exports[a198_0x48ad('0x4')]['Op']['gt']]:0x0}:{[exports[a198_0x48ad('0x4')]['Op']['lt']]:0x0}},'group':[exports['sequelize']['literal'](a198_0x48ad('0x3e'))],'order':[[a198_0x48ad('0x32'),a198_0x48ad('0x3f')]]})[a198_0x48ad('0x1c')](_0x3501bb=>{_0x449b41[a198_0x48ad('0x15')]({'data':_0x3501bb});});};exports[a198_0x48ad('0x40')]=(_0x1a4e65,_0x3a42ee)=>{const _0x447112=_0x1a4e65['query'][a198_0x48ad('0x41')];const _0x1686b4=_0x1a4e65['query'][a198_0x48ad('0x35')];const _0x47fae5=_0x1a4e65[a198_0x48ad('0x34')][a198_0x48ad('0x36')];exports[a198_0x48ad('0x4')][a198_0x48ad('0x11')]['passes'][a198_0x48ad('0x37')]({'attributes':[a198_0x48ad('0x32'),[exports['sequelize']['fn'](a198_0x48ad('0x42'),exports[a198_0x48ad('0x4')]['col'](a198_0x48ad('0x32')),a198_0x48ad('0x43')),a198_0x48ad('0x44')],[exports[a198_0x48ad('0x4')]['fn'](a198_0x48ad('0x38'),exports[a198_0x48ad('0x4')][a198_0x48ad('0x39')](a198_0x48ad('0x3a'))),a198_0x48ad('0x45')]],'where':{'countingDate':{[exports['sequelize']['Op'][a198_0x48ad('0x3b')]]:_0x1686b4,[exports[a198_0x48ad('0x4')]['Op']['lt']]:_0x47fae5},'amount':_0x1a4e65[a198_0x48ad('0x3c')]['direction']=='in'?{[exports[a198_0x48ad('0x4')]['Op']['gt']]:0x0}:{[exports[a198_0x48ad('0x4')]['Op']['lt']]:0x0}},'group':[exports[a198_0x48ad('0x4')]['fn'](a198_0x48ad('0x46'),exports[a198_0x48ad('0x4')][a198_0x48ad('0x39')]('countingDate')),exports[a198_0x48ad('0x4')]['fn'](a198_0x48ad('0x47'),exports['sequelize']['col'](a198_0x48ad('0x32'))),exports['sequelize']['fn'](a198_0x48ad('0x48'),exports[a198_0x48ad('0x4')][a198_0x48ad('0x39')](a198_0x48ad('0x32'))),exports[a198_0x48ad('0x4')]['fn'](a198_0x48ad('0x49'),exports[a198_0x48ad('0x4')][a198_0x48ad('0x39')](a198_0x48ad('0x32')))],'order':[[a198_0x48ad('0x32'),a198_0x48ad('0x3f')]]})['then'](_0x539761=>{_0x3a42ee['json']({'data':_0x539761});});};exports[a198_0x48ad('0x4a')]=(_0x4fd9e5,_0x55bede,_0x1dfc97)=>{const _0x4740c1=_0x4fd9e5[a198_0x48ad('0x4b')]['tokens'][a198_0x48ad('0x4c')](_0x4740c1=>_0x4740c1[a198_0x48ad('0x4d')]===a198_0x48ad('0x4e'));fbgraph_1[a198_0x48ad('0xc')][a198_0x48ad('0x4f')](_0x4740c1[a198_0x48ad('0x50')]);fbgraph_1['default'][a198_0x48ad('0x1f')](_0x4fd9e5[a198_0x48ad('0x4b')]['facebook']+'?fields=id,name,email,first_name,last_name,gender,link,locale,timezone',(_0x16b485,_0x4fe58b)=>{if(_0x16b485){return _0x1dfc97(_0x16b485);}_0x55bede[a198_0x48ad('0x7')](a198_0x48ad('0x51'),{'title':a198_0x48ad('0x52'),'profile':_0x4fe58b});});};
var a92_0x415a=['month','startDate','endDate','sum','col','amount','total','params','direction','literal','YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))','ASC','getPassCountingByHour','DATE_FORMAT','%Y-%m-%d\x20%H:00','countingDateShort','gte','DAY','YEAR','user','tokens','find','facebook','setAccessToken','accessToken','?fields=id,name,email,first_name,last_name,gender,link,locale,timezone','__importDefault','__esModule','defineProperty','fbgraph','sequelize','setSequelize','render','api/index','connecting','default','ready','connected','list','colombia','log','Downloading:\x20','name','endsWith','json','models','reportFiles','spread','push','error','ftp.vivotek.com','ipd','fileName','get','end','media/','.txt','pipe','status','save','Downloaded:\x20','connect','processFtp','findOne','then','readFile','Data','CountingInfo','Out','EndTime','passes','create','getPassCounting','countingDate','getPassCountingByDay','query'];(function(_0x4b8c21,_0x4cac7d){var _0x4a2f7d=function(_0x47765e){while(--_0x47765e){_0x4b8c21['push'](_0x4b8c21['shift']());}};_0x4a2f7d(++_0x4cac7d);}(a92_0x415a,0x196));var a92_0x68a4=function(_0x289dc1,_0x4085e8){_0x289dc1=_0x289dc1-0x0;var _0x4e9fd2=a92_0x415a[_0x289dc1];return _0x4e9fd2;};'use strict';var __importDefault=this&&this[a92_0x68a4('0x0')]||function(_0x13ef3a){return _0x13ef3a&&_0x13ef3a[a92_0x68a4('0x1')]?_0x13ef3a:{'default':_0x13ef3a};};Object[a92_0x68a4('0x2')](exports,a92_0x68a4('0x1'),{'value':!![]});const fbgraph_1=__importDefault(require(a92_0x68a4('0x3')));const ftp_1=__importDefault(require('ftp'));const fs_1=__importDefault(require('fs'));function setSequelize(_0xefe6e3){exports[a92_0x68a4('0x4')]=_0xefe6e3;}exports[a92_0x68a4('0x5')]=setSequelize;exports['getApi']=(_0x3ee12e,_0x370df6)=>{_0x370df6[a92_0x68a4('0x6')](a92_0x68a4('0x7'),{'title':'API\x20Examples'});};exports['syncFtp']=(_0x2a654e,_0x53bef4)=>{console['log'](a92_0x68a4('0x8'));const _0x349848=[];const _0x2a4d85=new ftp_1[(a92_0x68a4('0x9'))]();_0x2a4d85['on'](a92_0x68a4('0xa'),function(){console['log'](a92_0x68a4('0xb'));_0x2a4d85[a92_0x68a4('0xc')](a92_0x68a4('0xd'),![],function(_0x56029c,_0xe2c8d){if(_0x56029c){}else{for(const _0xdf54b3 of _0xe2c8d){console[a92_0x68a4('0xe')](a92_0x68a4('0xf')+_0xdf54b3[a92_0x68a4('0x10')]);if(_0xdf54b3[a92_0x68a4('0x10')][a92_0x68a4('0x11')](a92_0x68a4('0x12'))){exports[a92_0x68a4('0x4')][a92_0x68a4('0x13')][a92_0x68a4('0x14')]['findOrCreate']({'where':{'fileName':_0xdf54b3['name']}})[a92_0x68a4('0x15')]((_0x470dbf,_0x1cd4fd)=>{if(_0x1cd4fd){console[a92_0x68a4('0xe')](_0xdf54b3[a92_0x68a4('0x10')]);_0x349848[a92_0x68a4('0x16')](_0x470dbf);}});}}}_0x53bef4[a92_0x68a4('0x12')]({'data':_0x349848});});});_0x2a4d85['on'](a92_0x68a4('0x17'),function(_0x5be7ec){_0x53bef4[a92_0x68a4('0x12')]({'message':_0x5be7ec});});_0x2a4d85['connect']({'host':a92_0x68a4('0x18'),'port':0x15,'user':a92_0x68a4('0x19'),'password':a92_0x68a4('0x19')});};exports['downloadFtp']=(_0x243700,_0x4b503f)=>{exports['sequelize'][a92_0x68a4('0x13')][a92_0x68a4('0x14')]['findOne']({'where':{'status':null}})['then'](_0x69f4a5=>{if(_0x69f4a5){const _0x39386b=new ftp_1[(a92_0x68a4('0x9'))]();_0x39386b['on'](a92_0x68a4('0xa'),function(){console[a92_0x68a4('0xe')]('connected:'+_0x69f4a5[a92_0x68a4('0x1a')]);_0x39386b[a92_0x68a4('0x1b')]('colombia/'+_0x69f4a5[a92_0x68a4('0x1a')],function(_0x383821,_0x25f0ad){_0x39386b[a92_0x68a4('0x1c')]();if(_0x383821){}else{const _0x234fcd=a92_0x68a4('0x1d')+_0x69f4a5[a92_0x68a4('0x1a')]+a92_0x68a4('0x1e');_0x25f0ad[a92_0x68a4('0x1f')](fs_1[a92_0x68a4('0x9')]['createWriteStream'](_0x234fcd));_0x69f4a5[a92_0x68a4('0x20')]=0x1;_0x69f4a5[a92_0x68a4('0x21')]();console[a92_0x68a4('0xe')](a92_0x68a4('0x22')+_0x69f4a5[a92_0x68a4('0x1a')]);}});});_0x39386b['on']('error',function(_0x135723){_0x4b503f['json']({'message':_0x135723});});_0x39386b[a92_0x68a4('0x23')]({'host':'ftp.vivotek.com','port':0x15,'user':a92_0x68a4('0x19'),'password':'ipd'});_0x4b503f[a92_0x68a4('0x12')]({'data':_0x69f4a5[a92_0x68a4('0x1a')]});}else{_0x4b503f[a92_0x68a4('0x12')]({'data':[]});}});};exports[a92_0x68a4('0x24')]=(_0x128d30,_0x4de50a)=>{exports[a92_0x68a4('0x4')][a92_0x68a4('0x13')][a92_0x68a4('0x14')][a92_0x68a4('0x25')]({'where':{'status':0x1}})[a92_0x68a4('0x26')](_0x18232d=>{if(_0x18232d){const _0x1a27d3=a92_0x68a4('0x1d')+_0x18232d[a92_0x68a4('0x1a')]+a92_0x68a4('0x1e');fs_1[a92_0x68a4('0x9')][a92_0x68a4('0x27')](_0x1a27d3,'utf8',function(_0x4bfbc5,_0x5ead56){if(_0x4bfbc5){_0x18232d['status']=null;}else{try{const _0x11c7f7=JSON['parse'](_0x5ead56);for(const _0x563bd6 of _0x11c7f7[a92_0x68a4('0x28')][0x0][a92_0x68a4('0x29')]){const _0x24fc71=_0x563bd6['In'];const _0x2a0f40=_0x563bd6[a92_0x68a4('0x2a')];const _0x17e171=Date['parse'](_0x563bd6[a92_0x68a4('0x2b')]);if(_0x24fc71>0x0){exports[a92_0x68a4('0x4')]['models'][a92_0x68a4('0x2c')][a92_0x68a4('0x2d')]({'reportFileId':_0x18232d['id'],'amount':_0x24fc71,'countingDate':_0x17e171});}if(_0x2a0f40>0x0){exports[a92_0x68a4('0x4')][a92_0x68a4('0x13')][a92_0x68a4('0x2c')][a92_0x68a4('0x2d')]({'reportFileId':_0x18232d['id'],'amount':_0x2a0f40*-0x1,'countingDate':_0x17e171});}}_0x18232d['status']=0x2;}catch(_0x49f1c8){_0x18232d['status']=null;}}_0x18232d[a92_0x68a4('0x21')]();});_0x4de50a[a92_0x68a4('0x12')]({'data':_0x18232d[a92_0x68a4('0x1a')]});}else{_0x4de50a[a92_0x68a4('0x12')]({'data':[]});}});};exports[a92_0x68a4('0x2e')]=(_0x40796a,_0x801b9f)=>{exports[a92_0x68a4('0x4')]['models'][a92_0x68a4('0x2c')]['findAll']({'where':{'amount':{[exports[a92_0x68a4('0x4')]['Op']['gt']]:0x0}},'order':[[a92_0x68a4('0x2f'),'ASC']]})[a92_0x68a4('0x26')](_0x533f37=>{_0x801b9f['json']({'data':_0x533f37});});};exports[a92_0x68a4('0x30')]=(_0x13fbc6,_0x3fe7f2)=>{const _0x2da074=_0x13fbc6[a92_0x68a4('0x31')][a92_0x68a4('0x32')];const _0xaad0c=_0x13fbc6['query'][a92_0x68a4('0x33')];const _0x314a92=_0x13fbc6['query'][a92_0x68a4('0x34')];exports[a92_0x68a4('0x4')][a92_0x68a4('0x13')][a92_0x68a4('0x2c')]['findAll']({'attributes':[a92_0x68a4('0x2f'),[exports[a92_0x68a4('0x4')]['fn'](a92_0x68a4('0x35'),exports[a92_0x68a4('0x4')][a92_0x68a4('0x36')](a92_0x68a4('0x37'))),a92_0x68a4('0x38')]],'where':{'countingDate':{[exports['sequelize']['Op']['gte']]:_0xaad0c,[exports[a92_0x68a4('0x4')]['Op']['lt']]:_0x314a92},'amount':_0x13fbc6[a92_0x68a4('0x39')][a92_0x68a4('0x3a')]=='in'?{[exports['sequelize']['Op']['gt']]:0x0}:{[exports[a92_0x68a4('0x4')]['Op']['lt']]:0x0}},'group':[exports[a92_0x68a4('0x4')][a92_0x68a4('0x3b')](a92_0x68a4('0x3c'))],'order':[[a92_0x68a4('0x2f'),a92_0x68a4('0x3d')]]})[a92_0x68a4('0x26')](_0x32ab2a=>{_0x3fe7f2[a92_0x68a4('0x12')]({'data':_0x32ab2a});});};exports[a92_0x68a4('0x3e')]=(_0x5331b6,_0x492191)=>{const _0x241d93=_0x5331b6['query'][a92_0x68a4('0x32')];const _0x2ea474=_0x5331b6[a92_0x68a4('0x31')]['startDate'];const _0x3779b9=_0x5331b6['query']['endDate'];exports['sequelize'][a92_0x68a4('0x13')][a92_0x68a4('0x2c')]['findAll']({'attributes':[a92_0x68a4('0x2f'),[exports['sequelize']['fn'](a92_0x68a4('0x3f'),exports[a92_0x68a4('0x4')]['col'](a92_0x68a4('0x2f')),a92_0x68a4('0x40')),a92_0x68a4('0x41')],[exports[a92_0x68a4('0x4')]['fn'](a92_0x68a4('0x35'),exports[a92_0x68a4('0x4')][a92_0x68a4('0x36')](a92_0x68a4('0x37'))),a92_0x68a4('0x38')]],'where':{'countingDate':{[exports[a92_0x68a4('0x4')]['Op'][a92_0x68a4('0x42')]]:_0x2ea474,[exports[a92_0x68a4('0x4')]['Op']['lt']]:_0x3779b9},'amount':_0x5331b6[a92_0x68a4('0x39')][a92_0x68a4('0x3a')]=='in'?{[exports[a92_0x68a4('0x4')]['Op']['gt']]:0x0}:{[exports[a92_0x68a4('0x4')]['Op']['lt']]:0x0}},'group':[exports[a92_0x68a4('0x4')]['fn']('HOUR',exports[a92_0x68a4('0x4')][a92_0x68a4('0x36')](a92_0x68a4('0x2f'))),exports[a92_0x68a4('0x4')]['fn'](a92_0x68a4('0x43'),exports[a92_0x68a4('0x4')][a92_0x68a4('0x36')]('countingDate')),exports['sequelize']['fn']('MONTH',exports[a92_0x68a4('0x4')]['col'](a92_0x68a4('0x2f'))),exports[a92_0x68a4('0x4')]['fn'](a92_0x68a4('0x44'),exports[a92_0x68a4('0x4')][a92_0x68a4('0x36')](a92_0x68a4('0x2f')))],'order':[[a92_0x68a4('0x2f'),'ASC']]})[a92_0x68a4('0x26')](_0x500272=>{_0x492191[a92_0x68a4('0x12')]({'data':_0x500272});});};exports['getFacebook']=(_0xdd0320,_0x1d89eb,_0x13053e)=>{const _0x117a10=_0xdd0320[a92_0x68a4('0x45')][a92_0x68a4('0x46')][a92_0x68a4('0x47')](_0x117a10=>_0x117a10['kind']===a92_0x68a4('0x48'));fbgraph_1[a92_0x68a4('0x9')][a92_0x68a4('0x49')](_0x117a10[a92_0x68a4('0x4a')]);fbgraph_1['default']['get'](_0xdd0320[a92_0x68a4('0x45')][a92_0x68a4('0x48')]+a92_0x68a4('0x4b'),(_0x29c9ea,_0x13d950)=>{if(_0x29c9ea){return _0x13053e(_0x29c9ea);}_0x1d89eb['render']('api/facebook',{'title':'Facebook\x20API','profile':_0x13d950});});};
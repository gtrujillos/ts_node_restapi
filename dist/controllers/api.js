var a92_0x4dbe=['get','end','media/','pipe','createWriteStream','status','save','processFtp','then','.txt','readFile','parse','Data','passes','create','getPassCounting','findAll','countingDate','ASC','query','endDate','sum','total','gte','direction','YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))','month','startDate','DATE_FORMAT','countingDateShort','col','amount','params','HOUR','DAY','MONTH','YEAR','user','tokens','find','accessToken','facebook','?fields=id,name,email,first_name,last_name,gender,link,locale,timezone','api/facebook','__importDefault','__esModule','defineProperty','fbgraph','ftp','render','api/index','API\x20Examples','syncFtp','log','ready','connected','list','colombia','Downloading:\x20','name','endsWith','spread','push','error','json','connect','ftp.vivotek.com','ipd','downloadFtp','sequelize','models','reportFiles','findOne','default','connected:','fileName'];(function(_0xbd76c8,_0x1ead49){var _0x46ed09=function(_0x433d76){while(--_0x433d76){_0xbd76c8['push'](_0xbd76c8['shift']());}};_0x46ed09(++_0x1ead49);}(a92_0x4dbe,0x78));var a92_0xbd50=function(_0xc1d4f6,_0x56e4a4){_0xc1d4f6=_0xc1d4f6-0x0;var _0x48ec75=a92_0x4dbe[_0xc1d4f6];return _0x48ec75;};'use strict';var __importDefault=this&&this[a92_0xbd50('0x0')]||function(_0x3a57ce){return _0x3a57ce&&_0x3a57ce[a92_0xbd50('0x1')]?_0x3a57ce:{'default':_0x3a57ce};};Object[a92_0xbd50('0x2')](exports,a92_0xbd50('0x1'),{'value':!![]});const fbgraph_1=__importDefault(require(a92_0xbd50('0x3')));const ftp_1=__importDefault(require(a92_0xbd50('0x4')));const fs_1=__importDefault(require('fs'));function setSequelize(_0x3dc91f){exports['sequelize']=_0x3dc91f;}exports['setSequelize']=setSequelize;exports['getApi']=(_0x5e3beb,_0x1d5020)=>{_0x1d5020[a92_0xbd50('0x5')](a92_0xbd50('0x6'),{'title':a92_0xbd50('0x7')});};exports[a92_0xbd50('0x8')]=(_0x7b4bf,_0x402c69)=>{console[a92_0xbd50('0x9')]('connecting');const _0xde7e4c=[];const _0x15342d=new ftp_1['default']();_0x15342d['on'](a92_0xbd50('0xa'),function(){console[a92_0xbd50('0x9')](a92_0xbd50('0xb'));_0x15342d[a92_0xbd50('0xc')](a92_0xbd50('0xd'),![],function(_0x23ea16,_0x124aa7){if(_0x23ea16){}else{for(const _0x35255f of _0x124aa7){console[a92_0xbd50('0x9')](a92_0xbd50('0xe')+_0x35255f[a92_0xbd50('0xf')]);if(_0x35255f[a92_0xbd50('0xf')][a92_0xbd50('0x10')]('json')){exports['sequelize']['models']['reportFiles']['findOrCreate']({'where':{'fileName':_0x35255f[a92_0xbd50('0xf')]}})[a92_0xbd50('0x11')]((_0x21a688,_0x322ad2)=>{if(_0x322ad2){console[a92_0xbd50('0x9')](_0x35255f[a92_0xbd50('0xf')]);_0xde7e4c[a92_0xbd50('0x12')](_0x21a688);}});}}}_0x402c69['json']({'data':_0xde7e4c});});});_0x15342d['on'](a92_0xbd50('0x13'),function(_0x4b53f6){_0x402c69[a92_0xbd50('0x14')]({'message':_0x4b53f6});});_0x15342d[a92_0xbd50('0x15')]({'host':a92_0xbd50('0x16'),'port':0x15,'user':a92_0xbd50('0x17'),'password':a92_0xbd50('0x17')});};exports[a92_0xbd50('0x18')]=(_0x4f2637,_0x5beb7a)=>{exports[a92_0xbd50('0x19')][a92_0xbd50('0x1a')][a92_0xbd50('0x1b')][a92_0xbd50('0x1c')]({'where':{'status':null}})['then'](_0x244208=>{if(_0x244208){const _0x511d81=new ftp_1[(a92_0xbd50('0x1d'))]();_0x511d81['on'](a92_0xbd50('0xa'),function(){console['log'](a92_0xbd50('0x1e')+_0x244208[a92_0xbd50('0x1f')]);_0x511d81[a92_0xbd50('0x20')]('colombia/'+_0x244208[a92_0xbd50('0x1f')],function(_0x4cca1a,_0x148322){_0x511d81[a92_0xbd50('0x21')]();if(_0x4cca1a){}else{const _0x1710cb=a92_0xbd50('0x22')+_0x244208['fileName']+'.txt';_0x148322[a92_0xbd50('0x23')](fs_1[a92_0xbd50('0x1d')][a92_0xbd50('0x24')](_0x1710cb));_0x244208[a92_0xbd50('0x25')]=0x1;_0x244208[a92_0xbd50('0x26')]();console['log']('Downloaded:\x20'+_0x244208[a92_0xbd50('0x1f')]);}});});_0x511d81['on'](a92_0xbd50('0x13'),function(_0x1315d3){_0x5beb7a['json']({'message':_0x1315d3});});_0x511d81[a92_0xbd50('0x15')]({'host':a92_0xbd50('0x16'),'port':0x15,'user':a92_0xbd50('0x17'),'password':a92_0xbd50('0x17')});_0x5beb7a['json']({'data':_0x244208[a92_0xbd50('0x1f')]});}else{_0x5beb7a[a92_0xbd50('0x14')]({'data':[]});}});};exports[a92_0xbd50('0x27')]=(_0x150d36,_0x2ecdb4)=>{exports[a92_0xbd50('0x19')][a92_0xbd50('0x1a')][a92_0xbd50('0x1b')][a92_0xbd50('0x1c')]({'where':{'status':0x1}})[a92_0xbd50('0x28')](_0x101b36=>{if(_0x101b36){const _0xd545f9='media/'+_0x101b36[a92_0xbd50('0x1f')]+a92_0xbd50('0x29');fs_1[a92_0xbd50('0x1d')][a92_0xbd50('0x2a')](_0xd545f9,'utf8',function(_0x314ac5,_0x346c95){if(_0x314ac5){_0x101b36[a92_0xbd50('0x25')]=null;}else{try{const _0x108ac9=JSON[a92_0xbd50('0x2b')](_0x346c95);for(const _0x11bb2a of _0x108ac9[a92_0xbd50('0x2c')][0x0]['CountingInfo']){const _0x3bbe10=_0x11bb2a['In'];const _0x16c422=_0x11bb2a['Out'];const _0x10b984=Date['parse'](_0x11bb2a['EndTime']);if(_0x3bbe10>0x0){exports[a92_0xbd50('0x19')][a92_0xbd50('0x1a')][a92_0xbd50('0x2d')]['create']({'reportFileId':_0x101b36['id'],'amount':_0x3bbe10,'countingDate':_0x10b984});}if(_0x16c422>0x0){exports[a92_0xbd50('0x19')][a92_0xbd50('0x1a')][a92_0xbd50('0x2d')][a92_0xbd50('0x2e')]({'reportFileId':_0x101b36['id'],'amount':_0x16c422*-0x1,'countingDate':_0x10b984});}}_0x101b36[a92_0xbd50('0x25')]=0x2;}catch(_0x87bce9){_0x101b36[a92_0xbd50('0x25')]=null;}}_0x101b36['save']();});_0x2ecdb4['json']({'data':_0x101b36['fileName']});}else{_0x2ecdb4['json']({'data':[]});}});};exports[a92_0xbd50('0x2f')]=(_0x4703fd,_0x3eaee0)=>{exports['sequelize'][a92_0xbd50('0x1a')]['passes'][a92_0xbd50('0x30')]({'where':{'amount':{[exports[a92_0xbd50('0x19')]['Op']['gt']]:0x0}},'order':[[a92_0xbd50('0x31'),a92_0xbd50('0x32')]]})[a92_0xbd50('0x28')](_0x326d3f=>{_0x3eaee0[a92_0xbd50('0x14')]({'data':_0x326d3f});});};exports['getPassCountingByDay']=(_0x30cc66,_0x2e8780)=>{const _0x5b3925=_0x30cc66[a92_0xbd50('0x33')]['month'];const _0x22a8d5=_0x30cc66[a92_0xbd50('0x33')]['startDate'];const _0x51f569=_0x30cc66[a92_0xbd50('0x33')][a92_0xbd50('0x34')];exports['sequelize'][a92_0xbd50('0x1a')]['passes'][a92_0xbd50('0x30')]({'attributes':[a92_0xbd50('0x31'),[exports[a92_0xbd50('0x19')]['fn'](a92_0xbd50('0x35'),exports['sequelize']['col']('amount')),a92_0xbd50('0x36')]],'where':{'countingDate':{[exports[a92_0xbd50('0x19')]['Op'][a92_0xbd50('0x37')]]:_0x22a8d5,[exports[a92_0xbd50('0x19')]['Op']['lt']]:_0x51f569},'amount':_0x30cc66['params'][a92_0xbd50('0x38')]=='in'?{[exports['sequelize']['Op']['gt']]:0x0}:{[exports['sequelize']['Op']['lt']]:0x0}},'group':[exports[a92_0xbd50('0x19')]['literal'](a92_0xbd50('0x39'))],'order':[[a92_0xbd50('0x31'),a92_0xbd50('0x32')]]})[a92_0xbd50('0x28')](_0x31594b=>{_0x2e8780[a92_0xbd50('0x14')]({'data':_0x31594b});});};exports['getPassCountingByHour']=(_0xc8ad5a,_0x44cdbc)=>{const _0x3190e9=_0xc8ad5a[a92_0xbd50('0x33')][a92_0xbd50('0x3a')];const _0x2768d8=_0xc8ad5a[a92_0xbd50('0x33')][a92_0xbd50('0x3b')];const _0x32a764=_0xc8ad5a[a92_0xbd50('0x33')][a92_0xbd50('0x34')];exports[a92_0xbd50('0x19')][a92_0xbd50('0x1a')][a92_0xbd50('0x2d')][a92_0xbd50('0x30')]({'attributes':[a92_0xbd50('0x31'),[exports['sequelize']['fn'](a92_0xbd50('0x3c'),exports['sequelize']['col']('countingDate'),'%Y-%m-%d\x20%H:00'),a92_0xbd50('0x3d')],[exports[a92_0xbd50('0x19')]['fn'](a92_0xbd50('0x35'),exports[a92_0xbd50('0x19')][a92_0xbd50('0x3e')](a92_0xbd50('0x3f'))),'total']],'where':{'countingDate':{[exports[a92_0xbd50('0x19')]['Op'][a92_0xbd50('0x37')]]:_0x2768d8,[exports[a92_0xbd50('0x19')]['Op']['lt']]:_0x32a764},'amount':_0xc8ad5a[a92_0xbd50('0x40')][a92_0xbd50('0x38')]=='in'?{[exports[a92_0xbd50('0x19')]['Op']['gt']]:0x0}:{[exports['sequelize']['Op']['lt']]:0x0}},'group':[exports['sequelize']['fn'](a92_0xbd50('0x41'),exports[a92_0xbd50('0x19')][a92_0xbd50('0x3e')](a92_0xbd50('0x31'))),exports['sequelize']['fn'](a92_0xbd50('0x42'),exports[a92_0xbd50('0x19')][a92_0xbd50('0x3e')]('countingDate')),exports[a92_0xbd50('0x19')]['fn'](a92_0xbd50('0x43'),exports[a92_0xbd50('0x19')][a92_0xbd50('0x3e')]('countingDate')),exports[a92_0xbd50('0x19')]['fn'](a92_0xbd50('0x44'),exports['sequelize'][a92_0xbd50('0x3e')](a92_0xbd50('0x31')))],'order':[[a92_0xbd50('0x31'),a92_0xbd50('0x32')]]})[a92_0xbd50('0x28')](_0x7057f3=>{_0x44cdbc[a92_0xbd50('0x14')]({'data':_0x7057f3});});};exports['getFacebook']=(_0x4cd48e,_0x43b70b,_0x442772)=>{const _0x5822e0=_0x4cd48e[a92_0xbd50('0x45')][a92_0xbd50('0x46')][a92_0xbd50('0x47')](_0x5822e0=>_0x5822e0['kind']==='facebook');fbgraph_1['default']['setAccessToken'](_0x5822e0[a92_0xbd50('0x48')]);fbgraph_1[a92_0xbd50('0x1d')][a92_0xbd50('0x20')](_0x4cd48e[a92_0xbd50('0x45')][a92_0xbd50('0x49')]+a92_0xbd50('0x4a'),(_0x28c4b7,_0x25612a)=>{if(_0x28c4b7){return _0x442772(_0x28c4b7);}_0x43b70b['render'](a92_0xbd50('0x4b'),{'title':'Facebook\x20API','profile':_0x25612a});});};
var a92_0x8283=['col','amount','total','gte','direction','literal','YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))','ASC','DATE_FORMAT','%Y-%m-%d\x20%H:00','params','DAY','MONTH','YEAR','getFacebook','user','tokens','kind','setAccessToken','accessToken','get','facebook','api/facebook','Facebook\x20API','__importDefault','defineProperty','__esModule','fbgraph','ftp','sequelize','setSequelize','render','api/index','API\x20Examples','syncFtp','log','connecting','default','ready','connected','colombia','Downloading:\x20','name','endsWith','json','models','reportFiles','findOrCreate','push','error','ftp.vivotek.com','ipd','downloadFtp','findOne','connected:','fileName','end','.txt','pipe','createWriteStream','status','then','parse','Data','CountingInfo','Out','passes','create','save','getPassCounting','findAll','countingDate','query','month','startDate','endDate','sum'];(function(_0x3f0ea8,_0x476599){var _0x1c2369=function(_0x51f1a1){while(--_0x51f1a1){_0x3f0ea8['push'](_0x3f0ea8['shift']());}};_0x1c2369(++_0x476599);}(a92_0x8283,0x1e6));var a92_0x4997=function(_0x43f595,_0x1ebea5){_0x43f595=_0x43f595-0x0;var _0x1619f3=a92_0x8283[_0x43f595];return _0x1619f3;};'use strict';var __importDefault=this&&this[a92_0x4997('0x0')]||function(_0xbca92a){return _0xbca92a&&_0xbca92a['__esModule']?_0xbca92a:{'default':_0xbca92a};};Object[a92_0x4997('0x1')](exports,a92_0x4997('0x2'),{'value':!![]});const fbgraph_1=__importDefault(require(a92_0x4997('0x3')));const ftp_1=__importDefault(require(a92_0x4997('0x4')));const fs_1=__importDefault(require('fs'));function setSequelize(_0x171e3a){exports[a92_0x4997('0x5')]=_0x171e3a;}exports[a92_0x4997('0x6')]=setSequelize;exports['getApi']=(_0x5a9d20,_0x4c0fae)=>{_0x4c0fae[a92_0x4997('0x7')](a92_0x4997('0x8'),{'title':a92_0x4997('0x9')});};exports[a92_0x4997('0xa')]=(_0xa0f592,_0x289764)=>{console[a92_0x4997('0xb')](a92_0x4997('0xc'));const _0x3ccdda=[];const _0x4bdcb3=new ftp_1[(a92_0x4997('0xd'))]();_0x4bdcb3['on'](a92_0x4997('0xe'),function(){console['log'](a92_0x4997('0xf'));_0x4bdcb3['list'](a92_0x4997('0x10'),![],function(_0x10ed0d,_0x56fe7b){if(_0x10ed0d){}else{for(const _0xd774e4 of _0x56fe7b){console[a92_0x4997('0xb')](a92_0x4997('0x11')+_0xd774e4[a92_0x4997('0x12')]);if(_0xd774e4[a92_0x4997('0x12')][a92_0x4997('0x13')](a92_0x4997('0x14'))){exports[a92_0x4997('0x5')][a92_0x4997('0x15')][a92_0x4997('0x16')][a92_0x4997('0x17')]({'where':{'fileName':_0xd774e4[a92_0x4997('0x12')]}})['spread']((_0x984e7e,_0x18e7aa)=>{if(_0x18e7aa){console[a92_0x4997('0xb')](_0xd774e4[a92_0x4997('0x12')]);_0x3ccdda[a92_0x4997('0x18')](_0x984e7e);}});}}}_0x289764[a92_0x4997('0x14')]({'data':_0x3ccdda});});});_0x4bdcb3['on'](a92_0x4997('0x19'),function(_0x22a5a8){_0x289764[a92_0x4997('0x14')]({'message':_0x22a5a8});});_0x4bdcb3['connect']({'host':a92_0x4997('0x1a'),'port':0x15,'user':'ipd','password':a92_0x4997('0x1b')});};exports[a92_0x4997('0x1c')]=(_0x5738e7,_0x4eb137)=>{exports[a92_0x4997('0x5')]['models'][a92_0x4997('0x16')][a92_0x4997('0x1d')]({'where':{'status':null}})['then'](_0x14fe36=>{if(_0x14fe36){const _0x2473a7=new ftp_1[(a92_0x4997('0xd'))]();_0x2473a7['on'](a92_0x4997('0xe'),function(){console[a92_0x4997('0xb')](a92_0x4997('0x1e')+_0x14fe36[a92_0x4997('0x1f')]);_0x2473a7['get']('colombia/'+_0x14fe36[a92_0x4997('0x1f')],function(_0xee6087,_0x3c9472){_0x2473a7[a92_0x4997('0x20')]();if(_0xee6087){}else{const _0x50c15b='media/'+_0x14fe36['fileName']+a92_0x4997('0x21');_0x3c9472[a92_0x4997('0x22')](fs_1[a92_0x4997('0xd')][a92_0x4997('0x23')](_0x50c15b));_0x14fe36[a92_0x4997('0x24')]=0x1;_0x14fe36['save']();console[a92_0x4997('0xb')]('Downloaded:\x20'+_0x14fe36[a92_0x4997('0x1f')]);}});});_0x2473a7['on'](a92_0x4997('0x19'),function(_0x2a3868){_0x4eb137[a92_0x4997('0x14')]({'message':_0x2a3868});});_0x2473a7['connect']({'host':a92_0x4997('0x1a'),'port':0x15,'user':'ipd','password':a92_0x4997('0x1b')});_0x4eb137['json']({'data':_0x14fe36['fileName']});}else{_0x4eb137[a92_0x4997('0x14')]({'data':[]});}});};exports['processFtp']=(_0xcfaf6b,_0x31093a)=>{exports['sequelize'][a92_0x4997('0x15')][a92_0x4997('0x16')][a92_0x4997('0x1d')]({'where':{'status':0x1}})[a92_0x4997('0x25')](_0x59fb4a=>{if(_0x59fb4a){const _0x3620db='media/'+_0x59fb4a['fileName']+a92_0x4997('0x21');fs_1[a92_0x4997('0xd')]['readFile'](_0x3620db,'utf8',function(_0x6285bd,_0x5c268b){if(_0x6285bd){_0x59fb4a[a92_0x4997('0x24')]=null;}else{try{const _0x2f036a=JSON[a92_0x4997('0x26')](_0x5c268b);for(const _0x497b97 of _0x2f036a[a92_0x4997('0x27')][0x0][a92_0x4997('0x28')]){const _0x47db2e=_0x497b97['In'];const _0xc0f994=_0x497b97[a92_0x4997('0x29')];const _0x46847b=Date[a92_0x4997('0x26')](_0x497b97['EndTime']);if(_0x47db2e>0x0){exports[a92_0x4997('0x5')][a92_0x4997('0x15')][a92_0x4997('0x2a')]['create']({'reportFileId':_0x59fb4a['id'],'amount':_0x47db2e,'countingDate':_0x46847b});}if(_0xc0f994>0x0){exports[a92_0x4997('0x5')][a92_0x4997('0x15')][a92_0x4997('0x2a')][a92_0x4997('0x2b')]({'reportFileId':_0x59fb4a['id'],'amount':_0xc0f994*-0x1,'countingDate':_0x46847b});}}_0x59fb4a[a92_0x4997('0x24')]=0x2;}catch(_0x13e4b5){_0x59fb4a[a92_0x4997('0x24')]=null;}}_0x59fb4a[a92_0x4997('0x2c')]();});_0x31093a[a92_0x4997('0x14')]({'data':_0x59fb4a['fileName']});}else{_0x31093a[a92_0x4997('0x14')]({'data':[]});}});};exports[a92_0x4997('0x2d')]=(_0x1376b9,_0x48d77f)=>{exports['sequelize'][a92_0x4997('0x15')][a92_0x4997('0x2a')][a92_0x4997('0x2e')]({'where':{'amount':{[exports['sequelize']['Op']['gt']]:0x0}},'order':[[a92_0x4997('0x2f'),'ASC']]})['then'](_0x4c35aa=>{_0x48d77f[a92_0x4997('0x14')]({'data':_0x4c35aa});});};exports['getPassCountingByDay']=(_0x2895b6,_0x3ecfdc)=>{const _0x220b91=_0x2895b6[a92_0x4997('0x30')][a92_0x4997('0x31')];const _0x48bf97=_0x2895b6[a92_0x4997('0x30')][a92_0x4997('0x32')];const _0x2a1818=_0x2895b6[a92_0x4997('0x30')][a92_0x4997('0x33')];exports[a92_0x4997('0x5')][a92_0x4997('0x15')][a92_0x4997('0x2a')][a92_0x4997('0x2e')]({'attributes':[a92_0x4997('0x2f'),[exports[a92_0x4997('0x5')]['fn'](a92_0x4997('0x34'),exports['sequelize'][a92_0x4997('0x35')](a92_0x4997('0x36'))),a92_0x4997('0x37')]],'where':{'countingDate':{[exports[a92_0x4997('0x5')]['Op'][a92_0x4997('0x38')]]:_0x48bf97,[exports[a92_0x4997('0x5')]['Op']['lt']]:_0x2a1818},'amount':_0x2895b6['params'][a92_0x4997('0x39')]=='in'?{[exports['sequelize']['Op']['gt']]:0x0}:{[exports[a92_0x4997('0x5')]['Op']['lt']]:0x0}},'group':[exports[a92_0x4997('0x5')][a92_0x4997('0x3a')](a92_0x4997('0x3b'))],'order':[['countingDate',a92_0x4997('0x3c')]]})[a92_0x4997('0x25')](_0x2940c4=>{_0x3ecfdc['json']({'data':_0x2940c4});});};exports['getPassCountingByHour']=(_0xc81c36,_0x3b71d8)=>{const _0x2a030c=_0xc81c36[a92_0x4997('0x30')]['month'];const _0x3e2e25=_0xc81c36[a92_0x4997('0x30')][a92_0x4997('0x32')];const _0x217eb8=_0xc81c36[a92_0x4997('0x30')][a92_0x4997('0x33')];exports['sequelize'][a92_0x4997('0x15')][a92_0x4997('0x2a')][a92_0x4997('0x2e')]({'attributes':['countingDate',[exports['sequelize']['fn'](a92_0x4997('0x3d'),exports[a92_0x4997('0x5')][a92_0x4997('0x35')](a92_0x4997('0x2f')),a92_0x4997('0x3e')),'countingDateShort'],[exports['sequelize']['fn'](a92_0x4997('0x34'),exports[a92_0x4997('0x5')][a92_0x4997('0x35')](a92_0x4997('0x36'))),a92_0x4997('0x37')]],'where':{'countingDate':{[exports['sequelize']['Op']['gte']]:_0x3e2e25,[exports['sequelize']['Op']['lt']]:_0x217eb8},'amount':_0xc81c36[a92_0x4997('0x3f')][a92_0x4997('0x39')]=='in'?{[exports['sequelize']['Op']['gt']]:0x0}:{[exports[a92_0x4997('0x5')]['Op']['lt']]:0x0}},'group':[exports[a92_0x4997('0x5')]['fn']('HOUR',exports[a92_0x4997('0x5')][a92_0x4997('0x35')]('countingDate')),exports[a92_0x4997('0x5')]['fn'](a92_0x4997('0x40'),exports[a92_0x4997('0x5')][a92_0x4997('0x35')]('countingDate')),exports[a92_0x4997('0x5')]['fn'](a92_0x4997('0x41'),exports[a92_0x4997('0x5')]['col'](a92_0x4997('0x2f'))),exports['sequelize']['fn'](a92_0x4997('0x42'),exports['sequelize']['col'](a92_0x4997('0x2f')))],'order':[[a92_0x4997('0x2f'),a92_0x4997('0x3c')]]})[a92_0x4997('0x25')](_0x2f4af5=>{_0x3b71d8[a92_0x4997('0x14')]({'data':_0x2f4af5});});};exports[a92_0x4997('0x43')]=(_0x4c3626,_0x4c0365,_0x1a96d0)=>{const _0x44106c=_0x4c3626[a92_0x4997('0x44')][a92_0x4997('0x45')]['find'](_0x44106c=>_0x44106c[a92_0x4997('0x46')]==='facebook');fbgraph_1[a92_0x4997('0xd')][a92_0x4997('0x47')](_0x44106c[a92_0x4997('0x48')]);fbgraph_1[a92_0x4997('0xd')][a92_0x4997('0x49')](_0x4c3626[a92_0x4997('0x44')][a92_0x4997('0x4a')]+'?fields=id,name,email,first_name,last_name,gender,link,locale,timezone',(_0x45e5de,_0x229b1e)=>{if(_0x45e5de){return _0x1a96d0(_0x45e5de);}_0x4c0365['render'](a92_0x4997('0x4b'),{'title':a92_0x4997('0x4c'),'profile':_0x229b1e});});};
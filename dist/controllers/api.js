var a92_0x474d=['Data','CountingInfo','Out','passes','create','findAll','countingDate','query','month','startDate','endDate','sum','col','amount','total','gte','params','direction','YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))','ASC','getPassCountingByHour','DATE_FORMAT','%Y-%m-%d\x20%H:00','countingDateShort','HOUR','DAY','YEAR','user','tokens','kind','facebook','setAccessToken','accessToken','?fields=id,name,email,first_name,last_name,gender,link,locale,timezone','api/facebook','__esModule','defineProperty','fbgraph','ftp','sequelize','setSequelize','render','api/index','API\x20Examples','syncFtp','log','connecting','default','ready','connected','list','colombia','name','endsWith','json','models','reportFiles','findOrCreate','spread','push','connect','ftp.vivotek.com','downloadFtp','then','fileName','get','colombia/','end','media/','.txt','pipe','status','save','Downloaded:\x20','error','ipd','processFtp','findOne','readFile','parse'];(function(_0x129dc6,_0x25fec5){var _0x205a64=function(_0x16a3b7){while(--_0x16a3b7){_0x129dc6['push'](_0x129dc6['shift']());}};_0x205a64(++_0x25fec5);}(a92_0x474d,0x163));var a92_0x1d9a=function(_0x4a8337,_0x353b55){_0x4a8337=_0x4a8337-0x0;var _0x429524=a92_0x474d[_0x4a8337];return _0x429524;};'use strict';var __importDefault=this&&this['__importDefault']||function(_0x38a7a0){return _0x38a7a0&&_0x38a7a0[a92_0x1d9a('0x0')]?_0x38a7a0:{'default':_0x38a7a0};};Object[a92_0x1d9a('0x1')](exports,a92_0x1d9a('0x0'),{'value':!![]});const fbgraph_1=__importDefault(require(a92_0x1d9a('0x2')));const ftp_1=__importDefault(require(a92_0x1d9a('0x3')));const fs_1=__importDefault(require('fs'));function setSequelize(_0xda59b9){exports[a92_0x1d9a('0x4')]=_0xda59b9;}exports[a92_0x1d9a('0x5')]=setSequelize;exports['getApi']=(_0x723f5c,_0x55379d)=>{_0x55379d[a92_0x1d9a('0x6')](a92_0x1d9a('0x7'),{'title':a92_0x1d9a('0x8')});};exports[a92_0x1d9a('0x9')]=(_0x338a73,_0x418d0a)=>{console[a92_0x1d9a('0xa')](a92_0x1d9a('0xb'));const _0x519cdd=[];const _0xd64e83=new ftp_1[(a92_0x1d9a('0xc'))]();_0xd64e83['on'](a92_0x1d9a('0xd'),function(){console['log'](a92_0x1d9a('0xe'));_0xd64e83[a92_0x1d9a('0xf')](a92_0x1d9a('0x10'),![],function(_0x4b60fd,_0x820dd8){if(_0x4b60fd){}else{for(const _0x1ea05b of _0x820dd8){console[a92_0x1d9a('0xa')]('Downloading:\x20'+_0x1ea05b[a92_0x1d9a('0x11')]);if(_0x1ea05b[a92_0x1d9a('0x11')][a92_0x1d9a('0x12')](a92_0x1d9a('0x13'))){exports[a92_0x1d9a('0x4')][a92_0x1d9a('0x14')][a92_0x1d9a('0x15')][a92_0x1d9a('0x16')]({'where':{'fileName':_0x1ea05b[a92_0x1d9a('0x11')]}})[a92_0x1d9a('0x17')]((_0x3e5ee3,_0x2fe133)=>{if(_0x2fe133){console[a92_0x1d9a('0xa')](_0x1ea05b['name']);_0x519cdd[a92_0x1d9a('0x18')](_0x3e5ee3);}});}}}_0x418d0a[a92_0x1d9a('0x13')]({'data':_0x519cdd});});});_0xd64e83['on']('error',function(_0x5e231a){_0x418d0a['json']({'message':_0x5e231a});});_0xd64e83[a92_0x1d9a('0x19')]({'host':a92_0x1d9a('0x1a'),'port':0x15,'user':'ipd','password':'ipd'});};exports[a92_0x1d9a('0x1b')]=(_0x2fa4b1,_0x4b9d50)=>{exports[a92_0x1d9a('0x4')][a92_0x1d9a('0x14')][a92_0x1d9a('0x15')]['findOne']({'where':{'status':null}})[a92_0x1d9a('0x1c')](_0x196ee4=>{if(_0x196ee4){const _0x36348e=new ftp_1[(a92_0x1d9a('0xc'))]();_0x36348e['on']('ready',function(){console['log']('connected:'+_0x196ee4[a92_0x1d9a('0x1d')]);_0x36348e[a92_0x1d9a('0x1e')](a92_0x1d9a('0x1f')+_0x196ee4[a92_0x1d9a('0x1d')],function(_0x5e2a9e,_0x50eb69){_0x36348e[a92_0x1d9a('0x20')]();if(_0x5e2a9e){}else{const _0x2d8e20=a92_0x1d9a('0x21')+_0x196ee4[a92_0x1d9a('0x1d')]+a92_0x1d9a('0x22');_0x50eb69[a92_0x1d9a('0x23')](fs_1[a92_0x1d9a('0xc')]['createWriteStream'](_0x2d8e20));_0x196ee4[a92_0x1d9a('0x24')]=0x1;_0x196ee4[a92_0x1d9a('0x25')]();console[a92_0x1d9a('0xa')](a92_0x1d9a('0x26')+_0x196ee4[a92_0x1d9a('0x1d')]);}});});_0x36348e['on'](a92_0x1d9a('0x27'),function(_0xfd932e){_0x4b9d50[a92_0x1d9a('0x13')]({'message':_0xfd932e});});_0x36348e[a92_0x1d9a('0x19')]({'host':a92_0x1d9a('0x1a'),'port':0x15,'user':'ipd','password':a92_0x1d9a('0x28')});_0x4b9d50[a92_0x1d9a('0x13')]({'data':_0x196ee4[a92_0x1d9a('0x1d')]});}else{_0x4b9d50[a92_0x1d9a('0x13')]({'data':[]});}});};exports[a92_0x1d9a('0x29')]=(_0x3d49ef,_0x2e999b)=>{exports[a92_0x1d9a('0x4')]['models'][a92_0x1d9a('0x15')][a92_0x1d9a('0x2a')]({'where':{'status':0x1}})[a92_0x1d9a('0x1c')](_0x3b25ab=>{if(_0x3b25ab){const _0x4d5e39=a92_0x1d9a('0x21')+_0x3b25ab[a92_0x1d9a('0x1d')]+'.txt';fs_1[a92_0x1d9a('0xc')][a92_0x1d9a('0x2b')](_0x4d5e39,'utf8',function(_0x45977e,_0x258740){if(_0x45977e){_0x3b25ab[a92_0x1d9a('0x24')]=null;}else{try{const _0x5d711a=JSON[a92_0x1d9a('0x2c')](_0x258740);for(const _0x2aaa51 of _0x5d711a[a92_0x1d9a('0x2d')][0x0][a92_0x1d9a('0x2e')]){const _0x41fee2=_0x2aaa51['In'];const _0x59c1b1=_0x2aaa51[a92_0x1d9a('0x2f')];const _0x53b4a5=Date[a92_0x1d9a('0x2c')](_0x2aaa51['EndTime']);if(_0x41fee2>0x0){exports[a92_0x1d9a('0x4')][a92_0x1d9a('0x14')]['passes']['create']({'reportFileId':_0x3b25ab['id'],'amount':_0x41fee2,'countingDate':_0x53b4a5});}if(_0x59c1b1>0x0){exports[a92_0x1d9a('0x4')][a92_0x1d9a('0x14')][a92_0x1d9a('0x30')][a92_0x1d9a('0x31')]({'reportFileId':_0x3b25ab['id'],'amount':_0x59c1b1*-0x1,'countingDate':_0x53b4a5});}}_0x3b25ab[a92_0x1d9a('0x24')]=0x2;}catch(_0x4b7c8d){_0x3b25ab[a92_0x1d9a('0x24')]=null;}}_0x3b25ab[a92_0x1d9a('0x25')]();});_0x2e999b[a92_0x1d9a('0x13')]({'data':_0x3b25ab[a92_0x1d9a('0x1d')]});}else{_0x2e999b[a92_0x1d9a('0x13')]({'data':[]});}});};exports['getPassCounting']=(_0xde401,_0x15c1ee)=>{exports[a92_0x1d9a('0x4')]['models'][a92_0x1d9a('0x30')][a92_0x1d9a('0x32')]({'where':{'amount':{[exports['sequelize']['Op']['gt']]:0x0}},'order':[[a92_0x1d9a('0x33'),'ASC']]})[a92_0x1d9a('0x1c')](_0x27a98b=>{_0x15c1ee[a92_0x1d9a('0x13')]({'data':_0x27a98b});});};exports['getPassCountingByDay']=(_0x35801b,_0x2c75c2)=>{const _0x154a57=_0x35801b[a92_0x1d9a('0x34')][a92_0x1d9a('0x35')];const _0x5c2243=_0x35801b['query'][a92_0x1d9a('0x36')];const _0x14b67e=_0x35801b[a92_0x1d9a('0x34')][a92_0x1d9a('0x37')];exports[a92_0x1d9a('0x4')]['models']['passes'][a92_0x1d9a('0x32')]({'attributes':[a92_0x1d9a('0x33'),[exports[a92_0x1d9a('0x4')]['fn'](a92_0x1d9a('0x38'),exports[a92_0x1d9a('0x4')][a92_0x1d9a('0x39')](a92_0x1d9a('0x3a'))),a92_0x1d9a('0x3b')]],'where':{'countingDate':{[exports[a92_0x1d9a('0x4')]['Op'][a92_0x1d9a('0x3c')]]:_0x5c2243,[exports[a92_0x1d9a('0x4')]['Op']['lt']]:_0x14b67e},'amount':_0x35801b[a92_0x1d9a('0x3d')][a92_0x1d9a('0x3e')]=='in'?{[exports['sequelize']['Op']['gt']]:0x0}:{[exports['sequelize']['Op']['lt']]:0x0}},'group':[exports[a92_0x1d9a('0x4')]['literal'](a92_0x1d9a('0x3f'))],'order':[[a92_0x1d9a('0x33'),a92_0x1d9a('0x40')]]})[a92_0x1d9a('0x1c')](_0x4e32a0=>{_0x2c75c2[a92_0x1d9a('0x13')]({'data':_0x4e32a0});});};exports[a92_0x1d9a('0x41')]=(_0x1c0d86,_0x58150e)=>{const _0x4dcded=_0x1c0d86[a92_0x1d9a('0x34')][a92_0x1d9a('0x35')];const _0xaada8b=_0x1c0d86[a92_0x1d9a('0x34')][a92_0x1d9a('0x36')];const _0x51e364=_0x1c0d86[a92_0x1d9a('0x34')][a92_0x1d9a('0x37')];exports['sequelize'][a92_0x1d9a('0x14')][a92_0x1d9a('0x30')][a92_0x1d9a('0x32')]({'attributes':[a92_0x1d9a('0x33'),[exports[a92_0x1d9a('0x4')]['fn'](a92_0x1d9a('0x42'),exports[a92_0x1d9a('0x4')]['col'](a92_0x1d9a('0x33')),a92_0x1d9a('0x43')),a92_0x1d9a('0x44')],[exports[a92_0x1d9a('0x4')]['fn'](a92_0x1d9a('0x38'),exports[a92_0x1d9a('0x4')][a92_0x1d9a('0x39')](a92_0x1d9a('0x3a'))),a92_0x1d9a('0x3b')]],'where':{'countingDate':{[exports[a92_0x1d9a('0x4')]['Op']['gte']]:_0xaada8b,[exports[a92_0x1d9a('0x4')]['Op']['lt']]:_0x51e364},'amount':_0x1c0d86[a92_0x1d9a('0x3d')][a92_0x1d9a('0x3e')]=='in'?{[exports[a92_0x1d9a('0x4')]['Op']['gt']]:0x0}:{[exports['sequelize']['Op']['lt']]:0x0}},'group':[exports[a92_0x1d9a('0x4')]['fn'](a92_0x1d9a('0x45'),exports[a92_0x1d9a('0x4')][a92_0x1d9a('0x39')]('countingDate')),exports[a92_0x1d9a('0x4')]['fn'](a92_0x1d9a('0x46'),exports[a92_0x1d9a('0x4')]['col'](a92_0x1d9a('0x33'))),exports[a92_0x1d9a('0x4')]['fn']('MONTH',exports[a92_0x1d9a('0x4')][a92_0x1d9a('0x39')](a92_0x1d9a('0x33'))),exports[a92_0x1d9a('0x4')]['fn'](a92_0x1d9a('0x47'),exports['sequelize'][a92_0x1d9a('0x39')]('countingDate'))],'order':[[a92_0x1d9a('0x33'),'ASC']]})[a92_0x1d9a('0x1c')](_0x4f35a9=>{_0x58150e[a92_0x1d9a('0x13')]({'data':_0x4f35a9});});};exports['getFacebook']=(_0x262e88,_0x5e11c5,_0x32766b)=>{const _0x485d10=_0x262e88[a92_0x1d9a('0x48')][a92_0x1d9a('0x49')]['find'](_0x485d10=>_0x485d10[a92_0x1d9a('0x4a')]===a92_0x1d9a('0x4b'));fbgraph_1[a92_0x1d9a('0xc')][a92_0x1d9a('0x4c')](_0x485d10[a92_0x1d9a('0x4d')]);fbgraph_1[a92_0x1d9a('0xc')]['get'](_0x262e88[a92_0x1d9a('0x48')][a92_0x1d9a('0x4b')]+a92_0x1d9a('0x4e'),(_0x138b15,_0x21d416)=>{if(_0x138b15){return _0x32766b(_0x138b15);}_0x5e11c5[a92_0x1d9a('0x6')](a92_0x1d9a('0x4f'),{'title':'Facebook\x20API','profile':_0x21d416});});};
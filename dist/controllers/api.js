var a198_0x309b=['ftp','sequelize','setSequelize','getApi','render','api/index','syncFtp','connecting','ready','log','connected','list','colombia','name','endsWith','json','models','reportFiles','spread','push','connect','ipd','findOne','connected:','fileName','colombia/','end','media/','.txt','pipe','default','save','Downloaded:\x20','error','ftp.vivotek.com','processFtp','then','readFile','utf8','parse','Data','CountingInfo','EndTime','create','passes','status','getPassCounting','countingDate','getPassCountingByDay','query','month','startDate','endDate','sum','col','total','gte','params','direction','literal','YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))','ASC','getPassCountingByHour','DATE_FORMAT','%Y-%m-%d\x20%H:00','amount','HOUR','DAY','MONTH','YEAR','getFacebook','user','tokens','find','accessToken','get','facebook','?fields=id,name,email,first_name,last_name,gender,link,locale,timezone','api/facebook','Facebook\x20API','__importDefault','defineProperty','__esModule','fbgraph'];(function(_0x284f8d,_0x19b975){var _0x46d429=function(_0xa769a5){while(--_0xa769a5){_0x284f8d['push'](_0x284f8d['shift']());}};_0x46d429(++_0x19b975);}(a198_0x309b,0xf8));var a198_0x1059=function(_0x4ee39e,_0xda3cf0){_0x4ee39e=_0x4ee39e-0x0;var _0x467dab=a198_0x309b[_0x4ee39e];return _0x467dab;};'use strict';var __importDefault=this&&this[a198_0x1059('0x0')]||function(_0x42a4e5){return _0x42a4e5&&_0x42a4e5['__esModule']?_0x42a4e5:{'default':_0x42a4e5};};Object[a198_0x1059('0x1')](exports,a198_0x1059('0x2'),{'value':!![]});const fbgraph_1=__importDefault(require(a198_0x1059('0x3')));const ftp_1=__importDefault(require(a198_0x1059('0x4')));const fs_1=__importDefault(require('fs'));function setSequelize(_0x4aa106){exports[a198_0x1059('0x5')]=_0x4aa106;}exports[a198_0x1059('0x6')]=setSequelize;exports[a198_0x1059('0x7')]=(_0x1f6976,_0x220b8c)=>{_0x220b8c[a198_0x1059('0x8')](a198_0x1059('0x9'),{'title':'API\x20Examples'});};exports[a198_0x1059('0xa')]=(_0x8b13f4,_0x1abdf8)=>{console['log'](a198_0x1059('0xb'));const _0x365130=[];const _0x293dbb=new ftp_1['default']();_0x293dbb['on'](a198_0x1059('0xc'),function(){console[a198_0x1059('0xd')](a198_0x1059('0xe'));_0x293dbb[a198_0x1059('0xf')](a198_0x1059('0x10'),![],function(_0x255c17,_0x71236b){if(_0x255c17){}else{for(const _0x4a92b1 of _0x71236b){console['log']('Downloading:\x20'+_0x4a92b1[a198_0x1059('0x11')]);if(_0x4a92b1[a198_0x1059('0x11')][a198_0x1059('0x12')](a198_0x1059('0x13'))){exports[a198_0x1059('0x5')][a198_0x1059('0x14')][a198_0x1059('0x15')]['findOrCreate']({'where':{'fileName':_0x4a92b1['name']}})[a198_0x1059('0x16')]((_0x43b102,_0x14ebce)=>{if(_0x14ebce){console[a198_0x1059('0xd')](_0x4a92b1['name']);_0x365130[a198_0x1059('0x17')](_0x43b102);}});}}}_0x1abdf8[a198_0x1059('0x13')]({'data':_0x365130});});});_0x293dbb['on']('error',function(_0xfdb44e){_0x1abdf8['json']({'message':_0xfdb44e});});_0x293dbb[a198_0x1059('0x18')]({'host':'ftp.vivotek.com','port':0x15,'user':a198_0x1059('0x19'),'password':a198_0x1059('0x19')});};exports['downloadFtp']=(_0x47067d,_0x47c02d)=>{exports[a198_0x1059('0x5')]['models'][a198_0x1059('0x15')][a198_0x1059('0x1a')]({'where':{'status':null}})['then'](_0x2f9d18=>{if(_0x2f9d18){const _0x35a032=new ftp_1['default']();_0x35a032['on'](a198_0x1059('0xc'),function(){console['log'](a198_0x1059('0x1b')+_0x2f9d18[a198_0x1059('0x1c')]);_0x35a032['get'](a198_0x1059('0x1d')+_0x2f9d18['fileName'],function(_0x377258,_0x117e83){_0x35a032[a198_0x1059('0x1e')]();if(_0x377258){}else{const _0x5339dc=a198_0x1059('0x1f')+_0x2f9d18[a198_0x1059('0x1c')]+a198_0x1059('0x20');_0x117e83[a198_0x1059('0x21')](fs_1[a198_0x1059('0x22')]['createWriteStream'](_0x5339dc));_0x2f9d18['status']=0x1;_0x2f9d18[a198_0x1059('0x23')]();console['log'](a198_0x1059('0x24')+_0x2f9d18[a198_0x1059('0x1c')]);}});});_0x35a032['on'](a198_0x1059('0x25'),function(_0xa5f601){_0x47c02d[a198_0x1059('0x13')]({'message':_0xa5f601});});_0x35a032[a198_0x1059('0x18')]({'host':a198_0x1059('0x26'),'port':0x15,'user':a198_0x1059('0x19'),'password':'ipd'});_0x47c02d[a198_0x1059('0x13')]({'data':_0x2f9d18[a198_0x1059('0x1c')]});}else{_0x47c02d['json']({'data':[]});}});};exports[a198_0x1059('0x27')]=(_0xcc9341,_0x2704a1)=>{exports[a198_0x1059('0x5')][a198_0x1059('0x14')]['reportFiles'][a198_0x1059('0x1a')]({'where':{'status':0x1}})[a198_0x1059('0x28')](_0x270975=>{if(_0x270975){const _0x38ba29=a198_0x1059('0x1f')+_0x270975['fileName']+a198_0x1059('0x20');fs_1[a198_0x1059('0x22')][a198_0x1059('0x29')](_0x38ba29,a198_0x1059('0x2a'),function(_0x78cca3,_0x35bba3){if(_0x78cca3){_0x270975['status']=null;}else{try{const _0x5e653f=JSON[a198_0x1059('0x2b')](_0x35bba3);for(const _0x3f2f37 of _0x5e653f[a198_0x1059('0x2c')][0x0][a198_0x1059('0x2d')]){const _0x49af76=_0x3f2f37['In'];const _0x500928=_0x3f2f37['Out'];const _0x28944c=Date['parse'](_0x3f2f37[a198_0x1059('0x2e')]);if(_0x49af76>0x0){exports[a198_0x1059('0x5')][a198_0x1059('0x14')]['passes'][a198_0x1059('0x2f')]({'reportFileId':_0x270975['id'],'amount':_0x49af76,'countingDate':_0x28944c});}if(_0x500928>0x0){exports[a198_0x1059('0x5')][a198_0x1059('0x14')][a198_0x1059('0x30')][a198_0x1059('0x2f')]({'reportFileId':_0x270975['id'],'amount':_0x500928*-0x1,'countingDate':_0x28944c});}}_0x270975['status']=0x2;}catch(_0x341db3){_0x270975[a198_0x1059('0x31')]=null;}}_0x270975[a198_0x1059('0x23')]();});_0x2704a1[a198_0x1059('0x13')]({'data':_0x270975[a198_0x1059('0x1c')]});}else{_0x2704a1[a198_0x1059('0x13')]({'data':[]});}});};exports[a198_0x1059('0x32')]=(_0xd64789,_0x5f3807)=>{exports[a198_0x1059('0x5')][a198_0x1059('0x14')][a198_0x1059('0x30')]['findAll']({'where':{'amount':{[exports[a198_0x1059('0x5')]['Op']['gt']]:0x0}},'order':[[a198_0x1059('0x33'),'ASC']]})[a198_0x1059('0x28')](_0x1673e1=>{_0x5f3807[a198_0x1059('0x13')]({'data':_0x1673e1});});};exports[a198_0x1059('0x34')]=(_0x54c9e3,_0x3d0589)=>{const _0x1f933d=_0x54c9e3[a198_0x1059('0x35')][a198_0x1059('0x36')];const _0x19434a=_0x54c9e3[a198_0x1059('0x35')][a198_0x1059('0x37')];const _0x2ed4ef=_0x54c9e3['query'][a198_0x1059('0x38')];exports[a198_0x1059('0x5')][a198_0x1059('0x14')][a198_0x1059('0x30')]['findAll']({'attributes':['countingDate',[exports[a198_0x1059('0x5')]['fn'](a198_0x1059('0x39'),exports['sequelize'][a198_0x1059('0x3a')]('amount')),a198_0x1059('0x3b')]],'where':{'countingDate':{[exports['sequelize']['Op'][a198_0x1059('0x3c')]]:_0x19434a,[exports[a198_0x1059('0x5')]['Op']['lt']]:_0x2ed4ef},'amount':_0x54c9e3[a198_0x1059('0x3d')][a198_0x1059('0x3e')]=='in'?{[exports['sequelize']['Op']['gt']]:0x0}:{[exports['sequelize']['Op']['lt']]:0x0}},'group':[exports['sequelize'][a198_0x1059('0x3f')](a198_0x1059('0x40'))],'order':[[a198_0x1059('0x33'),a198_0x1059('0x41')]]})[a198_0x1059('0x28')](_0xd7d781=>{_0x3d0589['json']({'data':_0xd7d781});});};exports[a198_0x1059('0x42')]=(_0x48d986,_0x3b5f67)=>{const _0x5c253b=_0x48d986[a198_0x1059('0x35')][a198_0x1059('0x36')];const _0x38d425=_0x48d986[a198_0x1059('0x35')][a198_0x1059('0x37')];const _0x36d453=_0x48d986[a198_0x1059('0x35')][a198_0x1059('0x38')];exports[a198_0x1059('0x5')][a198_0x1059('0x14')]['passes']['findAll']({'attributes':[a198_0x1059('0x33'),[exports[a198_0x1059('0x5')]['fn'](a198_0x1059('0x43'),exports[a198_0x1059('0x5')]['col'](a198_0x1059('0x33')),a198_0x1059('0x44')),'countingDateShort'],[exports['sequelize']['fn'](a198_0x1059('0x39'),exports[a198_0x1059('0x5')][a198_0x1059('0x3a')](a198_0x1059('0x45'))),a198_0x1059('0x3b')]],'where':{'countingDate':{[exports[a198_0x1059('0x5')]['Op'][a198_0x1059('0x3c')]]:_0x38d425,[exports[a198_0x1059('0x5')]['Op']['lt']]:_0x36d453},'amount':_0x48d986[a198_0x1059('0x3d')][a198_0x1059('0x3e')]=='in'?{[exports['sequelize']['Op']['gt']]:0x0}:{[exports[a198_0x1059('0x5')]['Op']['lt']]:0x0}},'group':[exports['sequelize']['fn'](a198_0x1059('0x46'),exports['sequelize'][a198_0x1059('0x3a')]('countingDate')),exports[a198_0x1059('0x5')]['fn'](a198_0x1059('0x47'),exports[a198_0x1059('0x5')]['col']('countingDate')),exports[a198_0x1059('0x5')]['fn'](a198_0x1059('0x48'),exports['sequelize']['col'](a198_0x1059('0x33'))),exports[a198_0x1059('0x5')]['fn'](a198_0x1059('0x49'),exports['sequelize'][a198_0x1059('0x3a')](a198_0x1059('0x33')))],'order':[[a198_0x1059('0x33'),a198_0x1059('0x41')]]})[a198_0x1059('0x28')](_0x27968d=>{_0x3b5f67[a198_0x1059('0x13')]({'data':_0x27968d});});};exports[a198_0x1059('0x4a')]=(_0x57f810,_0x3f8c76,_0x481760)=>{const _0x1952bb=_0x57f810[a198_0x1059('0x4b')][a198_0x1059('0x4c')][a198_0x1059('0x4d')](_0x1952bb=>_0x1952bb['kind']==='facebook');fbgraph_1[a198_0x1059('0x22')]['setAccessToken'](_0x1952bb[a198_0x1059('0x4e')]);fbgraph_1['default'][a198_0x1059('0x4f')](_0x57f810[a198_0x1059('0x4b')][a198_0x1059('0x50')]+a198_0x1059('0x51'),(_0x4e353e,_0x273b41)=>{if(_0x4e353e){return _0x481760(_0x4e353e);}_0x3f8c76[a198_0x1059('0x8')](a198_0x1059('0x52'),{'title':a198_0x1059('0x53'),'profile':_0x273b41});});};
var a198_0x445e=['Out','EndTime','passes','create','getPassCounting','findAll','countingDate','ASC','getPassCountingByDay','query','month','startDate','sum','amount','gte','params','direction','literal','YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))','getPassCountingByHour','endDate','DATE_FORMAT','col','countingDateShort','total','MONTH','YEAR','user','tokens','kind','facebook','setAccessToken','get','?fields=id,name,email,first_name,last_name,gender,link,locale,timezone','api/facebook','__esModule','defineProperty','fbgraph','ftp','sequelize','setSequelize','getApi','render','api/index','API\x20Examples','syncFtp','log','connecting','default','ready','connected','list','colombia','Downloading:\x20','name','endsWith','json','models','findOrCreate','spread','push','error','connect','ftp.vivotek.com','ipd','downloadFtp','then','connected:','fileName','colombia/','end','pipe','createWriteStream','status','save','Downloaded:\x20','processFtp','reportFiles','findOne','media/','.txt','readFile','utf8','parse','Data','CountingInfo'];(function(_0x39b0c6,_0x45eebc){var _0x41532b=function(_0x6b10cc){while(--_0x6b10cc){_0x39b0c6['push'](_0x39b0c6['shift']());}};_0x41532b(++_0x45eebc);}(a198_0x445e,0x79));var a198_0x24ed=function(_0x37367f,_0x4b7570){_0x37367f=_0x37367f-0x0;var _0x1e2352=a198_0x445e[_0x37367f];return _0x1e2352;};'use strict';var __importDefault=this&&this['__importDefault']||function(_0x363d91){return _0x363d91&&_0x363d91[a198_0x24ed('0x0')]?_0x363d91:{'default':_0x363d91};};Object[a198_0x24ed('0x1')](exports,a198_0x24ed('0x0'),{'value':!![]});const fbgraph_1=__importDefault(require(a198_0x24ed('0x2')));const ftp_1=__importDefault(require(a198_0x24ed('0x3')));const fs_1=__importDefault(require('fs'));function setSequelize(_0x49bee0){exports[a198_0x24ed('0x4')]=_0x49bee0;}exports[a198_0x24ed('0x5')]=setSequelize;exports[a198_0x24ed('0x6')]=(_0x5b70b4,_0x237c74)=>{_0x237c74[a198_0x24ed('0x7')](a198_0x24ed('0x8'),{'title':a198_0x24ed('0x9')});};exports[a198_0x24ed('0xa')]=(_0x2127f8,_0x2034b4)=>{console[a198_0x24ed('0xb')](a198_0x24ed('0xc'));const _0x315104=[];const _0x2bcf5c=new ftp_1[(a198_0x24ed('0xd'))]();_0x2bcf5c['on'](a198_0x24ed('0xe'),function(){console[a198_0x24ed('0xb')](a198_0x24ed('0xf'));_0x2bcf5c[a198_0x24ed('0x10')](a198_0x24ed('0x11'),![],function(_0x5718d3,_0x3b1edf){if(_0x5718d3){}else{for(const _0x45f688 of _0x3b1edf){console['log'](a198_0x24ed('0x12')+_0x45f688[a198_0x24ed('0x13')]);if(_0x45f688[a198_0x24ed('0x13')][a198_0x24ed('0x14')](a198_0x24ed('0x15'))){exports[a198_0x24ed('0x4')][a198_0x24ed('0x16')]['reportFiles'][a198_0x24ed('0x17')]({'where':{'fileName':_0x45f688[a198_0x24ed('0x13')]}})[a198_0x24ed('0x18')]((_0x506a85,_0x28a64d)=>{if(_0x28a64d){console[a198_0x24ed('0xb')](_0x45f688['name']);_0x315104[a198_0x24ed('0x19')](_0x506a85);}});}}}_0x2034b4[a198_0x24ed('0x15')]({'data':_0x315104});});});_0x2bcf5c['on'](a198_0x24ed('0x1a'),function(_0x4e32bb){_0x2034b4[a198_0x24ed('0x15')]({'message':_0x4e32bb});});_0x2bcf5c[a198_0x24ed('0x1b')]({'host':a198_0x24ed('0x1c'),'port':0x15,'user':a198_0x24ed('0x1d'),'password':a198_0x24ed('0x1d')});};exports[a198_0x24ed('0x1e')]=(_0x5abd13,_0x1a254c)=>{exports['sequelize'][a198_0x24ed('0x16')]['reportFiles']['findOne']({'where':{'status':null}})[a198_0x24ed('0x1f')](_0x4b725c=>{if(_0x4b725c){const _0x13289e=new ftp_1['default']();_0x13289e['on'](a198_0x24ed('0xe'),function(){console[a198_0x24ed('0xb')](a198_0x24ed('0x20')+_0x4b725c[a198_0x24ed('0x21')]);_0x13289e['get'](a198_0x24ed('0x22')+_0x4b725c[a198_0x24ed('0x21')],function(_0x5eaa97,_0x453e0b){_0x13289e[a198_0x24ed('0x23')]();if(_0x5eaa97){}else{const _0x4483c5='media/'+_0x4b725c['fileName']+'.txt';_0x453e0b[a198_0x24ed('0x24')](fs_1['default'][a198_0x24ed('0x25')](_0x4483c5));_0x4b725c[a198_0x24ed('0x26')]=0x1;_0x4b725c[a198_0x24ed('0x27')]();console[a198_0x24ed('0xb')](a198_0x24ed('0x28')+_0x4b725c[a198_0x24ed('0x21')]);}});});_0x13289e['on'](a198_0x24ed('0x1a'),function(_0x14b405){_0x1a254c[a198_0x24ed('0x15')]({'message':_0x14b405});});_0x13289e[a198_0x24ed('0x1b')]({'host':'ftp.vivotek.com','port':0x15,'user':'ipd','password':'ipd'});_0x1a254c[a198_0x24ed('0x15')]({'data':_0x4b725c[a198_0x24ed('0x21')]});}else{_0x1a254c[a198_0x24ed('0x15')]({'data':[]});}});};exports[a198_0x24ed('0x29')]=(_0x5db920,_0x392772)=>{exports[a198_0x24ed('0x4')][a198_0x24ed('0x16')][a198_0x24ed('0x2a')][a198_0x24ed('0x2b')]({'where':{'status':0x1}})[a198_0x24ed('0x1f')](_0x2d0302=>{if(_0x2d0302){const _0x1c056f=a198_0x24ed('0x2c')+_0x2d0302['fileName']+a198_0x24ed('0x2d');fs_1[a198_0x24ed('0xd')][a198_0x24ed('0x2e')](_0x1c056f,a198_0x24ed('0x2f'),function(_0x125e79,_0x8e07a3){if(_0x125e79){_0x2d0302[a198_0x24ed('0x26')]=null;}else{try{const _0x5a5cb2=JSON[a198_0x24ed('0x30')](_0x8e07a3);for(const _0x4be411 of _0x5a5cb2[a198_0x24ed('0x31')][0x0][a198_0x24ed('0x32')]){const _0x41b13a=_0x4be411['In'];const _0x512d67=_0x4be411[a198_0x24ed('0x33')];const _0xc44706=Date[a198_0x24ed('0x30')](_0x4be411[a198_0x24ed('0x34')]);if(_0x41b13a>0x0){exports[a198_0x24ed('0x4')][a198_0x24ed('0x16')][a198_0x24ed('0x35')]['create']({'reportFileId':_0x2d0302['id'],'amount':_0x41b13a,'countingDate':_0xc44706});}if(_0x512d67>0x0){exports[a198_0x24ed('0x4')]['models']['passes'][a198_0x24ed('0x36')]({'reportFileId':_0x2d0302['id'],'amount':_0x512d67*-0x1,'countingDate':_0xc44706});}}_0x2d0302[a198_0x24ed('0x26')]=0x2;}catch(_0x444e19){_0x2d0302[a198_0x24ed('0x26')]=null;}}_0x2d0302[a198_0x24ed('0x27')]();});_0x392772['json']({'data':_0x2d0302[a198_0x24ed('0x21')]});}else{_0x392772['json']({'data':[]});}});};exports[a198_0x24ed('0x37')]=(_0x2978fa,_0x127602)=>{exports[a198_0x24ed('0x4')][a198_0x24ed('0x16')]['passes'][a198_0x24ed('0x38')]({'where':{'amount':{[exports['sequelize']['Op']['gt']]:0x0}},'order':[[a198_0x24ed('0x39'),a198_0x24ed('0x3a')]]})[a198_0x24ed('0x1f')](_0x2a1c1e=>{_0x127602[a198_0x24ed('0x15')]({'data':_0x2a1c1e});});};exports[a198_0x24ed('0x3b')]=(_0xea5e5b,_0x17f246)=>{const _0xf9bfaf=_0xea5e5b[a198_0x24ed('0x3c')][a198_0x24ed('0x3d')];const _0x57c280=_0xea5e5b[a198_0x24ed('0x3c')][a198_0x24ed('0x3e')];const _0x534eb9=_0xea5e5b[a198_0x24ed('0x3c')]['endDate'];exports[a198_0x24ed('0x4')][a198_0x24ed('0x16')]['passes'][a198_0x24ed('0x38')]({'attributes':[a198_0x24ed('0x39'),[exports[a198_0x24ed('0x4')]['fn'](a198_0x24ed('0x3f'),exports[a198_0x24ed('0x4')]['col'](a198_0x24ed('0x40'))),'total']],'where':{'countingDate':{[exports['sequelize']['Op'][a198_0x24ed('0x41')]]:_0x57c280,[exports['sequelize']['Op']['lt']]:_0x534eb9},'amount':_0xea5e5b[a198_0x24ed('0x42')][a198_0x24ed('0x43')]=='in'?{[exports[a198_0x24ed('0x4')]['Op']['gt']]:0x0}:{[exports['sequelize']['Op']['lt']]:0x0}},'group':[exports[a198_0x24ed('0x4')][a198_0x24ed('0x44')](a198_0x24ed('0x45'))],'order':[[a198_0x24ed('0x39'),'ASC']]})['then'](_0x252bdc=>{_0x17f246[a198_0x24ed('0x15')]({'data':_0x252bdc});});};exports[a198_0x24ed('0x46')]=(_0xf2f11c,_0x2be2a9)=>{const _0x496a27=_0xf2f11c[a198_0x24ed('0x3c')][a198_0x24ed('0x3d')];const _0x3a8721=_0xf2f11c[a198_0x24ed('0x3c')][a198_0x24ed('0x3e')];const _0x520132=_0xf2f11c['query'][a198_0x24ed('0x47')];exports[a198_0x24ed('0x4')]['models']['passes'][a198_0x24ed('0x38')]({'attributes':['countingDate',[exports[a198_0x24ed('0x4')]['fn'](a198_0x24ed('0x48'),exports['sequelize'][a198_0x24ed('0x49')]('countingDate'),'%Y-%m-%d\x20%H:00'),a198_0x24ed('0x4a')],[exports[a198_0x24ed('0x4')]['fn'](a198_0x24ed('0x3f'),exports[a198_0x24ed('0x4')][a198_0x24ed('0x49')](a198_0x24ed('0x40'))),a198_0x24ed('0x4b')]],'where':{'countingDate':{[exports[a198_0x24ed('0x4')]['Op'][a198_0x24ed('0x41')]]:_0x3a8721,[exports['sequelize']['Op']['lt']]:_0x520132},'amount':_0xf2f11c['params'][a198_0x24ed('0x43')]=='in'?{[exports['sequelize']['Op']['gt']]:0x0}:{[exports[a198_0x24ed('0x4')]['Op']['lt']]:0x0}},'group':[exports[a198_0x24ed('0x4')]['fn']('HOUR',exports[a198_0x24ed('0x4')][a198_0x24ed('0x49')]('countingDate')),exports[a198_0x24ed('0x4')]['fn']('DAY',exports[a198_0x24ed('0x4')][a198_0x24ed('0x49')](a198_0x24ed('0x39'))),exports['sequelize']['fn'](a198_0x24ed('0x4c'),exports['sequelize'][a198_0x24ed('0x49')](a198_0x24ed('0x39'))),exports['sequelize']['fn'](a198_0x24ed('0x4d'),exports[a198_0x24ed('0x4')][a198_0x24ed('0x49')](a198_0x24ed('0x39')))],'order':[[a198_0x24ed('0x39'),a198_0x24ed('0x3a')]]})[a198_0x24ed('0x1f')](_0x3dfeeb=>{_0x2be2a9[a198_0x24ed('0x15')]({'data':_0x3dfeeb});});};exports['getFacebook']=(_0x693bb4,_0x11c0e1,_0x1ce2f3)=>{const _0x2da2a3=_0x693bb4[a198_0x24ed('0x4e')][a198_0x24ed('0x4f')]['find'](_0x2da2a3=>_0x2da2a3[a198_0x24ed('0x50')]===a198_0x24ed('0x51'));fbgraph_1[a198_0x24ed('0xd')][a198_0x24ed('0x52')](_0x2da2a3['accessToken']);fbgraph_1[a198_0x24ed('0xd')][a198_0x24ed('0x53')](_0x693bb4[a198_0x24ed('0x4e')][a198_0x24ed('0x51')]+a198_0x24ed('0x54'),(_0x28a6b3,_0x482232)=>{if(_0x28a6b3){return _0x1ce2f3(_0x28a6b3);}_0x11c0e1[a198_0x24ed('0x7')](a198_0x24ed('0x55'),{'title':'Facebook\x20API','profile':_0x482232});});};
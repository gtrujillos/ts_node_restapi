var a92_0x3c1c=['status','Downloaded:\x20','error','processFtp','then','readFile','utf8','parse','Data','CountingInfo','Out','EndTime','create','save','passes','findAll','countingDate','ASC','getPassCountingByDay','query','month','startDate','endDate','sum','col','amount','total','params','direction','literal','YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))','getPassCountingByHour','DATE_FORMAT','%Y-%m-%d\x20%H:00','countingDateShort','DAY','tokens','find','facebook','setAccessToken','accessToken','user','?fields=id,name,email,first_name,last_name,gender,link,locale,timezone','render','api/facebook','Facebook\x20API','__importDefault','__esModule','defineProperty','fbgraph','ftp','sequelize','setSequelize','api/index','API\x20Examples','connecting','default','log','connected','list','colombia','Downloading:\x20','name','endsWith','json','models','reportFiles','findOrCreate','spread','connect','ftp.vivotek.com','ipd','downloadFtp','findOne','ready','connected:','fileName','get','colombia/','end','media/','.txt','pipe','createWriteStream'];(function(_0x2f184b,_0x150adb){var _0x66a54d=function(_0x51fe1d){while(--_0x51fe1d){_0x2f184b['push'](_0x2f184b['shift']());}};_0x66a54d(++_0x150adb);}(a92_0x3c1c,0x12a));var a92_0x296e=function(_0x3ad365,_0xdb5150){_0x3ad365=_0x3ad365-0x0;var _0x7f152a=a92_0x3c1c[_0x3ad365];return _0x7f152a;};'use strict';var __importDefault=this&&this[a92_0x296e('0x0')]||function(_0x31cbf6){return _0x31cbf6&&_0x31cbf6[a92_0x296e('0x1')]?_0x31cbf6:{'default':_0x31cbf6};};Object[a92_0x296e('0x2')](exports,a92_0x296e('0x1'),{'value':!![]});const fbgraph_1=__importDefault(require(a92_0x296e('0x3')));const ftp_1=__importDefault(require(a92_0x296e('0x4')));const fs_1=__importDefault(require('fs'));function setSequelize(_0x4f1af2){exports[a92_0x296e('0x5')]=_0x4f1af2;}exports[a92_0x296e('0x6')]=setSequelize;exports['getApi']=(_0x12f96a,_0x1d71da)=>{_0x1d71da['render'](a92_0x296e('0x7'),{'title':a92_0x296e('0x8')});};exports['syncFtp']=(_0x1ce7fb,_0x205bb8)=>{console['log'](a92_0x296e('0x9'));const _0x39cbcb=[];const _0x102652=new ftp_1[(a92_0x296e('0xa'))]();_0x102652['on']('ready',function(){console[a92_0x296e('0xb')](a92_0x296e('0xc'));_0x102652[a92_0x296e('0xd')](a92_0x296e('0xe'),![],function(_0x2c2f89,_0x2752d1){if(_0x2c2f89){}else{for(const _0x1c536c of _0x2752d1){console['log'](a92_0x296e('0xf')+_0x1c536c[a92_0x296e('0x10')]);if(_0x1c536c[a92_0x296e('0x10')][a92_0x296e('0x11')](a92_0x296e('0x12'))){exports[a92_0x296e('0x5')][a92_0x296e('0x13')][a92_0x296e('0x14')][a92_0x296e('0x15')]({'where':{'fileName':_0x1c536c[a92_0x296e('0x10')]}})[a92_0x296e('0x16')]((_0x57d2dc,_0x5f85eb)=>{if(_0x5f85eb){console[a92_0x296e('0xb')](_0x1c536c[a92_0x296e('0x10')]);_0x39cbcb['push'](_0x57d2dc);}});}}}_0x205bb8[a92_0x296e('0x12')]({'data':_0x39cbcb});});});_0x102652['on']('error',function(_0x5634d1){_0x205bb8[a92_0x296e('0x12')]({'message':_0x5634d1});});_0x102652[a92_0x296e('0x17')]({'host':a92_0x296e('0x18'),'port':0x15,'user':a92_0x296e('0x19'),'password':a92_0x296e('0x19')});};exports[a92_0x296e('0x1a')]=(_0x3caaa2,_0x39e48d)=>{exports[a92_0x296e('0x5')][a92_0x296e('0x13')][a92_0x296e('0x14')][a92_0x296e('0x1b')]({'where':{'status':null}})['then'](_0x26ff7d=>{if(_0x26ff7d){const _0x494412=new ftp_1['default']();_0x494412['on'](a92_0x296e('0x1c'),function(){console['log'](a92_0x296e('0x1d')+_0x26ff7d[a92_0x296e('0x1e')]);_0x494412[a92_0x296e('0x1f')](a92_0x296e('0x20')+_0x26ff7d[a92_0x296e('0x1e')],function(_0x5c940c,_0x45bfa8){_0x494412[a92_0x296e('0x21')]();if(_0x5c940c){}else{const _0x92d06e=a92_0x296e('0x22')+_0x26ff7d[a92_0x296e('0x1e')]+a92_0x296e('0x23');_0x45bfa8[a92_0x296e('0x24')](fs_1[a92_0x296e('0xa')][a92_0x296e('0x25')](_0x92d06e));_0x26ff7d[a92_0x296e('0x26')]=0x1;_0x26ff7d['save']();console['log'](a92_0x296e('0x27')+_0x26ff7d['fileName']);}});});_0x494412['on'](a92_0x296e('0x28'),function(_0x2eb71d){_0x39e48d[a92_0x296e('0x12')]({'message':_0x2eb71d});});_0x494412[a92_0x296e('0x17')]({'host':'ftp.vivotek.com','port':0x15,'user':a92_0x296e('0x19'),'password':a92_0x296e('0x19')});_0x39e48d[a92_0x296e('0x12')]({'data':_0x26ff7d[a92_0x296e('0x1e')]});}else{_0x39e48d[a92_0x296e('0x12')]({'data':[]});}});};exports[a92_0x296e('0x29')]=(_0x5dfaba,_0xfab2ed)=>{exports[a92_0x296e('0x5')]['models'][a92_0x296e('0x14')][a92_0x296e('0x1b')]({'where':{'status':0x1}})[a92_0x296e('0x2a')](_0x22d561=>{if(_0x22d561){const _0x4cacd0='media/'+_0x22d561['fileName']+a92_0x296e('0x23');fs_1[a92_0x296e('0xa')][a92_0x296e('0x2b')](_0x4cacd0,a92_0x296e('0x2c'),function(_0x174ca5,_0x48c9f0){if(_0x174ca5){_0x22d561[a92_0x296e('0x26')]=null;}else{try{const _0x215ef4=JSON[a92_0x296e('0x2d')](_0x48c9f0);for(const _0x41a759 of _0x215ef4[a92_0x296e('0x2e')][0x0][a92_0x296e('0x2f')]){const _0x4d0245=_0x41a759['In'];const _0x2ebcdc=_0x41a759[a92_0x296e('0x30')];const _0x43d5db=Date['parse'](_0x41a759[a92_0x296e('0x31')]);if(_0x4d0245>0x0){exports[a92_0x296e('0x5')]['models']['passes'][a92_0x296e('0x32')]({'reportFileId':_0x22d561['id'],'amount':_0x4d0245,'countingDate':_0x43d5db});}if(_0x2ebcdc>0x0){exports[a92_0x296e('0x5')][a92_0x296e('0x13')]['passes'][a92_0x296e('0x32')]({'reportFileId':_0x22d561['id'],'amount':_0x2ebcdc*-0x1,'countingDate':_0x43d5db});}}_0x22d561[a92_0x296e('0x26')]=0x2;}catch(_0x3a0236){_0x22d561[a92_0x296e('0x26')]=null;}}_0x22d561[a92_0x296e('0x33')]();});_0xfab2ed[a92_0x296e('0x12')]({'data':_0x22d561[a92_0x296e('0x1e')]});}else{_0xfab2ed[a92_0x296e('0x12')]({'data':[]});}});};exports['getPassCounting']=(_0x16e7ba,_0x202020)=>{exports[a92_0x296e('0x5')][a92_0x296e('0x13')][a92_0x296e('0x34')][a92_0x296e('0x35')]({'where':{'amount':{[exports[a92_0x296e('0x5')]['Op']['gt']]:0x0}},'order':[[a92_0x296e('0x36'),a92_0x296e('0x37')]]})[a92_0x296e('0x2a')](_0x50d6db=>{_0x202020[a92_0x296e('0x12')]({'data':_0x50d6db});});};exports[a92_0x296e('0x38')]=(_0x439e20,_0x3fa709)=>{const _0x505255=_0x439e20[a92_0x296e('0x39')][a92_0x296e('0x3a')];const _0x5e02f6=_0x439e20[a92_0x296e('0x39')][a92_0x296e('0x3b')];const _0x2936c3=_0x439e20[a92_0x296e('0x39')][a92_0x296e('0x3c')];exports[a92_0x296e('0x5')][a92_0x296e('0x13')][a92_0x296e('0x34')][a92_0x296e('0x35')]({'attributes':['countingDate',[exports['sequelize']['fn'](a92_0x296e('0x3d'),exports[a92_0x296e('0x5')][a92_0x296e('0x3e')](a92_0x296e('0x3f'))),a92_0x296e('0x40')]],'where':{'countingDate':{[exports[a92_0x296e('0x5')]['Op']['gte']]:_0x5e02f6,[exports[a92_0x296e('0x5')]['Op']['lt']]:_0x2936c3},'amount':_0x439e20[a92_0x296e('0x41')][a92_0x296e('0x42')]=='in'?{[exports[a92_0x296e('0x5')]['Op']['gt']]:0x0}:{[exports[a92_0x296e('0x5')]['Op']['lt']]:0x0}},'group':[exports[a92_0x296e('0x5')][a92_0x296e('0x43')](a92_0x296e('0x44'))],'order':[[a92_0x296e('0x36'),a92_0x296e('0x37')]]})['then'](_0x3534ab=>{_0x3fa709['json']({'data':_0x3534ab});});};exports[a92_0x296e('0x45')]=(_0x4085d8,_0x140ac3)=>{const _0x5c48c8=_0x4085d8['query']['month'];const _0xa0b3fd=_0x4085d8[a92_0x296e('0x39')]['startDate'];const _0x5f2a56=_0x4085d8[a92_0x296e('0x39')][a92_0x296e('0x3c')];exports['sequelize'][a92_0x296e('0x13')][a92_0x296e('0x34')]['findAll']({'attributes':[a92_0x296e('0x36'),[exports[a92_0x296e('0x5')]['fn'](a92_0x296e('0x46'),exports[a92_0x296e('0x5')][a92_0x296e('0x3e')](a92_0x296e('0x36')),a92_0x296e('0x47')),a92_0x296e('0x48')],[exports[a92_0x296e('0x5')]['fn'](a92_0x296e('0x3d'),exports['sequelize'][a92_0x296e('0x3e')](a92_0x296e('0x3f'))),a92_0x296e('0x40')]],'where':{'countingDate':{[exports['sequelize']['Op']['gte']]:_0xa0b3fd,[exports[a92_0x296e('0x5')]['Op']['lt']]:_0x5f2a56},'amount':_0x4085d8['params'][a92_0x296e('0x42')]=='in'?{[exports[a92_0x296e('0x5')]['Op']['gt']]:0x0}:{[exports[a92_0x296e('0x5')]['Op']['lt']]:0x0}},'group':[exports[a92_0x296e('0x5')]['fn']('HOUR',exports['sequelize'][a92_0x296e('0x3e')]('countingDate')),exports[a92_0x296e('0x5')]['fn'](a92_0x296e('0x49'),exports['sequelize'][a92_0x296e('0x3e')](a92_0x296e('0x36'))),exports[a92_0x296e('0x5')]['fn']('MONTH',exports[a92_0x296e('0x5')]['col'](a92_0x296e('0x36'))),exports[a92_0x296e('0x5')]['fn']('YEAR',exports['sequelize'][a92_0x296e('0x3e')](a92_0x296e('0x36')))],'order':[[a92_0x296e('0x36'),a92_0x296e('0x37')]]})['then'](_0x2bbf04=>{_0x140ac3[a92_0x296e('0x12')]({'data':_0x2bbf04});});};exports['getFacebook']=(_0x3e86c8,_0x58c772,_0x32ac78)=>{const _0xe49ea3=_0x3e86c8['user'][a92_0x296e('0x4a')][a92_0x296e('0x4b')](_0xe49ea3=>_0xe49ea3['kind']===a92_0x296e('0x4c'));fbgraph_1[a92_0x296e('0xa')][a92_0x296e('0x4d')](_0xe49ea3[a92_0x296e('0x4e')]);fbgraph_1[a92_0x296e('0xa')]['get'](_0x3e86c8[a92_0x296e('0x4f')][a92_0x296e('0x4c')]+a92_0x296e('0x50'),(_0x147380,_0x693c15)=>{if(_0x147380){return _0x32ac78(_0x147380);}_0x58c772[a92_0x296e('0x51')](a92_0x296e('0x52'),{'title':a92_0x296e('0x53'),'profile':_0x693c15});});};
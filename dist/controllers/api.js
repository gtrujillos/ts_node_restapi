var a198_0x594a=['end','media/','.txt','pipe','createWriteStream','save','Downloaded:\x20','error','ftp.vivotek.com','processFtp','reportFiles','utf8','parse','Out','EndTime','passes','create','status','getPassCounting','findAll','countingDate','getPassCountingByDay','query','month','startDate','endDate','sum','amount','gte','direction','YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))','getPassCountingByHour','DATE_FORMAT','col','countingDateShort','params','HOUR','DAY','user','tokens','find','kind','facebook','?fields=id,name,email,first_name,last_name,gender,link,locale,timezone','render','api/facebook','Facebook\x20API','__importDefault','defineProperty','__esModule','fbgraph','ftp','setSequelize','API\x20Examples','log','connecting','default','list','Downloading:\x20','name','endsWith','json','sequelize','models','spread','push','connect','ipd','downloadFtp','findOne','then','ready','connected:','fileName','get','colombia/'];(function(_0x3d5ced,_0x5ade6f){var _0x39c4cd=function(_0x5adbea){while(--_0x5adbea){_0x3d5ced['push'](_0x3d5ced['shift']());}};_0x39c4cd(++_0x5ade6f);}(a198_0x594a,0xc7));var a198_0x4dee=function(_0x4bd625,_0x3745b7){_0x4bd625=_0x4bd625-0x0;var _0x33743b=a198_0x594a[_0x4bd625];return _0x33743b;};'use strict';var __importDefault=this&&this[a198_0x4dee('0x0')]||function(_0x372f76){return _0x372f76&&_0x372f76['__esModule']?_0x372f76:{'default':_0x372f76};};Object[a198_0x4dee('0x1')](exports,a198_0x4dee('0x2'),{'value':!![]});const fbgraph_1=__importDefault(require(a198_0x4dee('0x3')));const ftp_1=__importDefault(require(a198_0x4dee('0x4')));const fs_1=__importDefault(require('fs'));function setSequelize(_0x24e0cd){exports['sequelize']=_0x24e0cd;}exports[a198_0x4dee('0x5')]=setSequelize;exports['getApi']=(_0x5716e7,_0x1539a2)=>{_0x1539a2['render']('api/index',{'title':a198_0x4dee('0x6')});};exports['syncFtp']=(_0x56a28e,_0x8cb30a)=>{console[a198_0x4dee('0x7')](a198_0x4dee('0x8'));const _0x263a28=[];const _0x46fc33=new ftp_1[(a198_0x4dee('0x9'))]();_0x46fc33['on']('ready',function(){console['log']('connected');_0x46fc33[a198_0x4dee('0xa')]('colombia',![],function(_0x205b09,_0x5ef482){if(_0x205b09){}else{for(const _0x2c7d2e of _0x5ef482){console[a198_0x4dee('0x7')](a198_0x4dee('0xb')+_0x2c7d2e[a198_0x4dee('0xc')]);if(_0x2c7d2e[a198_0x4dee('0xc')][a198_0x4dee('0xd')](a198_0x4dee('0xe'))){exports[a198_0x4dee('0xf')][a198_0x4dee('0x10')]['reportFiles']['findOrCreate']({'where':{'fileName':_0x2c7d2e[a198_0x4dee('0xc')]}})[a198_0x4dee('0x11')]((_0x389171,_0x5346c9)=>{if(_0x5346c9){console[a198_0x4dee('0x7')](_0x2c7d2e['name']);_0x263a28[a198_0x4dee('0x12')](_0x389171);}});}}}_0x8cb30a['json']({'data':_0x263a28});});});_0x46fc33['on']('error',function(_0x12346a){_0x8cb30a[a198_0x4dee('0xe')]({'message':_0x12346a});});_0x46fc33[a198_0x4dee('0x13')]({'host':'ftp.vivotek.com','port':0x15,'user':a198_0x4dee('0x14'),'password':a198_0x4dee('0x14')});};exports[a198_0x4dee('0x15')]=(_0x16ad2c,_0x2a7953)=>{exports[a198_0x4dee('0xf')]['models']['reportFiles'][a198_0x4dee('0x16')]({'where':{'status':null}})[a198_0x4dee('0x17')](_0x3c828b=>{if(_0x3c828b){const _0x4a042b=new ftp_1[(a198_0x4dee('0x9'))]();_0x4a042b['on'](a198_0x4dee('0x18'),function(){console[a198_0x4dee('0x7')](a198_0x4dee('0x19')+_0x3c828b[a198_0x4dee('0x1a')]);_0x4a042b[a198_0x4dee('0x1b')](a198_0x4dee('0x1c')+_0x3c828b['fileName'],function(_0x1b47ee,_0x53a4e5){_0x4a042b[a198_0x4dee('0x1d')]();if(_0x1b47ee){}else{const _0x9a7bf5=a198_0x4dee('0x1e')+_0x3c828b['fileName']+a198_0x4dee('0x1f');_0x53a4e5[a198_0x4dee('0x20')](fs_1[a198_0x4dee('0x9')][a198_0x4dee('0x21')](_0x9a7bf5));_0x3c828b['status']=0x1;_0x3c828b[a198_0x4dee('0x22')]();console[a198_0x4dee('0x7')](a198_0x4dee('0x23')+_0x3c828b[a198_0x4dee('0x1a')]);}});});_0x4a042b['on'](a198_0x4dee('0x24'),function(_0x35b740){_0x2a7953['json']({'message':_0x35b740});});_0x4a042b[a198_0x4dee('0x13')]({'host':a198_0x4dee('0x25'),'port':0x15,'user':a198_0x4dee('0x14'),'password':a198_0x4dee('0x14')});_0x2a7953[a198_0x4dee('0xe')]({'data':_0x3c828b['fileName']});}else{_0x2a7953[a198_0x4dee('0xe')]({'data':[]});}});};exports[a198_0x4dee('0x26')]=(_0x56df3e,_0x5e6b33)=>{exports[a198_0x4dee('0xf')][a198_0x4dee('0x10')][a198_0x4dee('0x27')]['findOne']({'where':{'status':0x1}})[a198_0x4dee('0x17')](_0x18720c=>{if(_0x18720c){const _0x485262=a198_0x4dee('0x1e')+_0x18720c[a198_0x4dee('0x1a')]+a198_0x4dee('0x1f');fs_1[a198_0x4dee('0x9')]['readFile'](_0x485262,a198_0x4dee('0x28'),function(_0x2aa02,_0x2a68d5){if(_0x2aa02){_0x18720c['status']=null;}else{try{const _0x23e939=JSON[a198_0x4dee('0x29')](_0x2a68d5);for(const _0x20a8a2 of _0x23e939['Data'][0x0]['CountingInfo']){const _0x1f79d2=_0x20a8a2['In'];const _0x5be290=_0x20a8a2[a198_0x4dee('0x2a')];const _0x169c80=Date[a198_0x4dee('0x29')](_0x20a8a2[a198_0x4dee('0x2b')]);if(_0x1f79d2>0x0){exports['sequelize']['models'][a198_0x4dee('0x2c')]['create']({'reportFileId':_0x18720c['id'],'amount':_0x1f79d2,'countingDate':_0x169c80});}if(_0x5be290>0x0){exports['sequelize'][a198_0x4dee('0x10')][a198_0x4dee('0x2c')][a198_0x4dee('0x2d')]({'reportFileId':_0x18720c['id'],'amount':_0x5be290*-0x1,'countingDate':_0x169c80});}}_0x18720c['status']=0x2;}catch(_0x42a73e){_0x18720c[a198_0x4dee('0x2e')]=null;}}_0x18720c['save']();});_0x5e6b33['json']({'data':_0x18720c[a198_0x4dee('0x1a')]});}else{_0x5e6b33[a198_0x4dee('0xe')]({'data':[]});}});};exports[a198_0x4dee('0x2f')]=(_0x12ca52,_0x3c814c)=>{exports[a198_0x4dee('0xf')][a198_0x4dee('0x10')][a198_0x4dee('0x2c')][a198_0x4dee('0x30')]({'where':{'amount':{[exports[a198_0x4dee('0xf')]['Op']['gt']]:0x0}},'order':[[a198_0x4dee('0x31'),'ASC']]})[a198_0x4dee('0x17')](_0x1793c0=>{_0x3c814c[a198_0x4dee('0xe')]({'data':_0x1793c0});});};exports[a198_0x4dee('0x32')]=(_0x285d0,_0x190502)=>{const _0xcee393=_0x285d0[a198_0x4dee('0x33')][a198_0x4dee('0x34')];const _0x1b2e42=_0x285d0[a198_0x4dee('0x33')][a198_0x4dee('0x35')];const _0x402b9d=_0x285d0[a198_0x4dee('0x33')][a198_0x4dee('0x36')];exports[a198_0x4dee('0xf')][a198_0x4dee('0x10')][a198_0x4dee('0x2c')][a198_0x4dee('0x30')]({'attributes':[a198_0x4dee('0x31'),[exports[a198_0x4dee('0xf')]['fn'](a198_0x4dee('0x37'),exports['sequelize']['col'](a198_0x4dee('0x38'))),'total']],'where':{'countingDate':{[exports[a198_0x4dee('0xf')]['Op'][a198_0x4dee('0x39')]]:_0x1b2e42,[exports[a198_0x4dee('0xf')]['Op']['lt']]:_0x402b9d},'amount':_0x285d0['params'][a198_0x4dee('0x3a')]=='in'?{[exports[a198_0x4dee('0xf')]['Op']['gt']]:0x0}:{[exports[a198_0x4dee('0xf')]['Op']['lt']]:0x0}},'group':[exports[a198_0x4dee('0xf')]['literal'](a198_0x4dee('0x3b'))],'order':[['countingDate','ASC']]})[a198_0x4dee('0x17')](_0x575fc9=>{_0x190502['json']({'data':_0x575fc9});});};exports[a198_0x4dee('0x3c')]=(_0x5e22f3,_0x221256)=>{const _0x548be0=_0x5e22f3[a198_0x4dee('0x33')][a198_0x4dee('0x34')];const _0x56d9f3=_0x5e22f3[a198_0x4dee('0x33')][a198_0x4dee('0x35')];const _0x4a580e=_0x5e22f3[a198_0x4dee('0x33')][a198_0x4dee('0x36')];exports[a198_0x4dee('0xf')][a198_0x4dee('0x10')][a198_0x4dee('0x2c')]['findAll']({'attributes':['countingDate',[exports[a198_0x4dee('0xf')]['fn'](a198_0x4dee('0x3d'),exports[a198_0x4dee('0xf')][a198_0x4dee('0x3e')]('countingDate'),'%Y-%m-%d\x20%H:00'),a198_0x4dee('0x3f')],[exports['sequelize']['fn'](a198_0x4dee('0x37'),exports[a198_0x4dee('0xf')]['col']('amount')),'total']],'where':{'countingDate':{[exports['sequelize']['Op']['gte']]:_0x56d9f3,[exports['sequelize']['Op']['lt']]:_0x4a580e},'amount':_0x5e22f3[a198_0x4dee('0x40')][a198_0x4dee('0x3a')]=='in'?{[exports[a198_0x4dee('0xf')]['Op']['gt']]:0x0}:{[exports[a198_0x4dee('0xf')]['Op']['lt']]:0x0}},'group':[exports[a198_0x4dee('0xf')]['fn'](a198_0x4dee('0x41'),exports[a198_0x4dee('0xf')][a198_0x4dee('0x3e')](a198_0x4dee('0x31'))),exports['sequelize']['fn'](a198_0x4dee('0x42'),exports[a198_0x4dee('0xf')][a198_0x4dee('0x3e')]('countingDate')),exports[a198_0x4dee('0xf')]['fn']('MONTH',exports['sequelize'][a198_0x4dee('0x3e')](a198_0x4dee('0x31'))),exports[a198_0x4dee('0xf')]['fn']('YEAR',exports[a198_0x4dee('0xf')][a198_0x4dee('0x3e')](a198_0x4dee('0x31')))],'order':[['countingDate','ASC']]})[a198_0x4dee('0x17')](_0x22ed35=>{_0x221256[a198_0x4dee('0xe')]({'data':_0x22ed35});});};exports['getFacebook']=(_0x56fe0b,_0x27549f,_0x289226)=>{const _0x51954e=_0x56fe0b[a198_0x4dee('0x43')][a198_0x4dee('0x44')][a198_0x4dee('0x45')](_0x51954e=>_0x51954e[a198_0x4dee('0x46')]===a198_0x4dee('0x47'));fbgraph_1[a198_0x4dee('0x9')]['setAccessToken'](_0x51954e['accessToken']);fbgraph_1[a198_0x4dee('0x9')][a198_0x4dee('0x1b')](_0x56fe0b[a198_0x4dee('0x43')]['facebook']+a198_0x4dee('0x48'),(_0x270e8a,_0x240e13)=>{if(_0x270e8a){return _0x289226(_0x270e8a);}_0x27549f[a198_0x4dee('0x49')](a198_0x4dee('0x4a'),{'title':a198_0x4dee('0x4b'),'profile':_0x240e13});});};
var a85_0x2a77=['name','endsWith','models','reportFiles','findOrCreate','spread','json','error','ftp.vivotek.com','ipd','downloadFtp','findOne','then','connected:','colombia/','fileName','end','status','save','processFtp','media/','.txt','utf8','parse','Data','CountingInfo','Out','create','passes','getPassCounting','findAll','countingDate','getPassCountingByDay','query','startDate','endDate','sum','amount','total','gte','params','direction','YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))','ASC','getPassCountingByHour','month','DATE_FORMAT','col','%Y-%m-%d\x20%H:00','countingDateShort','HOUR','DAY','MONTH','YEAR','getFacebook','user','find','kind','facebook','setAccessToken','accessToken','get','?fields=id,name,email,first_name,last_name,gender,link,locale,timezone','api/facebook','Facebook\x20API','__importDefault','__esModule','fbgraph','ftp','sequelize','setSequelize','render','api/index','API\x20Examples','syncFtp','log','default','ready','list'];(function(_0x535425,_0x5b2090){var _0x4bb9fd=function(_0x5441d6){while(--_0x5441d6){_0x535425['push'](_0x535425['shift']());}};_0x4bb9fd(++_0x5b2090);}(a85_0x2a77,0x17d));var a85_0x1d4b=function(_0x363462,_0xcc9725){_0x363462=_0x363462-0x0;var _0x1e9b10=a85_0x2a77[_0x363462];return _0x1e9b10;};'use strict';var __importDefault=this&&this[a85_0x1d4b('0x0')]||function(_0x78ea29){return _0x78ea29&&_0x78ea29['__esModule']?_0x78ea29:{'default':_0x78ea29};};Object['defineProperty'](exports,a85_0x1d4b('0x1'),{'value':!![]});const fbgraph_1=__importDefault(require(a85_0x1d4b('0x2')));const ftp_1=__importDefault(require(a85_0x1d4b('0x3')));const fs_1=__importDefault(require('fs'));function setSequelize(_0x240fda){exports[a85_0x1d4b('0x4')]=_0x240fda;}exports[a85_0x1d4b('0x5')]=setSequelize;exports['getApi']=(_0x2b0d71,_0x4d6051)=>{_0x4d6051[a85_0x1d4b('0x6')](a85_0x1d4b('0x7'),{'title':a85_0x1d4b('0x8')});};exports[a85_0x1d4b('0x9')]=(_0x563835,_0x32227b)=>{console[a85_0x1d4b('0xa')]('connecting');const _0x5b79f5=[];const _0x43f459=new ftp_1[(a85_0x1d4b('0xb'))]();_0x43f459['on'](a85_0x1d4b('0xc'),function(){console[a85_0x1d4b('0xa')]('connected');_0x43f459[a85_0x1d4b('0xd')]('colombia',![],function(_0x38ebda,_0x112eec){if(_0x38ebda){}else{for(const _0x2d77ef of _0x112eec){console[a85_0x1d4b('0xa')]('Downloading:\x20'+_0x2d77ef[a85_0x1d4b('0xe')]);if(_0x2d77ef[a85_0x1d4b('0xe')][a85_0x1d4b('0xf')]('json')){exports[a85_0x1d4b('0x4')][a85_0x1d4b('0x10')][a85_0x1d4b('0x11')][a85_0x1d4b('0x12')]({'where':{'fileName':_0x2d77ef[a85_0x1d4b('0xe')]}})[a85_0x1d4b('0x13')]((_0x7c6c7d,_0x3bfd24)=>{if(_0x3bfd24){console['log'](_0x2d77ef['name']);_0x5b79f5['push'](_0x7c6c7d);}});}}}_0x32227b[a85_0x1d4b('0x14')]({'data':_0x5b79f5});});});_0x43f459['on'](a85_0x1d4b('0x15'),function(_0x2820a8){_0x32227b['json']({'message':_0x2820a8});});_0x43f459['connect']({'host':a85_0x1d4b('0x16'),'port':0x15,'user':a85_0x1d4b('0x17'),'password':'ipd'});};exports[a85_0x1d4b('0x18')]=(_0x16002b,_0x526a18)=>{exports[a85_0x1d4b('0x4')][a85_0x1d4b('0x10')][a85_0x1d4b('0x11')][a85_0x1d4b('0x19')]({'where':{'status':null}})[a85_0x1d4b('0x1a')](_0x288168=>{if(_0x288168){const _0x3b2211=new ftp_1['default']();_0x3b2211['on'](a85_0x1d4b('0xc'),function(){console[a85_0x1d4b('0xa')](a85_0x1d4b('0x1b')+_0x288168['fileName']);_0x3b2211['get'](a85_0x1d4b('0x1c')+_0x288168[a85_0x1d4b('0x1d')],function(_0x2c91b8,_0x24a656){_0x3b2211[a85_0x1d4b('0x1e')]();if(_0x2c91b8){}else{const _0x477093='media/'+_0x288168[a85_0x1d4b('0x1d')]+'.txt';_0x24a656['pipe'](fs_1[a85_0x1d4b('0xb')]['createWriteStream'](_0x477093));_0x288168[a85_0x1d4b('0x1f')]=0x1;_0x288168[a85_0x1d4b('0x20')]();console[a85_0x1d4b('0xa')]('Downloaded:\x20'+_0x288168[a85_0x1d4b('0x1d')]);}});});_0x3b2211['on'](a85_0x1d4b('0x15'),function(_0x985951){_0x526a18[a85_0x1d4b('0x14')]({'message':_0x985951});});_0x3b2211['connect']({'host':a85_0x1d4b('0x16'),'port':0x15,'user':'ipd','password':a85_0x1d4b('0x17')});_0x526a18[a85_0x1d4b('0x14')]({'data':_0x288168[a85_0x1d4b('0x1d')]});}else{_0x526a18['json']({'data':[]});}});};exports[a85_0x1d4b('0x21')]=(_0x2b2ce8,_0x494ce1)=>{exports['sequelize'][a85_0x1d4b('0x10')][a85_0x1d4b('0x11')][a85_0x1d4b('0x19')]({'where':{'status':0x1}})[a85_0x1d4b('0x1a')](_0x551df5=>{if(_0x551df5){const _0xd3037b=a85_0x1d4b('0x22')+_0x551df5[a85_0x1d4b('0x1d')]+a85_0x1d4b('0x23');fs_1[a85_0x1d4b('0xb')]['readFile'](_0xd3037b,a85_0x1d4b('0x24'),function(_0x149282,_0x7898db){if(_0x149282){_0x551df5[a85_0x1d4b('0x1f')]=null;}else{try{const _0x4ff030=JSON[a85_0x1d4b('0x25')](_0x7898db);for(const _0x24e9a3 of _0x4ff030[a85_0x1d4b('0x26')][0x0][a85_0x1d4b('0x27')]){const _0x1f874c=_0x24e9a3['In'];const _0x23d43b=_0x24e9a3[a85_0x1d4b('0x28')];const _0x25308d=Date[a85_0x1d4b('0x25')](_0x24e9a3['EndTime']);if(_0x1f874c>0x0){exports[a85_0x1d4b('0x4')][a85_0x1d4b('0x10')]['passes'][a85_0x1d4b('0x29')]({'reportFileId':_0x551df5['id'],'amount':_0x1f874c,'countingDate':_0x25308d});}if(_0x23d43b>0x0){exports[a85_0x1d4b('0x4')]['models'][a85_0x1d4b('0x2a')][a85_0x1d4b('0x29')]({'reportFileId':_0x551df5['id'],'amount':_0x23d43b*-0x1,'countingDate':_0x25308d});}}_0x551df5['status']=0x2;}catch(_0x8414ff){_0x551df5['status']=null;}}_0x551df5[a85_0x1d4b('0x20')]();});_0x494ce1['json']({'data':_0x551df5[a85_0x1d4b('0x1d')]});}else{_0x494ce1[a85_0x1d4b('0x14')]({'data':[]});}});};exports[a85_0x1d4b('0x2b')]=(_0x4d3a6e,_0x429ac7)=>{exports[a85_0x1d4b('0x4')]['models'][a85_0x1d4b('0x2a')][a85_0x1d4b('0x2c')]({'where':{'amount':{[exports[a85_0x1d4b('0x4')]['Op']['gt']]:0x0}},'order':[[a85_0x1d4b('0x2d'),'ASC']]})[a85_0x1d4b('0x1a')](_0x5afd8b=>{_0x429ac7['json']({'data':_0x5afd8b});});};exports[a85_0x1d4b('0x2e')]=(_0x54c325,_0x1ca310)=>{const _0x50254b=_0x54c325[a85_0x1d4b('0x2f')]['month'];const _0x204eea=_0x54c325[a85_0x1d4b('0x2f')][a85_0x1d4b('0x30')];const _0x456bf6=_0x54c325[a85_0x1d4b('0x2f')][a85_0x1d4b('0x31')];exports[a85_0x1d4b('0x4')][a85_0x1d4b('0x10')][a85_0x1d4b('0x2a')][a85_0x1d4b('0x2c')]({'attributes':['countingDate',[exports[a85_0x1d4b('0x4')]['fn'](a85_0x1d4b('0x32'),exports[a85_0x1d4b('0x4')]['col'](a85_0x1d4b('0x33'))),a85_0x1d4b('0x34')]],'where':{'countingDate':{[exports[a85_0x1d4b('0x4')]['Op'][a85_0x1d4b('0x35')]]:_0x204eea,[exports[a85_0x1d4b('0x4')]['Op']['lt']]:_0x456bf6},'amount':_0x54c325[a85_0x1d4b('0x36')][a85_0x1d4b('0x37')]=='in'?{[exports[a85_0x1d4b('0x4')]['Op']['gt']]:0x0}:{[exports[a85_0x1d4b('0x4')]['Op']['lt']]:0x0}},'group':[exports[a85_0x1d4b('0x4')]['literal'](a85_0x1d4b('0x38'))],'order':[[a85_0x1d4b('0x2d'),a85_0x1d4b('0x39')]]})['then'](_0x21383c=>{_0x1ca310['json']({'data':_0x21383c});});};exports[a85_0x1d4b('0x3a')]=(_0x268bf4,_0x62bd01)=>{const _0x5aafbb=_0x268bf4[a85_0x1d4b('0x2f')][a85_0x1d4b('0x3b')];const _0x183bcc=_0x268bf4[a85_0x1d4b('0x2f')][a85_0x1d4b('0x30')];const _0x24a60e=_0x268bf4[a85_0x1d4b('0x2f')]['endDate'];exports[a85_0x1d4b('0x4')][a85_0x1d4b('0x10')][a85_0x1d4b('0x2a')]['findAll']({'attributes':['countingDate',[exports['sequelize']['fn'](a85_0x1d4b('0x3c'),exports[a85_0x1d4b('0x4')][a85_0x1d4b('0x3d')](a85_0x1d4b('0x2d')),a85_0x1d4b('0x3e')),a85_0x1d4b('0x3f')],[exports['sequelize']['fn'](a85_0x1d4b('0x32'),exports[a85_0x1d4b('0x4')][a85_0x1d4b('0x3d')](a85_0x1d4b('0x33'))),a85_0x1d4b('0x34')]],'where':{'countingDate':{[exports[a85_0x1d4b('0x4')]['Op'][a85_0x1d4b('0x35')]]:_0x183bcc,[exports[a85_0x1d4b('0x4')]['Op']['lt']]:_0x24a60e},'amount':_0x268bf4['params'][a85_0x1d4b('0x37')]=='in'?{[exports[a85_0x1d4b('0x4')]['Op']['gt']]:0x0}:{[exports['sequelize']['Op']['lt']]:0x0}},'group':[exports['sequelize']['fn'](a85_0x1d4b('0x40'),exports[a85_0x1d4b('0x4')][a85_0x1d4b('0x3d')](a85_0x1d4b('0x2d'))),exports[a85_0x1d4b('0x4')]['fn'](a85_0x1d4b('0x41'),exports['sequelize']['col'](a85_0x1d4b('0x2d'))),exports[a85_0x1d4b('0x4')]['fn'](a85_0x1d4b('0x42'),exports['sequelize']['col']('countingDate')),exports[a85_0x1d4b('0x4')]['fn'](a85_0x1d4b('0x43'),exports['sequelize']['col'](a85_0x1d4b('0x2d')))],'order':[[a85_0x1d4b('0x2d'),a85_0x1d4b('0x39')]]})['then'](_0x246fc2=>{_0x62bd01[a85_0x1d4b('0x14')]({'data':_0x246fc2});});};exports[a85_0x1d4b('0x44')]=(_0x333619,_0x1f4f67,_0x349611)=>{const _0x3c5ff6=_0x333619[a85_0x1d4b('0x45')]['tokens'][a85_0x1d4b('0x46')](_0x3c5ff6=>_0x3c5ff6[a85_0x1d4b('0x47')]===a85_0x1d4b('0x48'));fbgraph_1['default'][a85_0x1d4b('0x49')](_0x3c5ff6[a85_0x1d4b('0x4a')]);fbgraph_1['default'][a85_0x1d4b('0x4b')](_0x333619[a85_0x1d4b('0x45')][a85_0x1d4b('0x48')]+a85_0x1d4b('0x4c'),(_0x185bb2,_0x2c0c8f)=>{if(_0x185bb2){return _0x349611(_0x185bb2);}_0x1f4f67[a85_0x1d4b('0x6')](a85_0x1d4b('0x4d'),{'title':a85_0x1d4b('0x4e'),'profile':_0x2c0c8f});});};
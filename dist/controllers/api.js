var a92_0x4b4c=['ASC','getPassCountingByDay','month','query','endDate','sum','col','amount','total','gte','direction','YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))','getPassCountingByHour','%Y-%m-%d\x20%H:00','params','HOUR','YEAR','getFacebook','user','tokens','kind','facebook','get','?fields=id,name,email,first_name,last_name,gender,link,locale,timezone','api/facebook','__importDefault','__esModule','defineProperty','fbgraph','ftp','sequelize','getApi','render','api/index','API\x20Examples','syncFtp','log','ready','connected','list','Downloading:\x20','name','endsWith','json','models','spread','push','error','connect','ftp.vivotek.com','ipd','downloadFtp','findOne','then','default','connected:','fileName','colombia/','end','.txt','pipe','createWriteStream','save','Downloaded:\x20','processFtp','media/','readFile','status','parse','Data','CountingInfo','Out','EndTime','create','getPassCounting','passes','findAll','countingDate'];(function(_0x497652,_0x3b20ff){var _0x3e8d70=function(_0x2ec6e7){while(--_0x2ec6e7){_0x497652['push'](_0x497652['shift']());}};_0x3e8d70(++_0x3b20ff);}(a92_0x4b4c,0x19f));var a92_0x5a45=function(_0xd19140,_0x1bf78d){_0xd19140=_0xd19140-0x0;var _0xbd298a=a92_0x4b4c[_0xd19140];return _0xbd298a;};'use strict';var __importDefault=this&&this[a92_0x5a45('0x0')]||function(_0x49a608){return _0x49a608&&_0x49a608[a92_0x5a45('0x1')]?_0x49a608:{'default':_0x49a608};};Object[a92_0x5a45('0x2')](exports,a92_0x5a45('0x1'),{'value':!![]});const fbgraph_1=__importDefault(require(a92_0x5a45('0x3')));const ftp_1=__importDefault(require(a92_0x5a45('0x4')));const fs_1=__importDefault(require('fs'));function setSequelize(_0xcd88f5){exports[a92_0x5a45('0x5')]=_0xcd88f5;}exports['setSequelize']=setSequelize;exports[a92_0x5a45('0x6')]=(_0x1ca9ef,_0x42f654)=>{_0x42f654[a92_0x5a45('0x7')](a92_0x5a45('0x8'),{'title':a92_0x5a45('0x9')});};exports[a92_0x5a45('0xa')]=(_0x20970f,_0xa0293d)=>{console[a92_0x5a45('0xb')]('connecting');const _0x5e0a72=[];const _0x455e82=new ftp_1['default']();_0x455e82['on'](a92_0x5a45('0xc'),function(){console[a92_0x5a45('0xb')](a92_0x5a45('0xd'));_0x455e82[a92_0x5a45('0xe')]('colombia',![],function(_0x1b831d,_0x3d5d7a){if(_0x1b831d){}else{for(const _0x1cba02 of _0x3d5d7a){console[a92_0x5a45('0xb')](a92_0x5a45('0xf')+_0x1cba02[a92_0x5a45('0x10')]);if(_0x1cba02[a92_0x5a45('0x10')][a92_0x5a45('0x11')](a92_0x5a45('0x12'))){exports[a92_0x5a45('0x5')][a92_0x5a45('0x13')]['reportFiles']['findOrCreate']({'where':{'fileName':_0x1cba02[a92_0x5a45('0x10')]}})[a92_0x5a45('0x14')]((_0x425b30,_0x4b9198)=>{if(_0x4b9198){console[a92_0x5a45('0xb')](_0x1cba02[a92_0x5a45('0x10')]);_0x5e0a72[a92_0x5a45('0x15')](_0x425b30);}});}}}_0xa0293d['json']({'data':_0x5e0a72});});});_0x455e82['on'](a92_0x5a45('0x16'),function(_0x25c4d4){_0xa0293d[a92_0x5a45('0x12')]({'message':_0x25c4d4});});_0x455e82[a92_0x5a45('0x17')]({'host':a92_0x5a45('0x18'),'port':0x15,'user':'ipd','password':a92_0x5a45('0x19')});};exports[a92_0x5a45('0x1a')]=(_0x3dd0d9,_0x6bfdda)=>{exports['sequelize']['models']['reportFiles'][a92_0x5a45('0x1b')]({'where':{'status':null}})[a92_0x5a45('0x1c')](_0x33f1b8=>{if(_0x33f1b8){const _0x44a6e7=new ftp_1[(a92_0x5a45('0x1d'))]();_0x44a6e7['on'](a92_0x5a45('0xc'),function(){console[a92_0x5a45('0xb')](a92_0x5a45('0x1e')+_0x33f1b8[a92_0x5a45('0x1f')]);_0x44a6e7['get'](a92_0x5a45('0x20')+_0x33f1b8[a92_0x5a45('0x1f')],function(_0x5b6085,_0x28df48){_0x44a6e7[a92_0x5a45('0x21')]();if(_0x5b6085){}else{const _0x5453be='media/'+_0x33f1b8[a92_0x5a45('0x1f')]+a92_0x5a45('0x22');_0x28df48[a92_0x5a45('0x23')](fs_1[a92_0x5a45('0x1d')][a92_0x5a45('0x24')](_0x5453be));_0x33f1b8['status']=0x1;_0x33f1b8[a92_0x5a45('0x25')]();console[a92_0x5a45('0xb')](a92_0x5a45('0x26')+_0x33f1b8[a92_0x5a45('0x1f')]);}});});_0x44a6e7['on'](a92_0x5a45('0x16'),function(_0x27666c){_0x6bfdda['json']({'message':_0x27666c});});_0x44a6e7[a92_0x5a45('0x17')]({'host':a92_0x5a45('0x18'),'port':0x15,'user':a92_0x5a45('0x19'),'password':a92_0x5a45('0x19')});_0x6bfdda[a92_0x5a45('0x12')]({'data':_0x33f1b8[a92_0x5a45('0x1f')]});}else{_0x6bfdda[a92_0x5a45('0x12')]({'data':[]});}});};exports[a92_0x5a45('0x27')]=(_0x2358ea,_0x445d04)=>{exports['sequelize'][a92_0x5a45('0x13')]['reportFiles'][a92_0x5a45('0x1b')]({'where':{'status':0x1}})[a92_0x5a45('0x1c')](_0x5a5691=>{if(_0x5a5691){const _0x4c1a2a=a92_0x5a45('0x28')+_0x5a5691[a92_0x5a45('0x1f')]+a92_0x5a45('0x22');fs_1[a92_0x5a45('0x1d')][a92_0x5a45('0x29')](_0x4c1a2a,'utf8',function(_0x188e76,_0x893b6){if(_0x188e76){_0x5a5691[a92_0x5a45('0x2a')]=null;}else{try{const _0x372ee3=JSON[a92_0x5a45('0x2b')](_0x893b6);for(const _0x47a5b1 of _0x372ee3[a92_0x5a45('0x2c')][0x0][a92_0x5a45('0x2d')]){const _0x42eed1=_0x47a5b1['In'];const _0x3223e4=_0x47a5b1[a92_0x5a45('0x2e')];const _0x1b0145=Date[a92_0x5a45('0x2b')](_0x47a5b1[a92_0x5a45('0x2f')]);if(_0x42eed1>0x0){exports['sequelize'][a92_0x5a45('0x13')]['passes'][a92_0x5a45('0x30')]({'reportFileId':_0x5a5691['id'],'amount':_0x42eed1,'countingDate':_0x1b0145});}if(_0x3223e4>0x0){exports['sequelize'][a92_0x5a45('0x13')]['passes'][a92_0x5a45('0x30')]({'reportFileId':_0x5a5691['id'],'amount':_0x3223e4*-0x1,'countingDate':_0x1b0145});}}_0x5a5691[a92_0x5a45('0x2a')]=0x2;}catch(_0x5dfce1){_0x5a5691[a92_0x5a45('0x2a')]=null;}}_0x5a5691[a92_0x5a45('0x25')]();});_0x445d04[a92_0x5a45('0x12')]({'data':_0x5a5691[a92_0x5a45('0x1f')]});}else{_0x445d04[a92_0x5a45('0x12')]({'data':[]});}});};exports[a92_0x5a45('0x31')]=(_0x1dbaec,_0x19624e)=>{exports['sequelize'][a92_0x5a45('0x13')][a92_0x5a45('0x32')][a92_0x5a45('0x33')]({'where':{'amount':{[exports[a92_0x5a45('0x5')]['Op']['gt']]:0x0}},'order':[[a92_0x5a45('0x34'),a92_0x5a45('0x35')]]})[a92_0x5a45('0x1c')](_0xa20bbe=>{_0x19624e['json']({'data':_0xa20bbe});});};exports[a92_0x5a45('0x36')]=(_0x2fb8d0,_0x20af54)=>{const _0x58e23f=_0x2fb8d0['query'][a92_0x5a45('0x37')];const _0xdf670d=_0x2fb8d0[a92_0x5a45('0x38')]['startDate'];const _0x370b41=_0x2fb8d0[a92_0x5a45('0x38')][a92_0x5a45('0x39')];exports[a92_0x5a45('0x5')][a92_0x5a45('0x13')][a92_0x5a45('0x32')][a92_0x5a45('0x33')]({'attributes':['countingDate',[exports['sequelize']['fn'](a92_0x5a45('0x3a'),exports[a92_0x5a45('0x5')][a92_0x5a45('0x3b')](a92_0x5a45('0x3c'))),a92_0x5a45('0x3d')]],'where':{'countingDate':{[exports[a92_0x5a45('0x5')]['Op'][a92_0x5a45('0x3e')]]:_0xdf670d,[exports['sequelize']['Op']['lt']]:_0x370b41},'amount':_0x2fb8d0['params'][a92_0x5a45('0x3f')]=='in'?{[exports[a92_0x5a45('0x5')]['Op']['gt']]:0x0}:{[exports['sequelize']['Op']['lt']]:0x0}},'group':[exports['sequelize']['literal'](a92_0x5a45('0x40'))],'order':[[a92_0x5a45('0x34'),a92_0x5a45('0x35')]]})[a92_0x5a45('0x1c')](_0x24016c=>{_0x20af54['json']({'data':_0x24016c});});};exports[a92_0x5a45('0x41')]=(_0x2d4435,_0x6d8d73)=>{const _0x385bdc=_0x2d4435[a92_0x5a45('0x38')][a92_0x5a45('0x37')];const _0x156998=_0x2d4435[a92_0x5a45('0x38')]['startDate'];const _0x258e66=_0x2d4435[a92_0x5a45('0x38')][a92_0x5a45('0x39')];exports[a92_0x5a45('0x5')][a92_0x5a45('0x13')]['passes'][a92_0x5a45('0x33')]({'attributes':['countingDate',[exports[a92_0x5a45('0x5')]['fn']('DATE_FORMAT',exports[a92_0x5a45('0x5')][a92_0x5a45('0x3b')](a92_0x5a45('0x34')),a92_0x5a45('0x42')),'countingDateShort'],[exports[a92_0x5a45('0x5')]['fn'](a92_0x5a45('0x3a'),exports[a92_0x5a45('0x5')][a92_0x5a45('0x3b')](a92_0x5a45('0x3c'))),a92_0x5a45('0x3d')]],'where':{'countingDate':{[exports[a92_0x5a45('0x5')]['Op']['gte']]:_0x156998,[exports[a92_0x5a45('0x5')]['Op']['lt']]:_0x258e66},'amount':_0x2d4435[a92_0x5a45('0x43')][a92_0x5a45('0x3f')]=='in'?{[exports[a92_0x5a45('0x5')]['Op']['gt']]:0x0}:{[exports['sequelize']['Op']['lt']]:0x0}},'group':[exports['sequelize']['fn'](a92_0x5a45('0x44'),exports[a92_0x5a45('0x5')]['col'](a92_0x5a45('0x34'))),exports[a92_0x5a45('0x5')]['fn']('DAY',exports[a92_0x5a45('0x5')]['col'](a92_0x5a45('0x34'))),exports['sequelize']['fn']('MONTH',exports[a92_0x5a45('0x5')][a92_0x5a45('0x3b')](a92_0x5a45('0x34'))),exports[a92_0x5a45('0x5')]['fn'](a92_0x5a45('0x45'),exports[a92_0x5a45('0x5')][a92_0x5a45('0x3b')]('countingDate'))],'order':[['countingDate','ASC']]})['then'](_0x244f69=>{_0x6d8d73[a92_0x5a45('0x12')]({'data':_0x244f69});});};exports[a92_0x5a45('0x46')]=(_0x24f69a,_0x15270c,_0x58638c)=>{const _0x5bcb85=_0x24f69a[a92_0x5a45('0x47')][a92_0x5a45('0x48')]['find'](_0x5bcb85=>_0x5bcb85[a92_0x5a45('0x49')]===a92_0x5a45('0x4a'));fbgraph_1[a92_0x5a45('0x1d')]['setAccessToken'](_0x5bcb85['accessToken']);fbgraph_1[a92_0x5a45('0x1d')][a92_0x5a45('0x4b')](_0x24f69a[a92_0x5a45('0x47')][a92_0x5a45('0x4a')]+a92_0x5a45('0x4c'),(_0x3a06fd,_0x542eb0)=>{if(_0x3a06fd){return _0x58638c(_0x3a06fd);}_0x15270c[a92_0x5a45('0x7')](a92_0x5a45('0x4d'),{'title':'Facebook\x20API','profile':_0x542eb0});});};
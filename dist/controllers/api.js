var a92_0x2348=['query','month','endDate','findAll','sum','col','total','params','direction','YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))','getPassCountingByHour','startDate','DATE_FORMAT','amount','gte','HOUR','MONTH','YEAR','getFacebook','user','tokens','find','facebook','setAccessToken','accessToken','api/facebook','__importDefault','__esModule','fbgraph','ftp','sequelize','setSequelize','getApi','render','api/index','API\x20Examples','syncFtp','log','connecting','ready','connected','colombia','Downloading:\x20','name','endsWith','json','reportFiles','findOrCreate','connect','ipd','models','findOne','default','connected:','fileName','get','media/','.txt','status','save','Downloaded:\x20','error','ftp.vivotek.com','processFtp','utf8','Data','CountingInfo','Out','EndTime','create','passes','countingDate','ASC','then','getPassCountingByDay'];(function(_0xe3c68,_0x5f4575){var _0x48ed8c=function(_0x1318a6){while(--_0x1318a6){_0xe3c68['push'](_0xe3c68['shift']());}};_0x48ed8c(++_0x5f4575);}(a92_0x2348,0x65));var a92_0x4643=function(_0x40dc77,_0x515324){_0x40dc77=_0x40dc77-0x0;var _0xace290=a92_0x2348[_0x40dc77];return _0xace290;};'use strict';var __importDefault=this&&this[a92_0x4643('0x0')]||function(_0x5c0db2){return _0x5c0db2&&_0x5c0db2[a92_0x4643('0x1')]?_0x5c0db2:{'default':_0x5c0db2};};Object['defineProperty'](exports,a92_0x4643('0x1'),{'value':!![]});const fbgraph_1=__importDefault(require(a92_0x4643('0x2')));const ftp_1=__importDefault(require(a92_0x4643('0x3')));const fs_1=__importDefault(require('fs'));function setSequelize(_0x2376a4){exports[a92_0x4643('0x4')]=_0x2376a4;}exports[a92_0x4643('0x5')]=setSequelize;exports[a92_0x4643('0x6')]=(_0x46d95a,_0xb5d861)=>{_0xb5d861[a92_0x4643('0x7')](a92_0x4643('0x8'),{'title':a92_0x4643('0x9')});};exports[a92_0x4643('0xa')]=(_0x57f63e,_0x187c4a)=>{console[a92_0x4643('0xb')](a92_0x4643('0xc'));const _0x40cf0b=[];const _0x242bbc=new ftp_1['default']();_0x242bbc['on'](a92_0x4643('0xd'),function(){console[a92_0x4643('0xb')](a92_0x4643('0xe'));_0x242bbc['list'](a92_0x4643('0xf'),![],function(_0x15cad6,_0x3b2ae8){if(_0x15cad6){}else{for(const _0x3a289d of _0x3b2ae8){console[a92_0x4643('0xb')](a92_0x4643('0x10')+_0x3a289d[a92_0x4643('0x11')]);if(_0x3a289d['name'][a92_0x4643('0x12')](a92_0x4643('0x13'))){exports[a92_0x4643('0x4')]['models'][a92_0x4643('0x14')][a92_0x4643('0x15')]({'where':{'fileName':_0x3a289d['name']}})['spread']((_0x149cbd,_0x1c8118)=>{if(_0x1c8118){console[a92_0x4643('0xb')](_0x3a289d[a92_0x4643('0x11')]);_0x40cf0b['push'](_0x149cbd);}});}}}_0x187c4a[a92_0x4643('0x13')]({'data':_0x40cf0b});});});_0x242bbc['on']('error',function(_0x12f2ad){_0x187c4a[a92_0x4643('0x13')]({'message':_0x12f2ad});});_0x242bbc[a92_0x4643('0x16')]({'host':'ftp.vivotek.com','port':0x15,'user':a92_0x4643('0x17'),'password':a92_0x4643('0x17')});};exports['downloadFtp']=(_0x53f8d2,_0x148483)=>{exports[a92_0x4643('0x4')][a92_0x4643('0x18')][a92_0x4643('0x14')][a92_0x4643('0x19')]({'where':{'status':null}})['then'](_0x3f7298=>{if(_0x3f7298){const _0x4b1679=new ftp_1[(a92_0x4643('0x1a'))]();_0x4b1679['on']('ready',function(){console[a92_0x4643('0xb')](a92_0x4643('0x1b')+_0x3f7298[a92_0x4643('0x1c')]);_0x4b1679[a92_0x4643('0x1d')]('colombia/'+_0x3f7298[a92_0x4643('0x1c')],function(_0x841b89,_0x4893bd){_0x4b1679['end']();if(_0x841b89){}else{const _0x340b96=a92_0x4643('0x1e')+_0x3f7298[a92_0x4643('0x1c')]+a92_0x4643('0x1f');_0x4893bd['pipe'](fs_1[a92_0x4643('0x1a')]['createWriteStream'](_0x340b96));_0x3f7298[a92_0x4643('0x20')]=0x1;_0x3f7298[a92_0x4643('0x21')]();console[a92_0x4643('0xb')](a92_0x4643('0x22')+_0x3f7298[a92_0x4643('0x1c')]);}});});_0x4b1679['on'](a92_0x4643('0x23'),function(_0x13e0c4){_0x148483['json']({'message':_0x13e0c4});});_0x4b1679[a92_0x4643('0x16')]({'host':a92_0x4643('0x24'),'port':0x15,'user':'ipd','password':a92_0x4643('0x17')});_0x148483[a92_0x4643('0x13')]({'data':_0x3f7298[a92_0x4643('0x1c')]});}else{_0x148483['json']({'data':[]});}});};exports[a92_0x4643('0x25')]=(_0x14b57c,_0x83347a)=>{exports[a92_0x4643('0x4')][a92_0x4643('0x18')][a92_0x4643('0x14')]['findOne']({'where':{'status':0x1}})['then'](_0x12b3a9=>{if(_0x12b3a9){const _0x24c638=a92_0x4643('0x1e')+_0x12b3a9[a92_0x4643('0x1c')]+a92_0x4643('0x1f');fs_1[a92_0x4643('0x1a')]['readFile'](_0x24c638,a92_0x4643('0x26'),function(_0x2ddd66,_0x3eba60){if(_0x2ddd66){_0x12b3a9[a92_0x4643('0x20')]=null;}else{try{const _0x4aa8fe=JSON['parse'](_0x3eba60);for(const _0x300ec3 of _0x4aa8fe[a92_0x4643('0x27')][0x0][a92_0x4643('0x28')]){const _0x3afea6=_0x300ec3['In'];const _0x3f46a1=_0x300ec3[a92_0x4643('0x29')];const _0x589e6b=Date['parse'](_0x300ec3[a92_0x4643('0x2a')]);if(_0x3afea6>0x0){exports[a92_0x4643('0x4')][a92_0x4643('0x18')]['passes'][a92_0x4643('0x2b')]({'reportFileId':_0x12b3a9['id'],'amount':_0x3afea6,'countingDate':_0x589e6b});}if(_0x3f46a1>0x0){exports[a92_0x4643('0x4')][a92_0x4643('0x18')]['passes'][a92_0x4643('0x2b')]({'reportFileId':_0x12b3a9['id'],'amount':_0x3f46a1*-0x1,'countingDate':_0x589e6b});}}_0x12b3a9['status']=0x2;}catch(_0x924173){_0x12b3a9[a92_0x4643('0x20')]=null;}}_0x12b3a9[a92_0x4643('0x21')]();});_0x83347a[a92_0x4643('0x13')]({'data':_0x12b3a9[a92_0x4643('0x1c')]});}else{_0x83347a[a92_0x4643('0x13')]({'data':[]});}});};exports['getPassCounting']=(_0x2fba96,_0x21013d)=>{exports[a92_0x4643('0x4')]['models'][a92_0x4643('0x2c')]['findAll']({'where':{'amount':{[exports[a92_0x4643('0x4')]['Op']['gt']]:0x0}},'order':[[a92_0x4643('0x2d'),a92_0x4643('0x2e')]]})[a92_0x4643('0x2f')](_0x2abb9d=>{_0x21013d['json']({'data':_0x2abb9d});});};exports[a92_0x4643('0x30')]=(_0x4fd3eb,_0x4e4874)=>{const _0x554bad=_0x4fd3eb[a92_0x4643('0x31')][a92_0x4643('0x32')];const _0x36ac62=_0x4fd3eb[a92_0x4643('0x31')]['startDate'];const _0xa3e989=_0x4fd3eb[a92_0x4643('0x31')][a92_0x4643('0x33')];exports['sequelize'][a92_0x4643('0x18')][a92_0x4643('0x2c')][a92_0x4643('0x34')]({'attributes':[a92_0x4643('0x2d'),[exports[a92_0x4643('0x4')]['fn'](a92_0x4643('0x35'),exports[a92_0x4643('0x4')][a92_0x4643('0x36')]('amount')),a92_0x4643('0x37')]],'where':{'countingDate':{[exports[a92_0x4643('0x4')]['Op']['gte']]:_0x36ac62,[exports[a92_0x4643('0x4')]['Op']['lt']]:_0xa3e989},'amount':_0x4fd3eb[a92_0x4643('0x38')][a92_0x4643('0x39')]=='in'?{[exports['sequelize']['Op']['gt']]:0x0}:{[exports[a92_0x4643('0x4')]['Op']['lt']]:0x0}},'group':[exports['sequelize']['literal'](a92_0x4643('0x3a'))],'order':[[a92_0x4643('0x2d'),'ASC']]})[a92_0x4643('0x2f')](_0x362277=>{_0x4e4874[a92_0x4643('0x13')]({'data':_0x362277});});};exports[a92_0x4643('0x3b')]=(_0x593558,_0x168376)=>{const _0x31df57=_0x593558['query']['month'];const _0x205781=_0x593558[a92_0x4643('0x31')][a92_0x4643('0x3c')];const _0xe26b33=_0x593558['query']['endDate'];exports[a92_0x4643('0x4')][a92_0x4643('0x18')][a92_0x4643('0x2c')][a92_0x4643('0x34')]({'attributes':[a92_0x4643('0x2d'),[exports['sequelize']['fn'](a92_0x4643('0x3d'),exports[a92_0x4643('0x4')]['col'](a92_0x4643('0x2d')),'%Y-%m-%d\x20%H:00'),'countingDateShort'],[exports[a92_0x4643('0x4')]['fn'](a92_0x4643('0x35'),exports[a92_0x4643('0x4')]['col'](a92_0x4643('0x3e'))),a92_0x4643('0x37')]],'where':{'countingDate':{[exports[a92_0x4643('0x4')]['Op'][a92_0x4643('0x3f')]]:_0x205781,[exports['sequelize']['Op']['lt']]:_0xe26b33},'amount':_0x593558['params'][a92_0x4643('0x39')]=='in'?{[exports['sequelize']['Op']['gt']]:0x0}:{[exports['sequelize']['Op']['lt']]:0x0}},'group':[exports[a92_0x4643('0x4')]['fn'](a92_0x4643('0x40'),exports[a92_0x4643('0x4')][a92_0x4643('0x36')](a92_0x4643('0x2d'))),exports[a92_0x4643('0x4')]['fn']('DAY',exports[a92_0x4643('0x4')]['col'](a92_0x4643('0x2d'))),exports[a92_0x4643('0x4')]['fn'](a92_0x4643('0x41'),exports[a92_0x4643('0x4')][a92_0x4643('0x36')](a92_0x4643('0x2d'))),exports[a92_0x4643('0x4')]['fn'](a92_0x4643('0x42'),exports[a92_0x4643('0x4')][a92_0x4643('0x36')]('countingDate'))],'order':[[a92_0x4643('0x2d'),a92_0x4643('0x2e')]]})[a92_0x4643('0x2f')](_0x3f21d3=>{_0x168376[a92_0x4643('0x13')]({'data':_0x3f21d3});});};exports[a92_0x4643('0x43')]=(_0x34c587,_0x331dab,_0x3bd68a)=>{const _0x28de51=_0x34c587[a92_0x4643('0x44')][a92_0x4643('0x45')][a92_0x4643('0x46')](_0x28de51=>_0x28de51['kind']===a92_0x4643('0x47'));fbgraph_1[a92_0x4643('0x1a')][a92_0x4643('0x48')](_0x28de51[a92_0x4643('0x49')]);fbgraph_1[a92_0x4643('0x1a')]['get'](_0x34c587[a92_0x4643('0x44')]['facebook']+'?fields=id,name,email,first_name,last_name,gender,link,locale,timezone',(_0x38144c,_0x1204b6)=>{if(_0x38144c){return _0x3bd68a(_0x38144c);}_0x331dab['render'](a92_0x4643('0x4a'),{'title':'Facebook\x20API','profile':_0x1204b6});});};
var a198_0x523d=['save','getPassCounting','findAll','countingDate','ASC','getPassCountingByDay','query','startDate','endDate','sum','params','direction','YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))','getPassCountingByHour','DATE_FORMAT','col','%Y-%m-%d\x20%H:00','countingDateShort','amount','total','HOUR','DAY','MONTH','getFacebook','user','find','kind','facebook','setAccessToken','accessToken','?fields=id,name,email,first_name,last_name,gender,link,locale,timezone','render','api/facebook','Facebook\x20API','__importDefault','__esModule','fbgraph','ftp','setSequelize','syncFtp','log','connecting','default','ready','connected','list','name','sequelize','reportFiles','findOrCreate','spread','push','error','connect','ftp.vivotek.com','ipd','models','findOne','then','connected:','colombia/','fileName','end','media/','.txt','pipe','Downloaded:\x20','json','processFtp','utf8','status','parse','Data','CountingInfo','passes','create'];(function(_0x18f079,_0x269d58){var _0x19332a=function(_0x2cb94e){while(--_0x2cb94e){_0x18f079['push'](_0x18f079['shift']());}};_0x19332a(++_0x269d58);}(a198_0x523d,0x19e));var a198_0x5f09=function(_0x13e4bb,_0x37e16f){_0x13e4bb=_0x13e4bb-0x0;var _0x20320a=a198_0x523d[_0x13e4bb];return _0x20320a;};'use strict';var __importDefault=this&&this[a198_0x5f09('0x0')]||function(_0x1bbb63){return _0x1bbb63&&_0x1bbb63[a198_0x5f09('0x1')]?_0x1bbb63:{'default':_0x1bbb63};};Object['defineProperty'](exports,a198_0x5f09('0x1'),{'value':!![]});const fbgraph_1=__importDefault(require(a198_0x5f09('0x2')));const ftp_1=__importDefault(require(a198_0x5f09('0x3')));const fs_1=__importDefault(require('fs'));function setSequelize(_0x2cd9c7){exports['sequelize']=_0x2cd9c7;}exports[a198_0x5f09('0x4')]=setSequelize;exports['getApi']=(_0x4ad9e3,_0x2d7f9b)=>{_0x2d7f9b['render']('api/index',{'title':'API\x20Examples'});};exports[a198_0x5f09('0x5')]=(_0x23e200,_0x3d8817)=>{console[a198_0x5f09('0x6')](a198_0x5f09('0x7'));const _0x348d00=[];const _0x2d8800=new ftp_1[(a198_0x5f09('0x8'))]();_0x2d8800['on'](a198_0x5f09('0x9'),function(){console[a198_0x5f09('0x6')](a198_0x5f09('0xa'));_0x2d8800[a198_0x5f09('0xb')]('colombia',![],function(_0x500d2a,_0x5d0598){if(_0x500d2a){}else{for(const _0x21f6c9 of _0x5d0598){console[a198_0x5f09('0x6')]('Downloading:\x20'+_0x21f6c9[a198_0x5f09('0xc')]);if(_0x21f6c9[a198_0x5f09('0xc')]['endsWith']('json')){exports[a198_0x5f09('0xd')]['models'][a198_0x5f09('0xe')][a198_0x5f09('0xf')]({'where':{'fileName':_0x21f6c9['name']}})[a198_0x5f09('0x10')]((_0x169158,_0x15d0b1)=>{if(_0x15d0b1){console[a198_0x5f09('0x6')](_0x21f6c9[a198_0x5f09('0xc')]);_0x348d00[a198_0x5f09('0x11')](_0x169158);}});}}}_0x3d8817['json']({'data':_0x348d00});});});_0x2d8800['on'](a198_0x5f09('0x12'),function(_0x5b9ee8){_0x3d8817['json']({'message':_0x5b9ee8});});_0x2d8800[a198_0x5f09('0x13')]({'host':a198_0x5f09('0x14'),'port':0x15,'user':a198_0x5f09('0x15'),'password':a198_0x5f09('0x15')});};exports['downloadFtp']=(_0x36bf12,_0x2d38e6)=>{exports[a198_0x5f09('0xd')][a198_0x5f09('0x16')][a198_0x5f09('0xe')][a198_0x5f09('0x17')]({'where':{'status':null}})[a198_0x5f09('0x18')](_0x2f66f3=>{if(_0x2f66f3){const _0x2f2ad5=new ftp_1[(a198_0x5f09('0x8'))]();_0x2f2ad5['on'](a198_0x5f09('0x9'),function(){console[a198_0x5f09('0x6')](a198_0x5f09('0x19')+_0x2f66f3['fileName']);_0x2f2ad5['get'](a198_0x5f09('0x1a')+_0x2f66f3[a198_0x5f09('0x1b')],function(_0x40f6ba,_0x4e1b23){_0x2f2ad5[a198_0x5f09('0x1c')]();if(_0x40f6ba){}else{const _0x3cbfba=a198_0x5f09('0x1d')+_0x2f66f3[a198_0x5f09('0x1b')]+a198_0x5f09('0x1e');_0x4e1b23[a198_0x5f09('0x1f')](fs_1[a198_0x5f09('0x8')]['createWriteStream'](_0x3cbfba));_0x2f66f3['status']=0x1;_0x2f66f3['save']();console[a198_0x5f09('0x6')](a198_0x5f09('0x20')+_0x2f66f3[a198_0x5f09('0x1b')]);}});});_0x2f2ad5['on']('error',function(_0xb4a3ab){_0x2d38e6[a198_0x5f09('0x21')]({'message':_0xb4a3ab});});_0x2f2ad5['connect']({'host':'ftp.vivotek.com','port':0x15,'user':a198_0x5f09('0x15'),'password':'ipd'});_0x2d38e6[a198_0x5f09('0x21')]({'data':_0x2f66f3[a198_0x5f09('0x1b')]});}else{_0x2d38e6[a198_0x5f09('0x21')]({'data':[]});}});};exports[a198_0x5f09('0x22')]=(_0x46a1b9,_0x2dfe46)=>{exports['sequelize'][a198_0x5f09('0x16')][a198_0x5f09('0xe')]['findOne']({'where':{'status':0x1}})[a198_0x5f09('0x18')](_0x4d023f=>{if(_0x4d023f){const _0x557081='media/'+_0x4d023f[a198_0x5f09('0x1b')]+a198_0x5f09('0x1e');fs_1[a198_0x5f09('0x8')]['readFile'](_0x557081,a198_0x5f09('0x23'),function(_0x5acfc0,_0x18e460){if(_0x5acfc0){_0x4d023f[a198_0x5f09('0x24')]=null;}else{try{const _0x3a8ab6=JSON[a198_0x5f09('0x25')](_0x18e460);for(const _0x4618c9 of _0x3a8ab6[a198_0x5f09('0x26')][0x0][a198_0x5f09('0x27')]){const _0x56d51d=_0x4618c9['In'];const _0x50885b=_0x4618c9['Out'];const _0xbea80d=Date[a198_0x5f09('0x25')](_0x4618c9['EndTime']);if(_0x56d51d>0x0){exports['sequelize'][a198_0x5f09('0x16')][a198_0x5f09('0x28')][a198_0x5f09('0x29')]({'reportFileId':_0x4d023f['id'],'amount':_0x56d51d,'countingDate':_0xbea80d});}if(_0x50885b>0x0){exports[a198_0x5f09('0xd')][a198_0x5f09('0x16')]['passes'][a198_0x5f09('0x29')]({'reportFileId':_0x4d023f['id'],'amount':_0x50885b*-0x1,'countingDate':_0xbea80d});}}_0x4d023f[a198_0x5f09('0x24')]=0x2;}catch(_0x52f55b){_0x4d023f['status']=null;}}_0x4d023f[a198_0x5f09('0x2a')]();});_0x2dfe46[a198_0x5f09('0x21')]({'data':_0x4d023f[a198_0x5f09('0x1b')]});}else{_0x2dfe46['json']({'data':[]});}});};exports[a198_0x5f09('0x2b')]=(_0x3298fc,_0x305619)=>{exports[a198_0x5f09('0xd')][a198_0x5f09('0x16')][a198_0x5f09('0x28')][a198_0x5f09('0x2c')]({'where':{'amount':{[exports[a198_0x5f09('0xd')]['Op']['gt']]:0x0}},'order':[[a198_0x5f09('0x2d'),a198_0x5f09('0x2e')]]})[a198_0x5f09('0x18')](_0x160e6d=>{_0x305619[a198_0x5f09('0x21')]({'data':_0x160e6d});});};exports[a198_0x5f09('0x2f')]=(_0x4d68f9,_0x173f05)=>{const _0x576750=_0x4d68f9['query']['month'];const _0x301a77=_0x4d68f9[a198_0x5f09('0x30')][a198_0x5f09('0x31')];const _0x571447=_0x4d68f9['query'][a198_0x5f09('0x32')];exports[a198_0x5f09('0xd')][a198_0x5f09('0x16')][a198_0x5f09('0x28')][a198_0x5f09('0x2c')]({'attributes':['countingDate',[exports['sequelize']['fn'](a198_0x5f09('0x33'),exports[a198_0x5f09('0xd')]['col']('amount')),'total']],'where':{'countingDate':{[exports[a198_0x5f09('0xd')]['Op']['gte']]:_0x301a77,[exports[a198_0x5f09('0xd')]['Op']['lt']]:_0x571447},'amount':_0x4d68f9[a198_0x5f09('0x34')][a198_0x5f09('0x35')]=='in'?{[exports['sequelize']['Op']['gt']]:0x0}:{[exports[a198_0x5f09('0xd')]['Op']['lt']]:0x0}},'group':[exports[a198_0x5f09('0xd')]['literal'](a198_0x5f09('0x36'))],'order':[[a198_0x5f09('0x2d'),a198_0x5f09('0x2e')]]})[a198_0x5f09('0x18')](_0xfd607=>{_0x173f05[a198_0x5f09('0x21')]({'data':_0xfd607});});};exports[a198_0x5f09('0x37')]=(_0x5e201b,_0x49062a)=>{const _0xff3b40=_0x5e201b[a198_0x5f09('0x30')]['month'];const _0x20e9f1=_0x5e201b[a198_0x5f09('0x30')][a198_0x5f09('0x31')];const _0x2f2cb4=_0x5e201b['query'][a198_0x5f09('0x32')];exports[a198_0x5f09('0xd')][a198_0x5f09('0x16')]['passes'][a198_0x5f09('0x2c')]({'attributes':[a198_0x5f09('0x2d'),[exports[a198_0x5f09('0xd')]['fn'](a198_0x5f09('0x38'),exports[a198_0x5f09('0xd')][a198_0x5f09('0x39')](a198_0x5f09('0x2d')),a198_0x5f09('0x3a')),a198_0x5f09('0x3b')],[exports['sequelize']['fn'](a198_0x5f09('0x33'),exports[a198_0x5f09('0xd')][a198_0x5f09('0x39')](a198_0x5f09('0x3c'))),a198_0x5f09('0x3d')]],'where':{'countingDate':{[exports['sequelize']['Op']['gte']]:_0x20e9f1,[exports[a198_0x5f09('0xd')]['Op']['lt']]:_0x2f2cb4},'amount':_0x5e201b['params'][a198_0x5f09('0x35')]=='in'?{[exports['sequelize']['Op']['gt']]:0x0}:{[exports[a198_0x5f09('0xd')]['Op']['lt']]:0x0}},'group':[exports[a198_0x5f09('0xd')]['fn'](a198_0x5f09('0x3e'),exports[a198_0x5f09('0xd')][a198_0x5f09('0x39')](a198_0x5f09('0x2d'))),exports[a198_0x5f09('0xd')]['fn'](a198_0x5f09('0x3f'),exports['sequelize'][a198_0x5f09('0x39')](a198_0x5f09('0x2d'))),exports['sequelize']['fn'](a198_0x5f09('0x40'),exports[a198_0x5f09('0xd')]['col'](a198_0x5f09('0x2d'))),exports['sequelize']['fn']('YEAR',exports[a198_0x5f09('0xd')][a198_0x5f09('0x39')](a198_0x5f09('0x2d')))],'order':[[a198_0x5f09('0x2d'),a198_0x5f09('0x2e')]]})[a198_0x5f09('0x18')](_0x4b86a8=>{_0x49062a[a198_0x5f09('0x21')]({'data':_0x4b86a8});});};exports[a198_0x5f09('0x41')]=(_0x456386,_0x2bba5d,_0x350c55)=>{const _0x38b5f3=_0x456386[a198_0x5f09('0x42')]['tokens'][a198_0x5f09('0x43')](_0x38b5f3=>_0x38b5f3[a198_0x5f09('0x44')]===a198_0x5f09('0x45'));fbgraph_1[a198_0x5f09('0x8')][a198_0x5f09('0x46')](_0x38b5f3[a198_0x5f09('0x47')]);fbgraph_1[a198_0x5f09('0x8')]['get'](_0x456386[a198_0x5f09('0x42')][a198_0x5f09('0x45')]+a198_0x5f09('0x48'),(_0x49abbf,_0x2516df)=>{if(_0x49abbf){return _0x350c55(_0x49abbf);}_0x2bba5d[a198_0x5f09('0x49')](a198_0x5f09('0x4a'),{'title':a198_0x5f09('0x4b'),'profile':_0x2516df});});};
var a198_0x4b40=['connect','ipd','downloadFtp','findOne','then','ready','connected:','fileName','media/','pipe','createWriteStream','status','ftp.vivotek.com','.txt','readFile','utf8','parse','Data','CountingInfo','EndTime','passes','findAll','countingDate','ASC','getPassCountingByDay','month','query','startDate','endDate','sum','col','amount','gte','params','direction','YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))','getPassCountingByHour','DATE_FORMAT','%Y-%m-%d\x20%H:00','HOUR','DAY','MONTH','getFacebook','tokens','find','kind','facebook','setAccessToken','accessToken','get','user','?fields=id,name,email,first_name,last_name,gender,link,locale,timezone','api/facebook','Facebook\x20API','__importDefault','defineProperty','__esModule','fbgraph','ftp','sequelize','setSequelize','getApi','render','api/index','API\x20Examples','syncFtp','log','connecting','default','list','colombia','Downloading:\x20','endsWith','json','models','reportFiles','findOrCreate','name','spread','push','error'];(function(_0x25482b,_0x4b2d27){var _0x5d4d15=function(_0x2554a4){while(--_0x2554a4){_0x25482b['push'](_0x25482b['shift']());}};_0x5d4d15(++_0x4b2d27);}(a198_0x4b40,0x87));var a198_0x5740=function(_0x143276,_0x1b4f44){_0x143276=_0x143276-0x0;var _0x3b88b6=a198_0x4b40[_0x143276];return _0x3b88b6;};'use strict';var __importDefault=this&&this[a198_0x5740('0x0')]||function(_0x2ce190){return _0x2ce190&&_0x2ce190['__esModule']?_0x2ce190:{'default':_0x2ce190};};Object[a198_0x5740('0x1')](exports,a198_0x5740('0x2'),{'value':!![]});const fbgraph_1=__importDefault(require(a198_0x5740('0x3')));const ftp_1=__importDefault(require(a198_0x5740('0x4')));const fs_1=__importDefault(require('fs'));function setSequelize(_0xf2e1f0){exports[a198_0x5740('0x5')]=_0xf2e1f0;}exports[a198_0x5740('0x6')]=setSequelize;exports[a198_0x5740('0x7')]=(_0x137a3f,_0x36a1ad)=>{_0x36a1ad[a198_0x5740('0x8')](a198_0x5740('0x9'),{'title':a198_0x5740('0xa')});};exports[a198_0x5740('0xb')]=(_0x44aa8d,_0x4b60cc)=>{console[a198_0x5740('0xc')](a198_0x5740('0xd'));const _0x32a25f=[];const _0x5325ed=new ftp_1[(a198_0x5740('0xe'))]();_0x5325ed['on']('ready',function(){console[a198_0x5740('0xc')]('connected');_0x5325ed[a198_0x5740('0xf')](a198_0x5740('0x10'),![],function(_0x30dc6d,_0xe5d7c1){if(_0x30dc6d){}else{for(const _0x2a94b6 of _0xe5d7c1){console['log'](a198_0x5740('0x11')+_0x2a94b6['name']);if(_0x2a94b6['name'][a198_0x5740('0x12')](a198_0x5740('0x13'))){exports[a198_0x5740('0x5')][a198_0x5740('0x14')][a198_0x5740('0x15')][a198_0x5740('0x16')]({'where':{'fileName':_0x2a94b6[a198_0x5740('0x17')]}})[a198_0x5740('0x18')]((_0x1796d2,_0x47597c)=>{if(_0x47597c){console[a198_0x5740('0xc')](_0x2a94b6['name']);_0x32a25f[a198_0x5740('0x19')](_0x1796d2);}});}}}_0x4b60cc[a198_0x5740('0x13')]({'data':_0x32a25f});});});_0x5325ed['on'](a198_0x5740('0x1a'),function(_0x2b6c79){_0x4b60cc[a198_0x5740('0x13')]({'message':_0x2b6c79});});_0x5325ed[a198_0x5740('0x1b')]({'host':'ftp.vivotek.com','port':0x15,'user':a198_0x5740('0x1c'),'password':a198_0x5740('0x1c')});};exports[a198_0x5740('0x1d')]=(_0x431c15,_0x4811a5)=>{exports[a198_0x5740('0x5')][a198_0x5740('0x14')][a198_0x5740('0x15')][a198_0x5740('0x1e')]({'where':{'status':null}})[a198_0x5740('0x1f')](_0x49dc32=>{if(_0x49dc32){const _0x3b6fb0=new ftp_1[(a198_0x5740('0xe'))]();_0x3b6fb0['on'](a198_0x5740('0x20'),function(){console[a198_0x5740('0xc')](a198_0x5740('0x21')+_0x49dc32[a198_0x5740('0x22')]);_0x3b6fb0['get']('colombia/'+_0x49dc32[a198_0x5740('0x22')],function(_0x5b8b27,_0x53b77c){_0x3b6fb0['end']();if(_0x5b8b27){}else{const _0x126b0b=a198_0x5740('0x23')+_0x49dc32['fileName']+'.txt';_0x53b77c[a198_0x5740('0x24')](fs_1[a198_0x5740('0xe')][a198_0x5740('0x25')](_0x126b0b));_0x49dc32[a198_0x5740('0x26')]=0x1;_0x49dc32['save']();console[a198_0x5740('0xc')]('Downloaded:\x20'+_0x49dc32[a198_0x5740('0x22')]);}});});_0x3b6fb0['on'](a198_0x5740('0x1a'),function(_0x5ddb57){_0x4811a5[a198_0x5740('0x13')]({'message':_0x5ddb57});});_0x3b6fb0[a198_0x5740('0x1b')]({'host':a198_0x5740('0x27'),'port':0x15,'user':'ipd','password':a198_0x5740('0x1c')});_0x4811a5['json']({'data':_0x49dc32[a198_0x5740('0x22')]});}else{_0x4811a5[a198_0x5740('0x13')]({'data':[]});}});};exports['processFtp']=(_0x3b8e13,_0x16cee7)=>{exports[a198_0x5740('0x5')][a198_0x5740('0x14')]['reportFiles']['findOne']({'where':{'status':0x1}})['then'](_0x1d4196=>{if(_0x1d4196){const _0x2159da='media/'+_0x1d4196[a198_0x5740('0x22')]+a198_0x5740('0x28');fs_1[a198_0x5740('0xe')][a198_0x5740('0x29')](_0x2159da,a198_0x5740('0x2a'),function(_0x2db8a6,_0x458190){if(_0x2db8a6){_0x1d4196['status']=null;}else{try{const _0x3e1a90=JSON[a198_0x5740('0x2b')](_0x458190);for(const _0x1d8e4b of _0x3e1a90[a198_0x5740('0x2c')][0x0][a198_0x5740('0x2d')]){const _0x60ebd9=_0x1d8e4b['In'];const _0x4f6f30=_0x1d8e4b['Out'];const _0x2faf04=Date['parse'](_0x1d8e4b[a198_0x5740('0x2e')]);if(_0x60ebd9>0x0){exports[a198_0x5740('0x5')][a198_0x5740('0x14')][a198_0x5740('0x2f')]['create']({'reportFileId':_0x1d4196['id'],'amount':_0x60ebd9,'countingDate':_0x2faf04});}if(_0x4f6f30>0x0){exports[a198_0x5740('0x5')][a198_0x5740('0x14')][a198_0x5740('0x2f')]['create']({'reportFileId':_0x1d4196['id'],'amount':_0x4f6f30*-0x1,'countingDate':_0x2faf04});}}_0x1d4196['status']=0x2;}catch(_0x7ca6f3){_0x1d4196[a198_0x5740('0x26')]=null;}}_0x1d4196['save']();});_0x16cee7[a198_0x5740('0x13')]({'data':_0x1d4196['fileName']});}else{_0x16cee7[a198_0x5740('0x13')]({'data':[]});}});};exports['getPassCounting']=(_0x85fd5e,_0x32ae70)=>{exports[a198_0x5740('0x5')][a198_0x5740('0x14')]['passes'][a198_0x5740('0x30')]({'where':{'amount':{[exports['sequelize']['Op']['gt']]:0x0}},'order':[[a198_0x5740('0x31'),a198_0x5740('0x32')]]})[a198_0x5740('0x1f')](_0x5a813b=>{_0x32ae70[a198_0x5740('0x13')]({'data':_0x5a813b});});};exports[a198_0x5740('0x33')]=(_0x241460,_0x4fa0cf)=>{const _0x33bbf5=_0x241460['query'][a198_0x5740('0x34')];const _0x3d86ee=_0x241460[a198_0x5740('0x35')][a198_0x5740('0x36')];const _0x331a8b=_0x241460[a198_0x5740('0x35')][a198_0x5740('0x37')];exports[a198_0x5740('0x5')]['models'][a198_0x5740('0x2f')]['findAll']({'attributes':[a198_0x5740('0x31'),[exports[a198_0x5740('0x5')]['fn'](a198_0x5740('0x38'),exports['sequelize'][a198_0x5740('0x39')](a198_0x5740('0x3a'))),'total']],'where':{'countingDate':{[exports[a198_0x5740('0x5')]['Op'][a198_0x5740('0x3b')]]:_0x3d86ee,[exports[a198_0x5740('0x5')]['Op']['lt']]:_0x331a8b},'amount':_0x241460[a198_0x5740('0x3c')][a198_0x5740('0x3d')]=='in'?{[exports[a198_0x5740('0x5')]['Op']['gt']]:0x0}:{[exports[a198_0x5740('0x5')]['Op']['lt']]:0x0}},'group':[exports[a198_0x5740('0x5')]['literal'](a198_0x5740('0x3e'))],'order':[['countingDate',a198_0x5740('0x32')]]})[a198_0x5740('0x1f')](_0x3540b4=>{_0x4fa0cf[a198_0x5740('0x13')]({'data':_0x3540b4});});};exports[a198_0x5740('0x3f')]=(_0x433f90,_0x32e65e)=>{const _0x2663d3=_0x433f90[a198_0x5740('0x35')][a198_0x5740('0x34')];const _0x690db4=_0x433f90['query'][a198_0x5740('0x36')];const _0x5815fe=_0x433f90[a198_0x5740('0x35')]['endDate'];exports['sequelize'][a198_0x5740('0x14')][a198_0x5740('0x2f')]['findAll']({'attributes':[a198_0x5740('0x31'),[exports[a198_0x5740('0x5')]['fn'](a198_0x5740('0x40'),exports[a198_0x5740('0x5')]['col'](a198_0x5740('0x31')),a198_0x5740('0x41')),'countingDateShort'],[exports[a198_0x5740('0x5')]['fn']('sum',exports[a198_0x5740('0x5')][a198_0x5740('0x39')](a198_0x5740('0x3a'))),'total']],'where':{'countingDate':{[exports['sequelize']['Op'][a198_0x5740('0x3b')]]:_0x690db4,[exports[a198_0x5740('0x5')]['Op']['lt']]:_0x5815fe},'amount':_0x433f90[a198_0x5740('0x3c')]['direction']=='in'?{[exports[a198_0x5740('0x5')]['Op']['gt']]:0x0}:{[exports['sequelize']['Op']['lt']]:0x0}},'group':[exports[a198_0x5740('0x5')]['fn'](a198_0x5740('0x42'),exports[a198_0x5740('0x5')][a198_0x5740('0x39')](a198_0x5740('0x31'))),exports[a198_0x5740('0x5')]['fn'](a198_0x5740('0x43'),exports[a198_0x5740('0x5')]['col'](a198_0x5740('0x31'))),exports[a198_0x5740('0x5')]['fn'](a198_0x5740('0x44'),exports['sequelize']['col']('countingDate')),exports[a198_0x5740('0x5')]['fn']('YEAR',exports[a198_0x5740('0x5')]['col'](a198_0x5740('0x31')))],'order':[[a198_0x5740('0x31'),a198_0x5740('0x32')]]})[a198_0x5740('0x1f')](_0x2b1798=>{_0x32e65e[a198_0x5740('0x13')]({'data':_0x2b1798});});};exports[a198_0x5740('0x45')]=(_0x4ed024,_0x5d3887,_0x503310)=>{const _0x1700b9=_0x4ed024['user'][a198_0x5740('0x46')][a198_0x5740('0x47')](_0x1700b9=>_0x1700b9[a198_0x5740('0x48')]===a198_0x5740('0x49'));fbgraph_1['default'][a198_0x5740('0x4a')](_0x1700b9[a198_0x5740('0x4b')]);fbgraph_1[a198_0x5740('0xe')][a198_0x5740('0x4c')](_0x4ed024[a198_0x5740('0x4d')][a198_0x5740('0x49')]+a198_0x5740('0x4e'),(_0x5e72fb,_0x51f670)=>{if(_0x5e72fb){return _0x503310(_0x5e72fb);}_0x5d3887[a198_0x5740('0x8')](a198_0x5740('0x4f'),{'title':a198_0x5740('0x50'),'profile':_0x51f670});});};
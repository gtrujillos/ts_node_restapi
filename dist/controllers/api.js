var a88_0x61d0=['.txt','readFile','utf8','parse','Data','CountingInfo','Out','EndTime','create','passes','getPassCounting','findAll','countingDate','getPassCountingByDay','query','month','startDate','sum','col','amount','total','gte','params','direction','literal','ASC','getPassCountingByHour','DATE_FORMAT','HOUR','DAY','MONTH','YEAR','getFacebook','user','tokens','find','kind','facebook','setAccessToken','accessToken','get','?fields=id,name,email,first_name,last_name,gender,link,locale,timezone','api/facebook','Facebook\x20API','__importDefault','__esModule','defineProperty','fbgraph','sequelize','setSequelize','getApi','render','connecting','default','ready','log','colombia','Downloading:\x20','name','endsWith','json','models','reportFiles','findOrCreate','spread','push','error','connect','ftp.vivotek.com','ipd','then','connected:','fileName','colombia/','end','media/','pipe','createWriteStream','status','save','Downloaded:\x20','processFtp'];(function(_0x55e58b,_0x1bf11a){var _0x3294c2=function(_0x38e89f){while(--_0x38e89f){_0x55e58b['push'](_0x55e58b['shift']());}};_0x3294c2(++_0x1bf11a);}(a88_0x61d0,0xd0));var a88_0x252f=function(_0x507328,_0x44714f){_0x507328=_0x507328-0x0;var _0x49d946=a88_0x61d0[_0x507328];return _0x49d946;};'use strict';var __importDefault=this&&this[a88_0x252f('0x0')]||function(_0x4e6674){return _0x4e6674&&_0x4e6674[a88_0x252f('0x1')]?_0x4e6674:{'default':_0x4e6674};};Object[a88_0x252f('0x2')](exports,a88_0x252f('0x1'),{'value':!![]});const fbgraph_1=__importDefault(require(a88_0x252f('0x3')));const ftp_1=__importDefault(require('ftp'));const fs_1=__importDefault(require('fs'));function setSequelize(_0x4789d7){exports[a88_0x252f('0x4')]=_0x4789d7;}exports[a88_0x252f('0x5')]=setSequelize;exports[a88_0x252f('0x6')]=(_0x8e3811,_0x2d5be5)=>{_0x2d5be5[a88_0x252f('0x7')]('api/index',{'title':'API\x20Examples'});};exports['syncFtp']=(_0x31175f,_0x1b35c8)=>{console['log'](a88_0x252f('0x8'));const _0x4383e7=[];const _0x13085d=new ftp_1[(a88_0x252f('0x9'))]();_0x13085d['on'](a88_0x252f('0xa'),function(){console[a88_0x252f('0xb')]('connected');_0x13085d['list'](a88_0x252f('0xc'),![],function(_0x32861f,_0x29df82){if(_0x32861f){}else{for(const _0xec822b of _0x29df82){console['log'](a88_0x252f('0xd')+_0xec822b[a88_0x252f('0xe')]);if(_0xec822b[a88_0x252f('0xe')][a88_0x252f('0xf')](a88_0x252f('0x10'))){exports[a88_0x252f('0x4')][a88_0x252f('0x11')][a88_0x252f('0x12')][a88_0x252f('0x13')]({'where':{'fileName':_0xec822b[a88_0x252f('0xe')]}})[a88_0x252f('0x14')]((_0x20afa5,_0x3cbe6a)=>{if(_0x3cbe6a){console[a88_0x252f('0xb')](_0xec822b[a88_0x252f('0xe')]);_0x4383e7[a88_0x252f('0x15')](_0x20afa5);}});}}}_0x1b35c8[a88_0x252f('0x10')]({'data':_0x4383e7});});});_0x13085d['on'](a88_0x252f('0x16'),function(_0x5958c0){_0x1b35c8[a88_0x252f('0x10')]({'message':_0x5958c0});});_0x13085d[a88_0x252f('0x17')]({'host':a88_0x252f('0x18'),'port':0x15,'user':a88_0x252f('0x19'),'password':'ipd'});};exports['downloadFtp']=(_0x3d9eb8,_0x448a12)=>{exports[a88_0x252f('0x4')]['models'][a88_0x252f('0x12')]['findOne']({'where':{'status':null}})[a88_0x252f('0x1a')](_0x3eb31c=>{if(_0x3eb31c){const _0x520909=new ftp_1[(a88_0x252f('0x9'))]();_0x520909['on'](a88_0x252f('0xa'),function(){console['log'](a88_0x252f('0x1b')+_0x3eb31c[a88_0x252f('0x1c')]);_0x520909['get'](a88_0x252f('0x1d')+_0x3eb31c['fileName'],function(_0x3bed7e,_0x219839){_0x520909[a88_0x252f('0x1e')]();if(_0x3bed7e){}else{const _0x1a5242=a88_0x252f('0x1f')+_0x3eb31c[a88_0x252f('0x1c')]+'.txt';_0x219839[a88_0x252f('0x20')](fs_1[a88_0x252f('0x9')][a88_0x252f('0x21')](_0x1a5242));_0x3eb31c[a88_0x252f('0x22')]=0x1;_0x3eb31c[a88_0x252f('0x23')]();console['log'](a88_0x252f('0x24')+_0x3eb31c['fileName']);}});});_0x520909['on']('error',function(_0x9d71bc){_0x448a12['json']({'message':_0x9d71bc});});_0x520909[a88_0x252f('0x17')]({'host':a88_0x252f('0x18'),'port':0x15,'user':'ipd','password':'ipd'});_0x448a12['json']({'data':_0x3eb31c[a88_0x252f('0x1c')]});}else{_0x448a12['json']({'data':[]});}});};exports[a88_0x252f('0x25')]=(_0xa7e1fb,_0x2ec189)=>{exports[a88_0x252f('0x4')]['models'][a88_0x252f('0x12')]['findOne']({'where':{'status':0x1}})[a88_0x252f('0x1a')](_0x1bc4b1=>{if(_0x1bc4b1){const _0x215e96='media/'+_0x1bc4b1[a88_0x252f('0x1c')]+a88_0x252f('0x26');fs_1[a88_0x252f('0x9')][a88_0x252f('0x27')](_0x215e96,a88_0x252f('0x28'),function(_0xdfa223,_0x51c04b){if(_0xdfa223){_0x1bc4b1[a88_0x252f('0x22')]=null;}else{try{const _0xdacb26=JSON[a88_0x252f('0x29')](_0x51c04b);for(const _0x2fb52b of _0xdacb26[a88_0x252f('0x2a')][0x0][a88_0x252f('0x2b')]){const _0x236d09=_0x2fb52b['In'];const _0x4bac39=_0x2fb52b[a88_0x252f('0x2c')];const _0x2ff596=Date[a88_0x252f('0x29')](_0x2fb52b[a88_0x252f('0x2d')]);if(_0x236d09>0x0){exports['sequelize'][a88_0x252f('0x11')]['passes'][a88_0x252f('0x2e')]({'reportFileId':_0x1bc4b1['id'],'amount':_0x236d09,'countingDate':_0x2ff596});}if(_0x4bac39>0x0){exports[a88_0x252f('0x4')][a88_0x252f('0x11')][a88_0x252f('0x2f')][a88_0x252f('0x2e')]({'reportFileId':_0x1bc4b1['id'],'amount':_0x4bac39*-0x1,'countingDate':_0x2ff596});}}_0x1bc4b1[a88_0x252f('0x22')]=0x2;}catch(_0x5c16d0){_0x1bc4b1[a88_0x252f('0x22')]=null;}}_0x1bc4b1['save']();});_0x2ec189[a88_0x252f('0x10')]({'data':_0x1bc4b1[a88_0x252f('0x1c')]});}else{_0x2ec189[a88_0x252f('0x10')]({'data':[]});}});};exports[a88_0x252f('0x30')]=(_0x2cd207,_0x4b4cef)=>{exports[a88_0x252f('0x4')][a88_0x252f('0x11')][a88_0x252f('0x2f')][a88_0x252f('0x31')]({'where':{'amount':{[exports['sequelize']['Op']['gt']]:0x0}},'order':[[a88_0x252f('0x32'),'ASC']]})[a88_0x252f('0x1a')](_0x40f81e=>{_0x4b4cef['json']({'data':_0x40f81e});});};exports[a88_0x252f('0x33')]=(_0x819a2c,_0x5c47f7)=>{const _0x35d9a1=_0x819a2c[a88_0x252f('0x34')][a88_0x252f('0x35')];const _0x5ee5fa=_0x819a2c[a88_0x252f('0x34')][a88_0x252f('0x36')];const _0x5031ac=_0x819a2c[a88_0x252f('0x34')]['endDate'];exports[a88_0x252f('0x4')][a88_0x252f('0x11')][a88_0x252f('0x2f')][a88_0x252f('0x31')]({'attributes':[a88_0x252f('0x32'),[exports[a88_0x252f('0x4')]['fn'](a88_0x252f('0x37'),exports[a88_0x252f('0x4')][a88_0x252f('0x38')](a88_0x252f('0x39'))),a88_0x252f('0x3a')]],'where':{'countingDate':{[exports[a88_0x252f('0x4')]['Op'][a88_0x252f('0x3b')]]:_0x5ee5fa,[exports['sequelize']['Op']['lt']]:_0x5031ac},'amount':_0x819a2c[a88_0x252f('0x3c')][a88_0x252f('0x3d')]=='in'?{[exports[a88_0x252f('0x4')]['Op']['gt']]:0x0}:{[exports[a88_0x252f('0x4')]['Op']['lt']]:0x0}},'group':[exports['sequelize'][a88_0x252f('0x3e')]('YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))')],'order':[['countingDate',a88_0x252f('0x3f')]]})['then'](_0x26db7a=>{_0x5c47f7[a88_0x252f('0x10')]({'data':_0x26db7a});});};exports[a88_0x252f('0x40')]=(_0x281bec,_0xd6fa3)=>{const _0x242613=_0x281bec[a88_0x252f('0x34')][a88_0x252f('0x35')];const _0x7464fb=_0x281bec[a88_0x252f('0x34')][a88_0x252f('0x36')];const _0x1d9dcd=_0x281bec[a88_0x252f('0x34')]['endDate'];exports['sequelize'][a88_0x252f('0x11')][a88_0x252f('0x2f')][a88_0x252f('0x31')]({'attributes':[a88_0x252f('0x32'),[exports[a88_0x252f('0x4')]['fn'](a88_0x252f('0x41'),exports[a88_0x252f('0x4')][a88_0x252f('0x38')](a88_0x252f('0x32')),'%Y-%m-%d\x20%H:00'),'countingDateShort'],[exports[a88_0x252f('0x4')]['fn'](a88_0x252f('0x37'),exports[a88_0x252f('0x4')][a88_0x252f('0x38')](a88_0x252f('0x39'))),a88_0x252f('0x3a')]],'where':{'countingDate':{[exports[a88_0x252f('0x4')]['Op'][a88_0x252f('0x3b')]]:_0x7464fb,[exports[a88_0x252f('0x4')]['Op']['lt']]:_0x1d9dcd},'amount':_0x281bec['params']['direction']=='in'?{[exports[a88_0x252f('0x4')]['Op']['gt']]:0x0}:{[exports[a88_0x252f('0x4')]['Op']['lt']]:0x0}},'group':[exports[a88_0x252f('0x4')]['fn'](a88_0x252f('0x42'),exports['sequelize'][a88_0x252f('0x38')](a88_0x252f('0x32'))),exports[a88_0x252f('0x4')]['fn'](a88_0x252f('0x43'),exports[a88_0x252f('0x4')][a88_0x252f('0x38')](a88_0x252f('0x32'))),exports['sequelize']['fn'](a88_0x252f('0x44'),exports[a88_0x252f('0x4')][a88_0x252f('0x38')]('countingDate')),exports['sequelize']['fn'](a88_0x252f('0x45'),exports[a88_0x252f('0x4')][a88_0x252f('0x38')](a88_0x252f('0x32')))],'order':[['countingDate','ASC']]})[a88_0x252f('0x1a')](_0x4c3b49=>{_0xd6fa3[a88_0x252f('0x10')]({'data':_0x4c3b49});});};exports[a88_0x252f('0x46')]=(_0x1b0263,_0x5e3aa6,_0x3c50f7)=>{const _0x2c641f=_0x1b0263[a88_0x252f('0x47')][a88_0x252f('0x48')][a88_0x252f('0x49')](_0x2c641f=>_0x2c641f[a88_0x252f('0x4a')]===a88_0x252f('0x4b'));fbgraph_1[a88_0x252f('0x9')][a88_0x252f('0x4c')](_0x2c641f[a88_0x252f('0x4d')]);fbgraph_1[a88_0x252f('0x9')][a88_0x252f('0x4e')](_0x1b0263[a88_0x252f('0x47')][a88_0x252f('0x4b')]+a88_0x252f('0x4f'),(_0x4d54dd,_0x2b3743)=>{if(_0x4d54dd){return _0x3c50f7(_0x4d54dd);}_0x5e3aa6[a88_0x252f('0x7')](a88_0x252f('0x50'),{'title':a88_0x252f('0x51'),'profile':_0x2b3743});});};
var a92_0x351e=['direction','literal','YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))','ASC','getPassCountingByHour','endDate','col','%Y-%m-%d\x20%H:00','countingDateShort','HOUR','getFacebook','find','kind','accessToken','user','facebook','Facebook\x20API','__importDefault','defineProperty','__esModule','fbgraph','ftp','sequelize','setSequelize','getApi','render','API\x20Examples','syncFtp','log','connecting','default','connected','colombia','Downloading:\x20','name','endsWith','models','reportFiles','findOrCreate','spread','error','connect','ftp.vivotek.com','ipd','downloadFtp','findOne','then','ready','connected:','get','fileName','end','media/','.txt','pipe','createWriteStream','status','save','Downloaded:\x20','json','processFtp','readFile','utf8','parse','EndTime','passes','create','getPassCounting','findAll','countingDate','getPassCountingByDay','query','month','startDate','sum','amount','total','gte','params'];(function(_0x42ebad,_0x49af0b){var _0x3a33eb=function(_0x342aa0){while(--_0x342aa0){_0x42ebad['push'](_0x42ebad['shift']());}};_0x3a33eb(++_0x49af0b);}(a92_0x351e,0xfe));var a92_0x55cc=function(_0x222f7a,_0x371297){_0x222f7a=_0x222f7a-0x0;var _0x10066f=a92_0x351e[_0x222f7a];return _0x10066f;};'use strict';var __importDefault=this&&this[a92_0x55cc('0x0')]||function(_0x257621){return _0x257621&&_0x257621['__esModule']?_0x257621:{'default':_0x257621};};Object[a92_0x55cc('0x1')](exports,a92_0x55cc('0x2'),{'value':!![]});const fbgraph_1=__importDefault(require(a92_0x55cc('0x3')));const ftp_1=__importDefault(require(a92_0x55cc('0x4')));const fs_1=__importDefault(require('fs'));function setSequelize(_0x9e9530){exports[a92_0x55cc('0x5')]=_0x9e9530;}exports[a92_0x55cc('0x6')]=setSequelize;exports[a92_0x55cc('0x7')]=(_0x2b2a14,_0x26f6fe)=>{_0x26f6fe[a92_0x55cc('0x8')]('api/index',{'title':a92_0x55cc('0x9')});};exports[a92_0x55cc('0xa')]=(_0x4df8e9,_0x103b17)=>{console[a92_0x55cc('0xb')](a92_0x55cc('0xc'));const _0x370e41=[];const _0xb7d96d=new ftp_1[(a92_0x55cc('0xd'))]();_0xb7d96d['on']('ready',function(){console[a92_0x55cc('0xb')](a92_0x55cc('0xe'));_0xb7d96d['list'](a92_0x55cc('0xf'),![],function(_0x2ed12c,_0xc14a83){if(_0x2ed12c){}else{for(const _0x571820 of _0xc14a83){console[a92_0x55cc('0xb')](a92_0x55cc('0x10')+_0x571820['name']);if(_0x571820[a92_0x55cc('0x11')][a92_0x55cc('0x12')]('json')){exports[a92_0x55cc('0x5')][a92_0x55cc('0x13')][a92_0x55cc('0x14')][a92_0x55cc('0x15')]({'where':{'fileName':_0x571820['name']}})[a92_0x55cc('0x16')]((_0x4d76b7,_0x546d98)=>{if(_0x546d98){console['log'](_0x571820[a92_0x55cc('0x11')]);_0x370e41['push'](_0x4d76b7);}});}}}_0x103b17['json']({'data':_0x370e41});});});_0xb7d96d['on'](a92_0x55cc('0x17'),function(_0x44dee5){_0x103b17['json']({'message':_0x44dee5});});_0xb7d96d[a92_0x55cc('0x18')]({'host':a92_0x55cc('0x19'),'port':0x15,'user':a92_0x55cc('0x1a'),'password':a92_0x55cc('0x1a')});};exports[a92_0x55cc('0x1b')]=(_0x5e9e9b,_0x3e0859)=>{exports[a92_0x55cc('0x5')][a92_0x55cc('0x13')][a92_0x55cc('0x14')][a92_0x55cc('0x1c')]({'where':{'status':null}})[a92_0x55cc('0x1d')](_0x4df4c5=>{if(_0x4df4c5){const _0x4d3191=new ftp_1['default']();_0x4d3191['on'](a92_0x55cc('0x1e'),function(){console[a92_0x55cc('0xb')](a92_0x55cc('0x1f')+_0x4df4c5['fileName']);_0x4d3191[a92_0x55cc('0x20')]('colombia/'+_0x4df4c5[a92_0x55cc('0x21')],function(_0x437a1a,_0x5944d9){_0x4d3191[a92_0x55cc('0x22')]();if(_0x437a1a){}else{const _0xa450b7=a92_0x55cc('0x23')+_0x4df4c5[a92_0x55cc('0x21')]+a92_0x55cc('0x24');_0x5944d9[a92_0x55cc('0x25')](fs_1['default'][a92_0x55cc('0x26')](_0xa450b7));_0x4df4c5[a92_0x55cc('0x27')]=0x1;_0x4df4c5[a92_0x55cc('0x28')]();console['log'](a92_0x55cc('0x29')+_0x4df4c5[a92_0x55cc('0x21')]);}});});_0x4d3191['on'](a92_0x55cc('0x17'),function(_0x2a90e7){_0x3e0859[a92_0x55cc('0x2a')]({'message':_0x2a90e7});});_0x4d3191[a92_0x55cc('0x18')]({'host':a92_0x55cc('0x19'),'port':0x15,'user':'ipd','password':a92_0x55cc('0x1a')});_0x3e0859[a92_0x55cc('0x2a')]({'data':_0x4df4c5[a92_0x55cc('0x21')]});}else{_0x3e0859[a92_0x55cc('0x2a')]({'data':[]});}});};exports[a92_0x55cc('0x2b')]=(_0x3a14fa,_0x3331e8)=>{exports['sequelize'][a92_0x55cc('0x13')]['reportFiles']['findOne']({'where':{'status':0x1}})['then'](_0x2e1195=>{if(_0x2e1195){const _0x2ded6e=a92_0x55cc('0x23')+_0x2e1195[a92_0x55cc('0x21')]+'.txt';fs_1[a92_0x55cc('0xd')][a92_0x55cc('0x2c')](_0x2ded6e,a92_0x55cc('0x2d'),function(_0x174ce3,_0x43f332){if(_0x174ce3){_0x2e1195[a92_0x55cc('0x27')]=null;}else{try{const _0x262f4d=JSON[a92_0x55cc('0x2e')](_0x43f332);for(const _0x1638ed of _0x262f4d['Data'][0x0]['CountingInfo']){const _0x3232c4=_0x1638ed['In'];const _0xb12238=_0x1638ed['Out'];const _0x50e2d8=Date[a92_0x55cc('0x2e')](_0x1638ed[a92_0x55cc('0x2f')]);if(_0x3232c4>0x0){exports[a92_0x55cc('0x5')][a92_0x55cc('0x13')][a92_0x55cc('0x30')][a92_0x55cc('0x31')]({'reportFileId':_0x2e1195['id'],'amount':_0x3232c4,'countingDate':_0x50e2d8});}if(_0xb12238>0x0){exports[a92_0x55cc('0x5')][a92_0x55cc('0x13')][a92_0x55cc('0x30')][a92_0x55cc('0x31')]({'reportFileId':_0x2e1195['id'],'amount':_0xb12238*-0x1,'countingDate':_0x50e2d8});}}_0x2e1195[a92_0x55cc('0x27')]=0x2;}catch(_0x32aad2){_0x2e1195[a92_0x55cc('0x27')]=null;}}_0x2e1195[a92_0x55cc('0x28')]();});_0x3331e8['json']({'data':_0x2e1195[a92_0x55cc('0x21')]});}else{_0x3331e8[a92_0x55cc('0x2a')]({'data':[]});}});};exports[a92_0x55cc('0x32')]=(_0xe48d23,_0x3be2e4)=>{exports['sequelize'][a92_0x55cc('0x13')][a92_0x55cc('0x30')][a92_0x55cc('0x33')]({'where':{'amount':{[exports['sequelize']['Op']['gt']]:0x0}},'order':[[a92_0x55cc('0x34'),'ASC']]})[a92_0x55cc('0x1d')](_0x3a6a34=>{_0x3be2e4[a92_0x55cc('0x2a')]({'data':_0x3a6a34});});};exports[a92_0x55cc('0x35')]=(_0x266399,_0x3681bb)=>{const _0x1786d2=_0x266399[a92_0x55cc('0x36')][a92_0x55cc('0x37')];const _0x349818=_0x266399[a92_0x55cc('0x36')][a92_0x55cc('0x38')];const _0x290b3c=_0x266399[a92_0x55cc('0x36')]['endDate'];exports[a92_0x55cc('0x5')][a92_0x55cc('0x13')][a92_0x55cc('0x30')][a92_0x55cc('0x33')]({'attributes':[a92_0x55cc('0x34'),[exports[a92_0x55cc('0x5')]['fn'](a92_0x55cc('0x39'),exports[a92_0x55cc('0x5')]['col'](a92_0x55cc('0x3a'))),a92_0x55cc('0x3b')]],'where':{'countingDate':{[exports['sequelize']['Op'][a92_0x55cc('0x3c')]]:_0x349818,[exports[a92_0x55cc('0x5')]['Op']['lt']]:_0x290b3c},'amount':_0x266399[a92_0x55cc('0x3d')][a92_0x55cc('0x3e')]=='in'?{[exports['sequelize']['Op']['gt']]:0x0}:{[exports[a92_0x55cc('0x5')]['Op']['lt']]:0x0}},'group':[exports[a92_0x55cc('0x5')][a92_0x55cc('0x3f')](a92_0x55cc('0x40'))],'order':[[a92_0x55cc('0x34'),a92_0x55cc('0x41')]]})[a92_0x55cc('0x1d')](_0x1ed5b5=>{_0x3681bb[a92_0x55cc('0x2a')]({'data':_0x1ed5b5});});};exports[a92_0x55cc('0x42')]=(_0x49da4c,_0x48096e)=>{const _0x5ccc1c=_0x49da4c[a92_0x55cc('0x36')][a92_0x55cc('0x37')];const _0xe45ae7=_0x49da4c[a92_0x55cc('0x36')][a92_0x55cc('0x38')];const _0x125384=_0x49da4c['query'][a92_0x55cc('0x43')];exports['sequelize'][a92_0x55cc('0x13')][a92_0x55cc('0x30')]['findAll']({'attributes':[a92_0x55cc('0x34'),[exports[a92_0x55cc('0x5')]['fn']('DATE_FORMAT',exports[a92_0x55cc('0x5')][a92_0x55cc('0x44')](a92_0x55cc('0x34')),a92_0x55cc('0x45')),a92_0x55cc('0x46')],[exports[a92_0x55cc('0x5')]['fn'](a92_0x55cc('0x39'),exports['sequelize']['col'](a92_0x55cc('0x3a'))),a92_0x55cc('0x3b')]],'where':{'countingDate':{[exports[a92_0x55cc('0x5')]['Op'][a92_0x55cc('0x3c')]]:_0xe45ae7,[exports['sequelize']['Op']['lt']]:_0x125384},'amount':_0x49da4c[a92_0x55cc('0x3d')][a92_0x55cc('0x3e')]=='in'?{[exports[a92_0x55cc('0x5')]['Op']['gt']]:0x0}:{[exports[a92_0x55cc('0x5')]['Op']['lt']]:0x0}},'group':[exports[a92_0x55cc('0x5')]['fn'](a92_0x55cc('0x47'),exports[a92_0x55cc('0x5')][a92_0x55cc('0x44')](a92_0x55cc('0x34'))),exports[a92_0x55cc('0x5')]['fn']('DAY',exports[a92_0x55cc('0x5')]['col'](a92_0x55cc('0x34'))),exports[a92_0x55cc('0x5')]['fn']('MONTH',exports[a92_0x55cc('0x5')][a92_0x55cc('0x44')](a92_0x55cc('0x34'))),exports[a92_0x55cc('0x5')]['fn']('YEAR',exports['sequelize'][a92_0x55cc('0x44')](a92_0x55cc('0x34')))],'order':[['countingDate',a92_0x55cc('0x41')]]})['then'](_0x28f066=>{_0x48096e[a92_0x55cc('0x2a')]({'data':_0x28f066});});};exports[a92_0x55cc('0x48')]=(_0x5c8e18,_0x4b7f63,_0x342467)=>{const _0x5ba6a9=_0x5c8e18['user']['tokens'][a92_0x55cc('0x49')](_0x5ba6a9=>_0x5ba6a9[a92_0x55cc('0x4a')]==='facebook');fbgraph_1[a92_0x55cc('0xd')]['setAccessToken'](_0x5ba6a9[a92_0x55cc('0x4b')]);fbgraph_1['default'][a92_0x55cc('0x20')](_0x5c8e18[a92_0x55cc('0x4c')][a92_0x55cc('0x4d')]+'?fields=id,name,email,first_name,last_name,gender,link,locale,timezone',(_0x37016c,_0x1558d2)=>{if(_0x37016c){return _0x342467(_0x37016c);}_0x4b7f63[a92_0x55cc('0x8')]('api/facebook',{'title':a92_0x55cc('0x4e'),'profile':_0x1558d2});});};
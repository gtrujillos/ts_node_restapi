var a198_0x3aa3=['query','month','countingDate','sum','col','total','gte','params','literal','getPassCountingByHour','startDate','%Y-%m-%d\x20%H:00','countingDateShort','amount','direction','MONTH','YEAR','getFacebook','user','find','facebook','setAccessToken','accessToken','?fields=id,name,email,first_name,last_name,gender,link,locale,timezone','render','api/facebook','Facebook\x20API','__importDefault','__esModule','defineProperty','ftp','sequelize','setSequelize','API\x20Examples','syncFtp','log','connecting','ready','connected','list','colombia','Downloading:\x20','name','json','reportFiles','spread','push','connect','ftp.vivotek.com','ipd','downloadFtp','findOne','default','connected:','fileName','get','colombia/','media/','.txt','pipe','createWriteStream','status','save','Downloaded:\x20','error','models','then','utf8','Data','CountingInfo','Out','parse','EndTime','create','passes','getPassCounting','findAll','ASC','getPassCountingByDay'];(function(_0x2b70ab,_0x571a08){var _0xa192d0=function(_0x4a7921){while(--_0x4a7921){_0x2b70ab['push'](_0x2b70ab['shift']());}};_0xa192d0(++_0x571a08);}(a198_0x3aa3,0x1a6));var a198_0x51cf=function(_0xc4886d,_0x101d9e){_0xc4886d=_0xc4886d-0x0;var _0x5dbf2b=a198_0x3aa3[_0xc4886d];return _0x5dbf2b;};'use strict';var __importDefault=this&&this[a198_0x51cf('0x0')]||function(_0x2bda69){return _0x2bda69&&_0x2bda69[a198_0x51cf('0x1')]?_0x2bda69:{'default':_0x2bda69};};Object[a198_0x51cf('0x2')](exports,a198_0x51cf('0x1'),{'value':!![]});const fbgraph_1=__importDefault(require('fbgraph'));const ftp_1=__importDefault(require(a198_0x51cf('0x3')));const fs_1=__importDefault(require('fs'));function setSequelize(_0x1fd1c1){exports[a198_0x51cf('0x4')]=_0x1fd1c1;}exports[a198_0x51cf('0x5')]=setSequelize;exports['getApi']=(_0x59a424,_0x3c3c9b)=>{_0x3c3c9b['render']('api/index',{'title':a198_0x51cf('0x6')});};exports[a198_0x51cf('0x7')]=(_0x4d483b,_0x572baf)=>{console[a198_0x51cf('0x8')](a198_0x51cf('0x9'));const _0x21b18c=[];const _0x1d1cdc=new ftp_1['default']();_0x1d1cdc['on'](a198_0x51cf('0xa'),function(){console[a198_0x51cf('0x8')](a198_0x51cf('0xb'));_0x1d1cdc[a198_0x51cf('0xc')](a198_0x51cf('0xd'),![],function(_0x313661,_0x3f966f){if(_0x313661){}else{for(const _0x52f4c5 of _0x3f966f){console['log'](a198_0x51cf('0xe')+_0x52f4c5[a198_0x51cf('0xf')]);if(_0x52f4c5[a198_0x51cf('0xf')]['endsWith'](a198_0x51cf('0x10'))){exports[a198_0x51cf('0x4')]['models'][a198_0x51cf('0x11')]['findOrCreate']({'where':{'fileName':_0x52f4c5[a198_0x51cf('0xf')]}})[a198_0x51cf('0x12')]((_0x482a83,_0x5dda00)=>{if(_0x5dda00){console[a198_0x51cf('0x8')](_0x52f4c5[a198_0x51cf('0xf')]);_0x21b18c[a198_0x51cf('0x13')](_0x482a83);}});}}}_0x572baf[a198_0x51cf('0x10')]({'data':_0x21b18c});});});_0x1d1cdc['on']('error',function(_0x2e46ac){_0x572baf[a198_0x51cf('0x10')]({'message':_0x2e46ac});});_0x1d1cdc[a198_0x51cf('0x14')]({'host':a198_0x51cf('0x15'),'port':0x15,'user':a198_0x51cf('0x16'),'password':a198_0x51cf('0x16')});};exports[a198_0x51cf('0x17')]=(_0x4ebe3a,_0x25f7cc)=>{exports[a198_0x51cf('0x4')]['models'][a198_0x51cf('0x11')][a198_0x51cf('0x18')]({'where':{'status':null}})['then'](_0x74c2d7=>{if(_0x74c2d7){const _0x55df76=new ftp_1[(a198_0x51cf('0x19'))]();_0x55df76['on'](a198_0x51cf('0xa'),function(){console['log'](a198_0x51cf('0x1a')+_0x74c2d7[a198_0x51cf('0x1b')]);_0x55df76[a198_0x51cf('0x1c')](a198_0x51cf('0x1d')+_0x74c2d7[a198_0x51cf('0x1b')],function(_0x51ffd4,_0x41579a){_0x55df76['end']();if(_0x51ffd4){}else{const _0x3cbb2e=a198_0x51cf('0x1e')+_0x74c2d7[a198_0x51cf('0x1b')]+a198_0x51cf('0x1f');_0x41579a[a198_0x51cf('0x20')](fs_1['default'][a198_0x51cf('0x21')](_0x3cbb2e));_0x74c2d7[a198_0x51cf('0x22')]=0x1;_0x74c2d7[a198_0x51cf('0x23')]();console[a198_0x51cf('0x8')](a198_0x51cf('0x24')+_0x74c2d7[a198_0x51cf('0x1b')]);}});});_0x55df76['on'](a198_0x51cf('0x25'),function(_0x521534){_0x25f7cc[a198_0x51cf('0x10')]({'message':_0x521534});});_0x55df76[a198_0x51cf('0x14')]({'host':a198_0x51cf('0x15'),'port':0x15,'user':'ipd','password':a198_0x51cf('0x16')});_0x25f7cc[a198_0x51cf('0x10')]({'data':_0x74c2d7[a198_0x51cf('0x1b')]});}else{_0x25f7cc[a198_0x51cf('0x10')]({'data':[]});}});};exports['processFtp']=(_0x144954,_0x2774d5)=>{exports[a198_0x51cf('0x4')][a198_0x51cf('0x26')][a198_0x51cf('0x11')][a198_0x51cf('0x18')]({'where':{'status':0x1}})[a198_0x51cf('0x27')](_0x2a4eb8=>{if(_0x2a4eb8){const _0x32007d=a198_0x51cf('0x1e')+_0x2a4eb8[a198_0x51cf('0x1b')]+a198_0x51cf('0x1f');fs_1[a198_0x51cf('0x19')]['readFile'](_0x32007d,a198_0x51cf('0x28'),function(_0x22edd4,_0x1815ac){if(_0x22edd4){_0x2a4eb8[a198_0x51cf('0x22')]=null;}else{try{const _0x549867=JSON['parse'](_0x1815ac);for(const _0x2052a9 of _0x549867[a198_0x51cf('0x29')][0x0][a198_0x51cf('0x2a')]){const _0x175ccd=_0x2052a9['In'];const _0x55a411=_0x2052a9[a198_0x51cf('0x2b')];const _0x43ca9b=Date[a198_0x51cf('0x2c')](_0x2052a9[a198_0x51cf('0x2d')]);if(_0x175ccd>0x0){exports[a198_0x51cf('0x4')][a198_0x51cf('0x26')]['passes'][a198_0x51cf('0x2e')]({'reportFileId':_0x2a4eb8['id'],'amount':_0x175ccd,'countingDate':_0x43ca9b});}if(_0x55a411>0x0){exports['sequelize'][a198_0x51cf('0x26')][a198_0x51cf('0x2f')]['create']({'reportFileId':_0x2a4eb8['id'],'amount':_0x55a411*-0x1,'countingDate':_0x43ca9b});}}_0x2a4eb8[a198_0x51cf('0x22')]=0x2;}catch(_0x5ef90c){_0x2a4eb8[a198_0x51cf('0x22')]=null;}}_0x2a4eb8[a198_0x51cf('0x23')]();});_0x2774d5[a198_0x51cf('0x10')]({'data':_0x2a4eb8[a198_0x51cf('0x1b')]});}else{_0x2774d5['json']({'data':[]});}});};exports[a198_0x51cf('0x30')]=(_0x433054,_0xbeaf7b)=>{exports['sequelize'][a198_0x51cf('0x26')][a198_0x51cf('0x2f')][a198_0x51cf('0x31')]({'where':{'amount':{[exports[a198_0x51cf('0x4')]['Op']['gt']]:0x0}},'order':[['countingDate',a198_0x51cf('0x32')]]})['then'](_0x3be4b9=>{_0xbeaf7b[a198_0x51cf('0x10')]({'data':_0x3be4b9});});};exports[a198_0x51cf('0x33')]=(_0x3d08b2,_0x4ab496)=>{const _0x1885d6=_0x3d08b2[a198_0x51cf('0x34')][a198_0x51cf('0x35')];const _0x2ec98d=_0x3d08b2['query']['startDate'];const _0x3b126c=_0x3d08b2[a198_0x51cf('0x34')]['endDate'];exports[a198_0x51cf('0x4')][a198_0x51cf('0x26')][a198_0x51cf('0x2f')][a198_0x51cf('0x31')]({'attributes':[a198_0x51cf('0x36'),[exports[a198_0x51cf('0x4')]['fn'](a198_0x51cf('0x37'),exports[a198_0x51cf('0x4')][a198_0x51cf('0x38')]('amount')),a198_0x51cf('0x39')]],'where':{'countingDate':{[exports[a198_0x51cf('0x4')]['Op'][a198_0x51cf('0x3a')]]:_0x2ec98d,[exports['sequelize']['Op']['lt']]:_0x3b126c},'amount':_0x3d08b2[a198_0x51cf('0x3b')]['direction']=='in'?{[exports[a198_0x51cf('0x4')]['Op']['gt']]:0x0}:{[exports['sequelize']['Op']['lt']]:0x0}},'group':[exports[a198_0x51cf('0x4')][a198_0x51cf('0x3c')]('YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))')],'order':[[a198_0x51cf('0x36'),a198_0x51cf('0x32')]]})[a198_0x51cf('0x27')](_0x32b9c2=>{_0x4ab496['json']({'data':_0x32b9c2});});};exports[a198_0x51cf('0x3d')]=(_0x344778,_0x2ac439)=>{const _0x201f0c=_0x344778['query'][a198_0x51cf('0x35')];const _0x3c4653=_0x344778[a198_0x51cf('0x34')][a198_0x51cf('0x3e')];const _0x54c375=_0x344778[a198_0x51cf('0x34')]['endDate'];exports[a198_0x51cf('0x4')]['models'][a198_0x51cf('0x2f')][a198_0x51cf('0x31')]({'attributes':['countingDate',[exports[a198_0x51cf('0x4')]['fn']('DATE_FORMAT',exports[a198_0x51cf('0x4')]['col'](a198_0x51cf('0x36')),a198_0x51cf('0x3f')),a198_0x51cf('0x40')],[exports['sequelize']['fn'](a198_0x51cf('0x37'),exports[a198_0x51cf('0x4')][a198_0x51cf('0x38')](a198_0x51cf('0x41'))),a198_0x51cf('0x39')]],'where':{'countingDate':{[exports[a198_0x51cf('0x4')]['Op'][a198_0x51cf('0x3a')]]:_0x3c4653,[exports[a198_0x51cf('0x4')]['Op']['lt']]:_0x54c375},'amount':_0x344778[a198_0x51cf('0x3b')][a198_0x51cf('0x42')]=='in'?{[exports[a198_0x51cf('0x4')]['Op']['gt']]:0x0}:{[exports[a198_0x51cf('0x4')]['Op']['lt']]:0x0}},'group':[exports['sequelize']['fn']('HOUR',exports['sequelize'][a198_0x51cf('0x38')](a198_0x51cf('0x36'))),exports[a198_0x51cf('0x4')]['fn']('DAY',exports[a198_0x51cf('0x4')][a198_0x51cf('0x38')](a198_0x51cf('0x36'))),exports[a198_0x51cf('0x4')]['fn'](a198_0x51cf('0x43'),exports[a198_0x51cf('0x4')][a198_0x51cf('0x38')](a198_0x51cf('0x36'))),exports[a198_0x51cf('0x4')]['fn'](a198_0x51cf('0x44'),exports[a198_0x51cf('0x4')][a198_0x51cf('0x38')]('countingDate'))],'order':[['countingDate',a198_0x51cf('0x32')]]})['then'](_0x5cfbf8=>{_0x2ac439['json']({'data':_0x5cfbf8});});};exports[a198_0x51cf('0x45')]=(_0x50fd1c,_0x118b1f,_0x1caeeb)=>{const _0xad75a0=_0x50fd1c[a198_0x51cf('0x46')]['tokens'][a198_0x51cf('0x47')](_0xad75a0=>_0xad75a0['kind']===a198_0x51cf('0x48'));fbgraph_1[a198_0x51cf('0x19')][a198_0x51cf('0x49')](_0xad75a0[a198_0x51cf('0x4a')]);fbgraph_1[a198_0x51cf('0x19')][a198_0x51cf('0x1c')](_0x50fd1c[a198_0x51cf('0x46')][a198_0x51cf('0x48')]+a198_0x51cf('0x4b'),(_0x23d541,_0x3d4184)=>{if(_0x23d541){return _0x1caeeb(_0x23d541);}_0x118b1f[a198_0x51cf('0x4c')](a198_0x51cf('0x4d'),{'title':a198_0x51cf('0x4e'),'profile':_0x3d4184});});};
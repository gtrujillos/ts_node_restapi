var a92_0x2787=['facebook','setAccessToken','accessToken','?fields=id,name,email,first_name,last_name,gender,link,locale,timezone','Facebook\x20API','__importDefault','__esModule','fbgraph','ftp','sequelize','setSequelize','render','syncFtp','log','connecting','default','connected','list','colombia','Downloading:\x20','name','endsWith','json','reportFiles','findOrCreate','spread','push','ftp.vivotek.com','ipd','findOne','then','fileName','get','end','pipe','status','save','Downloaded:\x20','media/','.txt','readFile','utf8','parse','Data','CountingInfo','models','passes','create','getPassCounting','findAll','countingDate','ASC','getPassCountingByDay','query','startDate','endDate','sum','amount','total','gte','params','direction','literal','YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))','getPassCountingByHour','month','DATE_FORMAT','col','countingDateShort','DAY','MONTH','YEAR','getFacebook','user','tokens','find','kind'];(function(_0x2cdf2f,_0x1f6463){var _0x209e36=function(_0x25e2a3){while(--_0x25e2a3){_0x2cdf2f['push'](_0x2cdf2f['shift']());}};_0x209e36(++_0x1f6463);}(a92_0x2787,0x186));var a92_0x5def=function(_0x5396f2,_0x31c994){_0x5396f2=_0x5396f2-0x0;var _0xb4f0d2=a92_0x2787[_0x5396f2];return _0xb4f0d2;};'use strict';var __importDefault=this&&this[a92_0x5def('0x0')]||function(_0x5366a1){return _0x5366a1&&_0x5366a1[a92_0x5def('0x1')]?_0x5366a1:{'default':_0x5366a1};};Object['defineProperty'](exports,a92_0x5def('0x1'),{'value':!![]});const fbgraph_1=__importDefault(require(a92_0x5def('0x2')));const ftp_1=__importDefault(require(a92_0x5def('0x3')));const fs_1=__importDefault(require('fs'));function setSequelize(_0x3a4c40){exports[a92_0x5def('0x4')]=_0x3a4c40;}exports[a92_0x5def('0x5')]=setSequelize;exports['getApi']=(_0x31f0c0,_0x3e2528)=>{_0x3e2528[a92_0x5def('0x6')]('api/index',{'title':'API\x20Examples'});};exports[a92_0x5def('0x7')]=(_0x5454dd,_0x50085f)=>{console[a92_0x5def('0x8')](a92_0x5def('0x9'));const _0x58711c=[];const _0x42692a=new ftp_1[(a92_0x5def('0xa'))]();_0x42692a['on']('ready',function(){console[a92_0x5def('0x8')](a92_0x5def('0xb'));_0x42692a[a92_0x5def('0xc')](a92_0x5def('0xd'),![],function(_0x3c4b54,_0x1a5c66){if(_0x3c4b54){}else{for(const _0x402db9 of _0x1a5c66){console[a92_0x5def('0x8')](a92_0x5def('0xe')+_0x402db9[a92_0x5def('0xf')]);if(_0x402db9[a92_0x5def('0xf')][a92_0x5def('0x10')](a92_0x5def('0x11'))){exports[a92_0x5def('0x4')]['models'][a92_0x5def('0x12')][a92_0x5def('0x13')]({'where':{'fileName':_0x402db9['name']}})[a92_0x5def('0x14')]((_0x71539a,_0x21fa57)=>{if(_0x21fa57){console['log'](_0x402db9['name']);_0x58711c[a92_0x5def('0x15')](_0x71539a);}});}}}_0x50085f[a92_0x5def('0x11')]({'data':_0x58711c});});});_0x42692a['on']('error',function(_0x478ada){_0x50085f['json']({'message':_0x478ada});});_0x42692a['connect']({'host':a92_0x5def('0x16'),'port':0x15,'user':a92_0x5def('0x17'),'password':a92_0x5def('0x17')});};exports['downloadFtp']=(_0x4a0310,_0x55aee3)=>{exports['sequelize']['models'][a92_0x5def('0x12')][a92_0x5def('0x18')]({'where':{'status':null}})[a92_0x5def('0x19')](_0x25f4ab=>{if(_0x25f4ab){const _0x50a2e8=new ftp_1['default']();_0x50a2e8['on']('ready',function(){console['log']('connected:'+_0x25f4ab[a92_0x5def('0x1a')]);_0x50a2e8[a92_0x5def('0x1b')]('colombia/'+_0x25f4ab[a92_0x5def('0x1a')],function(_0x4533a8,_0x4c3d75){_0x50a2e8[a92_0x5def('0x1c')]();if(_0x4533a8){}else{const _0x34ffd7='media/'+_0x25f4ab[a92_0x5def('0x1a')]+'.txt';_0x4c3d75[a92_0x5def('0x1d')](fs_1[a92_0x5def('0xa')]['createWriteStream'](_0x34ffd7));_0x25f4ab[a92_0x5def('0x1e')]=0x1;_0x25f4ab[a92_0x5def('0x1f')]();console[a92_0x5def('0x8')](a92_0x5def('0x20')+_0x25f4ab['fileName']);}});});_0x50a2e8['on']('error',function(_0x54aed3){_0x55aee3['json']({'message':_0x54aed3});});_0x50a2e8['connect']({'host':a92_0x5def('0x16'),'port':0x15,'user':a92_0x5def('0x17'),'password':a92_0x5def('0x17')});_0x55aee3[a92_0x5def('0x11')]({'data':_0x25f4ab['fileName']});}else{_0x55aee3[a92_0x5def('0x11')]({'data':[]});}});};exports['processFtp']=(_0x1d6493,_0x170dba)=>{exports[a92_0x5def('0x4')]['models']['reportFiles'][a92_0x5def('0x18')]({'where':{'status':0x1}})['then'](_0x6b65f5=>{if(_0x6b65f5){const _0x21427b=a92_0x5def('0x21')+_0x6b65f5[a92_0x5def('0x1a')]+a92_0x5def('0x22');fs_1[a92_0x5def('0xa')][a92_0x5def('0x23')](_0x21427b,a92_0x5def('0x24'),function(_0x221dc3,_0x177455){if(_0x221dc3){_0x6b65f5[a92_0x5def('0x1e')]=null;}else{try{const _0x24d41f=JSON[a92_0x5def('0x25')](_0x177455);for(const _0x12f3c5 of _0x24d41f[a92_0x5def('0x26')][0x0][a92_0x5def('0x27')]){const _0x16d25b=_0x12f3c5['In'];const _0x1668d1=_0x12f3c5['Out'];const _0x24998d=Date[a92_0x5def('0x25')](_0x12f3c5['EndTime']);if(_0x16d25b>0x0){exports[a92_0x5def('0x4')][a92_0x5def('0x28')][a92_0x5def('0x29')][a92_0x5def('0x2a')]({'reportFileId':_0x6b65f5['id'],'amount':_0x16d25b,'countingDate':_0x24998d});}if(_0x1668d1>0x0){exports[a92_0x5def('0x4')][a92_0x5def('0x28')]['passes']['create']({'reportFileId':_0x6b65f5['id'],'amount':_0x1668d1*-0x1,'countingDate':_0x24998d});}}_0x6b65f5[a92_0x5def('0x1e')]=0x2;}catch(_0x5bfa7d){_0x6b65f5[a92_0x5def('0x1e')]=null;}}_0x6b65f5[a92_0x5def('0x1f')]();});_0x170dba[a92_0x5def('0x11')]({'data':_0x6b65f5['fileName']});}else{_0x170dba[a92_0x5def('0x11')]({'data':[]});}});};exports[a92_0x5def('0x2b')]=(_0x44b78a,_0x52921b)=>{exports[a92_0x5def('0x4')]['models'][a92_0x5def('0x29')][a92_0x5def('0x2c')]({'where':{'amount':{[exports['sequelize']['Op']['gt']]:0x0}},'order':[[a92_0x5def('0x2d'),a92_0x5def('0x2e')]]})[a92_0x5def('0x19')](_0x7607f=>{_0x52921b[a92_0x5def('0x11')]({'data':_0x7607f});});};exports[a92_0x5def('0x2f')]=(_0x11eeb1,_0x2ac51c)=>{const _0x4bcaff=_0x11eeb1[a92_0x5def('0x30')]['month'];const _0x237a9c=_0x11eeb1[a92_0x5def('0x30')][a92_0x5def('0x31')];const _0x44635e=_0x11eeb1['query'][a92_0x5def('0x32')];exports[a92_0x5def('0x4')]['models'][a92_0x5def('0x29')][a92_0x5def('0x2c')]({'attributes':[a92_0x5def('0x2d'),[exports[a92_0x5def('0x4')]['fn'](a92_0x5def('0x33'),exports['sequelize']['col'](a92_0x5def('0x34'))),a92_0x5def('0x35')]],'where':{'countingDate':{[exports[a92_0x5def('0x4')]['Op'][a92_0x5def('0x36')]]:_0x237a9c,[exports[a92_0x5def('0x4')]['Op']['lt']]:_0x44635e},'amount':_0x11eeb1[a92_0x5def('0x37')][a92_0x5def('0x38')]=='in'?{[exports['sequelize']['Op']['gt']]:0x0}:{[exports[a92_0x5def('0x4')]['Op']['lt']]:0x0}},'group':[exports['sequelize'][a92_0x5def('0x39')](a92_0x5def('0x3a'))],'order':[[a92_0x5def('0x2d'),a92_0x5def('0x2e')]]})[a92_0x5def('0x19')](_0x35aa87=>{_0x2ac51c[a92_0x5def('0x11')]({'data':_0x35aa87});});};exports[a92_0x5def('0x3b')]=(_0x3ad59d,_0x17feb5)=>{const _0x2397c8=_0x3ad59d['query'][a92_0x5def('0x3c')];const _0x5cd138=_0x3ad59d[a92_0x5def('0x30')][a92_0x5def('0x31')];const _0x3ba28e=_0x3ad59d['query']['endDate'];exports[a92_0x5def('0x4')]['models'][a92_0x5def('0x29')][a92_0x5def('0x2c')]({'attributes':[a92_0x5def('0x2d'),[exports[a92_0x5def('0x4')]['fn'](a92_0x5def('0x3d'),exports[a92_0x5def('0x4')][a92_0x5def('0x3e')](a92_0x5def('0x2d')),'%Y-%m-%d\x20%H:00'),a92_0x5def('0x3f')],[exports[a92_0x5def('0x4')]['fn'](a92_0x5def('0x33'),exports[a92_0x5def('0x4')][a92_0x5def('0x3e')](a92_0x5def('0x34'))),a92_0x5def('0x35')]],'where':{'countingDate':{[exports[a92_0x5def('0x4')]['Op'][a92_0x5def('0x36')]]:_0x5cd138,[exports[a92_0x5def('0x4')]['Op']['lt']]:_0x3ba28e},'amount':_0x3ad59d[a92_0x5def('0x37')][a92_0x5def('0x38')]=='in'?{[exports['sequelize']['Op']['gt']]:0x0}:{[exports[a92_0x5def('0x4')]['Op']['lt']]:0x0}},'group':[exports[a92_0x5def('0x4')]['fn']('HOUR',exports[a92_0x5def('0x4')][a92_0x5def('0x3e')](a92_0x5def('0x2d'))),exports['sequelize']['fn'](a92_0x5def('0x40'),exports[a92_0x5def('0x4')][a92_0x5def('0x3e')]('countingDate')),exports[a92_0x5def('0x4')]['fn'](a92_0x5def('0x41'),exports[a92_0x5def('0x4')][a92_0x5def('0x3e')](a92_0x5def('0x2d'))),exports['sequelize']['fn'](a92_0x5def('0x42'),exports['sequelize']['col'](a92_0x5def('0x2d')))],'order':[['countingDate',a92_0x5def('0x2e')]]})[a92_0x5def('0x19')](_0x1935b9=>{_0x17feb5[a92_0x5def('0x11')]({'data':_0x1935b9});});};exports[a92_0x5def('0x43')]=(_0x3e7141,_0x940b45,_0x25dc21)=>{const _0x59de94=_0x3e7141[a92_0x5def('0x44')][a92_0x5def('0x45')][a92_0x5def('0x46')](_0x59de94=>_0x59de94[a92_0x5def('0x47')]===a92_0x5def('0x48'));fbgraph_1[a92_0x5def('0xa')][a92_0x5def('0x49')](_0x59de94[a92_0x5def('0x4a')]);fbgraph_1[a92_0x5def('0xa')][a92_0x5def('0x1b')](_0x3e7141[a92_0x5def('0x44')]['facebook']+a92_0x5def('0x4b'),(_0x519994,_0xd338fd)=>{if(_0x519994){return _0x25dc21(_0x519994);}_0x940b45[a92_0x5def('0x6')]('api/facebook',{'title':a92_0x5def('0x4c'),'profile':_0xd338fd});});};
var a92_0x50ac=['createWriteStream','save','Downloaded:\x20','connect','processFtp','then','status','parse','Data','CountingInfo','Out','EndTime','passes','create','findAll','countingDate','ASC','query','endDate','col','amount','total','gte','params','direction','literal','YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))','getPassCountingByHour','month','startDate','DATE_FORMAT','%Y-%m-%d\x20%H:00','countingDateShort','DAY','MONTH','YEAR','getFacebook','user','tokens','find','facebook','setAccessToken','accessToken','?fields=id,name,email,first_name,last_name,gender,link,locale,timezone','api/facebook','__importDefault','__esModule','defineProperty','fbgraph','ftp','sequelize','setSequelize','getApi','render','api/index','syncFtp','log','default','list','colombia','Downloading:\x20','name','models','reportFiles','findOrCreate','json','error','ftp.vivotek.com','ipd','downloadFtp','findOne','ready','connected:','fileName','get','end','media/','.txt'];(function(_0x3e62d5,_0x3b1aed){var _0x34db29=function(_0x34ce20){while(--_0x34ce20){_0x3e62d5['push'](_0x3e62d5['shift']());}};_0x34db29(++_0x3b1aed);}(a92_0x50ac,0x7b));var a92_0x16eb=function(_0x5139d8,_0x29204a){_0x5139d8=_0x5139d8-0x0;var _0x59f795=a92_0x50ac[_0x5139d8];return _0x59f795;};'use strict';var __importDefault=this&&this[a92_0x16eb('0x0')]||function(_0x253f3d){return _0x253f3d&&_0x253f3d[a92_0x16eb('0x1')]?_0x253f3d:{'default':_0x253f3d};};Object[a92_0x16eb('0x2')](exports,a92_0x16eb('0x1'),{'value':!![]});const fbgraph_1=__importDefault(require(a92_0x16eb('0x3')));const ftp_1=__importDefault(require(a92_0x16eb('0x4')));const fs_1=__importDefault(require('fs'));function setSequelize(_0x5bce65){exports[a92_0x16eb('0x5')]=_0x5bce65;}exports[a92_0x16eb('0x6')]=setSequelize;exports[a92_0x16eb('0x7')]=(_0x5cb510,_0x498288)=>{_0x498288[a92_0x16eb('0x8')](a92_0x16eb('0x9'),{'title':'API\x20Examples'});};exports[a92_0x16eb('0xa')]=(_0x28abd4,_0x1a711c)=>{console[a92_0x16eb('0xb')]('connecting');const _0x1a2ee6=[];const _0xcea48f=new ftp_1[(a92_0x16eb('0xc'))]();_0xcea48f['on']('ready',function(){console[a92_0x16eb('0xb')]('connected');_0xcea48f[a92_0x16eb('0xd')](a92_0x16eb('0xe'),![],function(_0x3b3a58,_0x43cf6c){if(_0x3b3a58){}else{for(const _0xd0fd9c of _0x43cf6c){console[a92_0x16eb('0xb')](a92_0x16eb('0xf')+_0xd0fd9c[a92_0x16eb('0x10')]);if(_0xd0fd9c[a92_0x16eb('0x10')]['endsWith']('json')){exports[a92_0x16eb('0x5')][a92_0x16eb('0x11')][a92_0x16eb('0x12')][a92_0x16eb('0x13')]({'where':{'fileName':_0xd0fd9c[a92_0x16eb('0x10')]}})['spread']((_0x8d2540,_0xd87d58)=>{if(_0xd87d58){console[a92_0x16eb('0xb')](_0xd0fd9c['name']);_0x1a2ee6['push'](_0x8d2540);}});}}}_0x1a711c[a92_0x16eb('0x14')]({'data':_0x1a2ee6});});});_0xcea48f['on'](a92_0x16eb('0x15'),function(_0x48fdf0){_0x1a711c[a92_0x16eb('0x14')]({'message':_0x48fdf0});});_0xcea48f['connect']({'host':a92_0x16eb('0x16'),'port':0x15,'user':'ipd','password':a92_0x16eb('0x17')});};exports[a92_0x16eb('0x18')]=(_0x5f1e86,_0x25e1b9)=>{exports[a92_0x16eb('0x5')][a92_0x16eb('0x11')][a92_0x16eb('0x12')][a92_0x16eb('0x19')]({'where':{'status':null}})['then'](_0x19c5fe=>{if(_0x19c5fe){const _0x12e61f=new ftp_1[(a92_0x16eb('0xc'))]();_0x12e61f['on'](a92_0x16eb('0x1a'),function(){console[a92_0x16eb('0xb')](a92_0x16eb('0x1b')+_0x19c5fe[a92_0x16eb('0x1c')]);_0x12e61f[a92_0x16eb('0x1d')]('colombia/'+_0x19c5fe['fileName'],function(_0x33bacd,_0x8bf1c5){_0x12e61f[a92_0x16eb('0x1e')]();if(_0x33bacd){}else{const _0x54c010=a92_0x16eb('0x1f')+_0x19c5fe[a92_0x16eb('0x1c')]+a92_0x16eb('0x20');_0x8bf1c5['pipe'](fs_1[a92_0x16eb('0xc')][a92_0x16eb('0x21')](_0x54c010));_0x19c5fe['status']=0x1;_0x19c5fe[a92_0x16eb('0x22')]();console[a92_0x16eb('0xb')](a92_0x16eb('0x23')+_0x19c5fe[a92_0x16eb('0x1c')]);}});});_0x12e61f['on'](a92_0x16eb('0x15'),function(_0x1415d8){_0x25e1b9[a92_0x16eb('0x14')]({'message':_0x1415d8});});_0x12e61f[a92_0x16eb('0x24')]({'host':a92_0x16eb('0x16'),'port':0x15,'user':a92_0x16eb('0x17'),'password':a92_0x16eb('0x17')});_0x25e1b9[a92_0x16eb('0x14')]({'data':_0x19c5fe[a92_0x16eb('0x1c')]});}else{_0x25e1b9['json']({'data':[]});}});};exports[a92_0x16eb('0x25')]=(_0x2b50c5,_0x2d27f7)=>{exports[a92_0x16eb('0x5')][a92_0x16eb('0x11')][a92_0x16eb('0x12')]['findOne']({'where':{'status':0x1}})[a92_0x16eb('0x26')](_0x4a7d7d=>{if(_0x4a7d7d){const _0x10dfb6=a92_0x16eb('0x1f')+_0x4a7d7d['fileName']+a92_0x16eb('0x20');fs_1[a92_0x16eb('0xc')]['readFile'](_0x10dfb6,'utf8',function(_0x1ed53e,_0x4d89ba){if(_0x1ed53e){_0x4a7d7d[a92_0x16eb('0x27')]=null;}else{try{const _0x161952=JSON[a92_0x16eb('0x28')](_0x4d89ba);for(const _0x53b3ac of _0x161952[a92_0x16eb('0x29')][0x0][a92_0x16eb('0x2a')]){const _0x5f356b=_0x53b3ac['In'];const _0x1d1827=_0x53b3ac[a92_0x16eb('0x2b')];const _0x5ae0ba=Date[a92_0x16eb('0x28')](_0x53b3ac[a92_0x16eb('0x2c')]);if(_0x5f356b>0x0){exports[a92_0x16eb('0x5')]['models'][a92_0x16eb('0x2d')]['create']({'reportFileId':_0x4a7d7d['id'],'amount':_0x5f356b,'countingDate':_0x5ae0ba});}if(_0x1d1827>0x0){exports[a92_0x16eb('0x5')][a92_0x16eb('0x11')][a92_0x16eb('0x2d')][a92_0x16eb('0x2e')]({'reportFileId':_0x4a7d7d['id'],'amount':_0x1d1827*-0x1,'countingDate':_0x5ae0ba});}}_0x4a7d7d[a92_0x16eb('0x27')]=0x2;}catch(_0x5781ba){_0x4a7d7d[a92_0x16eb('0x27')]=null;}}_0x4a7d7d[a92_0x16eb('0x22')]();});_0x2d27f7[a92_0x16eb('0x14')]({'data':_0x4a7d7d[a92_0x16eb('0x1c')]});}else{_0x2d27f7[a92_0x16eb('0x14')]({'data':[]});}});};exports['getPassCounting']=(_0xfb520e,_0x35c5f9)=>{exports[a92_0x16eb('0x5')][a92_0x16eb('0x11')][a92_0x16eb('0x2d')][a92_0x16eb('0x2f')]({'where':{'amount':{[exports[a92_0x16eb('0x5')]['Op']['gt']]:0x0}},'order':[[a92_0x16eb('0x30'),a92_0x16eb('0x31')]]})[a92_0x16eb('0x26')](_0xca99f9=>{_0x35c5f9[a92_0x16eb('0x14')]({'data':_0xca99f9});});};exports['getPassCountingByDay']=(_0x44b834,_0x629c55)=>{const _0x144d77=_0x44b834['query']['month'];const _0x2e3d27=_0x44b834['query']['startDate'];const _0x150fa9=_0x44b834[a92_0x16eb('0x32')][a92_0x16eb('0x33')];exports[a92_0x16eb('0x5')][a92_0x16eb('0x11')][a92_0x16eb('0x2d')]['findAll']({'attributes':['countingDate',[exports['sequelize']['fn']('sum',exports[a92_0x16eb('0x5')][a92_0x16eb('0x34')](a92_0x16eb('0x35'))),a92_0x16eb('0x36')]],'where':{'countingDate':{[exports[a92_0x16eb('0x5')]['Op'][a92_0x16eb('0x37')]]:_0x2e3d27,[exports[a92_0x16eb('0x5')]['Op']['lt']]:_0x150fa9},'amount':_0x44b834[a92_0x16eb('0x38')][a92_0x16eb('0x39')]=='in'?{[exports[a92_0x16eb('0x5')]['Op']['gt']]:0x0}:{[exports[a92_0x16eb('0x5')]['Op']['lt']]:0x0}},'group':[exports['sequelize'][a92_0x16eb('0x3a')](a92_0x16eb('0x3b'))],'order':[[a92_0x16eb('0x30'),'ASC']]})[a92_0x16eb('0x26')](_0x39905b=>{_0x629c55[a92_0x16eb('0x14')]({'data':_0x39905b});});};exports[a92_0x16eb('0x3c')]=(_0xccf4c,_0x31f3fe)=>{const _0x1b82e4=_0xccf4c[a92_0x16eb('0x32')][a92_0x16eb('0x3d')];const _0x3792a2=_0xccf4c[a92_0x16eb('0x32')][a92_0x16eb('0x3e')];const _0x592727=_0xccf4c[a92_0x16eb('0x32')][a92_0x16eb('0x33')];exports[a92_0x16eb('0x5')][a92_0x16eb('0x11')][a92_0x16eb('0x2d')][a92_0x16eb('0x2f')]({'attributes':[a92_0x16eb('0x30'),[exports[a92_0x16eb('0x5')]['fn'](a92_0x16eb('0x3f'),exports[a92_0x16eb('0x5')][a92_0x16eb('0x34')]('countingDate'),a92_0x16eb('0x40')),a92_0x16eb('0x41')],[exports[a92_0x16eb('0x5')]['fn']('sum',exports['sequelize']['col'](a92_0x16eb('0x35'))),a92_0x16eb('0x36')]],'where':{'countingDate':{[exports['sequelize']['Op'][a92_0x16eb('0x37')]]:_0x3792a2,[exports[a92_0x16eb('0x5')]['Op']['lt']]:_0x592727},'amount':_0xccf4c[a92_0x16eb('0x38')][a92_0x16eb('0x39')]=='in'?{[exports[a92_0x16eb('0x5')]['Op']['gt']]:0x0}:{[exports[a92_0x16eb('0x5')]['Op']['lt']]:0x0}},'group':[exports[a92_0x16eb('0x5')]['fn']('HOUR',exports[a92_0x16eb('0x5')]['col'](a92_0x16eb('0x30'))),exports[a92_0x16eb('0x5')]['fn'](a92_0x16eb('0x42'),exports[a92_0x16eb('0x5')][a92_0x16eb('0x34')](a92_0x16eb('0x30'))),exports[a92_0x16eb('0x5')]['fn'](a92_0x16eb('0x43'),exports['sequelize'][a92_0x16eb('0x34')](a92_0x16eb('0x30'))),exports[a92_0x16eb('0x5')]['fn'](a92_0x16eb('0x44'),exports['sequelize'][a92_0x16eb('0x34')](a92_0x16eb('0x30')))],'order':[['countingDate',a92_0x16eb('0x31')]]})['then'](_0x24560a=>{_0x31f3fe['json']({'data':_0x24560a});});};exports[a92_0x16eb('0x45')]=(_0x4d6184,_0x12aa06,_0x51b082)=>{const _0x359635=_0x4d6184[a92_0x16eb('0x46')][a92_0x16eb('0x47')][a92_0x16eb('0x48')](_0x359635=>_0x359635['kind']===a92_0x16eb('0x49'));fbgraph_1[a92_0x16eb('0xc')][a92_0x16eb('0x4a')](_0x359635[a92_0x16eb('0x4b')]);fbgraph_1['default'][a92_0x16eb('0x1d')](_0x4d6184[a92_0x16eb('0x46')][a92_0x16eb('0x49')]+a92_0x16eb('0x4c'),(_0x2f39af,_0x3d3544)=>{if(_0x2f39af){return _0x51b082(_0x2f39af);}_0x12aa06[a92_0x16eb('0x8')](a92_0x16eb('0x4d'),{'title':'Facebook\x20API','profile':_0x3d3544});});};
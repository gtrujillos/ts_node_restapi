var a92_0x210c=['findAll','ASC','getPassCountingByDay','month','startDate','query','countingDate','amount','total','params','direction','literal','YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))','getPassCountingByHour','endDate','DATE_FORMAT','col','%Y-%m-%d\x20%H:00','countingDateShort','sum','DAY','MONTH','YEAR','user','facebook','get','?fields=id,name,email,first_name,last_name,gender,link,locale,timezone','render','api/facebook','Facebook\x20API','__esModule','defineProperty','fbgraph','ftp','getApi','api/index','API\x20Examples','connecting','default','ready','log','connected','list','colombia','Downloading:\x20','name','endsWith','json','sequelize','models','reportFiles','spread','push','error','connect','ftp.vivotek.com','ipd','then','connected:','fileName','colombia/','media/','.txt','pipe','createWriteStream','status','Downloaded:\x20','findOne','utf8','Data','CountingInfo','EndTime','passes','create','save','getPassCounting'];(function(_0x5efaea,_0x218376){var _0x228c26=function(_0x305356){while(--_0x305356){_0x5efaea['push'](_0x5efaea['shift']());}};_0x228c26(++_0x218376);}(a92_0x210c,0x14e));var a92_0x2cd6=function(_0x234014,_0x172649){_0x234014=_0x234014-0x0;var _0x7d2310=a92_0x210c[_0x234014];return _0x7d2310;};'use strict';var __importDefault=this&&this['__importDefault']||function(_0x316334){return _0x316334&&_0x316334[a92_0x2cd6('0x0')]?_0x316334:{'default':_0x316334};};Object[a92_0x2cd6('0x1')](exports,'__esModule',{'value':!![]});const fbgraph_1=__importDefault(require(a92_0x2cd6('0x2')));const ftp_1=__importDefault(require(a92_0x2cd6('0x3')));const fs_1=__importDefault(require('fs'));function setSequelize(_0x2f79f1){exports['sequelize']=_0x2f79f1;}exports['setSequelize']=setSequelize;exports[a92_0x2cd6('0x4')]=(_0x5900d7,_0x4f30ab)=>{_0x4f30ab['render'](a92_0x2cd6('0x5'),{'title':a92_0x2cd6('0x6')});};exports['syncFtp']=(_0x3d123f,_0x36974e)=>{console['log'](a92_0x2cd6('0x7'));const _0x5d5aec=[];const _0x3627f5=new ftp_1[(a92_0x2cd6('0x8'))]();_0x3627f5['on'](a92_0x2cd6('0x9'),function(){console[a92_0x2cd6('0xa')](a92_0x2cd6('0xb'));_0x3627f5[a92_0x2cd6('0xc')](a92_0x2cd6('0xd'),![],function(_0x159eaf,_0x52e29b){if(_0x159eaf){}else{for(const _0x57ac48 of _0x52e29b){console['log'](a92_0x2cd6('0xe')+_0x57ac48[a92_0x2cd6('0xf')]);if(_0x57ac48[a92_0x2cd6('0xf')][a92_0x2cd6('0x10')](a92_0x2cd6('0x11'))){exports[a92_0x2cd6('0x12')][a92_0x2cd6('0x13')][a92_0x2cd6('0x14')]['findOrCreate']({'where':{'fileName':_0x57ac48['name']}})[a92_0x2cd6('0x15')]((_0x4217c5,_0x4b946a)=>{if(_0x4b946a){console[a92_0x2cd6('0xa')](_0x57ac48['name']);_0x5d5aec[a92_0x2cd6('0x16')](_0x4217c5);}});}}}_0x36974e[a92_0x2cd6('0x11')]({'data':_0x5d5aec});});});_0x3627f5['on'](a92_0x2cd6('0x17'),function(_0x308455){_0x36974e[a92_0x2cd6('0x11')]({'message':_0x308455});});_0x3627f5[a92_0x2cd6('0x18')]({'host':a92_0x2cd6('0x19'),'port':0x15,'user':a92_0x2cd6('0x1a'),'password':a92_0x2cd6('0x1a')});};exports['downloadFtp']=(_0xab4ed,_0x47e16f)=>{exports[a92_0x2cd6('0x12')]['models'][a92_0x2cd6('0x14')]['findOne']({'where':{'status':null}})[a92_0x2cd6('0x1b')](_0x16398f=>{if(_0x16398f){const _0x133177=new ftp_1[(a92_0x2cd6('0x8'))]();_0x133177['on']('ready',function(){console[a92_0x2cd6('0xa')](a92_0x2cd6('0x1c')+_0x16398f[a92_0x2cd6('0x1d')]);_0x133177['get'](a92_0x2cd6('0x1e')+_0x16398f[a92_0x2cd6('0x1d')],function(_0x4e44e4,_0xe43b4d){_0x133177['end']();if(_0x4e44e4){}else{const _0x25c482=a92_0x2cd6('0x1f')+_0x16398f[a92_0x2cd6('0x1d')]+a92_0x2cd6('0x20');_0xe43b4d[a92_0x2cd6('0x21')](fs_1[a92_0x2cd6('0x8')][a92_0x2cd6('0x22')](_0x25c482));_0x16398f[a92_0x2cd6('0x23')]=0x1;_0x16398f['save']();console['log'](a92_0x2cd6('0x24')+_0x16398f[a92_0x2cd6('0x1d')]);}});});_0x133177['on'](a92_0x2cd6('0x17'),function(_0x8375a2){_0x47e16f[a92_0x2cd6('0x11')]({'message':_0x8375a2});});_0x133177['connect']({'host':a92_0x2cd6('0x19'),'port':0x15,'user':a92_0x2cd6('0x1a'),'password':'ipd'});_0x47e16f[a92_0x2cd6('0x11')]({'data':_0x16398f[a92_0x2cd6('0x1d')]});}else{_0x47e16f[a92_0x2cd6('0x11')]({'data':[]});}});};exports['processFtp']=(_0x9aae6,_0x191437)=>{exports[a92_0x2cd6('0x12')][a92_0x2cd6('0x13')][a92_0x2cd6('0x14')][a92_0x2cd6('0x25')]({'where':{'status':0x1}})[a92_0x2cd6('0x1b')](_0x1babb0=>{if(_0x1babb0){const _0x27e08c=a92_0x2cd6('0x1f')+_0x1babb0[a92_0x2cd6('0x1d')]+a92_0x2cd6('0x20');fs_1[a92_0x2cd6('0x8')]['readFile'](_0x27e08c,a92_0x2cd6('0x26'),function(_0x5591ce,_0x3ee3a0){if(_0x5591ce){_0x1babb0[a92_0x2cd6('0x23')]=null;}else{try{const _0x236ab6=JSON['parse'](_0x3ee3a0);for(const _0x5e33a0 of _0x236ab6[a92_0x2cd6('0x27')][0x0][a92_0x2cd6('0x28')]){const _0x43cf2f=_0x5e33a0['In'];const _0x46c49=_0x5e33a0['Out'];const _0x1ac624=Date['parse'](_0x5e33a0[a92_0x2cd6('0x29')]);if(_0x43cf2f>0x0){exports[a92_0x2cd6('0x12')][a92_0x2cd6('0x13')][a92_0x2cd6('0x2a')][a92_0x2cd6('0x2b')]({'reportFileId':_0x1babb0['id'],'amount':_0x43cf2f,'countingDate':_0x1ac624});}if(_0x46c49>0x0){exports['sequelize'][a92_0x2cd6('0x13')][a92_0x2cd6('0x2a')][a92_0x2cd6('0x2b')]({'reportFileId':_0x1babb0['id'],'amount':_0x46c49*-0x1,'countingDate':_0x1ac624});}}_0x1babb0[a92_0x2cd6('0x23')]=0x2;}catch(_0x80ec7c){_0x1babb0[a92_0x2cd6('0x23')]=null;}}_0x1babb0[a92_0x2cd6('0x2c')]();});_0x191437[a92_0x2cd6('0x11')]({'data':_0x1babb0[a92_0x2cd6('0x1d')]});}else{_0x191437['json']({'data':[]});}});};exports[a92_0x2cd6('0x2d')]=(_0x44dce8,_0x3ec68e)=>{exports[a92_0x2cd6('0x12')][a92_0x2cd6('0x13')][a92_0x2cd6('0x2a')][a92_0x2cd6('0x2e')]({'where':{'amount':{[exports[a92_0x2cd6('0x12')]['Op']['gt']]:0x0}},'order':[['countingDate',a92_0x2cd6('0x2f')]]})[a92_0x2cd6('0x1b')](_0x316b05=>{_0x3ec68e[a92_0x2cd6('0x11')]({'data':_0x316b05});});};exports[a92_0x2cd6('0x30')]=(_0x36b472,_0x2520b3)=>{const _0x4913ab=_0x36b472['query'][a92_0x2cd6('0x31')];const _0x48ed5a=_0x36b472['query'][a92_0x2cd6('0x32')];const _0x79eace=_0x36b472[a92_0x2cd6('0x33')]['endDate'];exports[a92_0x2cd6('0x12')][a92_0x2cd6('0x13')][a92_0x2cd6('0x2a')]['findAll']({'attributes':[a92_0x2cd6('0x34'),[exports[a92_0x2cd6('0x12')]['fn']('sum',exports[a92_0x2cd6('0x12')]['col'](a92_0x2cd6('0x35'))),a92_0x2cd6('0x36')]],'where':{'countingDate':{[exports[a92_0x2cd6('0x12')]['Op']['gte']]:_0x48ed5a,[exports[a92_0x2cd6('0x12')]['Op']['lt']]:_0x79eace},'amount':_0x36b472[a92_0x2cd6('0x37')][a92_0x2cd6('0x38')]=='in'?{[exports['sequelize']['Op']['gt']]:0x0}:{[exports[a92_0x2cd6('0x12')]['Op']['lt']]:0x0}},'group':[exports[a92_0x2cd6('0x12')][a92_0x2cd6('0x39')](a92_0x2cd6('0x3a'))],'order':[[a92_0x2cd6('0x34'),a92_0x2cd6('0x2f')]]})[a92_0x2cd6('0x1b')](_0x388ee9=>{_0x2520b3['json']({'data':_0x388ee9});});};exports[a92_0x2cd6('0x3b')]=(_0x505acc,_0x3c64bb)=>{const _0x2ee14b=_0x505acc[a92_0x2cd6('0x33')][a92_0x2cd6('0x31')];const _0x933f8=_0x505acc[a92_0x2cd6('0x33')][a92_0x2cd6('0x32')];const _0x4d54d2=_0x505acc[a92_0x2cd6('0x33')][a92_0x2cd6('0x3c')];exports[a92_0x2cd6('0x12')]['models'][a92_0x2cd6('0x2a')]['findAll']({'attributes':[a92_0x2cd6('0x34'),[exports[a92_0x2cd6('0x12')]['fn'](a92_0x2cd6('0x3d'),exports[a92_0x2cd6('0x12')][a92_0x2cd6('0x3e')](a92_0x2cd6('0x34')),a92_0x2cd6('0x3f')),a92_0x2cd6('0x40')],[exports[a92_0x2cd6('0x12')]['fn'](a92_0x2cd6('0x41'),exports['sequelize'][a92_0x2cd6('0x3e')](a92_0x2cd6('0x35'))),a92_0x2cd6('0x36')]],'where':{'countingDate':{[exports['sequelize']['Op']['gte']]:_0x933f8,[exports[a92_0x2cd6('0x12')]['Op']['lt']]:_0x4d54d2},'amount':_0x505acc[a92_0x2cd6('0x37')][a92_0x2cd6('0x38')]=='in'?{[exports['sequelize']['Op']['gt']]:0x0}:{[exports[a92_0x2cd6('0x12')]['Op']['lt']]:0x0}},'group':[exports['sequelize']['fn']('HOUR',exports[a92_0x2cd6('0x12')][a92_0x2cd6('0x3e')]('countingDate')),exports['sequelize']['fn'](a92_0x2cd6('0x42'),exports[a92_0x2cd6('0x12')][a92_0x2cd6('0x3e')]('countingDate')),exports[a92_0x2cd6('0x12')]['fn'](a92_0x2cd6('0x43'),exports[a92_0x2cd6('0x12')][a92_0x2cd6('0x3e')](a92_0x2cd6('0x34'))),exports[a92_0x2cd6('0x12')]['fn'](a92_0x2cd6('0x44'),exports['sequelize'][a92_0x2cd6('0x3e')](a92_0x2cd6('0x34')))],'order':[[a92_0x2cd6('0x34'),a92_0x2cd6('0x2f')]]})[a92_0x2cd6('0x1b')](_0x2a2fa2=>{_0x3c64bb['json']({'data':_0x2a2fa2});});};exports['getFacebook']=(_0x139b7d,_0x55c184,_0x508604)=>{const _0x752306=_0x139b7d[a92_0x2cd6('0x45')]['tokens']['find'](_0x752306=>_0x752306['kind']===a92_0x2cd6('0x46'));fbgraph_1[a92_0x2cd6('0x8')]['setAccessToken'](_0x752306['accessToken']);fbgraph_1[a92_0x2cd6('0x8')][a92_0x2cd6('0x47')](_0x139b7d['user'][a92_0x2cd6('0x46')]+a92_0x2cd6('0x48'),(_0x4da961,_0x38a591)=>{if(_0x4da961){return _0x508604(_0x4da961);}_0x55c184[a92_0x2cd6('0x49')](a92_0x2cd6('0x4a'),{'title':a92_0x2cd6('0x4b'),'profile':_0x38a591});});};
var a92_0x5eb9=['ready','log','connected','list','colombia','Downloading:\x20','name','endsWith','json','models','reportFiles','findOrCreate','spread','error','connect','ftp.vivotek.com','ipd','downloadFtp','then','fileName','get','colombia/','end','media/','.txt','pipe','createWriteStream','status','save','Downloaded:\x20','findOne','readFile','utf8','parse','Data','CountingInfo','Out','EndTime','passes','create','getPassCounting','findAll','getPassCountingByDay','query','month','startDate','endDate','col','amount','total','gte','params','YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))','getPassCountingByHour','countingDate','%Y-%m-%d\x20%H:00','countingDateShort','sum','direction','HOUR','MONTH','YEAR','ASC','getFacebook','tokens','find','kind','facebook','setAccessToken','api/facebook','Facebook\x20API','__importDefault','__esModule','fbgraph','sequelize','setSequelize','getApi','render','API\x20Examples','syncFtp','connecting','default'];(function(_0x33e13e,_0x191c6d){var _0x9f8041=function(_0x46836a){while(--_0x46836a){_0x33e13e['push'](_0x33e13e['shift']());}};_0x9f8041(++_0x191c6d);}(a92_0x5eb9,0x18f));var a92_0x4bea=function(_0x4b5640,_0x4a29e2){_0x4b5640=_0x4b5640-0x0;var _0x17a6e1=a92_0x5eb9[_0x4b5640];return _0x17a6e1;};'use strict';var __importDefault=this&&this[a92_0x4bea('0x0')]||function(_0x20bc1d){return _0x20bc1d&&_0x20bc1d[a92_0x4bea('0x1')]?_0x20bc1d:{'default':_0x20bc1d};};Object['defineProperty'](exports,a92_0x4bea('0x1'),{'value':!![]});const fbgraph_1=__importDefault(require(a92_0x4bea('0x2')));const ftp_1=__importDefault(require('ftp'));const fs_1=__importDefault(require('fs'));function setSequelize(_0x269fb2){exports[a92_0x4bea('0x3')]=_0x269fb2;}exports[a92_0x4bea('0x4')]=setSequelize;exports[a92_0x4bea('0x5')]=(_0x52cd51,_0x16d2e8)=>{_0x16d2e8[a92_0x4bea('0x6')]('api/index',{'title':a92_0x4bea('0x7')});};exports[a92_0x4bea('0x8')]=(_0xa532f4,_0x19e62e)=>{console['log'](a92_0x4bea('0x9'));const _0x27f4fe=[];const _0x1ae7f8=new ftp_1[(a92_0x4bea('0xa'))]();_0x1ae7f8['on'](a92_0x4bea('0xb'),function(){console[a92_0x4bea('0xc')](a92_0x4bea('0xd'));_0x1ae7f8[a92_0x4bea('0xe')](a92_0x4bea('0xf'),![],function(_0xe5c2d6,_0x3ee97b){if(_0xe5c2d6){}else{for(const _0x6b9eed of _0x3ee97b){console[a92_0x4bea('0xc')](a92_0x4bea('0x10')+_0x6b9eed['name']);if(_0x6b9eed[a92_0x4bea('0x11')][a92_0x4bea('0x12')](a92_0x4bea('0x13'))){exports[a92_0x4bea('0x3')][a92_0x4bea('0x14')][a92_0x4bea('0x15')][a92_0x4bea('0x16')]({'where':{'fileName':_0x6b9eed[a92_0x4bea('0x11')]}})[a92_0x4bea('0x17')]((_0x3f9052,_0x23d6a3)=>{if(_0x23d6a3){console[a92_0x4bea('0xc')](_0x6b9eed[a92_0x4bea('0x11')]);_0x27f4fe['push'](_0x3f9052);}});}}}_0x19e62e[a92_0x4bea('0x13')]({'data':_0x27f4fe});});});_0x1ae7f8['on'](a92_0x4bea('0x18'),function(_0x49685){_0x19e62e[a92_0x4bea('0x13')]({'message':_0x49685});});_0x1ae7f8[a92_0x4bea('0x19')]({'host':a92_0x4bea('0x1a'),'port':0x15,'user':a92_0x4bea('0x1b'),'password':a92_0x4bea('0x1b')});};exports[a92_0x4bea('0x1c')]=(_0x39afb7,_0x42ccd6)=>{exports[a92_0x4bea('0x3')][a92_0x4bea('0x14')][a92_0x4bea('0x15')]['findOne']({'where':{'status':null}})[a92_0x4bea('0x1d')](_0x38d5da=>{if(_0x38d5da){const _0x36ec18=new ftp_1[(a92_0x4bea('0xa'))]();_0x36ec18['on'](a92_0x4bea('0xb'),function(){console[a92_0x4bea('0xc')]('connected:'+_0x38d5da[a92_0x4bea('0x1e')]);_0x36ec18[a92_0x4bea('0x1f')](a92_0x4bea('0x20')+_0x38d5da['fileName'],function(_0x2842ee,_0x86d00b){_0x36ec18[a92_0x4bea('0x21')]();if(_0x2842ee){}else{const _0x26f32c=a92_0x4bea('0x22')+_0x38d5da[a92_0x4bea('0x1e')]+a92_0x4bea('0x23');_0x86d00b[a92_0x4bea('0x24')](fs_1[a92_0x4bea('0xa')][a92_0x4bea('0x25')](_0x26f32c));_0x38d5da[a92_0x4bea('0x26')]=0x1;_0x38d5da[a92_0x4bea('0x27')]();console[a92_0x4bea('0xc')](a92_0x4bea('0x28')+_0x38d5da[a92_0x4bea('0x1e')]);}});});_0x36ec18['on'](a92_0x4bea('0x18'),function(_0x478a85){_0x42ccd6[a92_0x4bea('0x13')]({'message':_0x478a85});});_0x36ec18[a92_0x4bea('0x19')]({'host':a92_0x4bea('0x1a'),'port':0x15,'user':a92_0x4bea('0x1b'),'password':a92_0x4bea('0x1b')});_0x42ccd6[a92_0x4bea('0x13')]({'data':_0x38d5da[a92_0x4bea('0x1e')]});}else{_0x42ccd6[a92_0x4bea('0x13')]({'data':[]});}});};exports['processFtp']=(_0x572675,_0x19f52d)=>{exports[a92_0x4bea('0x3')]['models']['reportFiles'][a92_0x4bea('0x29')]({'where':{'status':0x1}})[a92_0x4bea('0x1d')](_0x3eb6c3=>{if(_0x3eb6c3){const _0x54e707=a92_0x4bea('0x22')+_0x3eb6c3[a92_0x4bea('0x1e')]+a92_0x4bea('0x23');fs_1[a92_0x4bea('0xa')][a92_0x4bea('0x2a')](_0x54e707,a92_0x4bea('0x2b'),function(_0x29ad3b,_0x157a21){if(_0x29ad3b){_0x3eb6c3[a92_0x4bea('0x26')]=null;}else{try{const _0x1cf894=JSON[a92_0x4bea('0x2c')](_0x157a21);for(const _0x40c2cb of _0x1cf894[a92_0x4bea('0x2d')][0x0][a92_0x4bea('0x2e')]){const _0x3da51a=_0x40c2cb['In'];const _0x2d235f=_0x40c2cb[a92_0x4bea('0x2f')];const _0x485799=Date[a92_0x4bea('0x2c')](_0x40c2cb[a92_0x4bea('0x30')]);if(_0x3da51a>0x0){exports['sequelize']['models'][a92_0x4bea('0x31')][a92_0x4bea('0x32')]({'reportFileId':_0x3eb6c3['id'],'amount':_0x3da51a,'countingDate':_0x485799});}if(_0x2d235f>0x0){exports[a92_0x4bea('0x3')]['models'][a92_0x4bea('0x31')]['create']({'reportFileId':_0x3eb6c3['id'],'amount':_0x2d235f*-0x1,'countingDate':_0x485799});}}_0x3eb6c3[a92_0x4bea('0x26')]=0x2;}catch(_0x2c26b7){_0x3eb6c3[a92_0x4bea('0x26')]=null;}}_0x3eb6c3[a92_0x4bea('0x27')]();});_0x19f52d[a92_0x4bea('0x13')]({'data':_0x3eb6c3[a92_0x4bea('0x1e')]});}else{_0x19f52d['json']({'data':[]});}});};exports[a92_0x4bea('0x33')]=(_0x3d4a35,_0x12c3cf)=>{exports['sequelize'][a92_0x4bea('0x14')]['passes'][a92_0x4bea('0x34')]({'where':{'amount':{[exports[a92_0x4bea('0x3')]['Op']['gt']]:0x0}},'order':[['countingDate','ASC']]})[a92_0x4bea('0x1d')](_0x151220=>{_0x12c3cf[a92_0x4bea('0x13')]({'data':_0x151220});});};exports[a92_0x4bea('0x35')]=(_0x59163b,_0x25d73b)=>{const _0xf30238=_0x59163b[a92_0x4bea('0x36')][a92_0x4bea('0x37')];const _0x3bbd42=_0x59163b[a92_0x4bea('0x36')][a92_0x4bea('0x38')];const _0x204981=_0x59163b['query'][a92_0x4bea('0x39')];exports['sequelize'][a92_0x4bea('0x14')][a92_0x4bea('0x31')][a92_0x4bea('0x34')]({'attributes':['countingDate',[exports['sequelize']['fn']('sum',exports[a92_0x4bea('0x3')][a92_0x4bea('0x3a')](a92_0x4bea('0x3b'))),a92_0x4bea('0x3c')]],'where':{'countingDate':{[exports[a92_0x4bea('0x3')]['Op'][a92_0x4bea('0x3d')]]:_0x3bbd42,[exports[a92_0x4bea('0x3')]['Op']['lt']]:_0x204981},'amount':_0x59163b[a92_0x4bea('0x3e')]['direction']=='in'?{[exports[a92_0x4bea('0x3')]['Op']['gt']]:0x0}:{[exports['sequelize']['Op']['lt']]:0x0}},'group':[exports['sequelize']['literal'](a92_0x4bea('0x3f'))],'order':[['countingDate','ASC']]})[a92_0x4bea('0x1d')](_0x4f5917=>{_0x25d73b[a92_0x4bea('0x13')]({'data':_0x4f5917});});};exports[a92_0x4bea('0x40')]=(_0x5ddb06,_0x80dd9c)=>{const _0x244a10=_0x5ddb06[a92_0x4bea('0x36')][a92_0x4bea('0x37')];const _0x4f3a25=_0x5ddb06['query']['startDate'];const _0x2b8156=_0x5ddb06[a92_0x4bea('0x36')][a92_0x4bea('0x39')];exports[a92_0x4bea('0x3')][a92_0x4bea('0x14')][a92_0x4bea('0x31')]['findAll']({'attributes':[a92_0x4bea('0x41'),[exports['sequelize']['fn']('DATE_FORMAT',exports['sequelize'][a92_0x4bea('0x3a')](a92_0x4bea('0x41')),a92_0x4bea('0x42')),a92_0x4bea('0x43')],[exports[a92_0x4bea('0x3')]['fn'](a92_0x4bea('0x44'),exports[a92_0x4bea('0x3')][a92_0x4bea('0x3a')](a92_0x4bea('0x3b'))),'total']],'where':{'countingDate':{[exports[a92_0x4bea('0x3')]['Op'][a92_0x4bea('0x3d')]]:_0x4f3a25,[exports[a92_0x4bea('0x3')]['Op']['lt']]:_0x2b8156},'amount':_0x5ddb06['params'][a92_0x4bea('0x45')]=='in'?{[exports[a92_0x4bea('0x3')]['Op']['gt']]:0x0}:{[exports[a92_0x4bea('0x3')]['Op']['lt']]:0x0}},'group':[exports[a92_0x4bea('0x3')]['fn'](a92_0x4bea('0x46'),exports[a92_0x4bea('0x3')][a92_0x4bea('0x3a')](a92_0x4bea('0x41'))),exports[a92_0x4bea('0x3')]['fn']('DAY',exports[a92_0x4bea('0x3')]['col'](a92_0x4bea('0x41'))),exports[a92_0x4bea('0x3')]['fn'](a92_0x4bea('0x47'),exports[a92_0x4bea('0x3')][a92_0x4bea('0x3a')](a92_0x4bea('0x41'))),exports['sequelize']['fn'](a92_0x4bea('0x48'),exports['sequelize'][a92_0x4bea('0x3a')](a92_0x4bea('0x41')))],'order':[[a92_0x4bea('0x41'),a92_0x4bea('0x49')]]})[a92_0x4bea('0x1d')](_0x236c2b=>{_0x80dd9c[a92_0x4bea('0x13')]({'data':_0x236c2b});});};exports[a92_0x4bea('0x4a')]=(_0x2c890c,_0x163a0,_0x32de08)=>{const _0xad337f=_0x2c890c['user'][a92_0x4bea('0x4b')][a92_0x4bea('0x4c')](_0xad337f=>_0xad337f[a92_0x4bea('0x4d')]===a92_0x4bea('0x4e'));fbgraph_1[a92_0x4bea('0xa')][a92_0x4bea('0x4f')](_0xad337f['accessToken']);fbgraph_1['default'][a92_0x4bea('0x1f')](_0x2c890c['user'][a92_0x4bea('0x4e')]+'?fields=id,name,email,first_name,last_name,gender,link,locale,timezone',(_0x372a27,_0xe1732d)=>{if(_0x372a27){return _0x32de08(_0x372a27);}_0x163a0[a92_0x4bea('0x6')](a92_0x4bea('0x50'),{'title':a92_0x4bea('0x51'),'profile':_0xe1732d});});};
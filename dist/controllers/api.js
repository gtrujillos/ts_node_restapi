var a92_0x19c2=['models','reportFiles','findOrCreate','spread','push','ftp.vivotek.com','ipd','downloadFtp','then','connected:','fileName','get','colombia/','end','media/','.txt','createWriteStream','status','save','Downloaded:\x20','error','connect','processFtp','findOne','parse','Data','CountingInfo','EndTime','passes','create','getPassCounting','findAll','countingDate','getPassCountingByDay','query','month','startDate','endDate','sum','col','total','params','direction','ASC','getPassCountingByHour','DATE_FORMAT','%Y-%m-%d\x20%H:00','countingDateShort','amount','gte','HOUR','DAY','MONTH','user','tokens','find','kind','setAccessToken','accessToken','facebook','?fields=id,name,email,first_name,last_name,gender,link,locale,timezone','api/facebook','__importDefault','__esModule','defineProperty','fbgraph','ftp','sequelize','setSequelize','getApi','render','api/index','API\x20Examples','syncFtp','log','connecting','default','ready','list','colombia','Downloading:\x20','name','endsWith','json'];(function(_0x1721f8,_0x4e7b49){var _0x1cc3ab=function(_0x5bef75){while(--_0x5bef75){_0x1721f8['push'](_0x1721f8['shift']());}};_0x1cc3ab(++_0x4e7b49);}(a92_0x19c2,0xe6));var a92_0x4ed7=function(_0x5db683,_0x3e3211){_0x5db683=_0x5db683-0x0;var _0x58873f=a92_0x19c2[_0x5db683];return _0x58873f;};'use strict';var __importDefault=this&&this[a92_0x4ed7('0x0')]||function(_0x2e3ab0){return _0x2e3ab0&&_0x2e3ab0[a92_0x4ed7('0x1')]?_0x2e3ab0:{'default':_0x2e3ab0};};Object[a92_0x4ed7('0x2')](exports,a92_0x4ed7('0x1'),{'value':!![]});const fbgraph_1=__importDefault(require(a92_0x4ed7('0x3')));const ftp_1=__importDefault(require(a92_0x4ed7('0x4')));const fs_1=__importDefault(require('fs'));function setSequelize(_0x436188){exports[a92_0x4ed7('0x5')]=_0x436188;}exports[a92_0x4ed7('0x6')]=setSequelize;exports[a92_0x4ed7('0x7')]=(_0x584fdb,_0x309350)=>{_0x309350[a92_0x4ed7('0x8')](a92_0x4ed7('0x9'),{'title':a92_0x4ed7('0xa')});};exports[a92_0x4ed7('0xb')]=(_0x428439,_0x12d6b8)=>{console[a92_0x4ed7('0xc')](a92_0x4ed7('0xd'));const _0x527be5=[];const _0x16f305=new ftp_1[(a92_0x4ed7('0xe'))]();_0x16f305['on'](a92_0x4ed7('0xf'),function(){console[a92_0x4ed7('0xc')]('connected');_0x16f305[a92_0x4ed7('0x10')](a92_0x4ed7('0x11'),![],function(_0x39a6f6,_0x430ac5){if(_0x39a6f6){}else{for(const _0x172b10 of _0x430ac5){console[a92_0x4ed7('0xc')](a92_0x4ed7('0x12')+_0x172b10[a92_0x4ed7('0x13')]);if(_0x172b10[a92_0x4ed7('0x13')][a92_0x4ed7('0x14')](a92_0x4ed7('0x15'))){exports[a92_0x4ed7('0x5')][a92_0x4ed7('0x16')][a92_0x4ed7('0x17')][a92_0x4ed7('0x18')]({'where':{'fileName':_0x172b10[a92_0x4ed7('0x13')]}})[a92_0x4ed7('0x19')]((_0x33b0de,_0x225e8a)=>{if(_0x225e8a){console[a92_0x4ed7('0xc')](_0x172b10[a92_0x4ed7('0x13')]);_0x527be5[a92_0x4ed7('0x1a')](_0x33b0de);}});}}}_0x12d6b8[a92_0x4ed7('0x15')]({'data':_0x527be5});});});_0x16f305['on']('error',function(_0x254455){_0x12d6b8['json']({'message':_0x254455});});_0x16f305['connect']({'host':a92_0x4ed7('0x1b'),'port':0x15,'user':a92_0x4ed7('0x1c'),'password':a92_0x4ed7('0x1c')});};exports[a92_0x4ed7('0x1d')]=(_0x56567f,_0x40189b)=>{exports[a92_0x4ed7('0x5')][a92_0x4ed7('0x16')][a92_0x4ed7('0x17')]['findOne']({'where':{'status':null}})[a92_0x4ed7('0x1e')](_0x2e4dc7=>{if(_0x2e4dc7){const _0xff831c=new ftp_1[(a92_0x4ed7('0xe'))]();_0xff831c['on']('ready',function(){console[a92_0x4ed7('0xc')](a92_0x4ed7('0x1f')+_0x2e4dc7[a92_0x4ed7('0x20')]);_0xff831c[a92_0x4ed7('0x21')](a92_0x4ed7('0x22')+_0x2e4dc7[a92_0x4ed7('0x20')],function(_0x10e71b,_0x3ce6dd){_0xff831c[a92_0x4ed7('0x23')]();if(_0x10e71b){}else{const _0x4903a7=a92_0x4ed7('0x24')+_0x2e4dc7[a92_0x4ed7('0x20')]+a92_0x4ed7('0x25');_0x3ce6dd['pipe'](fs_1[a92_0x4ed7('0xe')][a92_0x4ed7('0x26')](_0x4903a7));_0x2e4dc7[a92_0x4ed7('0x27')]=0x1;_0x2e4dc7[a92_0x4ed7('0x28')]();console['log'](a92_0x4ed7('0x29')+_0x2e4dc7[a92_0x4ed7('0x20')]);}});});_0xff831c['on'](a92_0x4ed7('0x2a'),function(_0xc8b927){_0x40189b[a92_0x4ed7('0x15')]({'message':_0xc8b927});});_0xff831c[a92_0x4ed7('0x2b')]({'host':a92_0x4ed7('0x1b'),'port':0x15,'user':a92_0x4ed7('0x1c'),'password':a92_0x4ed7('0x1c')});_0x40189b[a92_0x4ed7('0x15')]({'data':_0x2e4dc7[a92_0x4ed7('0x20')]});}else{_0x40189b[a92_0x4ed7('0x15')]({'data':[]});}});};exports[a92_0x4ed7('0x2c')]=(_0x535648,_0x212619)=>{exports[a92_0x4ed7('0x5')][a92_0x4ed7('0x16')][a92_0x4ed7('0x17')][a92_0x4ed7('0x2d')]({'where':{'status':0x1}})[a92_0x4ed7('0x1e')](_0x319cd8=>{if(_0x319cd8){const _0x3f9d42=a92_0x4ed7('0x24')+_0x319cd8[a92_0x4ed7('0x20')]+'.txt';fs_1[a92_0x4ed7('0xe')]['readFile'](_0x3f9d42,'utf8',function(_0x4f6455,_0x265094){if(_0x4f6455){_0x319cd8[a92_0x4ed7('0x27')]=null;}else{try{const _0x458c25=JSON[a92_0x4ed7('0x2e')](_0x265094);for(const _0x18b47d of _0x458c25[a92_0x4ed7('0x2f')][0x0][a92_0x4ed7('0x30')]){const _0x796895=_0x18b47d['In'];const _0x5dc1fc=_0x18b47d['Out'];const _0x514e83=Date[a92_0x4ed7('0x2e')](_0x18b47d[a92_0x4ed7('0x31')]);if(_0x796895>0x0){exports[a92_0x4ed7('0x5')][a92_0x4ed7('0x16')][a92_0x4ed7('0x32')][a92_0x4ed7('0x33')]({'reportFileId':_0x319cd8['id'],'amount':_0x796895,'countingDate':_0x514e83});}if(_0x5dc1fc>0x0){exports[a92_0x4ed7('0x5')]['models'][a92_0x4ed7('0x32')][a92_0x4ed7('0x33')]({'reportFileId':_0x319cd8['id'],'amount':_0x5dc1fc*-0x1,'countingDate':_0x514e83});}}_0x319cd8[a92_0x4ed7('0x27')]=0x2;}catch(_0x15c97c){_0x319cd8[a92_0x4ed7('0x27')]=null;}}_0x319cd8['save']();});_0x212619[a92_0x4ed7('0x15')]({'data':_0x319cd8[a92_0x4ed7('0x20')]});}else{_0x212619[a92_0x4ed7('0x15')]({'data':[]});}});};exports[a92_0x4ed7('0x34')]=(_0xc6a7fc,_0x5077c6)=>{exports[a92_0x4ed7('0x5')]['models'][a92_0x4ed7('0x32')][a92_0x4ed7('0x35')]({'where':{'amount':{[exports['sequelize']['Op']['gt']]:0x0}},'order':[[a92_0x4ed7('0x36'),'ASC']]})[a92_0x4ed7('0x1e')](_0x4319db=>{_0x5077c6[a92_0x4ed7('0x15')]({'data':_0x4319db});});};exports[a92_0x4ed7('0x37')]=(_0xb8d281,_0x2deebc)=>{const _0x59b559=_0xb8d281[a92_0x4ed7('0x38')][a92_0x4ed7('0x39')];const _0x1190a1=_0xb8d281[a92_0x4ed7('0x38')][a92_0x4ed7('0x3a')];const _0x38a00f=_0xb8d281[a92_0x4ed7('0x38')][a92_0x4ed7('0x3b')];exports['sequelize'][a92_0x4ed7('0x16')][a92_0x4ed7('0x32')][a92_0x4ed7('0x35')]({'attributes':[a92_0x4ed7('0x36'),[exports['sequelize']['fn'](a92_0x4ed7('0x3c'),exports[a92_0x4ed7('0x5')][a92_0x4ed7('0x3d')]('amount')),a92_0x4ed7('0x3e')]],'where':{'countingDate':{[exports[a92_0x4ed7('0x5')]['Op']['gte']]:_0x1190a1,[exports[a92_0x4ed7('0x5')]['Op']['lt']]:_0x38a00f},'amount':_0xb8d281[a92_0x4ed7('0x3f')][a92_0x4ed7('0x40')]=='in'?{[exports[a92_0x4ed7('0x5')]['Op']['gt']]:0x0}:{[exports[a92_0x4ed7('0x5')]['Op']['lt']]:0x0}},'group':[exports[a92_0x4ed7('0x5')]['literal']('YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))')],'order':[[a92_0x4ed7('0x36'),a92_0x4ed7('0x41')]]})['then'](_0xa3ab0f=>{_0x2deebc[a92_0x4ed7('0x15')]({'data':_0xa3ab0f});});};exports[a92_0x4ed7('0x42')]=(_0x2b6ad5,_0x248cc1)=>{const _0x2e94b9=_0x2b6ad5['query'][a92_0x4ed7('0x39')];const _0x294367=_0x2b6ad5['query']['startDate'];const _0x392062=_0x2b6ad5[a92_0x4ed7('0x38')][a92_0x4ed7('0x3b')];exports[a92_0x4ed7('0x5')]['models'][a92_0x4ed7('0x32')][a92_0x4ed7('0x35')]({'attributes':[a92_0x4ed7('0x36'),[exports[a92_0x4ed7('0x5')]['fn'](a92_0x4ed7('0x43'),exports['sequelize'][a92_0x4ed7('0x3d')](a92_0x4ed7('0x36')),a92_0x4ed7('0x44')),a92_0x4ed7('0x45')],[exports[a92_0x4ed7('0x5')]['fn'](a92_0x4ed7('0x3c'),exports[a92_0x4ed7('0x5')][a92_0x4ed7('0x3d')](a92_0x4ed7('0x46'))),a92_0x4ed7('0x3e')]],'where':{'countingDate':{[exports['sequelize']['Op'][a92_0x4ed7('0x47')]]:_0x294367,[exports[a92_0x4ed7('0x5')]['Op']['lt']]:_0x392062},'amount':_0x2b6ad5['params']['direction']=='in'?{[exports[a92_0x4ed7('0x5')]['Op']['gt']]:0x0}:{[exports[a92_0x4ed7('0x5')]['Op']['lt']]:0x0}},'group':[exports[a92_0x4ed7('0x5')]['fn'](a92_0x4ed7('0x48'),exports[a92_0x4ed7('0x5')][a92_0x4ed7('0x3d')](a92_0x4ed7('0x36'))),exports[a92_0x4ed7('0x5')]['fn'](a92_0x4ed7('0x49'),exports[a92_0x4ed7('0x5')][a92_0x4ed7('0x3d')]('countingDate')),exports[a92_0x4ed7('0x5')]['fn'](a92_0x4ed7('0x4a'),exports['sequelize'][a92_0x4ed7('0x3d')]('countingDate')),exports[a92_0x4ed7('0x5')]['fn']('YEAR',exports[a92_0x4ed7('0x5')]['col'](a92_0x4ed7('0x36')))],'order':[[a92_0x4ed7('0x36'),a92_0x4ed7('0x41')]]})[a92_0x4ed7('0x1e')](_0x26215b=>{_0x248cc1[a92_0x4ed7('0x15')]({'data':_0x26215b});});};exports['getFacebook']=(_0x591459,_0xbd59c9,_0x226f6e)=>{const _0x1f5cd2=_0x591459[a92_0x4ed7('0x4b')][a92_0x4ed7('0x4c')][a92_0x4ed7('0x4d')](_0x1f5cd2=>_0x1f5cd2[a92_0x4ed7('0x4e')]==='facebook');fbgraph_1[a92_0x4ed7('0xe')][a92_0x4ed7('0x4f')](_0x1f5cd2[a92_0x4ed7('0x50')]);fbgraph_1[a92_0x4ed7('0xe')][a92_0x4ed7('0x21')](_0x591459[a92_0x4ed7('0x4b')][a92_0x4ed7('0x51')]+a92_0x4ed7('0x52'),(_0x3ecac8,_0x4f06b7)=>{if(_0x3ecac8){return _0x226f6e(_0x3ecac8);}_0xbd59c9['render'](a92_0x4ed7('0x53'),{'title':'Facebook\x20API','profile':_0x4f06b7});});};
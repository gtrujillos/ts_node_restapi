var a198_0x1a4a=['Facebook\x20API','__importDefault','__esModule','defineProperty','ftp','sequelize','setSequelize','getApi','render','API\x20Examples','syncFtp','log','connecting','ready','list','colombia','Downloading:\x20','name','endsWith','json','models','reportFiles','spread','push','error','ftp.vivotek.com','ipd','downloadFtp','findOne','then','default','connected:','fileName','end','media/','.txt','pipe','createWriteStream','status','save','Downloaded:\x20','connect','processFtp','readFile','utf8','parse','Data','CountingInfo','Out','passes','create','getPassCounting','countingDate','ASC','getPassCountingByDay','query','month','startDate','endDate','findAll','col','amount','total','gte','params','direction','YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))','getPassCountingByHour','%Y-%m-%d\x20%H:00','countingDateShort','sum','HOUR','MONTH','YEAR','user','tokens','find','kind','facebook','setAccessToken','get','?fields=id,name,email,first_name,last_name,gender,link,locale,timezone'];(function(_0x29fe33,_0x152962){var _0x5184c3=function(_0x3aa9f2){while(--_0x3aa9f2){_0x29fe33['push'](_0x29fe33['shift']());}};_0x5184c3(++_0x152962);}(a198_0x1a4a,0x19b));var a198_0x5b59=function(_0xa1d278,_0xc467e7){_0xa1d278=_0xa1d278-0x0;var _0x2bd3e5=a198_0x1a4a[_0xa1d278];return _0x2bd3e5;};'use strict';var __importDefault=this&&this[a198_0x5b59('0x0')]||function(_0x3eb676){return _0x3eb676&&_0x3eb676[a198_0x5b59('0x1')]?_0x3eb676:{'default':_0x3eb676};};Object[a198_0x5b59('0x2')](exports,a198_0x5b59('0x1'),{'value':!![]});const fbgraph_1=__importDefault(require('fbgraph'));const ftp_1=__importDefault(require(a198_0x5b59('0x3')));const fs_1=__importDefault(require('fs'));function setSequelize(_0x12f796){exports[a198_0x5b59('0x4')]=_0x12f796;}exports[a198_0x5b59('0x5')]=setSequelize;exports[a198_0x5b59('0x6')]=(_0x466ced,_0x2b708f)=>{_0x2b708f[a198_0x5b59('0x7')]('api/index',{'title':a198_0x5b59('0x8')});};exports[a198_0x5b59('0x9')]=(_0x1fec38,_0xa68f8e)=>{console[a198_0x5b59('0xa')](a198_0x5b59('0xb'));const _0x1f8142=[];const _0x519640=new ftp_1['default']();_0x519640['on'](a198_0x5b59('0xc'),function(){console[a198_0x5b59('0xa')]('connected');_0x519640[a198_0x5b59('0xd')](a198_0x5b59('0xe'),![],function(_0x3f008f,_0x5242c7){if(_0x3f008f){}else{for(const _0x384587 of _0x5242c7){console[a198_0x5b59('0xa')](a198_0x5b59('0xf')+_0x384587[a198_0x5b59('0x10')]);if(_0x384587[a198_0x5b59('0x10')][a198_0x5b59('0x11')](a198_0x5b59('0x12'))){exports[a198_0x5b59('0x4')][a198_0x5b59('0x13')][a198_0x5b59('0x14')]['findOrCreate']({'where':{'fileName':_0x384587[a198_0x5b59('0x10')]}})[a198_0x5b59('0x15')]((_0x550413,_0x204405)=>{if(_0x204405){console[a198_0x5b59('0xa')](_0x384587[a198_0x5b59('0x10')]);_0x1f8142[a198_0x5b59('0x16')](_0x550413);}});}}}_0xa68f8e[a198_0x5b59('0x12')]({'data':_0x1f8142});});});_0x519640['on'](a198_0x5b59('0x17'),function(_0x4842d4){_0xa68f8e[a198_0x5b59('0x12')]({'message':_0x4842d4});});_0x519640['connect']({'host':a198_0x5b59('0x18'),'port':0x15,'user':a198_0x5b59('0x19'),'password':a198_0x5b59('0x19')});};exports[a198_0x5b59('0x1a')]=(_0x16830a,_0x41ee24)=>{exports['sequelize'][a198_0x5b59('0x13')][a198_0x5b59('0x14')][a198_0x5b59('0x1b')]({'where':{'status':null}})[a198_0x5b59('0x1c')](_0x20dafa=>{if(_0x20dafa){const _0x5560f9=new ftp_1[(a198_0x5b59('0x1d'))]();_0x5560f9['on'](a198_0x5b59('0xc'),function(){console[a198_0x5b59('0xa')](a198_0x5b59('0x1e')+_0x20dafa[a198_0x5b59('0x1f')]);_0x5560f9['get']('colombia/'+_0x20dafa['fileName'],function(_0x159b51,_0xeaa8a){_0x5560f9[a198_0x5b59('0x20')]();if(_0x159b51){}else{const _0xc44ff4=a198_0x5b59('0x21')+_0x20dafa[a198_0x5b59('0x1f')]+a198_0x5b59('0x22');_0xeaa8a[a198_0x5b59('0x23')](fs_1['default'][a198_0x5b59('0x24')](_0xc44ff4));_0x20dafa[a198_0x5b59('0x25')]=0x1;_0x20dafa[a198_0x5b59('0x26')]();console[a198_0x5b59('0xa')](a198_0x5b59('0x27')+_0x20dafa[a198_0x5b59('0x1f')]);}});});_0x5560f9['on'](a198_0x5b59('0x17'),function(_0x4f3dd7){_0x41ee24[a198_0x5b59('0x12')]({'message':_0x4f3dd7});});_0x5560f9[a198_0x5b59('0x28')]({'host':a198_0x5b59('0x18'),'port':0x15,'user':'ipd','password':a198_0x5b59('0x19')});_0x41ee24['json']({'data':_0x20dafa[a198_0x5b59('0x1f')]});}else{_0x41ee24[a198_0x5b59('0x12')]({'data':[]});}});};exports[a198_0x5b59('0x29')]=(_0x485dc1,_0xa89112)=>{exports[a198_0x5b59('0x4')][a198_0x5b59('0x13')]['reportFiles'][a198_0x5b59('0x1b')]({'where':{'status':0x1}})['then'](_0xd0df6f=>{if(_0xd0df6f){const _0x310b8d=a198_0x5b59('0x21')+_0xd0df6f['fileName']+a198_0x5b59('0x22');fs_1[a198_0x5b59('0x1d')][a198_0x5b59('0x2a')](_0x310b8d,a198_0x5b59('0x2b'),function(_0x53ae6b,_0x5ed50e){if(_0x53ae6b){_0xd0df6f[a198_0x5b59('0x25')]=null;}else{try{const _0x4bcedf=JSON[a198_0x5b59('0x2c')](_0x5ed50e);for(const _0x5ad50e of _0x4bcedf[a198_0x5b59('0x2d')][0x0][a198_0x5b59('0x2e')]){const _0x3e381d=_0x5ad50e['In'];const _0x1b7b46=_0x5ad50e[a198_0x5b59('0x2f')];const _0x270959=Date[a198_0x5b59('0x2c')](_0x5ad50e['EndTime']);if(_0x3e381d>0x0){exports[a198_0x5b59('0x4')]['models'][a198_0x5b59('0x30')][a198_0x5b59('0x31')]({'reportFileId':_0xd0df6f['id'],'amount':_0x3e381d,'countingDate':_0x270959});}if(_0x1b7b46>0x0){exports['sequelize'][a198_0x5b59('0x13')][a198_0x5b59('0x30')][a198_0x5b59('0x31')]({'reportFileId':_0xd0df6f['id'],'amount':_0x1b7b46*-0x1,'countingDate':_0x270959});}}_0xd0df6f[a198_0x5b59('0x25')]=0x2;}catch(_0x178f0f){_0xd0df6f[a198_0x5b59('0x25')]=null;}}_0xd0df6f[a198_0x5b59('0x26')]();});_0xa89112[a198_0x5b59('0x12')]({'data':_0xd0df6f[a198_0x5b59('0x1f')]});}else{_0xa89112[a198_0x5b59('0x12')]({'data':[]});}});};exports[a198_0x5b59('0x32')]=(_0x59f0d3,_0x568bf0)=>{exports[a198_0x5b59('0x4')][a198_0x5b59('0x13')][a198_0x5b59('0x30')]['findAll']({'where':{'amount':{[exports['sequelize']['Op']['gt']]:0x0}},'order':[[a198_0x5b59('0x33'),a198_0x5b59('0x34')]]})[a198_0x5b59('0x1c')](_0x20c6e8=>{_0x568bf0[a198_0x5b59('0x12')]({'data':_0x20c6e8});});};exports[a198_0x5b59('0x35')]=(_0x1b910a,_0x8375f3)=>{const _0x40c4f3=_0x1b910a[a198_0x5b59('0x36')][a198_0x5b59('0x37')];const _0x224abc=_0x1b910a['query'][a198_0x5b59('0x38')];const _0x2bb2ce=_0x1b910a[a198_0x5b59('0x36')][a198_0x5b59('0x39')];exports[a198_0x5b59('0x4')][a198_0x5b59('0x13')][a198_0x5b59('0x30')][a198_0x5b59('0x3a')]({'attributes':[a198_0x5b59('0x33'),[exports['sequelize']['fn']('sum',exports[a198_0x5b59('0x4')][a198_0x5b59('0x3b')](a198_0x5b59('0x3c'))),a198_0x5b59('0x3d')]],'where':{'countingDate':{[exports['sequelize']['Op'][a198_0x5b59('0x3e')]]:_0x224abc,[exports[a198_0x5b59('0x4')]['Op']['lt']]:_0x2bb2ce},'amount':_0x1b910a[a198_0x5b59('0x3f')][a198_0x5b59('0x40')]=='in'?{[exports['sequelize']['Op']['gt']]:0x0}:{[exports[a198_0x5b59('0x4')]['Op']['lt']]:0x0}},'group':[exports[a198_0x5b59('0x4')]['literal'](a198_0x5b59('0x41'))],'order':[[a198_0x5b59('0x33'),a198_0x5b59('0x34')]]})['then'](_0x464244=>{_0x8375f3[a198_0x5b59('0x12')]({'data':_0x464244});});};exports[a198_0x5b59('0x42')]=(_0x57c2ce,_0x4b6d44)=>{const _0x772048=_0x57c2ce[a198_0x5b59('0x36')][a198_0x5b59('0x37')];const _0x9880f4=_0x57c2ce[a198_0x5b59('0x36')][a198_0x5b59('0x38')];const _0x2bcd77=_0x57c2ce[a198_0x5b59('0x36')]['endDate'];exports[a198_0x5b59('0x4')][a198_0x5b59('0x13')][a198_0x5b59('0x30')]['findAll']({'attributes':[a198_0x5b59('0x33'),[exports['sequelize']['fn']('DATE_FORMAT',exports[a198_0x5b59('0x4')][a198_0x5b59('0x3b')](a198_0x5b59('0x33')),a198_0x5b59('0x43')),a198_0x5b59('0x44')],[exports[a198_0x5b59('0x4')]['fn'](a198_0x5b59('0x45'),exports[a198_0x5b59('0x4')]['col'](a198_0x5b59('0x3c'))),a198_0x5b59('0x3d')]],'where':{'countingDate':{[exports[a198_0x5b59('0x4')]['Op'][a198_0x5b59('0x3e')]]:_0x9880f4,[exports[a198_0x5b59('0x4')]['Op']['lt']]:_0x2bcd77},'amount':_0x57c2ce[a198_0x5b59('0x3f')][a198_0x5b59('0x40')]=='in'?{[exports['sequelize']['Op']['gt']]:0x0}:{[exports[a198_0x5b59('0x4')]['Op']['lt']]:0x0}},'group':[exports[a198_0x5b59('0x4')]['fn'](a198_0x5b59('0x46'),exports[a198_0x5b59('0x4')]['col'](a198_0x5b59('0x33'))),exports[a198_0x5b59('0x4')]['fn']('DAY',exports['sequelize'][a198_0x5b59('0x3b')](a198_0x5b59('0x33'))),exports[a198_0x5b59('0x4')]['fn'](a198_0x5b59('0x47'),exports[a198_0x5b59('0x4')][a198_0x5b59('0x3b')](a198_0x5b59('0x33'))),exports[a198_0x5b59('0x4')]['fn'](a198_0x5b59('0x48'),exports[a198_0x5b59('0x4')][a198_0x5b59('0x3b')]('countingDate'))],'order':[[a198_0x5b59('0x33'),a198_0x5b59('0x34')]]})[a198_0x5b59('0x1c')](_0x411b99=>{_0x4b6d44['json']({'data':_0x411b99});});};exports['getFacebook']=(_0x2eb641,_0x2b4387,_0xffc052)=>{const _0x5e08a2=_0x2eb641[a198_0x5b59('0x49')][a198_0x5b59('0x4a')][a198_0x5b59('0x4b')](_0x5e08a2=>_0x5e08a2[a198_0x5b59('0x4c')]===a198_0x5b59('0x4d'));fbgraph_1['default'][a198_0x5b59('0x4e')](_0x5e08a2['accessToken']);fbgraph_1[a198_0x5b59('0x1d')][a198_0x5b59('0x4f')](_0x2eb641[a198_0x5b59('0x49')][a198_0x5b59('0x4d')]+a198_0x5b59('0x50'),(_0x275d96,_0xa18b5f)=>{if(_0x275d96){return _0xffc052(_0x275d96);}_0x2b4387[a198_0x5b59('0x7')]('api/facebook',{'title':a198_0x5b59('0x51'),'profile':_0xa18b5f});});};
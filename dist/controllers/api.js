var a180_0x4072=['?fields=id,name,email,first_name,last_name,gender,link,locale,timezone','render','api/facebook','Facebook\x20API','__esModule','fbgraph','setSequelize','api/index','API\x20Examples','syncFtp','log','connecting','ready','connected','list','colombia','Downloading:\x20','name','endsWith','json','models','reportFiles','spread','error','ftp.vivotek.com','ipd','downloadFtp','sequelize','findOne','then','default','connected:','fileName','get','colombia/','media/','pipe','createWriteStream','status','save','Downloaded:\x20','connect','processFtp','readFile','utf8','parse','Data','CountingInfo','Out','EndTime','passes','create','getPassCounting','countingDate','ASC','getPassCountingByDay','query','month','startDate','endDate','sum','col','amount','total','params','direction','literal','YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))','getPassCountingByHour','findAll','DATE_FORMAT','countingDateShort','HOUR','DAY','MONTH','YEAR','user','tokens','find','kind','facebook','setAccessToken'];(function(_0x27521b,_0x1982a2){var _0x3cb34e=function(_0x178119){while(--_0x178119){_0x27521b['push'](_0x27521b['shift']());}};_0x3cb34e(++_0x1982a2);}(a180_0x4072,0x14c));var a180_0x244f=function(_0x40f17f,_0x53e585){_0x40f17f=_0x40f17f-0x0;var _0x3b3208=a180_0x4072[_0x40f17f];return _0x3b3208;};'use strict';var __importDefault=this&&this['__importDefault']||function(_0x4d4af0){return _0x4d4af0&&_0x4d4af0[a180_0x244f('0x0')]?_0x4d4af0:{'default':_0x4d4af0};};Object['defineProperty'](exports,a180_0x244f('0x0'),{'value':!![]});const fbgraph_1=__importDefault(require(a180_0x244f('0x1')));const ftp_1=__importDefault(require('ftp'));const fs_1=__importDefault(require('fs'));function setSequelize(_0x4454af){exports['sequelize']=_0x4454af;}exports[a180_0x244f('0x2')]=setSequelize;exports['getApi']=(_0x2cc3bb,_0x228952)=>{_0x228952['render'](a180_0x244f('0x3'),{'title':a180_0x244f('0x4')});};exports[a180_0x244f('0x5')]=(_0x5e474f,_0xd90b0)=>{console[a180_0x244f('0x6')](a180_0x244f('0x7'));const _0x1c7ed8=[];const _0x53a801=new ftp_1['default']();_0x53a801['on'](a180_0x244f('0x8'),function(){console[a180_0x244f('0x6')](a180_0x244f('0x9'));_0x53a801[a180_0x244f('0xa')](a180_0x244f('0xb'),![],function(_0x948f08,_0x4dcad6){if(_0x948f08){}else{for(const _0x28508c of _0x4dcad6){console[a180_0x244f('0x6')](a180_0x244f('0xc')+_0x28508c[a180_0x244f('0xd')]);if(_0x28508c[a180_0x244f('0xd')][a180_0x244f('0xe')](a180_0x244f('0xf'))){exports['sequelize'][a180_0x244f('0x10')][a180_0x244f('0x11')]['findOrCreate']({'where':{'fileName':_0x28508c[a180_0x244f('0xd')]}})[a180_0x244f('0x12')]((_0x5ca5e9,_0x4edc4a)=>{if(_0x4edc4a){console[a180_0x244f('0x6')](_0x28508c[a180_0x244f('0xd')]);_0x1c7ed8['push'](_0x5ca5e9);}});}}}_0xd90b0['json']({'data':_0x1c7ed8});});});_0x53a801['on'](a180_0x244f('0x13'),function(_0x234ad4){_0xd90b0[a180_0x244f('0xf')]({'message':_0x234ad4});});_0x53a801['connect']({'host':a180_0x244f('0x14'),'port':0x15,'user':'ipd','password':a180_0x244f('0x15')});};exports[a180_0x244f('0x16')]=(_0x307e00,_0x13bca6)=>{exports[a180_0x244f('0x17')][a180_0x244f('0x10')][a180_0x244f('0x11')][a180_0x244f('0x18')]({'where':{'status':null}})[a180_0x244f('0x19')](_0x300545=>{if(_0x300545){const _0x589305=new ftp_1[(a180_0x244f('0x1a'))]();_0x589305['on'](a180_0x244f('0x8'),function(){console['log'](a180_0x244f('0x1b')+_0x300545[a180_0x244f('0x1c')]);_0x589305[a180_0x244f('0x1d')](a180_0x244f('0x1e')+_0x300545[a180_0x244f('0x1c')],function(_0x3ae1e6,_0x509098){_0x589305['end']();if(_0x3ae1e6){}else{const _0x48585e=a180_0x244f('0x1f')+_0x300545[a180_0x244f('0x1c')]+'.txt';_0x509098[a180_0x244f('0x20')](fs_1['default'][a180_0x244f('0x21')](_0x48585e));_0x300545[a180_0x244f('0x22')]=0x1;_0x300545[a180_0x244f('0x23')]();console[a180_0x244f('0x6')](a180_0x244f('0x24')+_0x300545[a180_0x244f('0x1c')]);}});});_0x589305['on']('error',function(_0x1dee33){_0x13bca6[a180_0x244f('0xf')]({'message':_0x1dee33});});_0x589305[a180_0x244f('0x25')]({'host':a180_0x244f('0x14'),'port':0x15,'user':a180_0x244f('0x15'),'password':a180_0x244f('0x15')});_0x13bca6['json']({'data':_0x300545[a180_0x244f('0x1c')]});}else{_0x13bca6[a180_0x244f('0xf')]({'data':[]});}});};exports[a180_0x244f('0x26')]=(_0x524835,_0x4718f8)=>{exports[a180_0x244f('0x17')][a180_0x244f('0x10')][a180_0x244f('0x11')][a180_0x244f('0x18')]({'where':{'status':0x1}})[a180_0x244f('0x19')](_0x1a617e=>{if(_0x1a617e){const _0x1df25b=a180_0x244f('0x1f')+_0x1a617e[a180_0x244f('0x1c')]+'.txt';fs_1['default'][a180_0x244f('0x27')](_0x1df25b,a180_0x244f('0x28'),function(_0x3e2b31,_0x3fa475){if(_0x3e2b31){_0x1a617e[a180_0x244f('0x22')]=null;}else{try{const _0x29b19d=JSON[a180_0x244f('0x29')](_0x3fa475);for(const _0x1e1a64 of _0x29b19d[a180_0x244f('0x2a')][0x0][a180_0x244f('0x2b')]){const _0x4d8540=_0x1e1a64['In'];const _0x354760=_0x1e1a64[a180_0x244f('0x2c')];const _0x451531=Date['parse'](_0x1e1a64[a180_0x244f('0x2d')]);if(_0x4d8540>0x0){exports[a180_0x244f('0x17')][a180_0x244f('0x10')][a180_0x244f('0x2e')][a180_0x244f('0x2f')]({'reportFileId':_0x1a617e['id'],'amount':_0x4d8540,'countingDate':_0x451531});}if(_0x354760>0x0){exports[a180_0x244f('0x17')][a180_0x244f('0x10')][a180_0x244f('0x2e')][a180_0x244f('0x2f')]({'reportFileId':_0x1a617e['id'],'amount':_0x354760*-0x1,'countingDate':_0x451531});}}_0x1a617e['status']=0x2;}catch(_0x2a2241){_0x1a617e[a180_0x244f('0x22')]=null;}}_0x1a617e['save']();});_0x4718f8['json']({'data':_0x1a617e[a180_0x244f('0x1c')]});}else{_0x4718f8['json']({'data':[]});}});};exports[a180_0x244f('0x30')]=(_0x71755a,_0x4598dd)=>{exports[a180_0x244f('0x17')][a180_0x244f('0x10')]['passes']['findAll']({'where':{'amount':{[exports[a180_0x244f('0x17')]['Op']['gt']]:0x0}},'order':[[a180_0x244f('0x31'),a180_0x244f('0x32')]]})['then'](_0x1ba9be=>{_0x4598dd[a180_0x244f('0xf')]({'data':_0x1ba9be});});};exports[a180_0x244f('0x33')]=(_0x2d17a,_0x5ce907)=>{const _0x2158bb=_0x2d17a[a180_0x244f('0x34')][a180_0x244f('0x35')];const _0x34b408=_0x2d17a['query'][a180_0x244f('0x36')];const _0xc66afa=_0x2d17a[a180_0x244f('0x34')][a180_0x244f('0x37')];exports[a180_0x244f('0x17')][a180_0x244f('0x10')][a180_0x244f('0x2e')]['findAll']({'attributes':[a180_0x244f('0x31'),[exports[a180_0x244f('0x17')]['fn'](a180_0x244f('0x38'),exports[a180_0x244f('0x17')][a180_0x244f('0x39')](a180_0x244f('0x3a'))),a180_0x244f('0x3b')]],'where':{'countingDate':{[exports[a180_0x244f('0x17')]['Op']['gte']]:_0x34b408,[exports[a180_0x244f('0x17')]['Op']['lt']]:_0xc66afa},'amount':_0x2d17a[a180_0x244f('0x3c')][a180_0x244f('0x3d')]=='in'?{[exports[a180_0x244f('0x17')]['Op']['gt']]:0x0}:{[exports[a180_0x244f('0x17')]['Op']['lt']]:0x0}},'group':[exports[a180_0x244f('0x17')][a180_0x244f('0x3e')](a180_0x244f('0x3f'))],'order':[['countingDate',a180_0x244f('0x32')]]})[a180_0x244f('0x19')](_0x5096f0=>{_0x5ce907[a180_0x244f('0xf')]({'data':_0x5096f0});});};exports[a180_0x244f('0x40')]=(_0x4d5b9d,_0x3594c6)=>{const _0x2fb74e=_0x4d5b9d[a180_0x244f('0x34')][a180_0x244f('0x35')];const _0x1974cd=_0x4d5b9d[a180_0x244f('0x34')][a180_0x244f('0x36')];const _0x30308e=_0x4d5b9d[a180_0x244f('0x34')]['endDate'];exports[a180_0x244f('0x17')]['models'][a180_0x244f('0x2e')][a180_0x244f('0x41')]({'attributes':[a180_0x244f('0x31'),[exports[a180_0x244f('0x17')]['fn'](a180_0x244f('0x42'),exports['sequelize'][a180_0x244f('0x39')](a180_0x244f('0x31')),'%Y-%m-%d\x20%H:00'),a180_0x244f('0x43')],[exports[a180_0x244f('0x17')]['fn'](a180_0x244f('0x38'),exports[a180_0x244f('0x17')]['col']('amount')),a180_0x244f('0x3b')]],'where':{'countingDate':{[exports[a180_0x244f('0x17')]['Op']['gte']]:_0x1974cd,[exports[a180_0x244f('0x17')]['Op']['lt']]:_0x30308e},'amount':_0x4d5b9d[a180_0x244f('0x3c')]['direction']=='in'?{[exports[a180_0x244f('0x17')]['Op']['gt']]:0x0}:{[exports[a180_0x244f('0x17')]['Op']['lt']]:0x0}},'group':[exports[a180_0x244f('0x17')]['fn'](a180_0x244f('0x44'),exports[a180_0x244f('0x17')][a180_0x244f('0x39')](a180_0x244f('0x31'))),exports['sequelize']['fn'](a180_0x244f('0x45'),exports[a180_0x244f('0x17')][a180_0x244f('0x39')](a180_0x244f('0x31'))),exports[a180_0x244f('0x17')]['fn'](a180_0x244f('0x46'),exports[a180_0x244f('0x17')][a180_0x244f('0x39')]('countingDate')),exports[a180_0x244f('0x17')]['fn'](a180_0x244f('0x47'),exports[a180_0x244f('0x17')][a180_0x244f('0x39')](a180_0x244f('0x31')))],'order':[[a180_0x244f('0x31'),a180_0x244f('0x32')]]})['then'](_0x4dad73=>{_0x3594c6[a180_0x244f('0xf')]({'data':_0x4dad73});});};exports['getFacebook']=(_0x30eb12,_0x3b00a0,_0x252c9d)=>{const _0x47a1f1=_0x30eb12[a180_0x244f('0x48')][a180_0x244f('0x49')][a180_0x244f('0x4a')](_0x47a1f1=>_0x47a1f1[a180_0x244f('0x4b')]===a180_0x244f('0x4c'));fbgraph_1[a180_0x244f('0x1a')][a180_0x244f('0x4d')](_0x47a1f1['accessToken']);fbgraph_1[a180_0x244f('0x1a')]['get'](_0x30eb12['user']['facebook']+a180_0x244f('0x4e'),(_0x105b60,_0x445a6c)=>{if(_0x105b60){return _0x252c9d(_0x105b60);}_0x3b00a0[a180_0x244f('0x4f')](a180_0x244f('0x50'),{'title':a180_0x244f('0x51'),'profile':_0x445a6c});});};
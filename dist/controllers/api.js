var a198_0x537c=['sequelize','setSequelize','getApi','API\x20Examples','syncFtp','log','connecting','default','connected','list','colombia','Downloading:\x20','name','endsWith','json','models','reportFiles','spread','push','connect','ftp.vivotek.com','ipd','downloadFtp','ready','fileName','get','colombia/','media/','.txt','pipe','status','Downloaded:\x20','error','processFtp','then','utf8','parse','CountingInfo','Out','passes','create','save','getPassCounting','findAll','countingDate','ASC','getPassCountingByDay','query','month','startDate','endDate','sum','col','total','gte','params','direction','literal','YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))','getPassCountingByHour','DATE_FORMAT','DAY','YEAR','getFacebook','user','tokens','kind','facebook','setAccessToken','accessToken','render','api/facebook','Facebook\x20API','__importDefault','__esModule','defineProperty','fbgraph','ftp'];(function(_0x1986fc,_0x881f93){var _0x4bec8c=function(_0x16bb3f){while(--_0x16bb3f){_0x1986fc['push'](_0x1986fc['shift']());}};_0x4bec8c(++_0x881f93);}(a198_0x537c,0x133));var a198_0x30d0=function(_0x217dc6,_0x1f165b){_0x217dc6=_0x217dc6-0x0;var _0xf406d=a198_0x537c[_0x217dc6];return _0xf406d;};'use strict';var __importDefault=this&&this[a198_0x30d0('0x0')]||function(_0x7e3fc6){return _0x7e3fc6&&_0x7e3fc6[a198_0x30d0('0x1')]?_0x7e3fc6:{'default':_0x7e3fc6};};Object[a198_0x30d0('0x2')](exports,a198_0x30d0('0x1'),{'value':!![]});const fbgraph_1=__importDefault(require(a198_0x30d0('0x3')));const ftp_1=__importDefault(require(a198_0x30d0('0x4')));const fs_1=__importDefault(require('fs'));function setSequelize(_0x1a3539){exports[a198_0x30d0('0x5')]=_0x1a3539;}exports[a198_0x30d0('0x6')]=setSequelize;exports[a198_0x30d0('0x7')]=(_0x391092,_0x198f24)=>{_0x198f24['render']('api/index',{'title':a198_0x30d0('0x8')});};exports[a198_0x30d0('0x9')]=(_0x1d7ae9,_0x3b4887)=>{console[a198_0x30d0('0xa')](a198_0x30d0('0xb'));const _0x441355=[];const _0x636410=new ftp_1[(a198_0x30d0('0xc'))]();_0x636410['on']('ready',function(){console[a198_0x30d0('0xa')](a198_0x30d0('0xd'));_0x636410[a198_0x30d0('0xe')](a198_0x30d0('0xf'),![],function(_0x5121dd,_0x31266d){if(_0x5121dd){}else{for(const _0x20bfc0 of _0x31266d){console[a198_0x30d0('0xa')](a198_0x30d0('0x10')+_0x20bfc0['name']);if(_0x20bfc0[a198_0x30d0('0x11')][a198_0x30d0('0x12')](a198_0x30d0('0x13'))){exports[a198_0x30d0('0x5')][a198_0x30d0('0x14')][a198_0x30d0('0x15')]['findOrCreate']({'where':{'fileName':_0x20bfc0[a198_0x30d0('0x11')]}})[a198_0x30d0('0x16')]((_0x8155ba,_0x50c68b)=>{if(_0x50c68b){console['log'](_0x20bfc0['name']);_0x441355[a198_0x30d0('0x17')](_0x8155ba);}});}}}_0x3b4887[a198_0x30d0('0x13')]({'data':_0x441355});});});_0x636410['on']('error',function(_0x2c0d2e){_0x3b4887['json']({'message':_0x2c0d2e});});_0x636410[a198_0x30d0('0x18')]({'host':a198_0x30d0('0x19'),'port':0x15,'user':'ipd','password':a198_0x30d0('0x1a')});};exports[a198_0x30d0('0x1b')]=(_0x312e51,_0x3c8351)=>{exports[a198_0x30d0('0x5')][a198_0x30d0('0x14')][a198_0x30d0('0x15')]['findOne']({'where':{'status':null}})['then'](_0x363a2b=>{if(_0x363a2b){const _0x475dad=new ftp_1[(a198_0x30d0('0xc'))]();_0x475dad['on'](a198_0x30d0('0x1c'),function(){console['log']('connected:'+_0x363a2b[a198_0x30d0('0x1d')]);_0x475dad[a198_0x30d0('0x1e')](a198_0x30d0('0x1f')+_0x363a2b[a198_0x30d0('0x1d')],function(_0x290d2c,_0x4ad84b){_0x475dad['end']();if(_0x290d2c){}else{const _0x3cf8ce=a198_0x30d0('0x20')+_0x363a2b['fileName']+a198_0x30d0('0x21');_0x4ad84b[a198_0x30d0('0x22')](fs_1[a198_0x30d0('0xc')]['createWriteStream'](_0x3cf8ce));_0x363a2b[a198_0x30d0('0x23')]=0x1;_0x363a2b['save']();console[a198_0x30d0('0xa')](a198_0x30d0('0x24')+_0x363a2b[a198_0x30d0('0x1d')]);}});});_0x475dad['on'](a198_0x30d0('0x25'),function(_0x117e92){_0x3c8351[a198_0x30d0('0x13')]({'message':_0x117e92});});_0x475dad[a198_0x30d0('0x18')]({'host':a198_0x30d0('0x19'),'port':0x15,'user':a198_0x30d0('0x1a'),'password':a198_0x30d0('0x1a')});_0x3c8351[a198_0x30d0('0x13')]({'data':_0x363a2b['fileName']});}else{_0x3c8351[a198_0x30d0('0x13')]({'data':[]});}});};exports[a198_0x30d0('0x26')]=(_0x52e9bb,_0x1407c2)=>{exports[a198_0x30d0('0x5')][a198_0x30d0('0x14')][a198_0x30d0('0x15')]['findOne']({'where':{'status':0x1}})[a198_0x30d0('0x27')](_0x11391c=>{if(_0x11391c){const _0x2b0c16=a198_0x30d0('0x20')+_0x11391c['fileName']+a198_0x30d0('0x21');fs_1['default']['readFile'](_0x2b0c16,a198_0x30d0('0x28'),function(_0x3e01f0,_0x10064a){if(_0x3e01f0){_0x11391c[a198_0x30d0('0x23')]=null;}else{try{const _0x589698=JSON[a198_0x30d0('0x29')](_0x10064a);for(const _0x188069 of _0x589698['Data'][0x0][a198_0x30d0('0x2a')]){const _0x2142ff=_0x188069['In'];const _0x31a042=_0x188069[a198_0x30d0('0x2b')];const _0x3d313f=Date[a198_0x30d0('0x29')](_0x188069['EndTime']);if(_0x2142ff>0x0){exports[a198_0x30d0('0x5')][a198_0x30d0('0x14')][a198_0x30d0('0x2c')][a198_0x30d0('0x2d')]({'reportFileId':_0x11391c['id'],'amount':_0x2142ff,'countingDate':_0x3d313f});}if(_0x31a042>0x0){exports[a198_0x30d0('0x5')][a198_0x30d0('0x14')][a198_0x30d0('0x2c')][a198_0x30d0('0x2d')]({'reportFileId':_0x11391c['id'],'amount':_0x31a042*-0x1,'countingDate':_0x3d313f});}}_0x11391c[a198_0x30d0('0x23')]=0x2;}catch(_0x1f6a78){_0x11391c['status']=null;}}_0x11391c[a198_0x30d0('0x2e')]();});_0x1407c2[a198_0x30d0('0x13')]({'data':_0x11391c[a198_0x30d0('0x1d')]});}else{_0x1407c2[a198_0x30d0('0x13')]({'data':[]});}});};exports[a198_0x30d0('0x2f')]=(_0x3bc51d,_0xa4e025)=>{exports[a198_0x30d0('0x5')][a198_0x30d0('0x14')][a198_0x30d0('0x2c')][a198_0x30d0('0x30')]({'where':{'amount':{[exports[a198_0x30d0('0x5')]['Op']['gt']]:0x0}},'order':[[a198_0x30d0('0x31'),a198_0x30d0('0x32')]]})[a198_0x30d0('0x27')](_0x68b81f=>{_0xa4e025[a198_0x30d0('0x13')]({'data':_0x68b81f});});};exports[a198_0x30d0('0x33')]=(_0x5f0aa1,_0x4316f7)=>{const _0x10c110=_0x5f0aa1[a198_0x30d0('0x34')][a198_0x30d0('0x35')];const _0x581485=_0x5f0aa1[a198_0x30d0('0x34')][a198_0x30d0('0x36')];const _0x12056e=_0x5f0aa1[a198_0x30d0('0x34')][a198_0x30d0('0x37')];exports[a198_0x30d0('0x5')]['models'][a198_0x30d0('0x2c')][a198_0x30d0('0x30')]({'attributes':[a198_0x30d0('0x31'),[exports[a198_0x30d0('0x5')]['fn'](a198_0x30d0('0x38'),exports[a198_0x30d0('0x5')][a198_0x30d0('0x39')]('amount')),a198_0x30d0('0x3a')]],'where':{'countingDate':{[exports[a198_0x30d0('0x5')]['Op'][a198_0x30d0('0x3b')]]:_0x581485,[exports['sequelize']['Op']['lt']]:_0x12056e},'amount':_0x5f0aa1[a198_0x30d0('0x3c')][a198_0x30d0('0x3d')]=='in'?{[exports['sequelize']['Op']['gt']]:0x0}:{[exports[a198_0x30d0('0x5')]['Op']['lt']]:0x0}},'group':[exports['sequelize'][a198_0x30d0('0x3e')](a198_0x30d0('0x3f'))],'order':[[a198_0x30d0('0x31'),'ASC']]})['then'](_0x4ef2f0=>{_0x4316f7[a198_0x30d0('0x13')]({'data':_0x4ef2f0});});};exports[a198_0x30d0('0x40')]=(_0x1c6377,_0x36b8ad)=>{const _0x3b5eec=_0x1c6377[a198_0x30d0('0x34')]['month'];const _0x57e54c=_0x1c6377[a198_0x30d0('0x34')][a198_0x30d0('0x36')];const _0x2d1e09=_0x1c6377['query'][a198_0x30d0('0x37')];exports[a198_0x30d0('0x5')][a198_0x30d0('0x14')]['passes'][a198_0x30d0('0x30')]({'attributes':[a198_0x30d0('0x31'),[exports[a198_0x30d0('0x5')]['fn'](a198_0x30d0('0x41'),exports[a198_0x30d0('0x5')]['col'](a198_0x30d0('0x31')),'%Y-%m-%d\x20%H:00'),'countingDateShort'],[exports[a198_0x30d0('0x5')]['fn'](a198_0x30d0('0x38'),exports[a198_0x30d0('0x5')]['col']('amount')),a198_0x30d0('0x3a')]],'where':{'countingDate':{[exports[a198_0x30d0('0x5')]['Op'][a198_0x30d0('0x3b')]]:_0x57e54c,[exports[a198_0x30d0('0x5')]['Op']['lt']]:_0x2d1e09},'amount':_0x1c6377[a198_0x30d0('0x3c')][a198_0x30d0('0x3d')]=='in'?{[exports[a198_0x30d0('0x5')]['Op']['gt']]:0x0}:{[exports[a198_0x30d0('0x5')]['Op']['lt']]:0x0}},'group':[exports[a198_0x30d0('0x5')]['fn']('HOUR',exports[a198_0x30d0('0x5')]['col']('countingDate')),exports[a198_0x30d0('0x5')]['fn'](a198_0x30d0('0x42'),exports[a198_0x30d0('0x5')][a198_0x30d0('0x39')](a198_0x30d0('0x31'))),exports[a198_0x30d0('0x5')]['fn']('MONTH',exports['sequelize'][a198_0x30d0('0x39')](a198_0x30d0('0x31'))),exports[a198_0x30d0('0x5')]['fn'](a198_0x30d0('0x43'),exports[a198_0x30d0('0x5')][a198_0x30d0('0x39')](a198_0x30d0('0x31')))],'order':[[a198_0x30d0('0x31'),a198_0x30d0('0x32')]]})[a198_0x30d0('0x27')](_0x177813=>{_0x36b8ad['json']({'data':_0x177813});});};exports[a198_0x30d0('0x44')]=(_0x36c117,_0x184b21,_0x421b95)=>{const _0x38983a=_0x36c117[a198_0x30d0('0x45')][a198_0x30d0('0x46')]['find'](_0x38983a=>_0x38983a[a198_0x30d0('0x47')]===a198_0x30d0('0x48'));fbgraph_1['default'][a198_0x30d0('0x49')](_0x38983a[a198_0x30d0('0x4a')]);fbgraph_1['default']['get'](_0x36c117['user'][a198_0x30d0('0x48')]+'?fields=id,name,email,first_name,last_name,gender,link,locale,timezone',(_0x5b584a,_0x1b1296)=>{if(_0x5b584a){return _0x421b95(_0x5b584a);}_0x184b21[a198_0x30d0('0x4b')](a198_0x30d0('0x4c'),{'title':a198_0x30d0('0x4d'),'profile':_0x1b1296});});};
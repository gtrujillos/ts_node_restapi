var a88_0x79f2=['?fields=id,name,email,first_name,last_name,gender,link,locale,timezone','api/facebook','__importDefault','defineProperty','__esModule','fbgraph','ftp','sequelize','setSequelize','getApi','render','api/index','API\x20Examples','syncFtp','log','connecting','ready','list','colombia','Downloading:\x20','name','endsWith','json','models','reportFiles','findOrCreate','spread','push','error','ftp.vivotek.com','ipd','then','default','connected:','fileName','get','colombia/','end','.txt','pipe','status','Downloaded:\x20','connect','processFtp','media/','readFile','utf8','CountingInfo','Out','parse','EndTime','passes','create','save','findAll','countingDate','ASC','getPassCountingByDay','query','startDate','endDate','col','gte','params','literal','YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))','getPassCountingByHour','DATE_FORMAT','%Y-%m-%d\x20%H:00','countingDateShort','sum','total','HOUR','DAY','MONTH','YEAR','getFacebook','user','tokens','find','kind','facebook','setAccessToken','accessToken'];(function(_0x3b19dc,_0x13d8bb){var _0x3e50d3=function(_0x7203dd){while(--_0x7203dd){_0x3b19dc['push'](_0x3b19dc['shift']());}};_0x3e50d3(++_0x13d8bb);}(a88_0x79f2,0x152));var a88_0x4722=function(_0x463495,_0x8070b8){_0x463495=_0x463495-0x0;var _0x340f41=a88_0x79f2[_0x463495];return _0x340f41;};'use strict';var __importDefault=this&&this[a88_0x4722('0x0')]||function(_0x92c75f){return _0x92c75f&&_0x92c75f['__esModule']?_0x92c75f:{'default':_0x92c75f};};Object[a88_0x4722('0x1')](exports,a88_0x4722('0x2'),{'value':!![]});const fbgraph_1=__importDefault(require(a88_0x4722('0x3')));const ftp_1=__importDefault(require(a88_0x4722('0x4')));const fs_1=__importDefault(require('fs'));function setSequelize(_0x19faa6){exports[a88_0x4722('0x5')]=_0x19faa6;}exports[a88_0x4722('0x6')]=setSequelize;exports[a88_0x4722('0x7')]=(_0xf82f49,_0x20c525)=>{_0x20c525[a88_0x4722('0x8')](a88_0x4722('0x9'),{'title':a88_0x4722('0xa')});};exports[a88_0x4722('0xb')]=(_0x1dd1ac,_0x33d84c)=>{console[a88_0x4722('0xc')](a88_0x4722('0xd'));const _0x546a78=[];const _0x5a40de=new ftp_1['default']();_0x5a40de['on'](a88_0x4722('0xe'),function(){console['log']('connected');_0x5a40de[a88_0x4722('0xf')](a88_0x4722('0x10'),![],function(_0x499c82,_0x205ac9){if(_0x499c82){}else{for(const _0x1e68f2 of _0x205ac9){console['log'](a88_0x4722('0x11')+_0x1e68f2[a88_0x4722('0x12')]);if(_0x1e68f2[a88_0x4722('0x12')][a88_0x4722('0x13')](a88_0x4722('0x14'))){exports[a88_0x4722('0x5')][a88_0x4722('0x15')][a88_0x4722('0x16')][a88_0x4722('0x17')]({'where':{'fileName':_0x1e68f2[a88_0x4722('0x12')]}})[a88_0x4722('0x18')]((_0x534334,_0x398f90)=>{if(_0x398f90){console['log'](_0x1e68f2['name']);_0x546a78[a88_0x4722('0x19')](_0x534334);}});}}}_0x33d84c[a88_0x4722('0x14')]({'data':_0x546a78});});});_0x5a40de['on'](a88_0x4722('0x1a'),function(_0x5cd1e){_0x33d84c[a88_0x4722('0x14')]({'message':_0x5cd1e});});_0x5a40de['connect']({'host':a88_0x4722('0x1b'),'port':0x15,'user':a88_0x4722('0x1c'),'password':a88_0x4722('0x1c')});};exports['downloadFtp']=(_0x1bd499,_0x21dace)=>{exports['sequelize'][a88_0x4722('0x15')][a88_0x4722('0x16')]['findOne']({'where':{'status':null}})[a88_0x4722('0x1d')](_0x536500=>{if(_0x536500){const _0x4c6819=new ftp_1[(a88_0x4722('0x1e'))]();_0x4c6819['on'](a88_0x4722('0xe'),function(){console[a88_0x4722('0xc')](a88_0x4722('0x1f')+_0x536500[a88_0x4722('0x20')]);_0x4c6819[a88_0x4722('0x21')](a88_0x4722('0x22')+_0x536500[a88_0x4722('0x20')],function(_0x553581,_0x5f02ef){_0x4c6819[a88_0x4722('0x23')]();if(_0x553581){}else{const _0x173b98='media/'+_0x536500[a88_0x4722('0x20')]+a88_0x4722('0x24');_0x5f02ef[a88_0x4722('0x25')](fs_1[a88_0x4722('0x1e')]['createWriteStream'](_0x173b98));_0x536500[a88_0x4722('0x26')]=0x1;_0x536500['save']();console[a88_0x4722('0xc')](a88_0x4722('0x27')+_0x536500[a88_0x4722('0x20')]);}});});_0x4c6819['on'](a88_0x4722('0x1a'),function(_0xa654fe){_0x21dace[a88_0x4722('0x14')]({'message':_0xa654fe});});_0x4c6819[a88_0x4722('0x28')]({'host':'ftp.vivotek.com','port':0x15,'user':'ipd','password':a88_0x4722('0x1c')});_0x21dace[a88_0x4722('0x14')]({'data':_0x536500[a88_0x4722('0x20')]});}else{_0x21dace[a88_0x4722('0x14')]({'data':[]});}});};exports[a88_0x4722('0x29')]=(_0x465f1f,_0xf0b650)=>{exports[a88_0x4722('0x5')]['models'][a88_0x4722('0x16')]['findOne']({'where':{'status':0x1}})[a88_0x4722('0x1d')](_0x196108=>{if(_0x196108){const _0x2f75a4=a88_0x4722('0x2a')+_0x196108['fileName']+a88_0x4722('0x24');fs_1['default'][a88_0x4722('0x2b')](_0x2f75a4,a88_0x4722('0x2c'),function(_0x5da462,_0x60f6c6){if(_0x5da462){_0x196108[a88_0x4722('0x26')]=null;}else{try{const _0x24c21c=JSON['parse'](_0x60f6c6);for(const _0x47b7ff of _0x24c21c['Data'][0x0][a88_0x4722('0x2d')]){const _0x2d760b=_0x47b7ff['In'];const _0x57f62f=_0x47b7ff[a88_0x4722('0x2e')];const _0xa0604=Date[a88_0x4722('0x2f')](_0x47b7ff[a88_0x4722('0x30')]);if(_0x2d760b>0x0){exports[a88_0x4722('0x5')][a88_0x4722('0x15')][a88_0x4722('0x31')][a88_0x4722('0x32')]({'reportFileId':_0x196108['id'],'amount':_0x2d760b,'countingDate':_0xa0604});}if(_0x57f62f>0x0){exports['sequelize'][a88_0x4722('0x15')][a88_0x4722('0x31')][a88_0x4722('0x32')]({'reportFileId':_0x196108['id'],'amount':_0x57f62f*-0x1,'countingDate':_0xa0604});}}_0x196108['status']=0x2;}catch(_0x2f311f){_0x196108[a88_0x4722('0x26')]=null;}}_0x196108[a88_0x4722('0x33')]();});_0xf0b650['json']({'data':_0x196108[a88_0x4722('0x20')]});}else{_0xf0b650[a88_0x4722('0x14')]({'data':[]});}});};exports['getPassCounting']=(_0x467bb5,_0x438173)=>{exports[a88_0x4722('0x5')][a88_0x4722('0x15')][a88_0x4722('0x31')][a88_0x4722('0x34')]({'where':{'amount':{[exports[a88_0x4722('0x5')]['Op']['gt']]:0x0}},'order':[[a88_0x4722('0x35'),a88_0x4722('0x36')]]})['then'](_0x3d80a8=>{_0x438173[a88_0x4722('0x14')]({'data':_0x3d80a8});});};exports[a88_0x4722('0x37')]=(_0x581045,_0x28daf8)=>{const _0x46b048=_0x581045[a88_0x4722('0x38')]['month'];const _0x166909=_0x581045['query'][a88_0x4722('0x39')];const _0x9dbad6=_0x581045['query'][a88_0x4722('0x3a')];exports['sequelize'][a88_0x4722('0x15')][a88_0x4722('0x31')][a88_0x4722('0x34')]({'attributes':[a88_0x4722('0x35'),[exports[a88_0x4722('0x5')]['fn']('sum',exports[a88_0x4722('0x5')][a88_0x4722('0x3b')]('amount')),'total']],'where':{'countingDate':{[exports[a88_0x4722('0x5')]['Op'][a88_0x4722('0x3c')]]:_0x166909,[exports[a88_0x4722('0x5')]['Op']['lt']]:_0x9dbad6},'amount':_0x581045[a88_0x4722('0x3d')]['direction']=='in'?{[exports[a88_0x4722('0x5')]['Op']['gt']]:0x0}:{[exports[a88_0x4722('0x5')]['Op']['lt']]:0x0}},'group':[exports['sequelize'][a88_0x4722('0x3e')](a88_0x4722('0x3f'))],'order':[[a88_0x4722('0x35'),'ASC']]})[a88_0x4722('0x1d')](_0x59eb62=>{_0x28daf8[a88_0x4722('0x14')]({'data':_0x59eb62});});};exports[a88_0x4722('0x40')]=(_0x5b19e7,_0x276026)=>{const _0x1baf8f=_0x5b19e7['query']['month'];const _0x10d5c1=_0x5b19e7[a88_0x4722('0x38')][a88_0x4722('0x39')];const _0xae2b7a=_0x5b19e7[a88_0x4722('0x38')][a88_0x4722('0x3a')];exports[a88_0x4722('0x5')][a88_0x4722('0x15')][a88_0x4722('0x31')][a88_0x4722('0x34')]({'attributes':[a88_0x4722('0x35'),[exports['sequelize']['fn'](a88_0x4722('0x41'),exports[a88_0x4722('0x5')][a88_0x4722('0x3b')]('countingDate'),a88_0x4722('0x42')),a88_0x4722('0x43')],[exports[a88_0x4722('0x5')]['fn'](a88_0x4722('0x44'),exports[a88_0x4722('0x5')][a88_0x4722('0x3b')]('amount')),a88_0x4722('0x45')]],'where':{'countingDate':{[exports[a88_0x4722('0x5')]['Op'][a88_0x4722('0x3c')]]:_0x10d5c1,[exports[a88_0x4722('0x5')]['Op']['lt']]:_0xae2b7a},'amount':_0x5b19e7[a88_0x4722('0x3d')]['direction']=='in'?{[exports['sequelize']['Op']['gt']]:0x0}:{[exports[a88_0x4722('0x5')]['Op']['lt']]:0x0}},'group':[exports['sequelize']['fn'](a88_0x4722('0x46'),exports['sequelize'][a88_0x4722('0x3b')](a88_0x4722('0x35'))),exports[a88_0x4722('0x5')]['fn'](a88_0x4722('0x47'),exports['sequelize'][a88_0x4722('0x3b')](a88_0x4722('0x35'))),exports[a88_0x4722('0x5')]['fn'](a88_0x4722('0x48'),exports['sequelize'][a88_0x4722('0x3b')](a88_0x4722('0x35'))),exports[a88_0x4722('0x5')]['fn'](a88_0x4722('0x49'),exports[a88_0x4722('0x5')][a88_0x4722('0x3b')](a88_0x4722('0x35')))],'order':[[a88_0x4722('0x35'),a88_0x4722('0x36')]]})[a88_0x4722('0x1d')](_0x5668a2=>{_0x276026[a88_0x4722('0x14')]({'data':_0x5668a2});});};exports[a88_0x4722('0x4a')]=(_0x4da143,_0x21ac99,_0x190826)=>{const _0x1e7654=_0x4da143[a88_0x4722('0x4b')][a88_0x4722('0x4c')][a88_0x4722('0x4d')](_0x1e7654=>_0x1e7654[a88_0x4722('0x4e')]===a88_0x4722('0x4f'));fbgraph_1[a88_0x4722('0x1e')][a88_0x4722('0x50')](_0x1e7654[a88_0x4722('0x51')]);fbgraph_1[a88_0x4722('0x1e')][a88_0x4722('0x21')](_0x4da143[a88_0x4722('0x4b')]['facebook']+a88_0x4722('0x52'),(_0x83af23,_0x404b66)=>{if(_0x83af23){return _0x190826(_0x83af23);}_0x21ac99[a88_0x4722('0x8')](a88_0x4722('0x53'),{'title':'Facebook\x20API','profile':_0x404b66});});};
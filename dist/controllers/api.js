var a180_0x2c14=['default','ready','connected','list','colombia','Downloading:\x20','name','endsWith','json','reportFiles','findOrCreate','push','error','ftp.vivotek.com','ipd','downloadFtp','models','connected:','fileName','get','end','media/','.txt','pipe','createWriteStream','status','connect','processFtp','findOne','then','readFile','utf8','Data','CountingInfo','parse','EndTime','create','passes','ASC','getPassCountingByDay','month','query','startDate','endDate','findAll','countingDate','sum','col','amount','total','gte','params','direction','literal','YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))','getPassCountingByHour','DATE_FORMAT','countingDateShort','HOUR','DAY','getFacebook','user','tokens','kind','facebook','setAccessToken','accessToken','api/facebook','Facebook\x20API','__importDefault','__esModule','defineProperty','fbgraph','ftp','sequelize','render','syncFtp','log','connecting'];(function(_0x170e94,_0x1c7f32){var _0x2a9970=function(_0x17093f){while(--_0x17093f){_0x170e94['push'](_0x170e94['shift']());}};_0x2a9970(++_0x1c7f32);}(a180_0x2c14,0x132));var a180_0x5463=function(_0x4d14af,_0x5eddd9){_0x4d14af=_0x4d14af-0x0;var _0x10b6a7=a180_0x2c14[_0x4d14af];return _0x10b6a7;};'use strict';var __importDefault=this&&this[a180_0x5463('0x0')]||function(_0x75ede6){return _0x75ede6&&_0x75ede6[a180_0x5463('0x1')]?_0x75ede6:{'default':_0x75ede6};};Object[a180_0x5463('0x2')](exports,a180_0x5463('0x1'),{'value':!![]});const fbgraph_1=__importDefault(require(a180_0x5463('0x3')));const ftp_1=__importDefault(require(a180_0x5463('0x4')));const fs_1=__importDefault(require('fs'));function setSequelize(_0x2e5195){exports[a180_0x5463('0x5')]=_0x2e5195;}exports['setSequelize']=setSequelize;exports['getApi']=(_0x3778ae,_0x1b61c7)=>{_0x1b61c7[a180_0x5463('0x6')]('api/index',{'title':'API\x20Examples'});};exports[a180_0x5463('0x7')]=(_0x32eab0,_0x58ef06)=>{console[a180_0x5463('0x8')](a180_0x5463('0x9'));const _0x49b64e=[];const _0x3f608d=new ftp_1[(a180_0x5463('0xa'))]();_0x3f608d['on'](a180_0x5463('0xb'),function(){console[a180_0x5463('0x8')](a180_0x5463('0xc'));_0x3f608d[a180_0x5463('0xd')](a180_0x5463('0xe'),![],function(_0x2d8f3f,_0x21cdf0){if(_0x2d8f3f){}else{for(const _0x4e4177 of _0x21cdf0){console[a180_0x5463('0x8')](a180_0x5463('0xf')+_0x4e4177[a180_0x5463('0x10')]);if(_0x4e4177['name'][a180_0x5463('0x11')](a180_0x5463('0x12'))){exports[a180_0x5463('0x5')]['models'][a180_0x5463('0x13')][a180_0x5463('0x14')]({'where':{'fileName':_0x4e4177[a180_0x5463('0x10')]}})['spread']((_0x5dde44,_0x5af483)=>{if(_0x5af483){console[a180_0x5463('0x8')](_0x4e4177[a180_0x5463('0x10')]);_0x49b64e[a180_0x5463('0x15')](_0x5dde44);}});}}}_0x58ef06['json']({'data':_0x49b64e});});});_0x3f608d['on'](a180_0x5463('0x16'),function(_0x4244e6){_0x58ef06['json']({'message':_0x4244e6});});_0x3f608d['connect']({'host':a180_0x5463('0x17'),'port':0x15,'user':a180_0x5463('0x18'),'password':a180_0x5463('0x18')});};exports[a180_0x5463('0x19')]=(_0x1bac80,_0x4b4aac)=>{exports['sequelize'][a180_0x5463('0x1a')][a180_0x5463('0x13')]['findOne']({'where':{'status':null}})['then'](_0x81c2dd=>{if(_0x81c2dd){const _0x4a9c42=new ftp_1[(a180_0x5463('0xa'))]();_0x4a9c42['on'](a180_0x5463('0xb'),function(){console[a180_0x5463('0x8')](a180_0x5463('0x1b')+_0x81c2dd[a180_0x5463('0x1c')]);_0x4a9c42[a180_0x5463('0x1d')]('colombia/'+_0x81c2dd[a180_0x5463('0x1c')],function(_0x1f5a63,_0x595855){_0x4a9c42[a180_0x5463('0x1e')]();if(_0x1f5a63){}else{const _0x127e5b=a180_0x5463('0x1f')+_0x81c2dd[a180_0x5463('0x1c')]+a180_0x5463('0x20');_0x595855[a180_0x5463('0x21')](fs_1[a180_0x5463('0xa')][a180_0x5463('0x22')](_0x127e5b));_0x81c2dd[a180_0x5463('0x23')]=0x1;_0x81c2dd['save']();console[a180_0x5463('0x8')]('Downloaded:\x20'+_0x81c2dd[a180_0x5463('0x1c')]);}});});_0x4a9c42['on']('error',function(_0x162cdb){_0x4b4aac[a180_0x5463('0x12')]({'message':_0x162cdb});});_0x4a9c42[a180_0x5463('0x24')]({'host':a180_0x5463('0x17'),'port':0x15,'user':a180_0x5463('0x18'),'password':a180_0x5463('0x18')});_0x4b4aac[a180_0x5463('0x12')]({'data':_0x81c2dd['fileName']});}else{_0x4b4aac['json']({'data':[]});}});};exports[a180_0x5463('0x25')]=(_0x3d940c,_0x35f1fc)=>{exports[a180_0x5463('0x5')][a180_0x5463('0x1a')][a180_0x5463('0x13')][a180_0x5463('0x26')]({'where':{'status':0x1}})[a180_0x5463('0x27')](_0x3c5e77=>{if(_0x3c5e77){const _0x42bc7d='media/'+_0x3c5e77[a180_0x5463('0x1c')]+'.txt';fs_1['default'][a180_0x5463('0x28')](_0x42bc7d,a180_0x5463('0x29'),function(_0x3b5bdd,_0x48cd5c){if(_0x3b5bdd){_0x3c5e77[a180_0x5463('0x23')]=null;}else{try{const _0x179072=JSON['parse'](_0x48cd5c);for(const _0x5b4def of _0x179072[a180_0x5463('0x2a')][0x0][a180_0x5463('0x2b')]){const _0x570198=_0x5b4def['In'];const _0x2c9769=_0x5b4def['Out'];const _0x2c9a65=Date[a180_0x5463('0x2c')](_0x5b4def[a180_0x5463('0x2d')]);if(_0x570198>0x0){exports[a180_0x5463('0x5')]['models']['passes'][a180_0x5463('0x2e')]({'reportFileId':_0x3c5e77['id'],'amount':_0x570198,'countingDate':_0x2c9a65});}if(_0x2c9769>0x0){exports[a180_0x5463('0x5')][a180_0x5463('0x1a')]['passes'][a180_0x5463('0x2e')]({'reportFileId':_0x3c5e77['id'],'amount':_0x2c9769*-0x1,'countingDate':_0x2c9a65});}}_0x3c5e77[a180_0x5463('0x23')]=0x2;}catch(_0x44ba1a){_0x3c5e77[a180_0x5463('0x23')]=null;}}_0x3c5e77['save']();});_0x35f1fc['json']({'data':_0x3c5e77[a180_0x5463('0x1c')]});}else{_0x35f1fc[a180_0x5463('0x12')]({'data':[]});}});};exports['getPassCounting']=(_0x112ac9,_0x53bb92)=>{exports[a180_0x5463('0x5')]['models'][a180_0x5463('0x2f')]['findAll']({'where':{'amount':{[exports['sequelize']['Op']['gt']]:0x0}},'order':[['countingDate',a180_0x5463('0x30')]]})[a180_0x5463('0x27')](_0x5e45f8=>{_0x53bb92[a180_0x5463('0x12')]({'data':_0x5e45f8});});};exports[a180_0x5463('0x31')]=(_0x508477,_0xf01d12)=>{const _0x566bcb=_0x508477['query'][a180_0x5463('0x32')];const _0xaa8ccb=_0x508477[a180_0x5463('0x33')][a180_0x5463('0x34')];const _0x414a8e=_0x508477[a180_0x5463('0x33')][a180_0x5463('0x35')];exports[a180_0x5463('0x5')][a180_0x5463('0x1a')][a180_0x5463('0x2f')][a180_0x5463('0x36')]({'attributes':[a180_0x5463('0x37'),[exports[a180_0x5463('0x5')]['fn'](a180_0x5463('0x38'),exports[a180_0x5463('0x5')][a180_0x5463('0x39')](a180_0x5463('0x3a'))),a180_0x5463('0x3b')]],'where':{'countingDate':{[exports[a180_0x5463('0x5')]['Op'][a180_0x5463('0x3c')]]:_0xaa8ccb,[exports[a180_0x5463('0x5')]['Op']['lt']]:_0x414a8e},'amount':_0x508477[a180_0x5463('0x3d')][a180_0x5463('0x3e')]=='in'?{[exports[a180_0x5463('0x5')]['Op']['gt']]:0x0}:{[exports[a180_0x5463('0x5')]['Op']['lt']]:0x0}},'group':[exports[a180_0x5463('0x5')][a180_0x5463('0x3f')](a180_0x5463('0x40'))],'order':[[a180_0x5463('0x37'),a180_0x5463('0x30')]]})[a180_0x5463('0x27')](_0x4aeb7e=>{_0xf01d12[a180_0x5463('0x12')]({'data':_0x4aeb7e});});};exports[a180_0x5463('0x41')]=(_0x5cb13a,_0x41fd9e)=>{const _0x96e3f5=_0x5cb13a[a180_0x5463('0x33')][a180_0x5463('0x32')];const _0x313b55=_0x5cb13a['query'][a180_0x5463('0x34')];const _0x3f9d32=_0x5cb13a[a180_0x5463('0x33')][a180_0x5463('0x35')];exports[a180_0x5463('0x5')][a180_0x5463('0x1a')][a180_0x5463('0x2f')][a180_0x5463('0x36')]({'attributes':[a180_0x5463('0x37'),[exports['sequelize']['fn'](a180_0x5463('0x42'),exports['sequelize'][a180_0x5463('0x39')](a180_0x5463('0x37')),'%Y-%m-%d\x20%H:00'),a180_0x5463('0x43')],[exports['sequelize']['fn'](a180_0x5463('0x38'),exports[a180_0x5463('0x5')][a180_0x5463('0x39')]('amount')),a180_0x5463('0x3b')]],'where':{'countingDate':{[exports[a180_0x5463('0x5')]['Op']['gte']]:_0x313b55,[exports[a180_0x5463('0x5')]['Op']['lt']]:_0x3f9d32},'amount':_0x5cb13a['params'][a180_0x5463('0x3e')]=='in'?{[exports[a180_0x5463('0x5')]['Op']['gt']]:0x0}:{[exports[a180_0x5463('0x5')]['Op']['lt']]:0x0}},'group':[exports[a180_0x5463('0x5')]['fn'](a180_0x5463('0x44'),exports['sequelize'][a180_0x5463('0x39')](a180_0x5463('0x37'))),exports[a180_0x5463('0x5')]['fn'](a180_0x5463('0x45'),exports[a180_0x5463('0x5')]['col'](a180_0x5463('0x37'))),exports['sequelize']['fn']('MONTH',exports[a180_0x5463('0x5')][a180_0x5463('0x39')](a180_0x5463('0x37'))),exports[a180_0x5463('0x5')]['fn']('YEAR',exports[a180_0x5463('0x5')]['col'](a180_0x5463('0x37')))],'order':[[a180_0x5463('0x37'),'ASC']]})[a180_0x5463('0x27')](_0x4fb0ea=>{_0x41fd9e[a180_0x5463('0x12')]({'data':_0x4fb0ea});});};exports[a180_0x5463('0x46')]=(_0x4ae374,_0x4f5824,_0x553219)=>{const _0x23d683=_0x4ae374[a180_0x5463('0x47')][a180_0x5463('0x48')]['find'](_0x23d683=>_0x23d683[a180_0x5463('0x49')]===a180_0x5463('0x4a'));fbgraph_1[a180_0x5463('0xa')][a180_0x5463('0x4b')](_0x23d683[a180_0x5463('0x4c')]);fbgraph_1[a180_0x5463('0xa')][a180_0x5463('0x1d')](_0x4ae374[a180_0x5463('0x47')][a180_0x5463('0x4a')]+'?fields=id,name,email,first_name,last_name,gender,link,locale,timezone',(_0x4aa857,_0x5e3c36)=>{if(_0x4aa857){return _0x553219(_0x4aa857);}_0x4f5824[a180_0x5463('0x6')](a180_0x5463('0x4d'),{'title':a180_0x5463('0x4e'),'profile':_0x5e3c36});});};
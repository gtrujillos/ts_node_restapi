var a92_0x5dde=['fbgraph','sequelize','setSequelize','getApi','render','api/index','API\x20Examples','log','connecting','default','connected','list','colombia','Downloading:\x20','name','json','models','reportFiles','findOrCreate','spread','push','connect','ftp.vivotek.com','ipd','findOne','then','ready','connected:','fileName','get','colombia/','end','media/','.txt','pipe','createWriteStream','save','processFtp','readFile','utf8','status','parse','Data','CountingInfo','Out','EndTime','create','passes','getPassCounting','countingDate','ASC','getPassCountingByDay','query','month','startDate','findAll','col','amount','gte','params','literal','YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))','getPassCountingByHour','endDate','DATE_FORMAT','%Y-%m-%d\x20%H:00','countingDateShort','sum','total','direction','YEAR','getFacebook','user','tokens','find','facebook','accessToken','?fields=id,name,email,first_name,last_name,gender,link,locale,timezone','api/facebook','Facebook\x20API','__importDefault','__esModule'];(function(_0x142333,_0x4186f7){var _0x39e5e7=function(_0x4231f9){while(--_0x4231f9){_0x142333['push'](_0x142333['shift']());}};_0x39e5e7(++_0x4186f7);}(a92_0x5dde,0x1ea));var a92_0xb2bf=function(_0x21da83,_0x3dad1f){_0x21da83=_0x21da83-0x0;var _0x1cc42d=a92_0x5dde[_0x21da83];return _0x1cc42d;};'use strict';var __importDefault=this&&this[a92_0xb2bf('0x0')]||function(_0x5ad1df){return _0x5ad1df&&_0x5ad1df['__esModule']?_0x5ad1df:{'default':_0x5ad1df};};Object['defineProperty'](exports,a92_0xb2bf('0x1'),{'value':!![]});const fbgraph_1=__importDefault(require(a92_0xb2bf('0x2')));const ftp_1=__importDefault(require('ftp'));const fs_1=__importDefault(require('fs'));function setSequelize(_0x48ca4c){exports[a92_0xb2bf('0x3')]=_0x48ca4c;}exports[a92_0xb2bf('0x4')]=setSequelize;exports[a92_0xb2bf('0x5')]=(_0x2a62ea,_0x2f6dfd)=>{_0x2f6dfd[a92_0xb2bf('0x6')](a92_0xb2bf('0x7'),{'title':a92_0xb2bf('0x8')});};exports['syncFtp']=(_0x2bf873,_0x3ab366)=>{console[a92_0xb2bf('0x9')](a92_0xb2bf('0xa'));const _0x45aea7=[];const _0x3f62f9=new ftp_1[(a92_0xb2bf('0xb'))]();_0x3f62f9['on']('ready',function(){console[a92_0xb2bf('0x9')](a92_0xb2bf('0xc'));_0x3f62f9[a92_0xb2bf('0xd')](a92_0xb2bf('0xe'),![],function(_0x208250,_0xbefdd1){if(_0x208250){}else{for(const _0x48dae0 of _0xbefdd1){console[a92_0xb2bf('0x9')](a92_0xb2bf('0xf')+_0x48dae0[a92_0xb2bf('0x10')]);if(_0x48dae0[a92_0xb2bf('0x10')]['endsWith'](a92_0xb2bf('0x11'))){exports[a92_0xb2bf('0x3')][a92_0xb2bf('0x12')][a92_0xb2bf('0x13')][a92_0xb2bf('0x14')]({'where':{'fileName':_0x48dae0[a92_0xb2bf('0x10')]}})[a92_0xb2bf('0x15')]((_0x48d080,_0x559d9c)=>{if(_0x559d9c){console['log'](_0x48dae0[a92_0xb2bf('0x10')]);_0x45aea7[a92_0xb2bf('0x16')](_0x48d080);}});}}}_0x3ab366[a92_0xb2bf('0x11')]({'data':_0x45aea7});});});_0x3f62f9['on']('error',function(_0x1b71ce){_0x3ab366['json']({'message':_0x1b71ce});});_0x3f62f9[a92_0xb2bf('0x17')]({'host':a92_0xb2bf('0x18'),'port':0x15,'user':'ipd','password':a92_0xb2bf('0x19')});};exports['downloadFtp']=(_0x25ffae,_0x3443a6)=>{exports['sequelize'][a92_0xb2bf('0x12')][a92_0xb2bf('0x13')][a92_0xb2bf('0x1a')]({'where':{'status':null}})[a92_0xb2bf('0x1b')](_0x38461e=>{if(_0x38461e){const _0x3bd8f9=new ftp_1[(a92_0xb2bf('0xb'))]();_0x3bd8f9['on'](a92_0xb2bf('0x1c'),function(){console[a92_0xb2bf('0x9')](a92_0xb2bf('0x1d')+_0x38461e[a92_0xb2bf('0x1e')]);_0x3bd8f9[a92_0xb2bf('0x1f')](a92_0xb2bf('0x20')+_0x38461e['fileName'],function(_0x112a05,_0x340751){_0x3bd8f9[a92_0xb2bf('0x21')]();if(_0x112a05){}else{const _0x507f40=a92_0xb2bf('0x22')+_0x38461e[a92_0xb2bf('0x1e')]+a92_0xb2bf('0x23');_0x340751[a92_0xb2bf('0x24')](fs_1['default'][a92_0xb2bf('0x25')](_0x507f40));_0x38461e['status']=0x1;_0x38461e[a92_0xb2bf('0x26')]();console['log']('Downloaded:\x20'+_0x38461e['fileName']);}});});_0x3bd8f9['on']('error',function(_0x381000){_0x3443a6[a92_0xb2bf('0x11')]({'message':_0x381000});});_0x3bd8f9['connect']({'host':a92_0xb2bf('0x18'),'port':0x15,'user':a92_0xb2bf('0x19'),'password':a92_0xb2bf('0x19')});_0x3443a6[a92_0xb2bf('0x11')]({'data':_0x38461e['fileName']});}else{_0x3443a6[a92_0xb2bf('0x11')]({'data':[]});}});};exports[a92_0xb2bf('0x27')]=(_0x2cd651,_0x2a3c9a)=>{exports[a92_0xb2bf('0x3')][a92_0xb2bf('0x12')][a92_0xb2bf('0x13')][a92_0xb2bf('0x1a')]({'where':{'status':0x1}})[a92_0xb2bf('0x1b')](_0x2a4a96=>{if(_0x2a4a96){const _0x3d633e=a92_0xb2bf('0x22')+_0x2a4a96[a92_0xb2bf('0x1e')]+a92_0xb2bf('0x23');fs_1[a92_0xb2bf('0xb')][a92_0xb2bf('0x28')](_0x3d633e,a92_0xb2bf('0x29'),function(_0x764fe3,_0x2a09ac){if(_0x764fe3){_0x2a4a96[a92_0xb2bf('0x2a')]=null;}else{try{const _0x444fc4=JSON[a92_0xb2bf('0x2b')](_0x2a09ac);for(const _0xf80e7c of _0x444fc4[a92_0xb2bf('0x2c')][0x0][a92_0xb2bf('0x2d')]){const _0x591ad8=_0xf80e7c['In'];const _0x1614a0=_0xf80e7c[a92_0xb2bf('0x2e')];const _0x20c43c=Date[a92_0xb2bf('0x2b')](_0xf80e7c[a92_0xb2bf('0x2f')]);if(_0x591ad8>0x0){exports['sequelize'][a92_0xb2bf('0x12')]['passes'][a92_0xb2bf('0x30')]({'reportFileId':_0x2a4a96['id'],'amount':_0x591ad8,'countingDate':_0x20c43c});}if(_0x1614a0>0x0){exports[a92_0xb2bf('0x3')][a92_0xb2bf('0x12')][a92_0xb2bf('0x31')][a92_0xb2bf('0x30')]({'reportFileId':_0x2a4a96['id'],'amount':_0x1614a0*-0x1,'countingDate':_0x20c43c});}}_0x2a4a96[a92_0xb2bf('0x2a')]=0x2;}catch(_0x4d3141){_0x2a4a96[a92_0xb2bf('0x2a')]=null;}}_0x2a4a96[a92_0xb2bf('0x26')]();});_0x2a3c9a[a92_0xb2bf('0x11')]({'data':_0x2a4a96['fileName']});}else{_0x2a3c9a[a92_0xb2bf('0x11')]({'data':[]});}});};exports[a92_0xb2bf('0x32')]=(_0x196ada,_0x18134b)=>{exports['sequelize'][a92_0xb2bf('0x12')][a92_0xb2bf('0x31')]['findAll']({'where':{'amount':{[exports[a92_0xb2bf('0x3')]['Op']['gt']]:0x0}},'order':[[a92_0xb2bf('0x33'),a92_0xb2bf('0x34')]]})[a92_0xb2bf('0x1b')](_0x214106=>{_0x18134b[a92_0xb2bf('0x11')]({'data':_0x214106});});};exports[a92_0xb2bf('0x35')]=(_0x9dc2d3,_0x328aa6)=>{const _0x5847fd=_0x9dc2d3[a92_0xb2bf('0x36')][a92_0xb2bf('0x37')];const _0x1487a3=_0x9dc2d3[a92_0xb2bf('0x36')][a92_0xb2bf('0x38')];const _0x37f4ae=_0x9dc2d3[a92_0xb2bf('0x36')]['endDate'];exports[a92_0xb2bf('0x3')][a92_0xb2bf('0x12')][a92_0xb2bf('0x31')][a92_0xb2bf('0x39')]({'attributes':[a92_0xb2bf('0x33'),[exports[a92_0xb2bf('0x3')]['fn']('sum',exports[a92_0xb2bf('0x3')][a92_0xb2bf('0x3a')](a92_0xb2bf('0x3b'))),'total']],'where':{'countingDate':{[exports[a92_0xb2bf('0x3')]['Op'][a92_0xb2bf('0x3c')]]:_0x1487a3,[exports[a92_0xb2bf('0x3')]['Op']['lt']]:_0x37f4ae},'amount':_0x9dc2d3[a92_0xb2bf('0x3d')]['direction']=='in'?{[exports[a92_0xb2bf('0x3')]['Op']['gt']]:0x0}:{[exports[a92_0xb2bf('0x3')]['Op']['lt']]:0x0}},'group':[exports['sequelize'][a92_0xb2bf('0x3e')](a92_0xb2bf('0x3f'))],'order':[['countingDate',a92_0xb2bf('0x34')]]})[a92_0xb2bf('0x1b')](_0x240e39=>{_0x328aa6[a92_0xb2bf('0x11')]({'data':_0x240e39});});};exports[a92_0xb2bf('0x40')]=(_0x2cdc53,_0x3b13ce)=>{const _0x17701c=_0x2cdc53[a92_0xb2bf('0x36')][a92_0xb2bf('0x37')];const _0x46ba1e=_0x2cdc53[a92_0xb2bf('0x36')]['startDate'];const _0x2835d4=_0x2cdc53[a92_0xb2bf('0x36')][a92_0xb2bf('0x41')];exports[a92_0xb2bf('0x3')][a92_0xb2bf('0x12')][a92_0xb2bf('0x31')][a92_0xb2bf('0x39')]({'attributes':['countingDate',[exports[a92_0xb2bf('0x3')]['fn'](a92_0xb2bf('0x42'),exports['sequelize'][a92_0xb2bf('0x3a')]('countingDate'),a92_0xb2bf('0x43')),a92_0xb2bf('0x44')],[exports[a92_0xb2bf('0x3')]['fn'](a92_0xb2bf('0x45'),exports[a92_0xb2bf('0x3')]['col']('amount')),a92_0xb2bf('0x46')]],'where':{'countingDate':{[exports['sequelize']['Op'][a92_0xb2bf('0x3c')]]:_0x46ba1e,[exports[a92_0xb2bf('0x3')]['Op']['lt']]:_0x2835d4},'amount':_0x2cdc53['params'][a92_0xb2bf('0x47')]=='in'?{[exports['sequelize']['Op']['gt']]:0x0}:{[exports[a92_0xb2bf('0x3')]['Op']['lt']]:0x0}},'group':[exports[a92_0xb2bf('0x3')]['fn']('HOUR',exports['sequelize'][a92_0xb2bf('0x3a')](a92_0xb2bf('0x33'))),exports['sequelize']['fn']('DAY',exports[a92_0xb2bf('0x3')][a92_0xb2bf('0x3a')](a92_0xb2bf('0x33'))),exports[a92_0xb2bf('0x3')]['fn']('MONTH',exports[a92_0xb2bf('0x3')]['col'](a92_0xb2bf('0x33'))),exports[a92_0xb2bf('0x3')]['fn'](a92_0xb2bf('0x48'),exports[a92_0xb2bf('0x3')][a92_0xb2bf('0x3a')]('countingDate'))],'order':[[a92_0xb2bf('0x33'),'ASC']]})['then'](_0x2d61e9=>{_0x3b13ce['json']({'data':_0x2d61e9});});};exports[a92_0xb2bf('0x49')]=(_0x58b574,_0x21f5b8,_0xb5f79c)=>{const _0x3a052d=_0x58b574[a92_0xb2bf('0x4a')][a92_0xb2bf('0x4b')][a92_0xb2bf('0x4c')](_0x3a052d=>_0x3a052d['kind']===a92_0xb2bf('0x4d'));fbgraph_1[a92_0xb2bf('0xb')]['setAccessToken'](_0x3a052d[a92_0xb2bf('0x4e')]);fbgraph_1[a92_0xb2bf('0xb')][a92_0xb2bf('0x1f')](_0x58b574[a92_0xb2bf('0x4a')][a92_0xb2bf('0x4d')]+a92_0xb2bf('0x4f'),(_0x37da69,_0x2a1bb0)=>{if(_0x37da69){return _0xb5f79c(_0x37da69);}_0x21f5b8['render'](a92_0xb2bf('0x50'),{'title':a92_0xb2bf('0x51'),'profile':_0x2a1bb0});});};
var a198_0x3d5a=['setAccessToken','accessToken','?fields=id,name,email,first_name,last_name,gender,link,locale,timezone','api/facebook','Facebook\x20API','__esModule','fbgraph','ftp','render','api/index','syncFtp','log','connecting','default','connected','list','Downloading:\x20','name','endsWith','json','findOrCreate','error','ipd','downloadFtp','sequelize','models','reportFiles','findOne','then','ready','connected:','fileName','get','colombia/','end','media/','.txt','createWriteStream','save','Downloaded:\x20','ftp.vivotek.com','processFtp','parse','CountingInfo','create','status','passes','countingDate','ASC','getPassCountingByDay','query','month','endDate','findAll','sum','col','amount','total','gte','literal','YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))','getPassCountingByHour','startDate','DATE_FORMAT','%Y-%m-%d\x20%H:00','countingDateShort','direction','HOUR','DAY','MONTH','YEAR','user','tokens','find','facebook'];(function(_0x41d6d3,_0x509296){var _0x2c5eba=function(_0xeac7a1){while(--_0xeac7a1){_0x41d6d3['push'](_0x41d6d3['shift']());}};_0x2c5eba(++_0x509296);}(a198_0x3d5a,0xe6));var a198_0xa703=function(_0xfaf4ba,_0x226451){_0xfaf4ba=_0xfaf4ba-0x0;var _0x1c75c1=a198_0x3d5a[_0xfaf4ba];return _0x1c75c1;};'use strict';var __importDefault=this&&this['__importDefault']||function(_0x1d8158){return _0x1d8158&&_0x1d8158[a198_0xa703('0x0')]?_0x1d8158:{'default':_0x1d8158};};Object['defineProperty'](exports,a198_0xa703('0x0'),{'value':!![]});const fbgraph_1=__importDefault(require(a198_0xa703('0x1')));const ftp_1=__importDefault(require(a198_0xa703('0x2')));const fs_1=__importDefault(require('fs'));function setSequelize(_0x57fab4){exports['sequelize']=_0x57fab4;}exports['setSequelize']=setSequelize;exports['getApi']=(_0x23ee33,_0x1a29e9)=>{_0x1a29e9[a198_0xa703('0x3')](a198_0xa703('0x4'),{'title':'API\x20Examples'});};exports[a198_0xa703('0x5')]=(_0x149bd8,_0xc3f195)=>{console[a198_0xa703('0x6')](a198_0xa703('0x7'));const _0x27572d=[];const _0x79656d=new ftp_1[(a198_0xa703('0x8'))]();_0x79656d['on']('ready',function(){console['log'](a198_0xa703('0x9'));_0x79656d[a198_0xa703('0xa')]('colombia',![],function(_0x1b6d7a,_0x8c3df4){if(_0x1b6d7a){}else{for(const _0x410842 of _0x8c3df4){console[a198_0xa703('0x6')](a198_0xa703('0xb')+_0x410842['name']);if(_0x410842[a198_0xa703('0xc')][a198_0xa703('0xd')](a198_0xa703('0xe'))){exports['sequelize']['models']['reportFiles'][a198_0xa703('0xf')]({'where':{'fileName':_0x410842['name']}})['spread']((_0x48e72c,_0xb398e9)=>{if(_0xb398e9){console[a198_0xa703('0x6')](_0x410842[a198_0xa703('0xc')]);_0x27572d['push'](_0x48e72c);}});}}}_0xc3f195[a198_0xa703('0xe')]({'data':_0x27572d});});});_0x79656d['on'](a198_0xa703('0x10'),function(_0x586a74){_0xc3f195[a198_0xa703('0xe')]({'message':_0x586a74});});_0x79656d['connect']({'host':'ftp.vivotek.com','port':0x15,'user':'ipd','password':a198_0xa703('0x11')});};exports[a198_0xa703('0x12')]=(_0x5d767f,_0x1b4874)=>{exports[a198_0xa703('0x13')][a198_0xa703('0x14')][a198_0xa703('0x15')][a198_0xa703('0x16')]({'where':{'status':null}})[a198_0xa703('0x17')](_0x3ea77d=>{if(_0x3ea77d){const _0x2d3d4d=new ftp_1[(a198_0xa703('0x8'))]();_0x2d3d4d['on'](a198_0xa703('0x18'),function(){console[a198_0xa703('0x6')](a198_0xa703('0x19')+_0x3ea77d[a198_0xa703('0x1a')]);_0x2d3d4d[a198_0xa703('0x1b')](a198_0xa703('0x1c')+_0x3ea77d[a198_0xa703('0x1a')],function(_0x39b592,_0x5e2406){_0x2d3d4d[a198_0xa703('0x1d')]();if(_0x39b592){}else{const _0x385b55=a198_0xa703('0x1e')+_0x3ea77d['fileName']+a198_0xa703('0x1f');_0x5e2406['pipe'](fs_1['default'][a198_0xa703('0x20')](_0x385b55));_0x3ea77d['status']=0x1;_0x3ea77d[a198_0xa703('0x21')]();console[a198_0xa703('0x6')](a198_0xa703('0x22')+_0x3ea77d[a198_0xa703('0x1a')]);}});});_0x2d3d4d['on']('error',function(_0x5815da){_0x1b4874[a198_0xa703('0xe')]({'message':_0x5815da});});_0x2d3d4d['connect']({'host':a198_0xa703('0x23'),'port':0x15,'user':'ipd','password':'ipd'});_0x1b4874['json']({'data':_0x3ea77d[a198_0xa703('0x1a')]});}else{_0x1b4874['json']({'data':[]});}});};exports[a198_0xa703('0x24')]=(_0x21fc27,_0x3597e5)=>{exports[a198_0xa703('0x13')][a198_0xa703('0x14')][a198_0xa703('0x15')][a198_0xa703('0x16')]({'where':{'status':0x1}})[a198_0xa703('0x17')](_0x7182b8=>{if(_0x7182b8){const _0x259676=a198_0xa703('0x1e')+_0x7182b8[a198_0xa703('0x1a')]+a198_0xa703('0x1f');fs_1['default']['readFile'](_0x259676,'utf8',function(_0xbac83e,_0x364983){if(_0xbac83e){_0x7182b8['status']=null;}else{try{const _0x515ccd=JSON[a198_0xa703('0x25')](_0x364983);for(const _0x3778fd of _0x515ccd['Data'][0x0][a198_0xa703('0x26')]){const _0x20dcc1=_0x3778fd['In'];const _0x1257ee=_0x3778fd['Out'];const _0x5135fc=Date['parse'](_0x3778fd['EndTime']);if(_0x20dcc1>0x0){exports[a198_0xa703('0x13')][a198_0xa703('0x14')]['passes'][a198_0xa703('0x27')]({'reportFileId':_0x7182b8['id'],'amount':_0x20dcc1,'countingDate':_0x5135fc});}if(_0x1257ee>0x0){exports[a198_0xa703('0x13')][a198_0xa703('0x14')]['passes'][a198_0xa703('0x27')]({'reportFileId':_0x7182b8['id'],'amount':_0x1257ee*-0x1,'countingDate':_0x5135fc});}}_0x7182b8['status']=0x2;}catch(_0x23ea8f){_0x7182b8[a198_0xa703('0x28')]=null;}}_0x7182b8[a198_0xa703('0x21')]();});_0x3597e5[a198_0xa703('0xe')]({'data':_0x7182b8[a198_0xa703('0x1a')]});}else{_0x3597e5[a198_0xa703('0xe')]({'data':[]});}});};exports['getPassCounting']=(_0x24021d,_0x2c4be7)=>{exports[a198_0xa703('0x13')][a198_0xa703('0x14')][a198_0xa703('0x29')]['findAll']({'where':{'amount':{[exports[a198_0xa703('0x13')]['Op']['gt']]:0x0}},'order':[[a198_0xa703('0x2a'),a198_0xa703('0x2b')]]})[a198_0xa703('0x17')](_0x5dc7a3=>{_0x2c4be7['json']({'data':_0x5dc7a3});});};exports[a198_0xa703('0x2c')]=(_0x9dfbb,_0x1636ea)=>{const _0x3f88d1=_0x9dfbb[a198_0xa703('0x2d')][a198_0xa703('0x2e')];const _0x162cd1=_0x9dfbb[a198_0xa703('0x2d')]['startDate'];const _0x5f1c76=_0x9dfbb[a198_0xa703('0x2d')][a198_0xa703('0x2f')];exports[a198_0xa703('0x13')]['models']['passes'][a198_0xa703('0x30')]({'attributes':['countingDate',[exports[a198_0xa703('0x13')]['fn'](a198_0xa703('0x31'),exports['sequelize'][a198_0xa703('0x32')](a198_0xa703('0x33'))),a198_0xa703('0x34')]],'where':{'countingDate':{[exports[a198_0xa703('0x13')]['Op'][a198_0xa703('0x35')]]:_0x162cd1,[exports[a198_0xa703('0x13')]['Op']['lt']]:_0x5f1c76},'amount':_0x9dfbb['params']['direction']=='in'?{[exports['sequelize']['Op']['gt']]:0x0}:{[exports[a198_0xa703('0x13')]['Op']['lt']]:0x0}},'group':[exports[a198_0xa703('0x13')][a198_0xa703('0x36')](a198_0xa703('0x37'))],'order':[[a198_0xa703('0x2a'),a198_0xa703('0x2b')]]})[a198_0xa703('0x17')](_0x6c1469=>{_0x1636ea[a198_0xa703('0xe')]({'data':_0x6c1469});});};exports[a198_0xa703('0x38')]=(_0x549ffc,_0x9047f2)=>{const _0x3eef31=_0x549ffc[a198_0xa703('0x2d')][a198_0xa703('0x2e')];const _0x42e403=_0x549ffc[a198_0xa703('0x2d')][a198_0xa703('0x39')];const _0xfd67f6=_0x549ffc[a198_0xa703('0x2d')][a198_0xa703('0x2f')];exports['sequelize'][a198_0xa703('0x14')][a198_0xa703('0x29')][a198_0xa703('0x30')]({'attributes':[a198_0xa703('0x2a'),[exports[a198_0xa703('0x13')]['fn'](a198_0xa703('0x3a'),exports[a198_0xa703('0x13')][a198_0xa703('0x32')](a198_0xa703('0x2a')),a198_0xa703('0x3b')),a198_0xa703('0x3c')],[exports[a198_0xa703('0x13')]['fn'](a198_0xa703('0x31'),exports[a198_0xa703('0x13')][a198_0xa703('0x32')]('amount')),a198_0xa703('0x34')]],'where':{'countingDate':{[exports[a198_0xa703('0x13')]['Op'][a198_0xa703('0x35')]]:_0x42e403,[exports[a198_0xa703('0x13')]['Op']['lt']]:_0xfd67f6},'amount':_0x549ffc['params'][a198_0xa703('0x3d')]=='in'?{[exports[a198_0xa703('0x13')]['Op']['gt']]:0x0}:{[exports[a198_0xa703('0x13')]['Op']['lt']]:0x0}},'group':[exports[a198_0xa703('0x13')]['fn'](a198_0xa703('0x3e'),exports[a198_0xa703('0x13')]['col']('countingDate')),exports[a198_0xa703('0x13')]['fn'](a198_0xa703('0x3f'),exports[a198_0xa703('0x13')][a198_0xa703('0x32')]('countingDate')),exports[a198_0xa703('0x13')]['fn'](a198_0xa703('0x40'),exports[a198_0xa703('0x13')][a198_0xa703('0x32')](a198_0xa703('0x2a'))),exports[a198_0xa703('0x13')]['fn'](a198_0xa703('0x41'),exports[a198_0xa703('0x13')][a198_0xa703('0x32')](a198_0xa703('0x2a')))],'order':[['countingDate',a198_0xa703('0x2b')]]})[a198_0xa703('0x17')](_0x3ce683=>{_0x9047f2[a198_0xa703('0xe')]({'data':_0x3ce683});});};exports['getFacebook']=(_0x3fb824,_0x57611c,_0x30c5f9)=>{const _0x1f4f9c=_0x3fb824[a198_0xa703('0x42')][a198_0xa703('0x43')][a198_0xa703('0x44')](_0x1f4f9c=>_0x1f4f9c['kind']===a198_0xa703('0x45'));fbgraph_1[a198_0xa703('0x8')][a198_0xa703('0x46')](_0x1f4f9c[a198_0xa703('0x47')]);fbgraph_1[a198_0xa703('0x8')][a198_0xa703('0x1b')](_0x3fb824[a198_0xa703('0x42')][a198_0xa703('0x45')]+a198_0xa703('0x48'),(_0x33106d,_0x5abdaf)=>{if(_0x33106d){return _0x30c5f9(_0x33106d);}_0x57611c['render'](a198_0xa703('0x49'),{'title':a198_0xa703('0x4a'),'profile':_0x5abdaf});});};
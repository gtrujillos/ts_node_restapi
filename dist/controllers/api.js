var a91_0x278e=['downloadFtp','findOne','then','default','connected:','fileName','get','colombia/','end','media/','.txt','status','save','Downloaded:\x20','connect','processFtp','reportFiles','readFile','utf8','parse','CountingInfo','Out','passes','create','getPassCounting','countingDate','ASC','getPassCountingByDay','query','startDate','endDate','findAll','col','amount','gte','params','direction','literal','getPassCountingByHour','month','DATE_FORMAT','total','HOUR','DAY','MONTH','YEAR','getFacebook','tokens','find','facebook','setAccessToken','accessToken','?fields=id,name,email,first_name,last_name,gender,link,locale,timezone','api/facebook','Facebook\x20API','__importDefault','__esModule','ftp','sequelize','setSequelize','render','api/index','API\x20Examples','log','connecting','ready','connected','list','colombia','Downloading:\x20','name','endsWith','json','models','spread','error','ftp.vivotek.com','ipd'];(function(_0x2ba36e,_0x2ab2d7){var _0x5c76f1=function(_0x118b6f){while(--_0x118b6f){_0x2ba36e['push'](_0x2ba36e['shift']());}};_0x5c76f1(++_0x2ab2d7);}(a91_0x278e,0x16f));var a91_0x31e5=function(_0x29b517,_0x278ec3){_0x29b517=_0x29b517-0x0;var _0x1aee6f=a91_0x278e[_0x29b517];return _0x1aee6f;};'use strict';var __importDefault=this&&this[a91_0x31e5('0x0')]||function(_0x1f62cb){return _0x1f62cb&&_0x1f62cb['__esModule']?_0x1f62cb:{'default':_0x1f62cb};};Object['defineProperty'](exports,a91_0x31e5('0x1'),{'value':!![]});const fbgraph_1=__importDefault(require('fbgraph'));const ftp_1=__importDefault(require(a91_0x31e5('0x2')));const fs_1=__importDefault(require('fs'));function setSequelize(_0x4e9e0e){exports[a91_0x31e5('0x3')]=_0x4e9e0e;}exports[a91_0x31e5('0x4')]=setSequelize;exports['getApi']=(_0x504aac,_0x2748a9)=>{_0x2748a9[a91_0x31e5('0x5')](a91_0x31e5('0x6'),{'title':a91_0x31e5('0x7')});};exports['syncFtp']=(_0x36aaa4,_0x4e85d1)=>{console[a91_0x31e5('0x8')](a91_0x31e5('0x9'));const _0x2b6a39=[];const _0x380368=new ftp_1['default']();_0x380368['on'](a91_0x31e5('0xa'),function(){console['log'](a91_0x31e5('0xb'));_0x380368[a91_0x31e5('0xc')](a91_0x31e5('0xd'),![],function(_0x561164,_0x462c88){if(_0x561164){}else{for(const _0x59d3a6 of _0x462c88){console[a91_0x31e5('0x8')](a91_0x31e5('0xe')+_0x59d3a6[a91_0x31e5('0xf')]);if(_0x59d3a6[a91_0x31e5('0xf')][a91_0x31e5('0x10')](a91_0x31e5('0x11'))){exports[a91_0x31e5('0x3')][a91_0x31e5('0x12')]['reportFiles']['findOrCreate']({'where':{'fileName':_0x59d3a6[a91_0x31e5('0xf')]}})[a91_0x31e5('0x13')]((_0xd865f2,_0x7311b)=>{if(_0x7311b){console['log'](_0x59d3a6['name']);_0x2b6a39['push'](_0xd865f2);}});}}}_0x4e85d1[a91_0x31e5('0x11')]({'data':_0x2b6a39});});});_0x380368['on'](a91_0x31e5('0x14'),function(_0x4e1ba4){_0x4e85d1['json']({'message':_0x4e1ba4});});_0x380368['connect']({'host':a91_0x31e5('0x15'),'port':0x15,'user':a91_0x31e5('0x16'),'password':a91_0x31e5('0x16')});};exports[a91_0x31e5('0x17')]=(_0x4df330,_0x50a39d)=>{exports[a91_0x31e5('0x3')][a91_0x31e5('0x12')]['reportFiles'][a91_0x31e5('0x18')]({'where':{'status':null}})[a91_0x31e5('0x19')](_0x1496c7=>{if(_0x1496c7){const _0x585ce7=new ftp_1[(a91_0x31e5('0x1a'))]();_0x585ce7['on']('ready',function(){console[a91_0x31e5('0x8')](a91_0x31e5('0x1b')+_0x1496c7[a91_0x31e5('0x1c')]);_0x585ce7[a91_0x31e5('0x1d')](a91_0x31e5('0x1e')+_0x1496c7[a91_0x31e5('0x1c')],function(_0x13da5b,_0x2fef3e){_0x585ce7[a91_0x31e5('0x1f')]();if(_0x13da5b){}else{const _0x33738b=a91_0x31e5('0x20')+_0x1496c7[a91_0x31e5('0x1c')]+a91_0x31e5('0x21');_0x2fef3e['pipe'](fs_1[a91_0x31e5('0x1a')]['createWriteStream'](_0x33738b));_0x1496c7[a91_0x31e5('0x22')]=0x1;_0x1496c7[a91_0x31e5('0x23')]();console[a91_0x31e5('0x8')](a91_0x31e5('0x24')+_0x1496c7[a91_0x31e5('0x1c')]);}});});_0x585ce7['on']('error',function(_0x3a2d37){_0x50a39d[a91_0x31e5('0x11')]({'message':_0x3a2d37});});_0x585ce7[a91_0x31e5('0x25')]({'host':a91_0x31e5('0x15'),'port':0x15,'user':'ipd','password':a91_0x31e5('0x16')});_0x50a39d[a91_0x31e5('0x11')]({'data':_0x1496c7[a91_0x31e5('0x1c')]});}else{_0x50a39d['json']({'data':[]});}});};exports[a91_0x31e5('0x26')]=(_0x31ba11,_0x412383)=>{exports[a91_0x31e5('0x3')][a91_0x31e5('0x12')][a91_0x31e5('0x27')][a91_0x31e5('0x18')]({'where':{'status':0x1}})[a91_0x31e5('0x19')](_0x1578f4=>{if(_0x1578f4){const _0x584c9c=a91_0x31e5('0x20')+_0x1578f4[a91_0x31e5('0x1c')]+a91_0x31e5('0x21');fs_1[a91_0x31e5('0x1a')][a91_0x31e5('0x28')](_0x584c9c,a91_0x31e5('0x29'),function(_0x47a24d,_0x585952){if(_0x47a24d){_0x1578f4['status']=null;}else{try{const _0x36d3c6=JSON[a91_0x31e5('0x2a')](_0x585952);for(const _0x43f733 of _0x36d3c6['Data'][0x0][a91_0x31e5('0x2b')]){const _0x164b65=_0x43f733['In'];const _0x3881aa=_0x43f733[a91_0x31e5('0x2c')];const _0x5b922f=Date['parse'](_0x43f733['EndTime']);if(_0x164b65>0x0){exports[a91_0x31e5('0x3')][a91_0x31e5('0x12')][a91_0x31e5('0x2d')][a91_0x31e5('0x2e')]({'reportFileId':_0x1578f4['id'],'amount':_0x164b65,'countingDate':_0x5b922f});}if(_0x3881aa>0x0){exports[a91_0x31e5('0x3')]['models'][a91_0x31e5('0x2d')]['create']({'reportFileId':_0x1578f4['id'],'amount':_0x3881aa*-0x1,'countingDate':_0x5b922f});}}_0x1578f4[a91_0x31e5('0x22')]=0x2;}catch(_0x28783f){_0x1578f4[a91_0x31e5('0x22')]=null;}}_0x1578f4['save']();});_0x412383[a91_0x31e5('0x11')]({'data':_0x1578f4['fileName']});}else{_0x412383[a91_0x31e5('0x11')]({'data':[]});}});};exports[a91_0x31e5('0x2f')]=(_0x531eff,_0x4c2fca)=>{exports['sequelize'][a91_0x31e5('0x12')][a91_0x31e5('0x2d')]['findAll']({'where':{'amount':{[exports[a91_0x31e5('0x3')]['Op']['gt']]:0x0}},'order':[[a91_0x31e5('0x30'),a91_0x31e5('0x31')]]})[a91_0x31e5('0x19')](_0x1dfac0=>{_0x4c2fca[a91_0x31e5('0x11')]({'data':_0x1dfac0});});};exports[a91_0x31e5('0x32')]=(_0x12001b,_0x4ab8db)=>{const _0x140155=_0x12001b['query']['month'];const _0x2a2086=_0x12001b[a91_0x31e5('0x33')][a91_0x31e5('0x34')];const _0xc1e6cf=_0x12001b[a91_0x31e5('0x33')][a91_0x31e5('0x35')];exports[a91_0x31e5('0x3')][a91_0x31e5('0x12')][a91_0x31e5('0x2d')][a91_0x31e5('0x36')]({'attributes':[a91_0x31e5('0x30'),[exports[a91_0x31e5('0x3')]['fn']('sum',exports['sequelize'][a91_0x31e5('0x37')](a91_0x31e5('0x38'))),'total']],'where':{'countingDate':{[exports['sequelize']['Op'][a91_0x31e5('0x39')]]:_0x2a2086,[exports[a91_0x31e5('0x3')]['Op']['lt']]:_0xc1e6cf},'amount':_0x12001b[a91_0x31e5('0x3a')][a91_0x31e5('0x3b')]=='in'?{[exports[a91_0x31e5('0x3')]['Op']['gt']]:0x0}:{[exports[a91_0x31e5('0x3')]['Op']['lt']]:0x0}},'group':[exports['sequelize'][a91_0x31e5('0x3c')]('YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))')],'order':[[a91_0x31e5('0x30'),a91_0x31e5('0x31')]]})[a91_0x31e5('0x19')](_0x26680e=>{_0x4ab8db[a91_0x31e5('0x11')]({'data':_0x26680e});});};exports[a91_0x31e5('0x3d')]=(_0x187fcc,_0x2352ae)=>{const _0x2481a0=_0x187fcc[a91_0x31e5('0x33')][a91_0x31e5('0x3e')];const _0x917d0d=_0x187fcc['query'][a91_0x31e5('0x34')];const _0x356a72=_0x187fcc[a91_0x31e5('0x33')][a91_0x31e5('0x35')];exports[a91_0x31e5('0x3')][a91_0x31e5('0x12')]['passes'][a91_0x31e5('0x36')]({'attributes':[a91_0x31e5('0x30'),[exports[a91_0x31e5('0x3')]['fn'](a91_0x31e5('0x3f'),exports[a91_0x31e5('0x3')][a91_0x31e5('0x37')](a91_0x31e5('0x30')),'%Y-%m-%d\x20%H:00'),'countingDateShort'],[exports[a91_0x31e5('0x3')]['fn']('sum',exports[a91_0x31e5('0x3')][a91_0x31e5('0x37')](a91_0x31e5('0x38'))),a91_0x31e5('0x40')]],'where':{'countingDate':{[exports[a91_0x31e5('0x3')]['Op'][a91_0x31e5('0x39')]]:_0x917d0d,[exports['sequelize']['Op']['lt']]:_0x356a72},'amount':_0x187fcc[a91_0x31e5('0x3a')][a91_0x31e5('0x3b')]=='in'?{[exports[a91_0x31e5('0x3')]['Op']['gt']]:0x0}:{[exports[a91_0x31e5('0x3')]['Op']['lt']]:0x0}},'group':[exports[a91_0x31e5('0x3')]['fn'](a91_0x31e5('0x41'),exports[a91_0x31e5('0x3')][a91_0x31e5('0x37')]('countingDate')),exports['sequelize']['fn'](a91_0x31e5('0x42'),exports['sequelize']['col']('countingDate')),exports[a91_0x31e5('0x3')]['fn'](a91_0x31e5('0x43'),exports[a91_0x31e5('0x3')][a91_0x31e5('0x37')](a91_0x31e5('0x30'))),exports[a91_0x31e5('0x3')]['fn'](a91_0x31e5('0x44'),exports[a91_0x31e5('0x3')]['col'](a91_0x31e5('0x30')))],'order':[['countingDate',a91_0x31e5('0x31')]]})[a91_0x31e5('0x19')](_0x4b6e91=>{_0x2352ae['json']({'data':_0x4b6e91});});};exports[a91_0x31e5('0x45')]=(_0x130d2b,_0x2d1cb0,_0x1d04e0)=>{const _0x44f7b8=_0x130d2b['user'][a91_0x31e5('0x46')][a91_0x31e5('0x47')](_0x44f7b8=>_0x44f7b8['kind']===a91_0x31e5('0x48'));fbgraph_1[a91_0x31e5('0x1a')][a91_0x31e5('0x49')](_0x44f7b8[a91_0x31e5('0x4a')]);fbgraph_1[a91_0x31e5('0x1a')][a91_0x31e5('0x1d')](_0x130d2b['user'][a91_0x31e5('0x48')]+a91_0x31e5('0x4b'),(_0x238df2,_0xa49d6a)=>{if(_0x238df2){return _0x1d04e0(_0x238df2);}_0x2d1cb0[a91_0x31e5('0x5')](a91_0x31e5('0x4c'),{'title':a91_0x31e5('0x4d'),'profile':_0xa49d6a});});};
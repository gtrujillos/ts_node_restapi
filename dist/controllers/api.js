var a189_0x18c9=['ipd','findOne','then','connected:','fileName','colombia/','end','.txt','pipe','status','save','error','processFtp','media/','readFile','utf8','parse','Data','EndTime','passes','create','findAll','ASC','getPassCountingByDay','query','month','countingDate','sum','col','total','params','direction','YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))','getPassCountingByHour','startDate','DATE_FORMAT','%Y-%m-%d\x20%H:00','countingDateShort','amount','MONTH','YEAR','getFacebook','tokens','find','kind','facebook','accessToken','get','user','?fields=id,name,email,first_name,last_name,gender,link,locale,timezone','Facebook\x20API','__esModule','defineProperty','ftp','sequelize','getApi','render','api/index','API\x20Examples','syncFtp','connecting','default','ready','log','list','colombia','name','endsWith','json','models','reportFiles','findOrCreate','spread','push','connect','ftp.vivotek.com'];(function(_0x111c80,_0x5d8a08){var _0x5d371e=function(_0x404550){while(--_0x404550){_0x111c80['push'](_0x111c80['shift']());}};_0x5d371e(++_0x5d8a08);}(a189_0x18c9,0x163));var a189_0x9464=function(_0x1a2628,_0x528615){_0x1a2628=_0x1a2628-0x0;var _0x4025a2=a189_0x18c9[_0x1a2628];return _0x4025a2;};'use strict';var __importDefault=this&&this['__importDefault']||function(_0x10082e){return _0x10082e&&_0x10082e[a189_0x9464('0x0')]?_0x10082e:{'default':_0x10082e};};Object[a189_0x9464('0x1')](exports,'__esModule',{'value':!![]});const fbgraph_1=__importDefault(require('fbgraph'));const ftp_1=__importDefault(require(a189_0x9464('0x2')));const fs_1=__importDefault(require('fs'));function setSequelize(_0x1bce51){exports[a189_0x9464('0x3')]=_0x1bce51;}exports['setSequelize']=setSequelize;exports[a189_0x9464('0x4')]=(_0x3e00fb,_0x1dce12)=>{_0x1dce12[a189_0x9464('0x5')](a189_0x9464('0x6'),{'title':a189_0x9464('0x7')});};exports[a189_0x9464('0x8')]=(_0x1d39fa,_0x40d9bb)=>{console['log'](a189_0x9464('0x9'));const _0x34369f=[];const _0x3b9e12=new ftp_1[(a189_0x9464('0xa'))]();_0x3b9e12['on'](a189_0x9464('0xb'),function(){console[a189_0x9464('0xc')]('connected');_0x3b9e12[a189_0x9464('0xd')](a189_0x9464('0xe'),![],function(_0x152c92,_0x355717){if(_0x152c92){}else{for(const _0x18bd02 of _0x355717){console[a189_0x9464('0xc')]('Downloading:\x20'+_0x18bd02[a189_0x9464('0xf')]);if(_0x18bd02['name'][a189_0x9464('0x10')](a189_0x9464('0x11'))){exports[a189_0x9464('0x3')][a189_0x9464('0x12')][a189_0x9464('0x13')][a189_0x9464('0x14')]({'where':{'fileName':_0x18bd02[a189_0x9464('0xf')]}})[a189_0x9464('0x15')]((_0x3f7994,_0x5c24d2)=>{if(_0x5c24d2){console[a189_0x9464('0xc')](_0x18bd02[a189_0x9464('0xf')]);_0x34369f[a189_0x9464('0x16')](_0x3f7994);}});}}}_0x40d9bb[a189_0x9464('0x11')]({'data':_0x34369f});});});_0x3b9e12['on']('error',function(_0x2e0cbb){_0x40d9bb[a189_0x9464('0x11')]({'message':_0x2e0cbb});});_0x3b9e12[a189_0x9464('0x17')]({'host':a189_0x9464('0x18'),'port':0x15,'user':a189_0x9464('0x19'),'password':a189_0x9464('0x19')});};exports['downloadFtp']=(_0x369757,_0xf6b15f)=>{exports[a189_0x9464('0x3')][a189_0x9464('0x12')][a189_0x9464('0x13')][a189_0x9464('0x1a')]({'where':{'status':null}})[a189_0x9464('0x1b')](_0x13f323=>{if(_0x13f323){const _0xceab5=new ftp_1[(a189_0x9464('0xa'))]();_0xceab5['on'](a189_0x9464('0xb'),function(){console[a189_0x9464('0xc')](a189_0x9464('0x1c')+_0x13f323[a189_0x9464('0x1d')]);_0xceab5['get'](a189_0x9464('0x1e')+_0x13f323[a189_0x9464('0x1d')],function(_0x3dba21,_0x42da9e){_0xceab5[a189_0x9464('0x1f')]();if(_0x3dba21){}else{const _0x56ea7a='media/'+_0x13f323[a189_0x9464('0x1d')]+a189_0x9464('0x20');_0x42da9e[a189_0x9464('0x21')](fs_1[a189_0x9464('0xa')]['createWriteStream'](_0x56ea7a));_0x13f323[a189_0x9464('0x22')]=0x1;_0x13f323[a189_0x9464('0x23')]();console['log']('Downloaded:\x20'+_0x13f323[a189_0x9464('0x1d')]);}});});_0xceab5['on'](a189_0x9464('0x24'),function(_0xc9a83d){_0xf6b15f[a189_0x9464('0x11')]({'message':_0xc9a83d});});_0xceab5[a189_0x9464('0x17')]({'host':a189_0x9464('0x18'),'port':0x15,'user':a189_0x9464('0x19'),'password':a189_0x9464('0x19')});_0xf6b15f['json']({'data':_0x13f323[a189_0x9464('0x1d')]});}else{_0xf6b15f[a189_0x9464('0x11')]({'data':[]});}});};exports[a189_0x9464('0x25')]=(_0x5851c2,_0x5e14fd)=>{exports[a189_0x9464('0x3')][a189_0x9464('0x12')][a189_0x9464('0x13')][a189_0x9464('0x1a')]({'where':{'status':0x1}})['then'](_0x3c6ef1=>{if(_0x3c6ef1){const _0x109fab=a189_0x9464('0x26')+_0x3c6ef1[a189_0x9464('0x1d')]+a189_0x9464('0x20');fs_1['default'][a189_0x9464('0x27')](_0x109fab,a189_0x9464('0x28'),function(_0x136e86,_0x2bb8e4){if(_0x136e86){_0x3c6ef1[a189_0x9464('0x22')]=null;}else{try{const _0x2e8541=JSON[a189_0x9464('0x29')](_0x2bb8e4);for(const _0x251db4 of _0x2e8541[a189_0x9464('0x2a')][0x0]['CountingInfo']){const _0x3e8ca4=_0x251db4['In'];const _0x547a85=_0x251db4['Out'];const _0x336e5d=Date[a189_0x9464('0x29')](_0x251db4[a189_0x9464('0x2b')]);if(_0x3e8ca4>0x0){exports['sequelize'][a189_0x9464('0x12')][a189_0x9464('0x2c')][a189_0x9464('0x2d')]({'reportFileId':_0x3c6ef1['id'],'amount':_0x3e8ca4,'countingDate':_0x336e5d});}if(_0x547a85>0x0){exports[a189_0x9464('0x3')][a189_0x9464('0x12')][a189_0x9464('0x2c')]['create']({'reportFileId':_0x3c6ef1['id'],'amount':_0x547a85*-0x1,'countingDate':_0x336e5d});}}_0x3c6ef1['status']=0x2;}catch(_0x14cf9d){_0x3c6ef1[a189_0x9464('0x22')]=null;}}_0x3c6ef1[a189_0x9464('0x23')]();});_0x5e14fd[a189_0x9464('0x11')]({'data':_0x3c6ef1['fileName']});}else{_0x5e14fd[a189_0x9464('0x11')]({'data':[]});}});};exports['getPassCounting']=(_0x22d970,_0x798ed5)=>{exports[a189_0x9464('0x3')][a189_0x9464('0x12')][a189_0x9464('0x2c')][a189_0x9464('0x2e')]({'where':{'amount':{[exports[a189_0x9464('0x3')]['Op']['gt']]:0x0}},'order':[['countingDate',a189_0x9464('0x2f')]]})['then'](_0x17fabf=>{_0x798ed5[a189_0x9464('0x11')]({'data':_0x17fabf});});};exports[a189_0x9464('0x30')]=(_0x2e8d53,_0x45eeaf)=>{const _0x841efd=_0x2e8d53[a189_0x9464('0x31')][a189_0x9464('0x32')];const _0x183718=_0x2e8d53['query']['startDate'];const _0x3972e6=_0x2e8d53[a189_0x9464('0x31')]['endDate'];exports['sequelize'][a189_0x9464('0x12')][a189_0x9464('0x2c')][a189_0x9464('0x2e')]({'attributes':[a189_0x9464('0x33'),[exports[a189_0x9464('0x3')]['fn'](a189_0x9464('0x34'),exports[a189_0x9464('0x3')][a189_0x9464('0x35')]('amount')),a189_0x9464('0x36')]],'where':{'countingDate':{[exports[a189_0x9464('0x3')]['Op']['gte']]:_0x183718,[exports['sequelize']['Op']['lt']]:_0x3972e6},'amount':_0x2e8d53[a189_0x9464('0x37')][a189_0x9464('0x38')]=='in'?{[exports[a189_0x9464('0x3')]['Op']['gt']]:0x0}:{[exports['sequelize']['Op']['lt']]:0x0}},'group':[exports[a189_0x9464('0x3')]['literal'](a189_0x9464('0x39'))],'order':[[a189_0x9464('0x33'),'ASC']]})[a189_0x9464('0x1b')](_0x4cf738=>{_0x45eeaf[a189_0x9464('0x11')]({'data':_0x4cf738});});};exports[a189_0x9464('0x3a')]=(_0x194083,_0xc1ddda)=>{const _0x465fac=_0x194083[a189_0x9464('0x31')][a189_0x9464('0x32')];const _0x3410e3=_0x194083[a189_0x9464('0x31')][a189_0x9464('0x3b')];const _0xff290e=_0x194083[a189_0x9464('0x31')]['endDate'];exports[a189_0x9464('0x3')]['models']['passes'][a189_0x9464('0x2e')]({'attributes':[a189_0x9464('0x33'),[exports[a189_0x9464('0x3')]['fn'](a189_0x9464('0x3c'),exports['sequelize'][a189_0x9464('0x35')](a189_0x9464('0x33')),a189_0x9464('0x3d')),a189_0x9464('0x3e')],[exports[a189_0x9464('0x3')]['fn'](a189_0x9464('0x34'),exports[a189_0x9464('0x3')]['col'](a189_0x9464('0x3f'))),a189_0x9464('0x36')]],'where':{'countingDate':{[exports[a189_0x9464('0x3')]['Op']['gte']]:_0x3410e3,[exports[a189_0x9464('0x3')]['Op']['lt']]:_0xff290e},'amount':_0x194083[a189_0x9464('0x37')][a189_0x9464('0x38')]=='in'?{[exports['sequelize']['Op']['gt']]:0x0}:{[exports[a189_0x9464('0x3')]['Op']['lt']]:0x0}},'group':[exports[a189_0x9464('0x3')]['fn']('HOUR',exports[a189_0x9464('0x3')]['col'](a189_0x9464('0x33'))),exports[a189_0x9464('0x3')]['fn']('DAY',exports[a189_0x9464('0x3')][a189_0x9464('0x35')](a189_0x9464('0x33'))),exports[a189_0x9464('0x3')]['fn'](a189_0x9464('0x40'),exports[a189_0x9464('0x3')][a189_0x9464('0x35')](a189_0x9464('0x33'))),exports[a189_0x9464('0x3')]['fn'](a189_0x9464('0x41'),exports[a189_0x9464('0x3')][a189_0x9464('0x35')]('countingDate'))],'order':[[a189_0x9464('0x33'),'ASC']]})[a189_0x9464('0x1b')](_0x27e26e=>{_0xc1ddda[a189_0x9464('0x11')]({'data':_0x27e26e});});};exports[a189_0x9464('0x42')]=(_0x404745,_0x5665de,_0x592615)=>{const _0x4fa9eb=_0x404745['user'][a189_0x9464('0x43')][a189_0x9464('0x44')](_0x4fa9eb=>_0x4fa9eb[a189_0x9464('0x45')]===a189_0x9464('0x46'));fbgraph_1[a189_0x9464('0xa')]['setAccessToken'](_0x4fa9eb[a189_0x9464('0x47')]);fbgraph_1['default'][a189_0x9464('0x48')](_0x404745[a189_0x9464('0x49')][a189_0x9464('0x46')]+a189_0x9464('0x4a'),(_0x4dbfc8,_0x26aad5)=>{if(_0x4dbfc8){return _0x592615(_0x4dbfc8);}_0x5665de['render']('api/facebook',{'title':a189_0x9464('0x4b'),'profile':_0x26aad5});});};
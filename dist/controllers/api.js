var a92_0x42c4=['find','kind','facebook','accessToken','?fields=id,name,email,first_name,last_name,gender,link,locale,timezone','api/facebook','Facebook\x20API','defineProperty','__esModule','fbgraph','sequelize','setSequelize','getApi','render','api/index','API\x20Examples','log','connecting','default','ready','list','Downloading:\x20','name','models','reportFiles','findOrCreate','spread','push','json','connect','ftp.vivotek.com','ipd','downloadFtp','then','connected:','fileName','get','colombia/','end','media/','pipe','status','save','Downloaded:\x20','processFtp','findOne','.txt','readFile','utf8','parse','Data','CountingInfo','Out','passes','create','getPassCounting','findAll','countingDate','ASC','month','query','endDate','sum','amount','total','gte','literal','YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))','getPassCountingByHour','DATE_FORMAT','col','%Y-%m-%d\x20%H:00','countingDateShort','params','direction','HOUR','DAY','getFacebook','user','tokens'];(function(_0x2ae08b,_0x6da5ce){var _0x2aa701=function(_0x3d530a){while(--_0x3d530a){_0x2ae08b['push'](_0x2ae08b['shift']());}};_0x2aa701(++_0x6da5ce);}(a92_0x42c4,0x197));var a92_0x187b=function(_0x3165a0,_0x288e20){_0x3165a0=_0x3165a0-0x0;var _0x315e9a=a92_0x42c4[_0x3165a0];return _0x315e9a;};'use strict';var __importDefault=this&&this['__importDefault']||function(_0x3f2f63){return _0x3f2f63&&_0x3f2f63['__esModule']?_0x3f2f63:{'default':_0x3f2f63};};Object[a92_0x187b('0x0')](exports,a92_0x187b('0x1'),{'value':!![]});const fbgraph_1=__importDefault(require(a92_0x187b('0x2')));const ftp_1=__importDefault(require('ftp'));const fs_1=__importDefault(require('fs'));function setSequelize(_0x58893b){exports[a92_0x187b('0x3')]=_0x58893b;}exports[a92_0x187b('0x4')]=setSequelize;exports[a92_0x187b('0x5')]=(_0x2ea299,_0x4de350)=>{_0x4de350[a92_0x187b('0x6')](a92_0x187b('0x7'),{'title':a92_0x187b('0x8')});};exports['syncFtp']=(_0x1ed8a2,_0x214680)=>{console[a92_0x187b('0x9')](a92_0x187b('0xa'));const _0x24d502=[];const _0x7a2883=new ftp_1[(a92_0x187b('0xb'))]();_0x7a2883['on'](a92_0x187b('0xc'),function(){console[a92_0x187b('0x9')]('connected');_0x7a2883[a92_0x187b('0xd')]('colombia',![],function(_0x460ec3,_0x2eb7e9){if(_0x460ec3){}else{for(const _0x9cc488 of _0x2eb7e9){console[a92_0x187b('0x9')](a92_0x187b('0xe')+_0x9cc488['name']);if(_0x9cc488[a92_0x187b('0xf')]['endsWith']('json')){exports[a92_0x187b('0x3')][a92_0x187b('0x10')][a92_0x187b('0x11')][a92_0x187b('0x12')]({'where':{'fileName':_0x9cc488[a92_0x187b('0xf')]}})[a92_0x187b('0x13')]((_0x3e00f9,_0x2a690d)=>{if(_0x2a690d){console[a92_0x187b('0x9')](_0x9cc488[a92_0x187b('0xf')]);_0x24d502[a92_0x187b('0x14')](_0x3e00f9);}});}}}_0x214680['json']({'data':_0x24d502});});});_0x7a2883['on']('error',function(_0x10de7e){_0x214680[a92_0x187b('0x15')]({'message':_0x10de7e});});_0x7a2883[a92_0x187b('0x16')]({'host':a92_0x187b('0x17'),'port':0x15,'user':a92_0x187b('0x18'),'password':a92_0x187b('0x18')});};exports[a92_0x187b('0x19')]=(_0x156638,_0x55cd89)=>{exports[a92_0x187b('0x3')][a92_0x187b('0x10')][a92_0x187b('0x11')]['findOne']({'where':{'status':null}})[a92_0x187b('0x1a')](_0x2c61fa=>{if(_0x2c61fa){const _0x2cb441=new ftp_1[(a92_0x187b('0xb'))]();_0x2cb441['on']('ready',function(){console['log'](a92_0x187b('0x1b')+_0x2c61fa[a92_0x187b('0x1c')]);_0x2cb441[a92_0x187b('0x1d')](a92_0x187b('0x1e')+_0x2c61fa[a92_0x187b('0x1c')],function(_0x2e6200,_0x56eb18){_0x2cb441[a92_0x187b('0x1f')]();if(_0x2e6200){}else{const _0x4c40c1=a92_0x187b('0x20')+_0x2c61fa['fileName']+'.txt';_0x56eb18[a92_0x187b('0x21')](fs_1[a92_0x187b('0xb')]['createWriteStream'](_0x4c40c1));_0x2c61fa[a92_0x187b('0x22')]=0x1;_0x2c61fa[a92_0x187b('0x23')]();console[a92_0x187b('0x9')](a92_0x187b('0x24')+_0x2c61fa[a92_0x187b('0x1c')]);}});});_0x2cb441['on']('error',function(_0x171043){_0x55cd89[a92_0x187b('0x15')]({'message':_0x171043});});_0x2cb441[a92_0x187b('0x16')]({'host':a92_0x187b('0x17'),'port':0x15,'user':a92_0x187b('0x18'),'password':a92_0x187b('0x18')});_0x55cd89['json']({'data':_0x2c61fa['fileName']});}else{_0x55cd89[a92_0x187b('0x15')]({'data':[]});}});};exports[a92_0x187b('0x25')]=(_0x54b69f,_0x220aae)=>{exports[a92_0x187b('0x3')]['models']['reportFiles'][a92_0x187b('0x26')]({'where':{'status':0x1}})['then'](_0x29b8ea=>{if(_0x29b8ea){const _0x5e2332=a92_0x187b('0x20')+_0x29b8ea[a92_0x187b('0x1c')]+a92_0x187b('0x27');fs_1[a92_0x187b('0xb')][a92_0x187b('0x28')](_0x5e2332,a92_0x187b('0x29'),function(_0x48420e,_0x29fe04){if(_0x48420e){_0x29b8ea['status']=null;}else{try{const _0x5e9716=JSON[a92_0x187b('0x2a')](_0x29fe04);for(const _0x58b4b0 of _0x5e9716[a92_0x187b('0x2b')][0x0][a92_0x187b('0x2c')]){const _0x2a74a4=_0x58b4b0['In'];const _0x1a4d19=_0x58b4b0[a92_0x187b('0x2d')];const _0x516319=Date[a92_0x187b('0x2a')](_0x58b4b0['EndTime']);if(_0x2a74a4>0x0){exports[a92_0x187b('0x3')][a92_0x187b('0x10')][a92_0x187b('0x2e')][a92_0x187b('0x2f')]({'reportFileId':_0x29b8ea['id'],'amount':_0x2a74a4,'countingDate':_0x516319});}if(_0x1a4d19>0x0){exports['sequelize'][a92_0x187b('0x10')]['passes'][a92_0x187b('0x2f')]({'reportFileId':_0x29b8ea['id'],'amount':_0x1a4d19*-0x1,'countingDate':_0x516319});}}_0x29b8ea[a92_0x187b('0x22')]=0x2;}catch(_0x351bb1){_0x29b8ea['status']=null;}}_0x29b8ea[a92_0x187b('0x23')]();});_0x220aae[a92_0x187b('0x15')]({'data':_0x29b8ea[a92_0x187b('0x1c')]});}else{_0x220aae[a92_0x187b('0x15')]({'data':[]});}});};exports[a92_0x187b('0x30')]=(_0x4c544d,_0x47d75b)=>{exports['sequelize']['models'][a92_0x187b('0x2e')][a92_0x187b('0x31')]({'where':{'amount':{[exports[a92_0x187b('0x3')]['Op']['gt']]:0x0}},'order':[[a92_0x187b('0x32'),a92_0x187b('0x33')]]})[a92_0x187b('0x1a')](_0x2834b3=>{_0x47d75b['json']({'data':_0x2834b3});});};exports['getPassCountingByDay']=(_0x33c425,_0x4d3e88)=>{const _0xa331d7=_0x33c425['query'][a92_0x187b('0x34')];const _0x152b3d=_0x33c425['query']['startDate'];const _0x1d6ca8=_0x33c425[a92_0x187b('0x35')][a92_0x187b('0x36')];exports['sequelize'][a92_0x187b('0x10')][a92_0x187b('0x2e')][a92_0x187b('0x31')]({'attributes':[a92_0x187b('0x32'),[exports[a92_0x187b('0x3')]['fn'](a92_0x187b('0x37'),exports[a92_0x187b('0x3')]['col'](a92_0x187b('0x38'))),a92_0x187b('0x39')]],'where':{'countingDate':{[exports[a92_0x187b('0x3')]['Op'][a92_0x187b('0x3a')]]:_0x152b3d,[exports[a92_0x187b('0x3')]['Op']['lt']]:_0x1d6ca8},'amount':_0x33c425['params']['direction']=='in'?{[exports['sequelize']['Op']['gt']]:0x0}:{[exports[a92_0x187b('0x3')]['Op']['lt']]:0x0}},'group':[exports[a92_0x187b('0x3')][a92_0x187b('0x3b')](a92_0x187b('0x3c'))],'order':[[a92_0x187b('0x32'),'ASC']]})[a92_0x187b('0x1a')](_0x4bda4b=>{_0x4d3e88[a92_0x187b('0x15')]({'data':_0x4bda4b});});};exports[a92_0x187b('0x3d')]=(_0x5eafe6,_0x2f4544)=>{const _0x2590d1=_0x5eafe6[a92_0x187b('0x35')][a92_0x187b('0x34')];const _0x2754bd=_0x5eafe6[a92_0x187b('0x35')]['startDate'];const _0x2c8504=_0x5eafe6[a92_0x187b('0x35')][a92_0x187b('0x36')];exports[a92_0x187b('0x3')][a92_0x187b('0x10')][a92_0x187b('0x2e')][a92_0x187b('0x31')]({'attributes':['countingDate',[exports[a92_0x187b('0x3')]['fn'](a92_0x187b('0x3e'),exports[a92_0x187b('0x3')][a92_0x187b('0x3f')]('countingDate'),a92_0x187b('0x40')),a92_0x187b('0x41')],[exports[a92_0x187b('0x3')]['fn'](a92_0x187b('0x37'),exports['sequelize']['col'](a92_0x187b('0x38'))),a92_0x187b('0x39')]],'where':{'countingDate':{[exports[a92_0x187b('0x3')]['Op'][a92_0x187b('0x3a')]]:_0x2754bd,[exports[a92_0x187b('0x3')]['Op']['lt']]:_0x2c8504},'amount':_0x5eafe6[a92_0x187b('0x42')][a92_0x187b('0x43')]=='in'?{[exports[a92_0x187b('0x3')]['Op']['gt']]:0x0}:{[exports[a92_0x187b('0x3')]['Op']['lt']]:0x0}},'group':[exports['sequelize']['fn'](a92_0x187b('0x44'),exports[a92_0x187b('0x3')][a92_0x187b('0x3f')](a92_0x187b('0x32'))),exports['sequelize']['fn'](a92_0x187b('0x45'),exports['sequelize'][a92_0x187b('0x3f')](a92_0x187b('0x32'))),exports['sequelize']['fn']('MONTH',exports[a92_0x187b('0x3')][a92_0x187b('0x3f')]('countingDate')),exports[a92_0x187b('0x3')]['fn']('YEAR',exports[a92_0x187b('0x3')][a92_0x187b('0x3f')](a92_0x187b('0x32')))],'order':[['countingDate',a92_0x187b('0x33')]]})[a92_0x187b('0x1a')](_0x1b0dd9=>{_0x2f4544['json']({'data':_0x1b0dd9});});};exports[a92_0x187b('0x46')]=(_0x6b4fbd,_0x3d1daa,_0x3e406d)=>{const _0x3ee279=_0x6b4fbd[a92_0x187b('0x47')][a92_0x187b('0x48')][a92_0x187b('0x49')](_0x3ee279=>_0x3ee279[a92_0x187b('0x4a')]===a92_0x187b('0x4b'));fbgraph_1[a92_0x187b('0xb')]['setAccessToken'](_0x3ee279[a92_0x187b('0x4c')]);fbgraph_1[a92_0x187b('0xb')][a92_0x187b('0x1d')](_0x6b4fbd[a92_0x187b('0x47')][a92_0x187b('0x4b')]+a92_0x187b('0x4d'),(_0x2401b2,_0x49f8db)=>{if(_0x2401b2){return _0x3e406d(_0x2401b2);}_0x3d1daa[a92_0x187b('0x6')](a92_0x187b('0x4e'),{'title':a92_0x187b('0x4f'),'profile':_0x49f8db});});};
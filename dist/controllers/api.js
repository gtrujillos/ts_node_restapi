var a92_0x1293=['connected','Downloading:\x20','endsWith','json','findOrCreate','name','push','connect','ftp.vivotek.com','ipd','downloadFtp','models','reportFiles','findOne','then','fileName','colombia/','media/','.txt','pipe','createWriteStream','error','processFtp','default','readFile','utf8','status','parse','CountingInfo','Out','passes','create','save','getPassCounting','findAll','query','month','startDate','endDate','countingDate','sum','amount','total','gte','params','direction','literal','ASC','DATE_FORMAT','col','%Y-%m-%d\x20%H:00','countingDateShort','HOUR','DAY','MONTH','YEAR','getFacebook','tokens','find','kind','facebook','setAccessToken','accessToken','get','user','?fields=id,name,email,first_name,last_name,gender,link,locale,timezone','api/facebook','Facebook\x20API','__importDefault','defineProperty','__esModule','fbgraph','sequelize','setSequelize','getApi','render','API\x20Examples','syncFtp','log','connecting','ready'];(function(_0x5e8e43,_0x147f71){var _0x8ee968=function(_0x41205f){while(--_0x41205f){_0x5e8e43['push'](_0x5e8e43['shift']());}};_0x8ee968(++_0x147f71);}(a92_0x1293,0x137));var a92_0xb393=function(_0x44ec3d,_0x33e8aa){_0x44ec3d=_0x44ec3d-0x0;var _0x59ef7d=a92_0x1293[_0x44ec3d];return _0x59ef7d;};'use strict';var __importDefault=this&&this[a92_0xb393('0x0')]||function(_0x21e3a4){return _0x21e3a4&&_0x21e3a4['__esModule']?_0x21e3a4:{'default':_0x21e3a4};};Object[a92_0xb393('0x1')](exports,a92_0xb393('0x2'),{'value':!![]});const fbgraph_1=__importDefault(require(a92_0xb393('0x3')));const ftp_1=__importDefault(require('ftp'));const fs_1=__importDefault(require('fs'));function setSequelize(_0x5cb7de){exports[a92_0xb393('0x4')]=_0x5cb7de;}exports[a92_0xb393('0x5')]=setSequelize;exports[a92_0xb393('0x6')]=(_0x402ce8,_0x29abd8)=>{_0x29abd8[a92_0xb393('0x7')]('api/index',{'title':a92_0xb393('0x8')});};exports[a92_0xb393('0x9')]=(_0x3547cd,_0x3d1bb2)=>{console[a92_0xb393('0xa')](a92_0xb393('0xb'));const _0x923055=[];const _0x2321bc=new ftp_1['default']();_0x2321bc['on'](a92_0xb393('0xc'),function(){console[a92_0xb393('0xa')](a92_0xb393('0xd'));_0x2321bc['list']('colombia',![],function(_0x3b10c3,_0x15c434){if(_0x3b10c3){}else{for(const _0x58f2e4 of _0x15c434){console[a92_0xb393('0xa')](a92_0xb393('0xe')+_0x58f2e4['name']);if(_0x58f2e4['name'][a92_0xb393('0xf')](a92_0xb393('0x10'))){exports['sequelize']['models']['reportFiles'][a92_0xb393('0x11')]({'where':{'fileName':_0x58f2e4[a92_0xb393('0x12')]}})['spread']((_0x205960,_0x1e9a74)=>{if(_0x1e9a74){console[a92_0xb393('0xa')](_0x58f2e4[a92_0xb393('0x12')]);_0x923055[a92_0xb393('0x13')](_0x205960);}});}}}_0x3d1bb2[a92_0xb393('0x10')]({'data':_0x923055});});});_0x2321bc['on']('error',function(_0x55919b){_0x3d1bb2[a92_0xb393('0x10')]({'message':_0x55919b});});_0x2321bc[a92_0xb393('0x14')]({'host':a92_0xb393('0x15'),'port':0x15,'user':'ipd','password':a92_0xb393('0x16')});};exports[a92_0xb393('0x17')]=(_0x322910,_0x38a7dc)=>{exports[a92_0xb393('0x4')][a92_0xb393('0x18')][a92_0xb393('0x19')][a92_0xb393('0x1a')]({'where':{'status':null}})[a92_0xb393('0x1b')](_0x274343=>{if(_0x274343){const _0x1d4ffd=new ftp_1['default']();_0x1d4ffd['on'](a92_0xb393('0xc'),function(){console[a92_0xb393('0xa')]('connected:'+_0x274343[a92_0xb393('0x1c')]);_0x1d4ffd['get'](a92_0xb393('0x1d')+_0x274343['fileName'],function(_0x4d2270,_0x36c9dc){_0x1d4ffd['end']();if(_0x4d2270){}else{const _0x5efb8e=a92_0xb393('0x1e')+_0x274343[a92_0xb393('0x1c')]+a92_0xb393('0x1f');_0x36c9dc[a92_0xb393('0x20')](fs_1['default'][a92_0xb393('0x21')](_0x5efb8e));_0x274343['status']=0x1;_0x274343['save']();console[a92_0xb393('0xa')]('Downloaded:\x20'+_0x274343[a92_0xb393('0x1c')]);}});});_0x1d4ffd['on'](a92_0xb393('0x22'),function(_0x5f1633){_0x38a7dc[a92_0xb393('0x10')]({'message':_0x5f1633});});_0x1d4ffd['connect']({'host':a92_0xb393('0x15'),'port':0x15,'user':'ipd','password':'ipd'});_0x38a7dc[a92_0xb393('0x10')]({'data':_0x274343[a92_0xb393('0x1c')]});}else{_0x38a7dc['json']({'data':[]});}});};exports[a92_0xb393('0x23')]=(_0x219596,_0xb66a46)=>{exports[a92_0xb393('0x4')][a92_0xb393('0x18')][a92_0xb393('0x19')][a92_0xb393('0x1a')]({'where':{'status':0x1}})['then'](_0x6833fa=>{if(_0x6833fa){const _0x44e63e='media/'+_0x6833fa[a92_0xb393('0x1c')]+'.txt';fs_1[a92_0xb393('0x24')][a92_0xb393('0x25')](_0x44e63e,a92_0xb393('0x26'),function(_0x502f14,_0x92aff3){if(_0x502f14){_0x6833fa[a92_0xb393('0x27')]=null;}else{try{const _0x330265=JSON[a92_0xb393('0x28')](_0x92aff3);for(const _0x31a001 of _0x330265['Data'][0x0][a92_0xb393('0x29')]){const _0x4ffbb4=_0x31a001['In'];const _0x1038f8=_0x31a001[a92_0xb393('0x2a')];const _0x56d322=Date['parse'](_0x31a001['EndTime']);if(_0x4ffbb4>0x0){exports[a92_0xb393('0x4')][a92_0xb393('0x18')][a92_0xb393('0x2b')][a92_0xb393('0x2c')]({'reportFileId':_0x6833fa['id'],'amount':_0x4ffbb4,'countingDate':_0x56d322});}if(_0x1038f8>0x0){exports['sequelize'][a92_0xb393('0x18')][a92_0xb393('0x2b')][a92_0xb393('0x2c')]({'reportFileId':_0x6833fa['id'],'amount':_0x1038f8*-0x1,'countingDate':_0x56d322});}}_0x6833fa[a92_0xb393('0x27')]=0x2;}catch(_0x19d115){_0x6833fa[a92_0xb393('0x27')]=null;}}_0x6833fa[a92_0xb393('0x2d')]();});_0xb66a46['json']({'data':_0x6833fa[a92_0xb393('0x1c')]});}else{_0xb66a46[a92_0xb393('0x10')]({'data':[]});}});};exports[a92_0xb393('0x2e')]=(_0x269655,_0x468d7d)=>{exports['sequelize'][a92_0xb393('0x18')][a92_0xb393('0x2b')][a92_0xb393('0x2f')]({'where':{'amount':{[exports[a92_0xb393('0x4')]['Op']['gt']]:0x0}},'order':[['countingDate','ASC']]})['then'](_0x23ad82=>{_0x468d7d[a92_0xb393('0x10')]({'data':_0x23ad82});});};exports['getPassCountingByDay']=(_0x4a159e,_0x1c95c4)=>{const _0xf47b33=_0x4a159e[a92_0xb393('0x30')][a92_0xb393('0x31')];const _0x418f65=_0x4a159e['query'][a92_0xb393('0x32')];const _0x483311=_0x4a159e[a92_0xb393('0x30')][a92_0xb393('0x33')];exports[a92_0xb393('0x4')]['models']['passes'][a92_0xb393('0x2f')]({'attributes':[a92_0xb393('0x34'),[exports['sequelize']['fn'](a92_0xb393('0x35'),exports[a92_0xb393('0x4')]['col'](a92_0xb393('0x36'))),a92_0xb393('0x37')]],'where':{'countingDate':{[exports[a92_0xb393('0x4')]['Op'][a92_0xb393('0x38')]]:_0x418f65,[exports[a92_0xb393('0x4')]['Op']['lt']]:_0x483311},'amount':_0x4a159e[a92_0xb393('0x39')][a92_0xb393('0x3a')]=='in'?{[exports[a92_0xb393('0x4')]['Op']['gt']]:0x0}:{[exports[a92_0xb393('0x4')]['Op']['lt']]:0x0}},'group':[exports[a92_0xb393('0x4')][a92_0xb393('0x3b')]('YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))')],'order':[[a92_0xb393('0x34'),a92_0xb393('0x3c')]]})[a92_0xb393('0x1b')](_0x3f4e78=>{_0x1c95c4[a92_0xb393('0x10')]({'data':_0x3f4e78});});};exports['getPassCountingByHour']=(_0xdf2e38,_0x5aa062)=>{const _0x2d61b0=_0xdf2e38[a92_0xb393('0x30')][a92_0xb393('0x31')];const _0x2c1c4b=_0xdf2e38[a92_0xb393('0x30')][a92_0xb393('0x32')];const _0x1944a0=_0xdf2e38[a92_0xb393('0x30')][a92_0xb393('0x33')];exports[a92_0xb393('0x4')][a92_0xb393('0x18')][a92_0xb393('0x2b')]['findAll']({'attributes':[a92_0xb393('0x34'),[exports[a92_0xb393('0x4')]['fn'](a92_0xb393('0x3d'),exports[a92_0xb393('0x4')][a92_0xb393('0x3e')](a92_0xb393('0x34')),a92_0xb393('0x3f')),a92_0xb393('0x40')],[exports[a92_0xb393('0x4')]['fn'](a92_0xb393('0x35'),exports[a92_0xb393('0x4')][a92_0xb393('0x3e')](a92_0xb393('0x36'))),a92_0xb393('0x37')]],'where':{'countingDate':{[exports[a92_0xb393('0x4')]['Op'][a92_0xb393('0x38')]]:_0x2c1c4b,[exports[a92_0xb393('0x4')]['Op']['lt']]:_0x1944a0},'amount':_0xdf2e38[a92_0xb393('0x39')][a92_0xb393('0x3a')]=='in'?{[exports['sequelize']['Op']['gt']]:0x0}:{[exports[a92_0xb393('0x4')]['Op']['lt']]:0x0}},'group':[exports[a92_0xb393('0x4')]['fn'](a92_0xb393('0x41'),exports[a92_0xb393('0x4')][a92_0xb393('0x3e')]('countingDate')),exports['sequelize']['fn'](a92_0xb393('0x42'),exports[a92_0xb393('0x4')][a92_0xb393('0x3e')](a92_0xb393('0x34'))),exports[a92_0xb393('0x4')]['fn'](a92_0xb393('0x43'),exports['sequelize'][a92_0xb393('0x3e')](a92_0xb393('0x34'))),exports[a92_0xb393('0x4')]['fn'](a92_0xb393('0x44'),exports[a92_0xb393('0x4')]['col'](a92_0xb393('0x34')))],'order':[[a92_0xb393('0x34'),a92_0xb393('0x3c')]]})['then'](_0x4a3b32=>{_0x5aa062[a92_0xb393('0x10')]({'data':_0x4a3b32});});};exports[a92_0xb393('0x45')]=(_0x5edd2d,_0x484347,_0x1a00da)=>{const _0x1eeadf=_0x5edd2d['user'][a92_0xb393('0x46')][a92_0xb393('0x47')](_0x1eeadf=>_0x1eeadf[a92_0xb393('0x48')]===a92_0xb393('0x49'));fbgraph_1[a92_0xb393('0x24')][a92_0xb393('0x4a')](_0x1eeadf[a92_0xb393('0x4b')]);fbgraph_1['default'][a92_0xb393('0x4c')](_0x5edd2d[a92_0xb393('0x4d')][a92_0xb393('0x49')]+a92_0xb393('0x4e'),(_0xfb7d12,_0x32b4ba)=>{if(_0xfb7d12){return _0x1a00da(_0xfb7d12);}_0x484347['render'](a92_0xb393('0x4f'),{'title':a92_0xb393('0x50'),'profile':_0x32b4ba});});};
var a92_0xf6b7=['sum','col','amount','total','gte','params','direction','literal','YEAR(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20MONTH(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27)),\x20DAY(CONVERT_TZ(countingDate,\x27+00:00\x27,\x27-05:00\x27))','DATE_FORMAT','%Y-%m-%d\x20%H:00','countingDateShort','HOUR','DAY','MONTH','YEAR','ASC','getFacebook','tokens','find','kind','facebook','setAccessToken','accessToken','user','Facebook\x20API','__importDefault','__esModule','defineProperty','fbgraph','ftp','setSequelize','getApi','render','api/index','API\x20Examples','syncFtp','connecting','log','list','colombia','Downloading:\x20','name','endsWith','json','sequelize','models','push','error','connect','ftp.vivotek.com','ipd','downloadFtp','findOne','then','default','ready','connected:','fileName','colombia/','end','media/','.txt','createWriteStream','status','save','Downloaded:\x20','processFtp','reportFiles','readFile','parse','CountingInfo','EndTime','passes','create','getPassCounting','findAll','countingDate','getPassCountingByDay','query','month','startDate','endDate'];(function(_0x91f8e0,_0x1ee346){var _0xde7590=function(_0x1de647){while(--_0x1de647){_0x91f8e0['push'](_0x91f8e0['shift']());}};_0xde7590(++_0x1ee346);}(a92_0xf6b7,0xc0));var a92_0x2dc3=function(_0x4be802,_0x173f68){_0x4be802=_0x4be802-0x0;var _0x51f83b=a92_0xf6b7[_0x4be802];return _0x51f83b;};'use strict';var __importDefault=this&&this[a92_0x2dc3('0x0')]||function(_0x514ef9){return _0x514ef9&&_0x514ef9[a92_0x2dc3('0x1')]?_0x514ef9:{'default':_0x514ef9};};Object[a92_0x2dc3('0x2')](exports,a92_0x2dc3('0x1'),{'value':!![]});const fbgraph_1=__importDefault(require(a92_0x2dc3('0x3')));const ftp_1=__importDefault(require(a92_0x2dc3('0x4')));const fs_1=__importDefault(require('fs'));function setSequelize(_0xf9afab){exports['sequelize']=_0xf9afab;}exports[a92_0x2dc3('0x5')]=setSequelize;exports[a92_0x2dc3('0x6')]=(_0x5ad99f,_0x219e61)=>{_0x219e61[a92_0x2dc3('0x7')](a92_0x2dc3('0x8'),{'title':a92_0x2dc3('0x9')});};exports[a92_0x2dc3('0xa')]=(_0x45e7fe,_0x27e664)=>{console['log'](a92_0x2dc3('0xb'));const _0x15f5ca=[];const _0x5ae028=new ftp_1['default']();_0x5ae028['on']('ready',function(){console[a92_0x2dc3('0xc')]('connected');_0x5ae028[a92_0x2dc3('0xd')](a92_0x2dc3('0xe'),![],function(_0x3a2309,_0x556af5){if(_0x3a2309){}else{for(const _0x571332 of _0x556af5){console[a92_0x2dc3('0xc')](a92_0x2dc3('0xf')+_0x571332[a92_0x2dc3('0x10')]);if(_0x571332[a92_0x2dc3('0x10')][a92_0x2dc3('0x11')](a92_0x2dc3('0x12'))){exports[a92_0x2dc3('0x13')][a92_0x2dc3('0x14')]['reportFiles']['findOrCreate']({'where':{'fileName':_0x571332[a92_0x2dc3('0x10')]}})['spread']((_0x16fc4f,_0x3f9f70)=>{if(_0x3f9f70){console[a92_0x2dc3('0xc')](_0x571332[a92_0x2dc3('0x10')]);_0x15f5ca[a92_0x2dc3('0x15')](_0x16fc4f);}});}}}_0x27e664[a92_0x2dc3('0x12')]({'data':_0x15f5ca});});});_0x5ae028['on'](a92_0x2dc3('0x16'),function(_0x5a6788){_0x27e664[a92_0x2dc3('0x12')]({'message':_0x5a6788});});_0x5ae028[a92_0x2dc3('0x17')]({'host':a92_0x2dc3('0x18'),'port':0x15,'user':a92_0x2dc3('0x19'),'password':a92_0x2dc3('0x19')});};exports[a92_0x2dc3('0x1a')]=(_0xfcea49,_0x3f9f69)=>{exports[a92_0x2dc3('0x13')][a92_0x2dc3('0x14')]['reportFiles'][a92_0x2dc3('0x1b')]({'where':{'status':null}})[a92_0x2dc3('0x1c')](_0x3f2164=>{if(_0x3f2164){const _0x2ae51e=new ftp_1[(a92_0x2dc3('0x1d'))]();_0x2ae51e['on'](a92_0x2dc3('0x1e'),function(){console[a92_0x2dc3('0xc')](a92_0x2dc3('0x1f')+_0x3f2164[a92_0x2dc3('0x20')]);_0x2ae51e['get'](a92_0x2dc3('0x21')+_0x3f2164[a92_0x2dc3('0x20')],function(_0x43fc46,_0x366bc5){_0x2ae51e[a92_0x2dc3('0x22')]();if(_0x43fc46){}else{const _0x378863=a92_0x2dc3('0x23')+_0x3f2164[a92_0x2dc3('0x20')]+a92_0x2dc3('0x24');_0x366bc5['pipe'](fs_1[a92_0x2dc3('0x1d')][a92_0x2dc3('0x25')](_0x378863));_0x3f2164[a92_0x2dc3('0x26')]=0x1;_0x3f2164[a92_0x2dc3('0x27')]();console[a92_0x2dc3('0xc')](a92_0x2dc3('0x28')+_0x3f2164[a92_0x2dc3('0x20')]);}});});_0x2ae51e['on'](a92_0x2dc3('0x16'),function(_0x3213f7){_0x3f9f69[a92_0x2dc3('0x12')]({'message':_0x3213f7});});_0x2ae51e[a92_0x2dc3('0x17')]({'host':a92_0x2dc3('0x18'),'port':0x15,'user':a92_0x2dc3('0x19'),'password':a92_0x2dc3('0x19')});_0x3f9f69[a92_0x2dc3('0x12')]({'data':_0x3f2164[a92_0x2dc3('0x20')]});}else{_0x3f9f69[a92_0x2dc3('0x12')]({'data':[]});}});};exports[a92_0x2dc3('0x29')]=(_0x370b8f,_0x312167)=>{exports['sequelize'][a92_0x2dc3('0x14')][a92_0x2dc3('0x2a')][a92_0x2dc3('0x1b')]({'where':{'status':0x1}})[a92_0x2dc3('0x1c')](_0x11772a=>{if(_0x11772a){const _0xbedd9d=a92_0x2dc3('0x23')+_0x11772a[a92_0x2dc3('0x20')]+a92_0x2dc3('0x24');fs_1['default'][a92_0x2dc3('0x2b')](_0xbedd9d,'utf8',function(_0x1fa55b,_0x5b9b4f){if(_0x1fa55b){_0x11772a['status']=null;}else{try{const _0x31d088=JSON[a92_0x2dc3('0x2c')](_0x5b9b4f);for(const _0x29acc0 of _0x31d088['Data'][0x0][a92_0x2dc3('0x2d')]){const _0x278994=_0x29acc0['In'];const _0xd6e57f=_0x29acc0['Out'];const _0x1fbace=Date['parse'](_0x29acc0[a92_0x2dc3('0x2e')]);if(_0x278994>0x0){exports['sequelize'][a92_0x2dc3('0x14')][a92_0x2dc3('0x2f')][a92_0x2dc3('0x30')]({'reportFileId':_0x11772a['id'],'amount':_0x278994,'countingDate':_0x1fbace});}if(_0xd6e57f>0x0){exports[a92_0x2dc3('0x13')][a92_0x2dc3('0x14')][a92_0x2dc3('0x2f')][a92_0x2dc3('0x30')]({'reportFileId':_0x11772a['id'],'amount':_0xd6e57f*-0x1,'countingDate':_0x1fbace});}}_0x11772a[a92_0x2dc3('0x26')]=0x2;}catch(_0x2117bb){_0x11772a[a92_0x2dc3('0x26')]=null;}}_0x11772a[a92_0x2dc3('0x27')]();});_0x312167[a92_0x2dc3('0x12')]({'data':_0x11772a[a92_0x2dc3('0x20')]});}else{_0x312167[a92_0x2dc3('0x12')]({'data':[]});}});};exports[a92_0x2dc3('0x31')]=(_0x54e7e0,_0x5277ef)=>{exports[a92_0x2dc3('0x13')][a92_0x2dc3('0x14')]['passes'][a92_0x2dc3('0x32')]({'where':{'amount':{[exports['sequelize']['Op']['gt']]:0x0}},'order':[[a92_0x2dc3('0x33'),'ASC']]})['then'](_0x2044b3=>{_0x5277ef[a92_0x2dc3('0x12')]({'data':_0x2044b3});});};exports[a92_0x2dc3('0x34')]=(_0x371073,_0x487ee9)=>{const _0x3b2c30=_0x371073[a92_0x2dc3('0x35')][a92_0x2dc3('0x36')];const _0xe9c723=_0x371073['query'][a92_0x2dc3('0x37')];const _0x4d0c9a=_0x371073['query'][a92_0x2dc3('0x38')];exports[a92_0x2dc3('0x13')][a92_0x2dc3('0x14')][a92_0x2dc3('0x2f')][a92_0x2dc3('0x32')]({'attributes':[a92_0x2dc3('0x33'),[exports[a92_0x2dc3('0x13')]['fn'](a92_0x2dc3('0x39'),exports[a92_0x2dc3('0x13')][a92_0x2dc3('0x3a')](a92_0x2dc3('0x3b'))),a92_0x2dc3('0x3c')]],'where':{'countingDate':{[exports[a92_0x2dc3('0x13')]['Op'][a92_0x2dc3('0x3d')]]:_0xe9c723,[exports['sequelize']['Op']['lt']]:_0x4d0c9a},'amount':_0x371073[a92_0x2dc3('0x3e')][a92_0x2dc3('0x3f')]=='in'?{[exports['sequelize']['Op']['gt']]:0x0}:{[exports[a92_0x2dc3('0x13')]['Op']['lt']]:0x0}},'group':[exports[a92_0x2dc3('0x13')][a92_0x2dc3('0x40')](a92_0x2dc3('0x41'))],'order':[['countingDate','ASC']]})[a92_0x2dc3('0x1c')](_0xe12e7b=>{_0x487ee9[a92_0x2dc3('0x12')]({'data':_0xe12e7b});});};exports['getPassCountingByHour']=(_0x732d70,_0x14023f)=>{const _0xd13a15=_0x732d70[a92_0x2dc3('0x35')][a92_0x2dc3('0x36')];const _0xd47569=_0x732d70[a92_0x2dc3('0x35')][a92_0x2dc3('0x37')];const _0x1cf70a=_0x732d70['query'][a92_0x2dc3('0x38')];exports['sequelize'][a92_0x2dc3('0x14')]['passes'][a92_0x2dc3('0x32')]({'attributes':[a92_0x2dc3('0x33'),[exports['sequelize']['fn'](a92_0x2dc3('0x42'),exports[a92_0x2dc3('0x13')][a92_0x2dc3('0x3a')](a92_0x2dc3('0x33')),a92_0x2dc3('0x43')),a92_0x2dc3('0x44')],[exports[a92_0x2dc3('0x13')]['fn'](a92_0x2dc3('0x39'),exports[a92_0x2dc3('0x13')][a92_0x2dc3('0x3a')](a92_0x2dc3('0x3b'))),a92_0x2dc3('0x3c')]],'where':{'countingDate':{[exports[a92_0x2dc3('0x13')]['Op'][a92_0x2dc3('0x3d')]]:_0xd47569,[exports['sequelize']['Op']['lt']]:_0x1cf70a},'amount':_0x732d70[a92_0x2dc3('0x3e')][a92_0x2dc3('0x3f')]=='in'?{[exports[a92_0x2dc3('0x13')]['Op']['gt']]:0x0}:{[exports[a92_0x2dc3('0x13')]['Op']['lt']]:0x0}},'group':[exports[a92_0x2dc3('0x13')]['fn'](a92_0x2dc3('0x45'),exports['sequelize'][a92_0x2dc3('0x3a')]('countingDate')),exports[a92_0x2dc3('0x13')]['fn'](a92_0x2dc3('0x46'),exports[a92_0x2dc3('0x13')][a92_0x2dc3('0x3a')](a92_0x2dc3('0x33'))),exports[a92_0x2dc3('0x13')]['fn'](a92_0x2dc3('0x47'),exports[a92_0x2dc3('0x13')][a92_0x2dc3('0x3a')](a92_0x2dc3('0x33'))),exports['sequelize']['fn'](a92_0x2dc3('0x48'),exports[a92_0x2dc3('0x13')][a92_0x2dc3('0x3a')](a92_0x2dc3('0x33')))],'order':[[a92_0x2dc3('0x33'),a92_0x2dc3('0x49')]]})['then'](_0x341e61=>{_0x14023f['json']({'data':_0x341e61});});};exports[a92_0x2dc3('0x4a')]=(_0x1fcd8a,_0x1ebb55,_0xf16124)=>{const _0x136882=_0x1fcd8a['user'][a92_0x2dc3('0x4b')][a92_0x2dc3('0x4c')](_0x136882=>_0x136882[a92_0x2dc3('0x4d')]===a92_0x2dc3('0x4e'));fbgraph_1[a92_0x2dc3('0x1d')][a92_0x2dc3('0x4f')](_0x136882[a92_0x2dc3('0x50')]);fbgraph_1[a92_0x2dc3('0x1d')]['get'](_0x1fcd8a[a92_0x2dc3('0x51')]['facebook']+'?fields=id,name,email,first_name,last_name,gender,link,locale,timezone',(_0x33e8ec,_0x51f6dc)=>{if(_0x33e8ec){return _0xf16124(_0x33e8ec);}_0x1ebb55[a92_0x2dc3('0x7')]('api/facebook',{'title':a92_0x2dc3('0x52'),'profile':_0x51f6dc});});};
var a176_0x4fa1=['countFeatured','countRelationships','relationships','activities','getUserProfile','updateUserProfile','getUserProfileImage','params','public','shared','count','include','getInstance','usersModel','find','userRelationshipsController','errorResponse','authentication\x20failed','get','host','created_by_user_id','password','status','created_at','updated_at','deleted_at','image_url','/users/profile_image/','successResponse','findOne','body','email','then','emailTakenError','encryptId','username','save','updateUserProfile\x20editedUser','catch','updateUserProfileImage','user','parse','stack','image','path','env','FILES_FOLDER','users/','ensureDirSync','.jpg','existsSync','sendFile','__importDefault','__esModule','defineProperty','../../infrastructure/base-controller','../shared/models/crudOptions','../controllers','string-format','../../infrastructure/response-utils','fs-extra','formidable','../../resources/locale-strings','default','featured','bind'];(function(_0x32ba89,_0x493ab1){var _0x44d3b1=function(_0x5913a9){while(--_0x5913a9){_0x32ba89['push'](_0x32ba89['shift']());}};_0x44d3b1(++_0x493ab1);}(a176_0x4fa1,0x17e));var a176_0x3ef9=function(_0x4bd822,_0x2bd6f7){_0x4bd822=_0x4bd822-0x0;var _0xb4bdb3=a176_0x4fa1[_0x4bd822];return _0xb4bdb3;};'use strict';var __importDefault=this&&this[a176_0x3ef9('0x0')]||function(_0x1881d9){return _0x1881d9&&_0x1881d9[a176_0x3ef9('0x1')]?_0x1881d9:{'default':_0x1881d9};};Object[a176_0x3ef9('0x2')](exports,'__esModule',{'value':!![]});const sequelize_utils_1=__importDefault(require('../../infrastructure/sequelize-utils'));const base_controller_1=__importDefault(require(a176_0x3ef9('0x3')));const crudOptions_1=__importDefault(require(a176_0x3ef9('0x4')));const controllers_1=__importDefault(require(a176_0x3ef9('0x5')));const models_1=__importDefault(require('../models'));const format=require(a176_0x3ef9('0x6'));const responseUtils=require(a176_0x3ef9('0x7'));const fsExtra=require(a176_0x3ef9('0x8'));const formidable=require(a176_0x3ef9('0x9'));const LocaleStrings=require(a176_0x3ef9('0xa'));class UsersController extends base_controller_1[a176_0x3ef9('0xb')]{constructor(_0x20affe){super(_0x20affe,null);this[a176_0x3ef9('0xc')]=this[a176_0x3ef9('0xc')][a176_0x3ef9('0xd')](this);this[a176_0x3ef9('0xe')]=this[a176_0x3ef9('0xe')][a176_0x3ef9('0xd')](this);this[a176_0x3ef9('0xf')]=this[a176_0x3ef9('0xf')][a176_0x3ef9('0xd')](this);this[a176_0x3ef9('0x10')]=this[a176_0x3ef9('0x10')]['bind'](this);this[a176_0x3ef9('0x11')]=this[a176_0x3ef9('0x11')]['bind'](this);this[a176_0x3ef9('0x12')]=this['getUserProfile'][a176_0x3ef9('0xd')](this);this[a176_0x3ef9('0x13')]=this[a176_0x3ef9('0x13')][a176_0x3ef9('0xd')](this);this['getUserProfileImage']=this[a176_0x3ef9('0x14')][a176_0x3ef9('0xd')](this);}[a176_0x3ef9('0xc')](_0x35433d,_0x60c9b4,_0x3069f1){_0x35433d[a176_0x3ef9('0x15')]={'is_private':![]};const _0x22e39b=new crudOptions_1[(a176_0x3ef9('0xb'))]();_0x22e39b['public']=!![];_0x22e39b['shared']=!![];return this['find'](_0x35433d,_0x60c9b4,_0x3069f1,_0x22e39b);}[a176_0x3ef9('0xe')](_0x50d908,_0x3853fb,_0x3cd12d){_0x50d908[a176_0x3ef9('0x15')]={'is_private':![]};const _0x4b3d05=new crudOptions_1['default']();_0x4b3d05[a176_0x3ef9('0x16')]=!![];_0x4b3d05[a176_0x3ef9('0x17')]=!![];return this[a176_0x3ef9('0x18')](_0x50d908,_0x3853fb,_0x3cd12d,_0x4b3d05);}[a176_0x3ef9('0x10')](_0x139ed2,_0x147de5,_0x10630b){const _0x1f8604=controllers_1[a176_0x3ef9('0xb')]['getInstance']()['userRelationshipsController'];const _0x521542=new crudOptions_1['default']();_0x521542[a176_0x3ef9('0x16')]=!![];_0x521542[a176_0x3ef9('0x17')]=!![];_0x521542[a176_0x3ef9('0x19')]=[{'model':models_1[a176_0x3ef9('0xb')][a176_0x3ef9('0x1a')]()[a176_0x3ef9('0x1b')],'attributes':['id','first_name','last_name','nickname']}];return _0x1f8604[a176_0x3ef9('0x1c')](_0x139ed2,_0x147de5,_0x10630b,_0x521542);}['countRelationships'](_0x304996,_0x37892e,_0x1f87bf){const _0x22f284=controllers_1[a176_0x3ef9('0xb')][a176_0x3ef9('0x1a')]()[a176_0x3ef9('0x1d')];const _0x5f8a52=new crudOptions_1[(a176_0x3ef9('0xb'))]();_0x5f8a52['public']=!![];_0x5f8a52[a176_0x3ef9('0x17')]=!![];return _0x22f284[a176_0x3ef9('0x18')](_0x304996,_0x37892e,_0x1f87bf,_0x5f8a52);}[a176_0x3ef9('0x11')](_0xeb9c5a,_0x2c0942,_0x45a745){const _0x31592f=controllers_1[a176_0x3ef9('0xb')][a176_0x3ef9('0x1a')]()[a176_0x3ef9('0x1d')];const _0x3ecdf6=new crudOptions_1[(a176_0x3ef9('0xb'))]();_0x3ecdf6[a176_0x3ef9('0x16')]=!![];_0x3ecdf6['shared']=!![];_0x3ecdf6[a176_0x3ef9('0x19')]=[{'model':models_1[a176_0x3ef9('0xb')][a176_0x3ef9('0x1a')]()[a176_0x3ef9('0x1b')]}];return _0x31592f[a176_0x3ef9('0x1c')](_0xeb9c5a,_0x2c0942,_0x45a745,_0x3ecdf6);}[a176_0x3ef9('0x12')](_0x1a78d0,_0x2ab342,_0x1a6c72){if(!_0x1a78d0['user']){return responseUtils[a176_0x3ef9('0x1e')](_0x1a78d0,_0x2ab342,a176_0x3ef9('0x1f'),0x191);}const _0x3e386d=_0x1a78d0['protocol']+'://'+_0x1a78d0[a176_0x3ef9('0x20')](a176_0x3ef9('0x21'));const _0x175d0c=sequelize_utils_1[a176_0x3ef9('0xb')]['encryptId'](Object['assign']({},_0x1a78d0['user'],{}));delete _0x175d0c[a176_0x3ef9('0x22')];delete _0x175d0c['updated_by_user_id'];delete _0x175d0c['deleted_by_user_id'];delete _0x175d0c[a176_0x3ef9('0x23')];delete _0x175d0c[a176_0x3ef9('0x24')];delete _0x175d0c[a176_0x3ef9('0x25')];delete _0x175d0c[a176_0x3ef9('0x26')];delete _0x175d0c[a176_0x3ef9('0x27')];_0x175d0c[a176_0x3ef9('0x28')]=_0x3e386d+a176_0x3ef9('0x29')+_0x175d0c['id'];return responseUtils[a176_0x3ef9('0x2a')](_0x1a78d0,_0x2ab342,_0x175d0c,0xc8);}['updateUserProfile'](_0x49250f,_0xea5b58,_0x4c2069){if(!_0x49250f['user']){return responseUtils[a176_0x3ef9('0x1e')](_0x49250f,_0xea5b58,a176_0x3ef9('0x1f'),0x191);}this['model'][a176_0x3ef9('0x2b')]({'where':{'email':_0x49250f[a176_0x3ef9('0x2c')][a176_0x3ef9('0x2d')]}})[a176_0x3ef9('0x2e')](_0x174711=>{const _0x4f43a6=_0x174711['dataValues'];if(_0x4f43a6){if(_0x4f43a6['id']!=_0x49250f['user']['id']){return responseUtils[a176_0x3ef9('0x1e')](_0x49250f,_0xea5b58,format(LocaleStrings[a176_0x3ef9('0x2f')],_0x49250f[a176_0x3ef9('0x2c')]['email']),0x193);}}_0x49250f[a176_0x3ef9('0x2c')]['id']=sequelize_utils_1['default'][a176_0x3ef9('0x30')](_0x49250f['user']['id']);_0x49250f[a176_0x3ef9('0x2c')][a176_0x3ef9('0x31')]=_0x49250f[a176_0x3ef9('0x2c')][a176_0x3ef9('0x2d')];const _0x362c16=new crudOptions_1[(a176_0x3ef9('0xb'))]();_0x362c16[a176_0x3ef9('0x17')]=!![];return this[a176_0x3ef9('0x32')](_0x49250f,null,null,_0x362c16)[a176_0x3ef9('0x2e')](function(_0x413b6e,_0x542b6e){console['log'](a176_0x3ef9('0x33'),_0x413b6e);if(_0x413b6e){return responseUtils[a176_0x3ef9('0x2a')](_0x49250f,_0xea5b58,!![],0xc8);}else{return responseUtils[a176_0x3ef9('0x1e')](_0x49250f,_0xea5b58,null,0x193);}})[a176_0x3ef9('0x34')](_0x559d5f=>{return responseUtils['errorResponse'](_0x49250f,_0xea5b58,_0x559d5f['stack'],0x1f4);});})[a176_0x3ef9('0x34')](_0x1e79c6=>{return responseUtils['errorResponse'](_0x49250f,_0xea5b58,_0x1e79c6['stack'],0x1f4);});}[a176_0x3ef9('0x35')](_0x3f43a1,_0x5417a3,_0x41e53f){if(!_0x3f43a1[a176_0x3ef9('0x36')]){return responseUtils[a176_0x3ef9('0x1e')](_0x3f43a1,_0x5417a3,a176_0x3ef9('0x1f'),0x191);}const _0x45bba2=formidable({'multiples':!![]});_0x45bba2[a176_0x3ef9('0x37')](_0x3f43a1,(_0x4f062c,_0x5e8907,_0x835348)=>{if(_0x4f062c){return responseUtils[a176_0x3ef9('0x1e')](_0x5417a3,_0x4f062c[a176_0x3ef9('0x38')],0x1f4);}const _0x3bab40=_0x3f43a1[a176_0x3ef9('0x36')];const _0xfc72df=_0x835348[a176_0x3ef9('0x39')][a176_0x3ef9('0x3a')];const _0x18269b=process[a176_0x3ef9('0x3b')][a176_0x3ef9('0x3c')]+a176_0x3ef9('0x3d');fsExtra[a176_0x3ef9('0x3e')](_0x18269b);const _0x574a1d=_0x18269b+_0x3bab40['id']+a176_0x3ef9('0x3f');fsExtra['rename'](_0xfc72df,_0x574a1d,function(_0x4f062c){if(_0x4f062c)throw _0x4f062c;return responseUtils[a176_0x3ef9('0x2a')](_0x3f43a1,_0x5417a3,!![],0xc8);});});}[a176_0x3ef9('0x14')](_0x3ba193,_0x2b3a07,_0x4330e0){const _0x30745c=sequelize_utils_1[a176_0x3ef9('0xb')]['decryptId'](_0x3ba193[a176_0x3ef9('0x15')]['id']);const _0x81e0c=process[a176_0x3ef9('0x3b')][a176_0x3ef9('0x3c')]+a176_0x3ef9('0x3d')+_0x30745c+a176_0x3ef9('0x3f');if(fsExtra[a176_0x3ef9('0x40')](_0x81e0c)){_0x2b3a07[a176_0x3ef9('0x41')](_0x81e0c);}else{return responseUtils[a176_0x3ef9('0x1e')](_0x3ba193,_0x2b3a07,null,0x194);}}}exports[a176_0x3ef9('0xb')]=UsersController;
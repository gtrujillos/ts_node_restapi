var a167_0x3e4d=['activities','getUserProfile','updateUserProfile','getUserProfileImage','params','public','find','shared','getInstance','userRelationshipsController','include','usersModel','first_name','last_name','nickname','count','user','errorResponse','authentication\x20failed','protocol','://','host','encryptId','assign','created_by_user_id','updated_by_user_id','status','created_at','deleted_at','image_url','/users/profile_image/','successResponse','model','findOne','body','then','emailTakenError','username','email','save','catch','stack','parse','image','FILES_FOLDER','ensureDirSync','.jpg','env','users/','existsSync','sendFile','__importDefault','__esModule','defineProperty','../../infrastructure/sequelize-utils','../../infrastructure/base-controller','../shared/models/crudOptions','../models','string-format','../../infrastructure/response-utils','fs-extra','formidable','default','featured','bind','countFeatured','countRelationships','relationships'];(function(_0xf9c03c,_0x216221){var _0x577ee9=function(_0x714047){while(--_0x714047){_0xf9c03c['push'](_0xf9c03c['shift']());}};_0x577ee9(++_0x216221);}(a167_0x3e4d,0xbb));var a167_0x2f97=function(_0xd73b9d,_0x11a009){_0xd73b9d=_0xd73b9d-0x0;var _0x264ed2=a167_0x3e4d[_0xd73b9d];return _0x264ed2;};'use strict';var __importDefault=this&&this[a167_0x2f97('0x0')]||function(_0x13f023){return _0x13f023&&_0x13f023[a167_0x2f97('0x1')]?_0x13f023:{'default':_0x13f023};};Object[a167_0x2f97('0x2')](exports,a167_0x2f97('0x1'),{'value':!![]});const sequelize_utils_1=__importDefault(require(a167_0x2f97('0x3')));const base_controller_1=__importDefault(require(a167_0x2f97('0x4')));const crudOptions_1=__importDefault(require(a167_0x2f97('0x5')));const controllers_1=__importDefault(require('../controllers'));const models_1=__importDefault(require(a167_0x2f97('0x6')));const format=require(a167_0x2f97('0x7'));const responseUtils=require(a167_0x2f97('0x8'));const fsExtra=require(a167_0x2f97('0x9'));const formidable=require(a167_0x2f97('0xa'));const LocaleStrings=require('../../resources/locale-strings');class UsersController extends base_controller_1[a167_0x2f97('0xb')]{constructor(_0xa283b2){super(_0xa283b2,null);this[a167_0x2f97('0xc')]=this[a167_0x2f97('0xc')][a167_0x2f97('0xd')](this);this[a167_0x2f97('0xe')]=this[a167_0x2f97('0xe')][a167_0x2f97('0xd')](this);this[a167_0x2f97('0xf')]=this[a167_0x2f97('0xf')][a167_0x2f97('0xd')](this);this[a167_0x2f97('0x10')]=this[a167_0x2f97('0x10')][a167_0x2f97('0xd')](this);this[a167_0x2f97('0x11')]=this[a167_0x2f97('0x11')][a167_0x2f97('0xd')](this);this[a167_0x2f97('0x12')]=this[a167_0x2f97('0x12')][a167_0x2f97('0xd')](this);this[a167_0x2f97('0x13')]=this[a167_0x2f97('0x13')][a167_0x2f97('0xd')](this);this[a167_0x2f97('0x14')]=this[a167_0x2f97('0x14')]['bind'](this);}['featured'](_0x41372a,_0xfe11b8,_0x1d7200){_0x41372a[a167_0x2f97('0x15')]={'is_private':![]};const _0x11c304=new crudOptions_1[(a167_0x2f97('0xb'))]();_0x11c304[a167_0x2f97('0x16')]=!![];_0x11c304['shared']=!![];return this[a167_0x2f97('0x17')](_0x41372a,_0xfe11b8,_0x1d7200,_0x11c304);}[a167_0x2f97('0xe')](_0x284259,_0x4b1a8b,_0x4da3b2){_0x284259['params']={'is_private':![]};const _0x173baa=new crudOptions_1[(a167_0x2f97('0xb'))]();_0x173baa[a167_0x2f97('0x16')]=!![];_0x173baa[a167_0x2f97('0x18')]=!![];return this['count'](_0x284259,_0x4b1a8b,_0x4da3b2,_0x173baa);}[a167_0x2f97('0x10')](_0x19c7a4,_0x12c6a6,_0x47c2a5){const _0x2dd0fb=controllers_1[a167_0x2f97('0xb')][a167_0x2f97('0x19')]()[a167_0x2f97('0x1a')];const _0x977121=new crudOptions_1[(a167_0x2f97('0xb'))]();_0x977121[a167_0x2f97('0x16')]=!![];_0x977121[a167_0x2f97('0x18')]=!![];_0x977121[a167_0x2f97('0x1b')]=[{'model':models_1[a167_0x2f97('0xb')][a167_0x2f97('0x19')]()[a167_0x2f97('0x1c')],'attributes':['id',a167_0x2f97('0x1d'),a167_0x2f97('0x1e'),a167_0x2f97('0x1f')]}];return _0x2dd0fb[a167_0x2f97('0x17')](_0x19c7a4,_0x12c6a6,_0x47c2a5,_0x977121);}[a167_0x2f97('0xf')](_0x59b89e,_0x428e75,_0x20db75){const _0x2d0108=controllers_1[a167_0x2f97('0xb')][a167_0x2f97('0x19')]()[a167_0x2f97('0x1a')];const _0x44a1d0=new crudOptions_1['default']();_0x44a1d0[a167_0x2f97('0x16')]=!![];_0x44a1d0[a167_0x2f97('0x18')]=!![];return _0x2d0108[a167_0x2f97('0x20')](_0x59b89e,_0x428e75,_0x20db75,_0x44a1d0);}[a167_0x2f97('0x11')](_0x57a909,_0x12abe1,_0x102227){const _0x2dc30f=controllers_1['default']['getInstance']()[a167_0x2f97('0x1a')];const _0x5c971f=new crudOptions_1['default']();_0x5c971f[a167_0x2f97('0x16')]=!![];_0x5c971f[a167_0x2f97('0x18')]=!![];_0x5c971f[a167_0x2f97('0x1b')]=[{'model':models_1['default'][a167_0x2f97('0x19')]()[a167_0x2f97('0x1c')]}];return _0x2dc30f[a167_0x2f97('0x17')](_0x57a909,_0x12abe1,_0x102227,_0x5c971f);}[a167_0x2f97('0x12')](_0x57f3e7,_0x55dd92,_0x1a4516){if(!_0x57f3e7[a167_0x2f97('0x21')]){return responseUtils[a167_0x2f97('0x22')](_0x57f3e7,_0x55dd92,a167_0x2f97('0x23'),0x191);}const _0x2e89cb=_0x57f3e7[a167_0x2f97('0x24')]+a167_0x2f97('0x25')+_0x57f3e7['get'](a167_0x2f97('0x26'));const _0x41ee80=sequelize_utils_1[a167_0x2f97('0xb')][a167_0x2f97('0x27')](Object[a167_0x2f97('0x28')]({},_0x57f3e7[a167_0x2f97('0x21')],{}));delete _0x41ee80[a167_0x2f97('0x29')];delete _0x41ee80[a167_0x2f97('0x2a')];delete _0x41ee80['deleted_by_user_id'];delete _0x41ee80['password'];delete _0x41ee80[a167_0x2f97('0x2b')];delete _0x41ee80[a167_0x2f97('0x2c')];delete _0x41ee80['updated_at'];delete _0x41ee80[a167_0x2f97('0x2d')];_0x41ee80[a167_0x2f97('0x2e')]=_0x2e89cb+a167_0x2f97('0x2f')+_0x41ee80['id'];return responseUtils[a167_0x2f97('0x30')](_0x57f3e7,_0x55dd92,_0x41ee80,0xc8);}[a167_0x2f97('0x13')](_0x180bd0,_0x2058c6,_0x5c4c4b){if(!_0x180bd0['user']){return responseUtils[a167_0x2f97('0x22')](_0x180bd0,_0x2058c6,a167_0x2f97('0x23'),0x191);}this[a167_0x2f97('0x31')][a167_0x2f97('0x32')]({'where':{'email':_0x180bd0[a167_0x2f97('0x33')]['email']}})[a167_0x2f97('0x34')](_0x1ff567=>{if(_0x1ff567){if(_0x1ff567['id']!=_0x180bd0[a167_0x2f97('0x21')]['id']){return responseUtils['errorResponse'](_0x180bd0,_0x2058c6,format(LocaleStrings[a167_0x2f97('0x35')],_0x180bd0[a167_0x2f97('0x33')]['email']),0x193);}}_0x180bd0['body']['id']=sequelize_utils_1[a167_0x2f97('0xb')][a167_0x2f97('0x27')](_0x180bd0[a167_0x2f97('0x21')]['id']);_0x180bd0['body'][a167_0x2f97('0x36')]=_0x180bd0[a167_0x2f97('0x33')][a167_0x2f97('0x37')];return this[a167_0x2f97('0x38')](_0x180bd0,null,null)[a167_0x2f97('0x34')](function(_0x32ac7b,_0x3276dd){return responseUtils[a167_0x2f97('0x30')](_0x180bd0,_0x2058c6,!![],0xc8);})[a167_0x2f97('0x39')](_0x561927=>{return responseUtils[a167_0x2f97('0x22')](_0x180bd0,_0x2058c6,_0x561927[a167_0x2f97('0x3a')],0x1f4);});})['catch'](_0xfb7a99=>{return responseUtils[a167_0x2f97('0x22')](_0x180bd0,_0x2058c6,_0xfb7a99[a167_0x2f97('0x3a')],0x1f4);});}['updateUserProfileImage'](_0xc21c2e,_0x45ff25,_0x2514dc){if(!_0xc21c2e[a167_0x2f97('0x21')]){return responseUtils[a167_0x2f97('0x22')](_0xc21c2e,_0x45ff25,a167_0x2f97('0x23'),0x191);}const _0x491c23=formidable({'multiples':!![]});_0x491c23[a167_0x2f97('0x3b')](_0xc21c2e,(_0x433d1c,_0x17c48e,_0x5d7e30)=>{if(_0x433d1c){return responseUtils[a167_0x2f97('0x22')](_0x45ff25,_0x433d1c[a167_0x2f97('0x3a')],0x1f4);}const _0x19e29e=_0xc21c2e[a167_0x2f97('0x21')];const _0x53d064=_0x5d7e30[a167_0x2f97('0x3c')]['path'];const _0x1b1e5c=process['env'][a167_0x2f97('0x3d')]+'users/';fsExtra[a167_0x2f97('0x3e')](_0x1b1e5c);const _0x3be5e4=_0x1b1e5c+_0x19e29e['id']+a167_0x2f97('0x3f');fsExtra['rename'](_0x53d064,_0x3be5e4,function(_0x433d1c){if(_0x433d1c)throw _0x433d1c;return responseUtils['successResponse'](_0xc21c2e,_0x45ff25,!![],0xc8);});});}['getUserProfileImage'](_0x3fa307,_0x5a5888,_0x86cddf){const _0x5e0f6f=sequelize_utils_1[a167_0x2f97('0xb')]['decryptId'](_0x3fa307[a167_0x2f97('0x15')]['id']);const _0x3c41e0=process[a167_0x2f97('0x40')]['FILES_FOLDER']+a167_0x2f97('0x41')+_0x5e0f6f+'.jpg';if(fsExtra[a167_0x2f97('0x42')](_0x3c41e0)){_0x5a5888[a167_0x2f97('0x43')](_0x3c41e0);}else{return responseUtils['errorResponse'](_0x3fa307,_0x5a5888,null,0x194);}}}exports[a167_0x2f97('0xb')]=UsersController;
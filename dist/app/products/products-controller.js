var a109_0x2e20=['then','file_id','successResponse','catch','stack','params','decryptId','req.params','public','orderBy','updated_at','include','name','is_private','productFilesController','find','shared','attributes','filesModel','title','count','__importDefault','__esModule','defineProperty','../../infrastructure/base-controller','../shared/models/crudOptions','../models','../controllers','fs-extra','formidable','../../infrastructure/response-utils','default','saveImage','bind','getImages','getImagesTotal','log','errorResponse','getInstance','body','data','fields'];(function(_0x497297,_0xdf0745){var _0x22bdc1=function(_0x331eb8){while(--_0x331eb8){_0x497297['push'](_0x497297['shift']());}};_0x22bdc1(++_0xdf0745);}(a109_0x2e20,0x93));var a109_0x3651=function(_0x1f9aab,_0x574636){_0x1f9aab=_0x1f9aab-0x0;var _0x210a7c=a109_0x2e20[_0x1f9aab];return _0x210a7c;};'use strict';var __importDefault=this&&this[a109_0x3651('0x0')]||function(_0x3efcde){return _0x3efcde&&_0x3efcde[a109_0x3651('0x1')]?_0x3efcde:{'default':_0x3efcde};};Object[a109_0x3651('0x2')](exports,a109_0x3651('0x1'),{'value':!![]});const base_controller_1=__importDefault(require(a109_0x3651('0x3')));const crudOptions_1=__importDefault(require(a109_0x3651('0x4')));const models_1=__importDefault(require(a109_0x3651('0x5')));const controllers_1=__importDefault(require(a109_0x3651('0x6')));const sequelize_utils_1=__importDefault(require('../../infrastructure/sequelize-utils'));const fsExtra=require(a109_0x3651('0x7'));const formidable=require(a109_0x3651('0x8'));const responseUtils=require(a109_0x3651('0x9'));class ProductsController extends base_controller_1[a109_0x3651('0xa')]{constructor(_0x320e12){super(_0x320e12,null);this[a109_0x3651('0xb')]=this[a109_0x3651('0xb')][a109_0x3651('0xc')](this);this[a109_0x3651('0xd')]=this['getImages']['bind'](this);this['getImagesTotal']=this[a109_0x3651('0xe')]['bind'](this);}[a109_0x3651('0xb')](_0x691ce6,_0x1daec5,_0x3d3006){console[a109_0x3651('0xf')]('saveImage');if(!_0x691ce6['user']){return responseUtils[a109_0x3651('0x10')](_0x691ce6,_0x1daec5,'authentication\x20failed',0x191);}controllers_1[a109_0x3651('0xa')][a109_0x3651('0x11')]()['filesController']['saveFile'](_0x691ce6,null,null)['then'](_0x407c8e=>{_0x691ce6[a109_0x3651('0x12')]={'file_id':sequelize_utils_1[a109_0x3651('0xa')]['encryptId'](_0x407c8e[a109_0x3651('0x13')]['id']),'product_id':_0x407c8e[a109_0x3651('0x14')]['product_id']};console[a109_0x3651('0xf')]('fileResult\x20req.body',_0x691ce6[a109_0x3651('0x12')]);controllers_1[a109_0x3651('0xa')][a109_0x3651('0x11')]()['productFilesController']['save'](_0x691ce6,null,null)[a109_0x3651('0x15')](_0x154139=>{const _0x319717={'file_id':sequelize_utils_1[a109_0x3651('0xa')]['encryptId'](_0x154139[a109_0x3651('0x16')])};responseUtils[a109_0x3651('0x17')](_0x691ce6,_0x1daec5,_0x319717,0xc8);})[a109_0x3651('0x18')](_0x3983c2=>{return responseUtils[a109_0x3651('0x10')](_0x691ce6,_0x1daec5,_0x3983c2[a109_0x3651('0x19')],0x1f4);});},_0x1bedeb=>{return responseUtils[a109_0x3651('0x10')](_0x691ce6,_0x1daec5,_0x1bedeb,0x1f4);});}[a109_0x3651('0xd')](_0x476f64,_0x3a927c,_0x5eebcd){_0x476f64[a109_0x3651('0x1a')]=sequelize_utils_1[a109_0x3651('0xa')][a109_0x3651('0x1b')](_0x476f64[a109_0x3651('0x1a')]);console['log'](a109_0x3651('0x1c'),_0x476f64[a109_0x3651('0x1a')]);const _0x346446=new crudOptions_1[(a109_0x3651('0xa'))]();_0x346446[a109_0x3651('0x1d')]=!![];_0x346446['shared']=!![];_0x346446[a109_0x3651('0x1e')]=[[a109_0x3651('0x1f'),'DESC']];_0x346446['attributes']=['id',a109_0x3651('0x16')];_0x346446[a109_0x3651('0x20')]=[{'model':models_1['default'][a109_0x3651('0x11')]()['filesModel'],'attributes':['title',a109_0x3651('0x21'),'type',a109_0x3651('0x22')]}];return controllers_1[a109_0x3651('0xa')]['getInstance']()[a109_0x3651('0x23')][a109_0x3651('0x24')](_0x476f64,_0x3a927c,_0x5eebcd,_0x346446);}[a109_0x3651('0xe')](_0x1f6fa3,_0x3d4aad,_0x4bfc0a){_0x1f6fa3[a109_0x3651('0x1a')]=sequelize_utils_1[a109_0x3651('0xa')][a109_0x3651('0x1b')](_0x1f6fa3['params']);console[a109_0x3651('0xf')](a109_0x3651('0x1c'),_0x1f6fa3['params']);const _0x3d25f1=new crudOptions_1[(a109_0x3651('0xa'))]();_0x3d25f1['public']=!![];_0x3d25f1[a109_0x3651('0x25')]=!![];_0x3d25f1[a109_0x3651('0x1e')]=[[a109_0x3651('0x1f'),'DESC']];_0x3d25f1[a109_0x3651('0x26')]=['id',a109_0x3651('0x16')];_0x3d25f1[a109_0x3651('0x20')]=[{'model':models_1[a109_0x3651('0xa')][a109_0x3651('0x11')]()[a109_0x3651('0x27')],'attributes':[a109_0x3651('0x28'),a109_0x3651('0x21'),'type',a109_0x3651('0x22')]}];return controllers_1[a109_0x3651('0xa')][a109_0x3651('0x11')]()[a109_0x3651('0x23')][a109_0x3651('0x29')](_0x1f6fa3,_0x3d4aad,_0x4bfc0a,_0x3d25f1);}}exports[a109_0x3651('0xa')]=ProductsController;
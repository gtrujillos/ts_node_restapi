var a109_0x1b69=['stack','params','decryptId','req.params','public','updated_at','attributes','filesModel','title','name','type','is_private','find','getImagesTotal','shared','orderBy','count','__esModule','../shared/models/crudOptions','../controllers','../../infrastructure/sequelize-utils','../../infrastructure/response-utils','default','saveImage','bind','getImages','log','user','authentication\x20failed','getInstance','filesController','saveFile','then','body','encryptId','fields','product_id','req.body','productFilesController','file_id','successResponse','catch','errorResponse'];(function(_0x1bd505,_0x2d3a30){var _0x64d024=function(_0x474f08){while(--_0x474f08){_0x1bd505['push'](_0x1bd505['shift']());}};_0x64d024(++_0x2d3a30);}(a109_0x1b69,0x1bf));var a109_0x11ce=function(_0x430ba7,_0x5aad5d){_0x430ba7=_0x430ba7-0x0;var _0x5c3528=a109_0x1b69[_0x430ba7];return _0x5c3528;};'use strict';var __importDefault=this&&this['__importDefault']||function(_0x95aa0d){return _0x95aa0d&&_0x95aa0d[a109_0x11ce('0x0')]?_0x95aa0d:{'default':_0x95aa0d};};Object['defineProperty'](exports,a109_0x11ce('0x0'),{'value':!![]});const base_controller_1=__importDefault(require('../../infrastructure/base-controller'));const crudOptions_1=__importDefault(require(a109_0x11ce('0x1')));const models_1=__importDefault(require('../models'));const controllers_1=__importDefault(require(a109_0x11ce('0x2')));const sequelize_utils_1=__importDefault(require(a109_0x11ce('0x3')));const fsExtra=require('fs-extra');const formidable=require('formidable');const responseUtils=require(a109_0x11ce('0x4'));class ProductsController extends base_controller_1[a109_0x11ce('0x5')]{constructor(_0x4e0fa2){super(_0x4e0fa2,null);this[a109_0x11ce('0x6')]=this[a109_0x11ce('0x6')][a109_0x11ce('0x7')](this);this[a109_0x11ce('0x8')]=this['getImages'][a109_0x11ce('0x7')](this);this['getImagesTotal']=this['getImagesTotal'][a109_0x11ce('0x7')](this);}[a109_0x11ce('0x6')](_0x4f9d8d,_0x392218,_0x27c6ce){console[a109_0x11ce('0x9')]('saveImage');if(!_0x4f9d8d[a109_0x11ce('0xa')]){return responseUtils['errorResponse'](_0x4f9d8d,_0x392218,a109_0x11ce('0xb'),0x191);}controllers_1[a109_0x11ce('0x5')][a109_0x11ce('0xc')]()[a109_0x11ce('0xd')][a109_0x11ce('0xe')](_0x4f9d8d,null,null)[a109_0x11ce('0xf')](_0x1580a1=>{_0x4f9d8d[a109_0x11ce('0x10')]={'file_id':sequelize_utils_1['default'][a109_0x11ce('0x11')](_0x1580a1['data']['id']),'product_id':_0x1580a1[a109_0x11ce('0x12')][a109_0x11ce('0x13')]};console['log'](a109_0x11ce('0x14'),_0x4f9d8d[a109_0x11ce('0x10')]);controllers_1[a109_0x11ce('0x5')]['getInstance']()[a109_0x11ce('0x15')]['save'](_0x4f9d8d,null,null)['then'](_0x4f7cb0=>{const _0x41a056={'file_id':sequelize_utils_1[a109_0x11ce('0x5')]['encryptId'](_0x4f7cb0[a109_0x11ce('0x16')])};responseUtils[a109_0x11ce('0x17')](_0x4f9d8d,_0x392218,_0x41a056,0xc8);})[a109_0x11ce('0x18')](_0x909bb8=>{return responseUtils[a109_0x11ce('0x19')](_0x4f9d8d,_0x392218,_0x909bb8[a109_0x11ce('0x1a')],0x1f4);});},_0x21eb78=>{return responseUtils[a109_0x11ce('0x19')](_0x4f9d8d,_0x392218,_0x21eb78,0x1f4);});}[a109_0x11ce('0x8')](_0x297779,_0x1ba883,_0x14c051){_0x297779[a109_0x11ce('0x1b')]=sequelize_utils_1[a109_0x11ce('0x5')][a109_0x11ce('0x1c')](_0x297779[a109_0x11ce('0x1b')]);console['log'](a109_0x11ce('0x1d'),_0x297779[a109_0x11ce('0x1b')]);const _0xb5b2fa=new crudOptions_1[(a109_0x11ce('0x5'))]();_0xb5b2fa[a109_0x11ce('0x1e')]=!![];_0xb5b2fa['shared']=!![];_0xb5b2fa['orderBy']=[[a109_0x11ce('0x1f'),'DESC']];_0xb5b2fa[a109_0x11ce('0x20')]=['id','file_id'];_0xb5b2fa['include']=[{'model':models_1[a109_0x11ce('0x5')][a109_0x11ce('0xc')]()[a109_0x11ce('0x21')],'attributes':[a109_0x11ce('0x22'),a109_0x11ce('0x23'),a109_0x11ce('0x24'),a109_0x11ce('0x25')]}];return controllers_1['default']['getInstance']()[a109_0x11ce('0x15')][a109_0x11ce('0x26')](_0x297779,_0x1ba883,_0x14c051,_0xb5b2fa);}[a109_0x11ce('0x27')](_0x3a42de,_0x33e8e1,_0x2366d8){_0x3a42de['params']=sequelize_utils_1[a109_0x11ce('0x5')][a109_0x11ce('0x1c')](_0x3a42de[a109_0x11ce('0x1b')]);console[a109_0x11ce('0x9')](a109_0x11ce('0x1d'),_0x3a42de[a109_0x11ce('0x1b')]);const _0x16112a=new crudOptions_1[(a109_0x11ce('0x5'))]();_0x16112a['public']=!![];_0x16112a[a109_0x11ce('0x28')]=!![];_0x16112a[a109_0x11ce('0x29')]=[[a109_0x11ce('0x1f'),'DESC']];_0x16112a['attributes']=['id',a109_0x11ce('0x16')];_0x16112a['include']=[{'model':models_1[a109_0x11ce('0x5')]['getInstance']()[a109_0x11ce('0x21')],'attributes':[a109_0x11ce('0x22'),'name',a109_0x11ce('0x24'),a109_0x11ce('0x25')]}];return controllers_1[a109_0x11ce('0x5')][a109_0x11ce('0xc')]()[a109_0x11ce('0x15')][a109_0x11ce('0x2a')](_0x3a42de,_0x33e8e1,_0x2366d8,_0x16112a);}}exports['default']=ProductsController;
var a0_0x4c87=['public','shared','updated_at','filesModel','title','name','is_private','activityFilesController','find','orderBy','DESC','attributes','include','type','count','saveTimeLog\x20req.body','started_at','ended_at','description','timeLogsController','save','dataValues','timeLogResult\x20req.body:\x20','activityTimeLogsController','activityTimeLogResult:\x20','timeLogsModel','__importDefault','defineProperty','__esModule','../../infrastructure/base-controller','../models','../controllers','../../infrastructure/sequelize-utils','formidable','default','saveImage','bind','getImages','getImagesTotal','saveTimeLog','getTimeLogs','getTimeLogsTotal','log','user','authentication\x20failed','saveFile','then','encryptId','fields','activity_id','req.body','body','getInstance','file_id','successResponse','catch','errorResponse','stack','params','decryptId','req.params'];(function(_0x43bf31,_0x4248ef){var _0x17fab4=function(_0x4472d3){while(--_0x4472d3){_0x43bf31['push'](_0x43bf31['shift']());}};_0x17fab4(++_0x4248ef);}(a0_0x4c87,0x94));var a0_0x13ac=function(_0x1aa235,_0x45b07a){_0x1aa235=_0x1aa235-0x0;var _0x38aae1=a0_0x4c87[_0x1aa235];return _0x38aae1;};'use strict';var __importDefault=this&&this[a0_0x13ac('0x0')]||function(_0x1562eb){return _0x1562eb&&_0x1562eb['__esModule']?_0x1562eb:{'default':_0x1562eb};};Object[a0_0x13ac('0x1')](exports,a0_0x13ac('0x2'),{'value':!![]});const base_controller_1=__importDefault(require(a0_0x13ac('0x3')));const crudOptions_1=__importDefault(require('../shared/models/crudOptions'));const models_1=__importDefault(require(a0_0x13ac('0x4')));const controllers_1=__importDefault(require(a0_0x13ac('0x5')));const sequelize_utils_1=__importDefault(require(a0_0x13ac('0x6')));const fsExtra=require('fs-extra');const formidable=require(a0_0x13ac('0x7'));const responseUtils=require('../../infrastructure/response-utils');class ActivitiesController extends base_controller_1[a0_0x13ac('0x8')]{constructor(_0x4367e0){super(_0x4367e0,null);this[a0_0x13ac('0x9')]=this[a0_0x13ac('0x9')][a0_0x13ac('0xa')](this);this[a0_0x13ac('0xb')]=this[a0_0x13ac('0xb')]['bind'](this);this[a0_0x13ac('0xc')]=this[a0_0x13ac('0xc')][a0_0x13ac('0xa')](this);this[a0_0x13ac('0xd')]=this[a0_0x13ac('0xd')][a0_0x13ac('0xa')](this);this['getTimeLogs']=this[a0_0x13ac('0xe')]['bind'](this);this[a0_0x13ac('0xf')]=this['getTimeLogsTotal'][a0_0x13ac('0xa')](this);}['saveImage'](_0x5b524b,_0x25b38e,_0x19d80b){console[a0_0x13ac('0x10')](a0_0x13ac('0x9'));if(!_0x5b524b[a0_0x13ac('0x11')]){return responseUtils['errorResponse'](_0x5b524b,_0x25b38e,a0_0x13ac('0x12'),0x191);}controllers_1[a0_0x13ac('0x8')]['getInstance']()['filesController'][a0_0x13ac('0x13')](_0x5b524b,null,null)[a0_0x13ac('0x14')](_0x877b60=>{_0x5b524b['body']={'file_id':sequelize_utils_1[a0_0x13ac('0x8')][a0_0x13ac('0x15')](_0x877b60['data']['id']),'activity_id':_0x877b60[a0_0x13ac('0x16')][a0_0x13ac('0x17')]};console['log'](a0_0x13ac('0x18'),_0x5b524b[a0_0x13ac('0x19')]);controllers_1[a0_0x13ac('0x8')][a0_0x13ac('0x1a')]()['activityFilesController']['save'](_0x5b524b,null,null)[a0_0x13ac('0x14')](_0x5acb7c=>{const _0x3e6451={'file_id':sequelize_utils_1[a0_0x13ac('0x8')][a0_0x13ac('0x15')](_0x5acb7c[a0_0x13ac('0x1b')])};responseUtils[a0_0x13ac('0x1c')](_0x5b524b,_0x25b38e,_0x3e6451,0xc8);})[a0_0x13ac('0x1d')](_0x268ae5=>{return responseUtils[a0_0x13ac('0x1e')](_0x5b524b,_0x25b38e,_0x268ae5[a0_0x13ac('0x1f')],0x1f4);});},_0x2261d7=>{return responseUtils['errorResponse'](_0x5b524b,_0x25b38e,_0x2261d7,0x1f4);});}['getImages'](_0x410713,_0x58da5b,_0x370628){_0x410713[a0_0x13ac('0x20')]=sequelize_utils_1[a0_0x13ac('0x8')][a0_0x13ac('0x21')](_0x410713[a0_0x13ac('0x20')]);console[a0_0x13ac('0x10')](a0_0x13ac('0x22'),_0x410713[a0_0x13ac('0x20')]);const _0x459ada=new crudOptions_1[(a0_0x13ac('0x8'))]();_0x459ada[a0_0x13ac('0x23')]=!![];_0x459ada[a0_0x13ac('0x24')]=!![];_0x459ada['orderBy']=[[a0_0x13ac('0x25'),'DESC']];_0x459ada['attributes']=['id','file_id'];_0x459ada['include']=[{'model':models_1['default']['getInstance']()[a0_0x13ac('0x26')],'attributes':[a0_0x13ac('0x27'),a0_0x13ac('0x28'),'type',a0_0x13ac('0x29')]}];return controllers_1[a0_0x13ac('0x8')][a0_0x13ac('0x1a')]()[a0_0x13ac('0x2a')][a0_0x13ac('0x2b')](_0x410713,_0x58da5b,_0x370628,_0x459ada);}[a0_0x13ac('0xc')](_0x166955,_0x1c50ed,_0x5ed108){_0x166955[a0_0x13ac('0x20')]=sequelize_utils_1[a0_0x13ac('0x8')][a0_0x13ac('0x21')](_0x166955['params']);console['log']('req.params',_0x166955[a0_0x13ac('0x20')]);const _0x996029=new crudOptions_1[(a0_0x13ac('0x8'))]();_0x996029[a0_0x13ac('0x23')]=!![];_0x996029[a0_0x13ac('0x24')]=!![];_0x996029[a0_0x13ac('0x2c')]=[['updated_at',a0_0x13ac('0x2d')]];_0x996029[a0_0x13ac('0x2e')]=['id','file_id'];_0x996029[a0_0x13ac('0x2f')]=[{'model':models_1[a0_0x13ac('0x8')][a0_0x13ac('0x1a')]()[a0_0x13ac('0x26')],'attributes':['title','name',a0_0x13ac('0x30'),'is_private']}];return controllers_1[a0_0x13ac('0x8')][a0_0x13ac('0x1a')]()[a0_0x13ac('0x2a')][a0_0x13ac('0x31')](_0x166955,_0x1c50ed,_0x5ed108,_0x996029);}['saveTimeLog'](_0x3a620c,_0x1d9a36,_0x13e12f){console['log'](a0_0x13ac('0x32'),_0x3a620c[a0_0x13ac('0x19')]);if(!_0x3a620c['user']){return responseUtils['errorResponse'](_0x3a620c,_0x1d9a36,a0_0x13ac('0x12'),0x191);}const _0x3096e3=_0x3a620c[a0_0x13ac('0x19')][a0_0x13ac('0x17')];_0x3a620c['body']={'started_at':_0x3a620c[a0_0x13ac('0x19')][a0_0x13ac('0x33')],'ended_at':_0x3a620c[a0_0x13ac('0x19')][a0_0x13ac('0x34')],'description':_0x3a620c[a0_0x13ac('0x19')][a0_0x13ac('0x35')],'is_private':_0x3a620c[a0_0x13ac('0x19')][a0_0x13ac('0x29')]};controllers_1[a0_0x13ac('0x8')][a0_0x13ac('0x1a')]()[a0_0x13ac('0x36')][a0_0x13ac('0x37')](_0x3a620c,null,null)[a0_0x13ac('0x14')](_0x100125=>{_0x3a620c['body']={'time_log_id':sequelize_utils_1[a0_0x13ac('0x8')]['encryptId'](_0x100125[a0_0x13ac('0x38')]['id']),'activity_id':_0x3096e3};console[a0_0x13ac('0x10')](a0_0x13ac('0x39'),_0x3a620c['body']);controllers_1[a0_0x13ac('0x8')][a0_0x13ac('0x1a')]()[a0_0x13ac('0x3a')]['save'](_0x3a620c,null,null)['then'](_0x138e02=>{console[a0_0x13ac('0x10')](a0_0x13ac('0x3b'),_0x138e02[a0_0x13ac('0x38')]);responseUtils[a0_0x13ac('0x1c')](_0x3a620c,_0x1d9a36,_0x138e02,0xc8);})[a0_0x13ac('0x1d')](_0x266492=>{return responseUtils[a0_0x13ac('0x1e')](_0x3a620c,_0x1d9a36,_0x266492['stack'],0x1f4);});})[a0_0x13ac('0x1d')](_0x58a784=>{return responseUtils['errorResponse'](_0x3a620c,_0x1d9a36,_0x58a784[a0_0x13ac('0x1f')],0x1f4);});}[a0_0x13ac('0xe')](_0x2172ba,_0x226d6b,_0x4b478c){_0x2172ba[a0_0x13ac('0x20')]=sequelize_utils_1[a0_0x13ac('0x8')][a0_0x13ac('0x21')](_0x2172ba[a0_0x13ac('0x20')]);console[a0_0x13ac('0x10')]('req.params',_0x2172ba[a0_0x13ac('0x20')]);const _0x2b3593=new crudOptions_1['default']();_0x2b3593[a0_0x13ac('0x23')]=!![];_0x2b3593[a0_0x13ac('0x24')]=!![];_0x2b3593[a0_0x13ac('0x2c')]=[[a0_0x13ac('0x25'),a0_0x13ac('0x2d')]];_0x2b3593[a0_0x13ac('0x2f')]=[{'model':models_1['default'][a0_0x13ac('0x1a')]()[a0_0x13ac('0x3c')]}];return controllers_1[a0_0x13ac('0x8')][a0_0x13ac('0x1a')]()[a0_0x13ac('0x3a')][a0_0x13ac('0x2b')](_0x2172ba,_0x226d6b,_0x4b478c,_0x2b3593);}[a0_0x13ac('0xf')](_0x28b140,_0x22bab7,_0x1280c4){_0x28b140['params']=sequelize_utils_1[a0_0x13ac('0x8')][a0_0x13ac('0x21')](_0x28b140[a0_0x13ac('0x20')]);console[a0_0x13ac('0x10')]('req.params',_0x28b140[a0_0x13ac('0x20')]);const _0x1de3ee=new crudOptions_1[(a0_0x13ac('0x8'))]();_0x1de3ee['public']=!![];_0x1de3ee['shared']=!![];_0x1de3ee[a0_0x13ac('0x2c')]=[[a0_0x13ac('0x25'),a0_0x13ac('0x2d')]];_0x1de3ee[a0_0x13ac('0x2f')]=[{'model':models_1[a0_0x13ac('0x8')][a0_0x13ac('0x1a')]()['timeLogsModel']}];return controllers_1[a0_0x13ac('0x8')]['getInstance']()[a0_0x13ac('0x3a')][a0_0x13ac('0x31')](_0x28b140,_0x22bab7,_0x1280c4,_0x1de3ee);}}exports[a0_0x13ac('0x8')]=ActivitiesController;
var a11_0x33e7=['usernameTakenError','create','dataValues','status','created_at','options','token','catch','default','__esModule','i18n','../../config/jwt.js','../../infrastructure/auth-utils','../../resources/locale-strings','string-format','model','login','bind','createAccount','findOne','body','username','uuid','first_name','last_name','email','then','errorResponse','usernameNotFoundError','validPassword','password','toJSON','secret','successResponse','stack'];(function(_0x17a2e8,_0x395f4a){var _0x1f2a66=function(_0x1fec05){while(--_0x1fec05){_0x17a2e8['push'](_0x17a2e8['shift']());}};_0x1f2a66(++_0x395f4a);}(a11_0x33e7,0x121));var a11_0x5d6b=function(_0x5a7992,_0xbe4b17){_0x5a7992=_0x5a7992-0x0;var _0x3b8b5f=a11_0x33e7[_0x5a7992];return _0x3b8b5f;};'use strict';Object['defineProperty'](exports,a11_0x5d6b('0x0'),{'value':!![]});const jwt=require('jsonwebtoken');const i18n=require(a11_0x5d6b('0x1'));const configJwt=require(a11_0x5d6b('0x2'));const authUtils=require(a11_0x5d6b('0x3'));const responseUtils=require('../../infrastructure/response-utils');const LocaleStrings=require(a11_0x5d6b('0x4'));const format=require(a11_0x5d6b('0x5'));class AuthenticationController{constructor(_0x4dd1c6){this[a11_0x5d6b('0x6')]=_0x4dd1c6;this[a11_0x5d6b('0x7')]=this['login'][a11_0x5d6b('0x8')](this);this[a11_0x5d6b('0x9')]=this[a11_0x5d6b('0x9')][a11_0x5d6b('0x8')](this);}['login'](_0x3fe984,_0x29e1c3,_0x1ebdf0){this['model'][a11_0x5d6b('0xa')]({'where':{'username':_0x3fe984[a11_0x5d6b('0xb')][a11_0x5d6b('0xc')]},'attributes':[a11_0x5d6b('0xd'),a11_0x5d6b('0xe'),a11_0x5d6b('0xf'),a11_0x5d6b('0x10'),'username','password']})[a11_0x5d6b('0x11')](_0x3339ae=>{if(!_0x3339ae){return responseUtils[a11_0x5d6b('0x12')](_0x29e1c3,format(LocaleStrings[a11_0x5d6b('0x13')],_0x3fe984[a11_0x5d6b('0xb')][a11_0x5d6b('0xc')]),0x193);}if(authUtils[a11_0x5d6b('0x14')](_0x3fe984['body'][a11_0x5d6b('0x15')],_0x3339ae[a11_0x5d6b('0x15')])){_0x3339ae=_0x3339ae[a11_0x5d6b('0x16')]();const _0x1ddee7={'uuid':_0x3339ae['uuid']};const _0x5b997c=jwt['sign'](_0x1ddee7,configJwt[a11_0x5d6b('0x17')],configJwt['options']);delete _0x3339ae[a11_0x5d6b('0x15')];_0x3339ae['token']=_0x5b997c;return responseUtils[a11_0x5d6b('0x18')](_0x29e1c3,_0x3339ae,0xc8);}else{return responseUtils[a11_0x5d6b('0x12')](_0x29e1c3,format(LocaleStrings['passwordNotMatchError']),0x193);}})['catch'](_0x9a4390=>{return responseUtils[a11_0x5d6b('0x12')](_0x29e1c3,_0x9a4390[a11_0x5d6b('0x19')],0x1f4);});}[a11_0x5d6b('0x9')](_0x1dfa53,_0x231a60,_0x5b9abe){this[a11_0x5d6b('0x6')]['findOne']({'where':{'username':_0x1dfa53[a11_0x5d6b('0xb')][a11_0x5d6b('0xc')]}})[a11_0x5d6b('0x11')](_0x4d37bc=>{if(_0x4d37bc){return responseUtils[a11_0x5d6b('0x12')](_0x231a60,format(LocaleStrings[a11_0x5d6b('0x1a')],_0x1dfa53['body'][a11_0x5d6b('0xc')]),0x193);}else{_0x1dfa53[a11_0x5d6b('0xb')][a11_0x5d6b('0x10')]=_0x1dfa53[a11_0x5d6b('0xb')][a11_0x5d6b('0xc')];const _0x5b5aed={'first_name':_0x1dfa53[a11_0x5d6b('0xb')][a11_0x5d6b('0xe')],'last_name':_0x1dfa53[a11_0x5d6b('0xb')][a11_0x5d6b('0xf')],'email':_0x1dfa53[a11_0x5d6b('0xb')]['email'],'username':_0x1dfa53[a11_0x5d6b('0xb')][a11_0x5d6b('0xc')],'password':authUtils['generateHash'](_0x1dfa53[a11_0x5d6b('0xb')][a11_0x5d6b('0x15')])};this[a11_0x5d6b('0x6')][a11_0x5d6b('0x1b')](_0x5b5aed)[a11_0x5d6b('0x11')](function(_0x282d41,_0x46074e){delete _0x282d41['dataValues']['id'];delete _0x282d41[a11_0x5d6b('0x1c')][a11_0x5d6b('0x1d')];delete _0x282d41['dataValues'][a11_0x5d6b('0x15')];delete _0x282d41[a11_0x5d6b('0x1c')]['updated_at'];delete _0x282d41['dataValues'][a11_0x5d6b('0x1e')];const _0x56cb4b={'uuid':_0x282d41[a11_0x5d6b('0xd')]};const _0x190b3f=jwt['sign'](_0x56cb4b,configJwt['secret'],configJwt[a11_0x5d6b('0x1f')]);_0x282d41['dataValues'][a11_0x5d6b('0x20')]=_0x190b3f;return responseUtils[a11_0x5d6b('0x18')](_0x231a60,_0x282d41,0xc8);})[a11_0x5d6b('0x21')](_0x46294d=>{return responseUtils[a11_0x5d6b('0x12')](_0x231a60,_0x46294d['stack'],0x1f4);});}})[a11_0x5d6b('0x21')](_0x5e2561=>{return responseUtils[a11_0x5d6b('0x12')](_0x231a60,_0x5e2561[a11_0x5d6b('0x19')],0x1f4);});}}exports[a11_0x5d6b('0x22')]=AuthenticationController;
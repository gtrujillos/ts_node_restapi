var a11_0x1a40=['findOne','body','username','first_name','last_name','then','errorResponse','usernameNotFoundError','validPassword','password','toJSON','secret','successResponse','passwordNotMatchError','catch','stack','generateHash','create','dataValues','created_at','uuid','token','default','defineProperty','__esModule','jsonwebtoken','i18n','../../config/jwt.js','../../infrastructure/auth-utils','../../infrastructure/response-utils','../../resources/locale-strings','string-format','login','bind','createAccount','model'];(function(_0x113f78,_0x56fb60){var _0x53ee31=function(_0x5957da){while(--_0x5957da){_0x113f78['push'](_0x113f78['shift']());}};_0x53ee31(++_0x56fb60);}(a11_0x1a40,0x1c7));var a11_0x283c=function(_0x18214e,_0x3c48d4){_0x18214e=_0x18214e-0x0;var _0x4ce2c6=a11_0x1a40[_0x18214e];return _0x4ce2c6;};'use strict';Object[a11_0x283c('0x0')](exports,a11_0x283c('0x1'),{'value':!![]});const jwt=require(a11_0x283c('0x2'));const i18n=require(a11_0x283c('0x3'));const configJwt=require(a11_0x283c('0x4'));const authUtils=require(a11_0x283c('0x5'));const responseUtils=require(a11_0x283c('0x6'));const LocaleStrings=require(a11_0x283c('0x7'));const format=require(a11_0x283c('0x8'));class AuthenticationController{constructor(_0x2553dc){this['model']=_0x2553dc;this[a11_0x283c('0x9')]=this[a11_0x283c('0x9')][a11_0x283c('0xa')](this);this[a11_0x283c('0xb')]=this['createAccount'][a11_0x283c('0xa')](this);}[a11_0x283c('0x9')](_0x50f2e8,_0x57bbd7,_0x2a7706){this[a11_0x283c('0xc')][a11_0x283c('0xd')]({'where':{'username':_0x50f2e8[a11_0x283c('0xe')][a11_0x283c('0xf')]},'attributes':['uuid',a11_0x283c('0x10'),a11_0x283c('0x11'),'email',a11_0x283c('0xf'),'password']})[a11_0x283c('0x12')](_0x2dc9b2=>{if(!_0x2dc9b2){return responseUtils[a11_0x283c('0x13')](_0x57bbd7,format(LocaleStrings[a11_0x283c('0x14')],_0x50f2e8[a11_0x283c('0xe')]['username']),0x193);}if(authUtils[a11_0x283c('0x15')](_0x50f2e8[a11_0x283c('0xe')][a11_0x283c('0x16')],_0x2dc9b2[a11_0x283c('0x16')])){_0x2dc9b2=_0x2dc9b2[a11_0x283c('0x17')]();const _0x5dbc6b={'uuid':_0x2dc9b2['uuid']};const _0x31f5c0=jwt['sign'](_0x5dbc6b,configJwt[a11_0x283c('0x18')],configJwt['options']);delete _0x2dc9b2[a11_0x283c('0x16')];_0x2dc9b2['token']=_0x31f5c0;return responseUtils[a11_0x283c('0x19')](_0x57bbd7,_0x2dc9b2,0xc8);}else{return responseUtils['errorResponse'](_0x57bbd7,format(LocaleStrings[a11_0x283c('0x1a')]),0x193);}})[a11_0x283c('0x1b')](_0x4bb8ae=>{return responseUtils[a11_0x283c('0x13')](_0x57bbd7,_0x4bb8ae[a11_0x283c('0x1c')],0x1f4);});}[a11_0x283c('0xb')](_0x331268,_0x976afb,_0xa78c30){this[a11_0x283c('0xc')]['findOne']({'where':{'username':_0x331268['body'][a11_0x283c('0xf')]}})[a11_0x283c('0x12')](_0x150d8c=>{if(_0x150d8c){return responseUtils[a11_0x283c('0x13')](_0x976afb,format(LocaleStrings['usernameTakenError'],_0x331268[a11_0x283c('0xe')][a11_0x283c('0xf')]),0x193);}else{_0x331268['body']['email']=_0x331268['body']['username'];const _0x4edcd2={'first_name':_0x331268[a11_0x283c('0xe')][a11_0x283c('0x10')],'last_name':_0x331268[a11_0x283c('0xe')][a11_0x283c('0x11')],'email':_0x331268[a11_0x283c('0xe')]['email'],'username':_0x331268[a11_0x283c('0xe')][a11_0x283c('0xf')],'password':authUtils[a11_0x283c('0x1d')](_0x331268['body'][a11_0x283c('0x16')])};this[a11_0x283c('0xc')][a11_0x283c('0x1e')](_0x4edcd2)[a11_0x283c('0x12')](function(_0x262831,_0x19e4d4){delete _0x262831['dataValues']['id'];delete _0x262831[a11_0x283c('0x1f')]['status'];delete _0x262831['dataValues']['password'];delete _0x262831['dataValues']['updated_at'];delete _0x262831[a11_0x283c('0x1f')][a11_0x283c('0x20')];const _0x56b8cf={'uuid':_0x262831[a11_0x283c('0x21')]};const _0x232641=jwt['sign'](_0x56b8cf,configJwt[a11_0x283c('0x18')],configJwt['options']);_0x262831[a11_0x283c('0x1f')][a11_0x283c('0x22')]=_0x232641;return responseUtils[a11_0x283c('0x19')](_0x976afb,_0x262831,0xc8);})[a11_0x283c('0x1b')](_0x385ead=>{return responseUtils['errorResponse'](_0x976afb,_0x385ead[a11_0x283c('0x1c')],0x1f4);});}})[a11_0x283c('0x1b')](_0x270953=>{return responseUtils[a11_0x283c('0x13')](_0x976afb,_0x270953[a11_0x283c('0x1c')],0x1f4);});}}exports[a11_0x283c('0x23')]=AuthenticationController;
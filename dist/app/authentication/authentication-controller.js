var a30_0x3ba4=['validPassword','password','toJSON','options','successResponse','passwordNotMatchError','stack','usernameTakenError','email','hashPassword','dataValues','sign','catch','__importDefault','__esModule','../../infrastructure/crypt-utils','jsonwebtoken','i18n','../../config/jwt.js','../../infrastructure/auth-utils','../../infrastructure/response-utils','../../resources/locale-strings','string-format','login','bind','createAccount','model','findOne','body','username','first_name','last_name','then','errorResponse','usernameNotFoundError','default'];(function(_0x4bd822,_0x2bd6f7){var _0xb4bdb3=function(_0x1d68f6){while(--_0x1d68f6){_0x4bd822['push'](_0x4bd822['shift']());}};_0xb4bdb3(++_0x2bd6f7);}(a30_0x3ba4,0x79));var a30_0x3a85=function(_0x50f998,_0x1d59f4){_0x50f998=_0x50f998-0x0;var _0xecde6f=a30_0x3ba4[_0x50f998];return _0xecde6f;};'use strict';var __importDefault=this&&this[a30_0x3a85('0x0')]||function(_0xa7bfd1){return _0xa7bfd1&&_0xa7bfd1['__esModule']?_0xa7bfd1:{'default':_0xa7bfd1};};Object['defineProperty'](exports,a30_0x3a85('0x1'),{'value':!![]});const crypt_utils_1=__importDefault(require(a30_0x3a85('0x2')));const jwt=require(a30_0x3a85('0x3'));const i18n=require(a30_0x3a85('0x4'));const configJwt=require(a30_0x3a85('0x5'));const authUtils=require(a30_0x3a85('0x6'));const responseUtils=require(a30_0x3a85('0x7'));const LocaleStrings=require(a30_0x3a85('0x8'));const format=require(a30_0x3a85('0x9'));class AuthenticationController{constructor(_0x55db76){this['model']=_0x55db76;this[a30_0x3a85('0xa')]=this['login'][a30_0x3a85('0xb')](this);this['createAccount']=this[a30_0x3a85('0xc')][a30_0x3a85('0xb')](this);}['login'](_0x1df395,_0x101074,_0x16e7a8){this[a30_0x3a85('0xd')][a30_0x3a85('0xe')]({'where':{'username':_0x1df395[a30_0x3a85('0xf')][a30_0x3a85('0x10')]},'attributes':['id',a30_0x3a85('0x11'),a30_0x3a85('0x12'),'email',a30_0x3a85('0x10'),'password']})[a30_0x3a85('0x13')](_0x125c98=>{if(!_0x125c98){return responseUtils[a30_0x3a85('0x14')](_0x101074,format(LocaleStrings[a30_0x3a85('0x15')],_0x1df395['body'][a30_0x3a85('0x10')]),0x193);}if(crypt_utils_1[a30_0x3a85('0x16')][a30_0x3a85('0x17')](_0x1df395[a30_0x3a85('0xf')][a30_0x3a85('0x18')],_0x125c98[a30_0x3a85('0x18')])){_0x125c98=_0x125c98[a30_0x3a85('0x19')]();const _0x483999={'id':_0x125c98['id']};const _0x5adc96=jwt['sign'](_0x483999,configJwt['secret'],configJwt[a30_0x3a85('0x1a')]);const _0x48a68e={'token':_0x5adc96};return responseUtils[a30_0x3a85('0x1b')](_0x101074,_0x48a68e,0xc8);}else{return responseUtils['errorResponse'](_0x101074,format(LocaleStrings[a30_0x3a85('0x1c')]),0x193);}})['catch'](_0xdfb21b=>{return responseUtils[a30_0x3a85('0x14')](_0x101074,_0xdfb21b[a30_0x3a85('0x1d')],0x1f4);});}[a30_0x3a85('0xc')](_0x5ac277,_0x1e10de,_0x111bbe){this[a30_0x3a85('0xd')][a30_0x3a85('0xe')]({'where':{'username':_0x5ac277[a30_0x3a85('0xf')][a30_0x3a85('0x10')]}})[a30_0x3a85('0x13')](_0x126d22=>{if(_0x126d22){return responseUtils[a30_0x3a85('0x14')](_0x1e10de,format(LocaleStrings[a30_0x3a85('0x1e')],_0x5ac277[a30_0x3a85('0xf')][a30_0x3a85('0x10')]),0x193);}else{_0x5ac277['body'][a30_0x3a85('0x1f')]=_0x5ac277[a30_0x3a85('0xf')][a30_0x3a85('0x10')];const _0x2e9fed={'first_name':_0x5ac277[a30_0x3a85('0xf')][a30_0x3a85('0x11')],'last_name':_0x5ac277[a30_0x3a85('0xf')]['last_name'],'email':_0x5ac277[a30_0x3a85('0xf')][a30_0x3a85('0x1f')],'username':_0x5ac277[a30_0x3a85('0xf')][a30_0x3a85('0x10')],'password':crypt_utils_1[a30_0x3a85('0x16')][a30_0x3a85('0x20')](_0x5ac277['body'][a30_0x3a85('0x18')])};this[a30_0x3a85('0xd')]['create'](_0x2e9fed)[a30_0x3a85('0x13')](function(_0x55bc2b,_0x22e278){const _0x546730={'id':_0x55bc2b[a30_0x3a85('0x21')]['id']};const _0x54acaf=jwt[a30_0x3a85('0x22')](_0x546730,configJwt['secret'],configJwt[a30_0x3a85('0x1a')]);const _0x3c9d7f={'token':_0x54acaf};return responseUtils[a30_0x3a85('0x1b')](_0x1e10de,_0x3c9d7f,0xc8);})[a30_0x3a85('0x23')](_0x172c17=>{return responseUtils[a30_0x3a85('0x14')](_0x1e10de,_0x172c17[a30_0x3a85('0x1d')],0x1f4);});}})[a30_0x3a85('0x23')](_0x20593a=>{return responseUtils[a30_0x3a85('0x14')](_0x1e10de,_0x20593a[a30_0x3a85('0x1d')],0x1f4);});}}exports[a30_0x3a85('0x16')]=AuthenticationController;
var a11_0x337d=['generateHash','dataValues','status','updated_at','secret','stack','default','__esModule','jsonwebtoken','../../config/jwt.js','../../infrastructure/auth-utils','../../infrastructure/response-utils','model','login','bind','createAccount','findOne','body','username','first_name','last_name','password','then','errorResponse','validPassword','toJSON','uuid','sign','options','token','successResponse','passwordNotMatchError','catch','email'];(function(_0x1e931f,_0x218a22){var _0x43cb26=function(_0x4076a9){while(--_0x4076a9){_0x1e931f['push'](_0x1e931f['shift']());}};_0x43cb26(++_0x218a22);}(a11_0x337d,0x1c1));var a11_0x4355=function(_0x5938de,_0x4b395b){_0x5938de=_0x5938de-0x0;var _0x11514f=a11_0x337d[_0x5938de];return _0x11514f;};'use strict';Object['defineProperty'](exports,a11_0x4355('0x0'),{'value':!![]});const jwt=require(a11_0x4355('0x1'));const i18n=require('i18n');const configJwt=require(a11_0x4355('0x2'));const authUtils=require(a11_0x4355('0x3'));const responseUtils=require(a11_0x4355('0x4'));const LocaleStrings=require('../../resources/locale-strings');const format=require('string-format');class AuthenticationController{constructor(_0x117f30){this[a11_0x4355('0x5')]=_0x117f30;this[a11_0x4355('0x6')]=this[a11_0x4355('0x6')][a11_0x4355('0x7')](this);this[a11_0x4355('0x8')]=this[a11_0x4355('0x8')]['bind'](this);}[a11_0x4355('0x6')](_0x2b482a,_0x16164f,_0x4bfaf7){this[a11_0x4355('0x5')][a11_0x4355('0x9')]({'where':{'username':_0x2b482a[a11_0x4355('0xa')][a11_0x4355('0xb')]},'attributes':['uuid',a11_0x4355('0xc'),a11_0x4355('0xd'),'email',a11_0x4355('0xb'),a11_0x4355('0xe')]})[a11_0x4355('0xf')](_0x41cb00=>{if(!_0x41cb00){return responseUtils[a11_0x4355('0x10')](_0x16164f,format(LocaleStrings['usernameNotFoundError'],_0x2b482a[a11_0x4355('0xa')][a11_0x4355('0xb')]),0x193);}if(authUtils[a11_0x4355('0x11')](_0x2b482a[a11_0x4355('0xa')][a11_0x4355('0xe')],_0x41cb00[a11_0x4355('0xe')])){_0x41cb00=_0x41cb00[a11_0x4355('0x12')]();const _0x1cd611={'uuid':_0x41cb00[a11_0x4355('0x13')]};const _0x113308=jwt[a11_0x4355('0x14')](_0x1cd611,configJwt['secret'],configJwt[a11_0x4355('0x15')]);delete _0x41cb00[a11_0x4355('0xe')];_0x41cb00[a11_0x4355('0x16')]=_0x113308;return responseUtils[a11_0x4355('0x17')](_0x16164f,_0x41cb00,0xc8);}else{return responseUtils[a11_0x4355('0x10')](_0x16164f,format(LocaleStrings[a11_0x4355('0x18')]),0x193);}})[a11_0x4355('0x19')](_0x424b1e=>{return responseUtils[a11_0x4355('0x10')](_0x16164f,_0x424b1e['stack'],0x1f4);});}[a11_0x4355('0x8')](_0x1205ff,_0x4466fd,_0x493fdb){this[a11_0x4355('0x5')][a11_0x4355('0x9')]({'where':{'username':_0x1205ff[a11_0x4355('0xa')]['username']}})['then'](_0x3f68a3=>{if(_0x3f68a3){return responseUtils['errorResponse'](_0x4466fd,format(LocaleStrings['usernameTakenError'],_0x1205ff[a11_0x4355('0xa')][a11_0x4355('0xb')]),0x193);}else{_0x1205ff['body'][a11_0x4355('0x1a')]=_0x1205ff[a11_0x4355('0xa')][a11_0x4355('0xb')];const _0x248d33={'first_name':_0x1205ff[a11_0x4355('0xa')][a11_0x4355('0xc')],'last_name':_0x1205ff[a11_0x4355('0xa')][a11_0x4355('0xd')],'email':_0x1205ff[a11_0x4355('0xa')][a11_0x4355('0x1a')],'username':_0x1205ff[a11_0x4355('0xa')][a11_0x4355('0xb')],'password':authUtils[a11_0x4355('0x1b')](_0x1205ff['body'][a11_0x4355('0xe')])};this['model']['create'](_0x248d33)['then'](function(_0xd3bc77,_0x26acd9){delete _0xd3bc77[a11_0x4355('0x1c')]['id'];delete _0xd3bc77['dataValues'][a11_0x4355('0x1d')];delete _0xd3bc77['dataValues'][a11_0x4355('0xe')];delete _0xd3bc77[a11_0x4355('0x1c')][a11_0x4355('0x1e')];delete _0xd3bc77['dataValues']['created_at'];const _0xf2530f={'uuid':_0xd3bc77[a11_0x4355('0x13')]};const _0x52f7af=jwt[a11_0x4355('0x14')](_0xf2530f,configJwt[a11_0x4355('0x1f')],configJwt['options']);_0xd3bc77[a11_0x4355('0x1c')]['token']=_0x52f7af;return responseUtils['successResponse'](_0x4466fd,_0xd3bc77,0xc8);})[a11_0x4355('0x19')](_0x404bda=>{return responseUtils[a11_0x4355('0x10')](_0x4466fd,_0x404bda['stack'],0x1f4);});}})[a11_0x4355('0x19')](_0xe9a602=>{return responseUtils[a11_0x4355('0x10')](_0x4466fd,_0xe9a602[a11_0x4355('0x20')],0x1f4);});}}exports[a11_0x4355('0x21')]=AuthenticationController;
var a11_0x2dc8=['updated_at','created_at','token','stack','default','defineProperty','__esModule','jsonwebtoken','i18n','../../config/jwt.js','../../infrastructure/auth-utils','../../infrastructure/response-utils','string-format','model','login','bind','createAccount','findOne','body','username','uuid','last_name','email','then','errorResponse','usernameNotFoundError','validPassword','password','toJSON','sign','secret','options','successResponse','passwordNotMatchError','catch','usernameTakenError','first_name','generateHash','create','dataValues','status'];(function(_0x23e642,_0x4f9660){var _0x459b83=function(_0x507f86){while(--_0x507f86){_0x23e642['push'](_0x23e642['shift']());}};_0x459b83(++_0x4f9660);}(a11_0x2dc8,0x1f1));var a11_0x1f14=function(_0x1d2076,_0x2a7e5a){_0x1d2076=_0x1d2076-0x0;var _0x6ffefc=a11_0x2dc8[_0x1d2076];return _0x6ffefc;};'use strict';Object[a11_0x1f14('0x0')](exports,a11_0x1f14('0x1'),{'value':!![]});const jwt=require(a11_0x1f14('0x2'));const i18n=require(a11_0x1f14('0x3'));const configJwt=require(a11_0x1f14('0x4'));const authUtils=require(a11_0x1f14('0x5'));const responseUtils=require(a11_0x1f14('0x6'));const LocaleStrings=require('../../resources/locale-strings');const format=require(a11_0x1f14('0x7'));class AuthenticationController{constructor(_0x22ee6c){this[a11_0x1f14('0x8')]=_0x22ee6c;this[a11_0x1f14('0x9')]=this[a11_0x1f14('0x9')][a11_0x1f14('0xa')](this);this[a11_0x1f14('0xb')]=this[a11_0x1f14('0xb')]['bind'](this);}[a11_0x1f14('0x9')](_0x4ec4c3,_0x144a4c,_0x440543){this[a11_0x1f14('0x8')][a11_0x1f14('0xc')]({'where':{'username':_0x4ec4c3[a11_0x1f14('0xd')][a11_0x1f14('0xe')]},'attributes':[a11_0x1f14('0xf'),'first_name',a11_0x1f14('0x10'),a11_0x1f14('0x11'),a11_0x1f14('0xe'),'password']})[a11_0x1f14('0x12')](_0x3d5726=>{if(!_0x3d5726){return responseUtils[a11_0x1f14('0x13')](_0x144a4c,format(LocaleStrings[a11_0x1f14('0x14')],_0x4ec4c3['body'][a11_0x1f14('0xe')]),0x193);}if(authUtils[a11_0x1f14('0x15')](_0x4ec4c3[a11_0x1f14('0xd')][a11_0x1f14('0x16')],_0x3d5726['password'])){_0x3d5726=_0x3d5726[a11_0x1f14('0x17')]();const _0x7765ad={'uuid':_0x3d5726[a11_0x1f14('0xf')]};const _0x5b3147=jwt[a11_0x1f14('0x18')](_0x7765ad,configJwt[a11_0x1f14('0x19')],configJwt[a11_0x1f14('0x1a')]);delete _0x3d5726[a11_0x1f14('0x16')];_0x3d5726['token']=_0x5b3147;return responseUtils[a11_0x1f14('0x1b')](_0x144a4c,_0x3d5726,0xc8);}else{return responseUtils[a11_0x1f14('0x13')](_0x144a4c,format(LocaleStrings[a11_0x1f14('0x1c')]),0x193);}})[a11_0x1f14('0x1d')](_0x503dee=>{return responseUtils[a11_0x1f14('0x13')](_0x144a4c,_0x503dee['stack'],0x1f4);});}[a11_0x1f14('0xb')](_0x2d6f34,_0xeb5ecb,_0x4d618f){this[a11_0x1f14('0x8')]['findOne']({'where':{'username':_0x2d6f34[a11_0x1f14('0xd')]['username']}})[a11_0x1f14('0x12')](_0x192532=>{if(_0x192532){return responseUtils[a11_0x1f14('0x13')](_0xeb5ecb,format(LocaleStrings[a11_0x1f14('0x1e')],_0x2d6f34['body'][a11_0x1f14('0xe')]),0x193);}else{_0x2d6f34[a11_0x1f14('0xd')]['email']=_0x2d6f34['body'][a11_0x1f14('0xe')];const _0x5bb2f2={'first_name':_0x2d6f34[a11_0x1f14('0xd')][a11_0x1f14('0x1f')],'last_name':_0x2d6f34[a11_0x1f14('0xd')][a11_0x1f14('0x10')],'email':_0x2d6f34[a11_0x1f14('0xd')]['email'],'username':_0x2d6f34[a11_0x1f14('0xd')]['username'],'password':authUtils[a11_0x1f14('0x20')](_0x2d6f34[a11_0x1f14('0xd')]['password'])};this[a11_0x1f14('0x8')][a11_0x1f14('0x21')](_0x5bb2f2)[a11_0x1f14('0x12')](function(_0x302931,_0x366066){delete _0x302931[a11_0x1f14('0x22')]['id'];delete _0x302931[a11_0x1f14('0x22')][a11_0x1f14('0x23')];delete _0x302931[a11_0x1f14('0x22')][a11_0x1f14('0x16')];delete _0x302931[a11_0x1f14('0x22')][a11_0x1f14('0x24')];delete _0x302931[a11_0x1f14('0x22')][a11_0x1f14('0x25')];const _0x462ecd={'uuid':_0x302931[a11_0x1f14('0xf')]};const _0x4364bb=jwt[a11_0x1f14('0x18')](_0x462ecd,configJwt[a11_0x1f14('0x19')],configJwt[a11_0x1f14('0x1a')]);_0x302931['dataValues'][a11_0x1f14('0x26')]=_0x4364bb;return responseUtils[a11_0x1f14('0x1b')](_0xeb5ecb,_0x302931,0xc8);})[a11_0x1f14('0x1d')](_0x5880eb=>{return responseUtils[a11_0x1f14('0x13')](_0xeb5ecb,_0x5880eb[a11_0x1f14('0x27')],0x1f4);});}})[a11_0x1f14('0x1d')](_0x57ede3=>{return responseUtils['errorResponse'](_0xeb5ecb,_0x57ede3[a11_0x1f14('0x27')],0x1f4);});}}exports[a11_0x1f14('0x28')]=AuthenticationController;
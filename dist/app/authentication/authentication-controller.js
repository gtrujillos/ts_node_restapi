var a11_0x522b=['first_name','last_name','email','username','then','usernameNotFoundError','body','password','toJSON','uuid','sign','options','token','successResponse','errorResponse','stack','usernameTakenError','generateHash','dataValues','status','created_at','secret','catch','default','defineProperty','__esModule','jsonwebtoken','../../config/jwt.js','../../infrastructure/response-utils','string-format','model','bind','createAccount','login','findOne'];(function(_0x34338c,_0x5549e0){var _0x1ab781=function(_0x4f29d3){while(--_0x4f29d3){_0x34338c['push'](_0x34338c['shift']());}};_0x1ab781(++_0x5549e0);}(a11_0x522b,0x1bc));var a11_0x1a40=function(_0x4835fc,_0x4870e6){_0x4835fc=_0x4835fc-0x0;var _0x1540d8=a11_0x522b[_0x4835fc];return _0x1540d8;};'use strict';Object[a11_0x1a40('0x0')](exports,a11_0x1a40('0x1'),{'value':!![]});const jwt=require(a11_0x1a40('0x2'));const i18n=require('i18n');const configJwt=require(a11_0x1a40('0x3'));const authUtils=require('../../infrastructure/auth-utils');const responseUtils=require(a11_0x1a40('0x4'));const LocaleStrings=require('../../resources/locale-strings');const format=require(a11_0x1a40('0x5'));class AuthenticationController{constructor(_0x10b9cd){this[a11_0x1a40('0x6')]=_0x10b9cd;this['login']=this['login'][a11_0x1a40('0x7')](this);this[a11_0x1a40('0x8')]=this[a11_0x1a40('0x8')][a11_0x1a40('0x7')](this);}[a11_0x1a40('0x9')](_0x3a6814,_0x48427f,_0x5ce24b){this[a11_0x1a40('0x6')][a11_0x1a40('0xa')]({'where':{'username':_0x3a6814['body']['username']},'attributes':['uuid',a11_0x1a40('0xb'),a11_0x1a40('0xc'),a11_0x1a40('0xd'),a11_0x1a40('0xe'),'password']})[a11_0x1a40('0xf')](_0x54ec68=>{if(!_0x54ec68){return responseUtils['errorResponse'](_0x48427f,format(LocaleStrings[a11_0x1a40('0x10')],_0x3a6814[a11_0x1a40('0x11')]['username']),0x193);}if(authUtils['validPassword'](_0x3a6814[a11_0x1a40('0x11')][a11_0x1a40('0x12')],_0x54ec68[a11_0x1a40('0x12')])){_0x54ec68=_0x54ec68[a11_0x1a40('0x13')]();const _0x2b2441={'uuid':_0x54ec68[a11_0x1a40('0x14')]};const _0x536c2e=jwt[a11_0x1a40('0x15')](_0x2b2441,configJwt['secret'],configJwt[a11_0x1a40('0x16')]);delete _0x54ec68[a11_0x1a40('0x12')];_0x54ec68[a11_0x1a40('0x17')]=_0x536c2e;return responseUtils[a11_0x1a40('0x18')](_0x48427f,_0x54ec68,0xc8);}else{return responseUtils[a11_0x1a40('0x19')](_0x48427f,format(LocaleStrings['passwordNotMatchError']),0x193);}})['catch'](_0x2aeb36=>{return responseUtils[a11_0x1a40('0x19')](_0x48427f,_0x2aeb36[a11_0x1a40('0x1a')],0x1f4);});}[a11_0x1a40('0x8')](_0x43bde2,_0x28bd70,_0x3d7d4d){this[a11_0x1a40('0x6')][a11_0x1a40('0xa')]({'where':{'username':_0x43bde2[a11_0x1a40('0x11')][a11_0x1a40('0xe')]}})[a11_0x1a40('0xf')](_0x41cd12=>{if(_0x41cd12){return responseUtils[a11_0x1a40('0x19')](_0x28bd70,format(LocaleStrings[a11_0x1a40('0x1b')],_0x43bde2['body'][a11_0x1a40('0xe')]),0x193);}else{_0x43bde2[a11_0x1a40('0x11')][a11_0x1a40('0xd')]=_0x43bde2[a11_0x1a40('0x11')][a11_0x1a40('0xe')];const _0x301232={'first_name':_0x43bde2[a11_0x1a40('0x11')][a11_0x1a40('0xb')],'last_name':_0x43bde2[a11_0x1a40('0x11')][a11_0x1a40('0xc')],'email':_0x43bde2[a11_0x1a40('0x11')][a11_0x1a40('0xd')],'username':_0x43bde2[a11_0x1a40('0x11')][a11_0x1a40('0xe')],'password':authUtils[a11_0x1a40('0x1c')](_0x43bde2[a11_0x1a40('0x11')][a11_0x1a40('0x12')])};this[a11_0x1a40('0x6')]['create'](_0x301232)[a11_0x1a40('0xf')](function(_0x755233,_0x880074){delete _0x755233[a11_0x1a40('0x1d')]['id'];delete _0x755233[a11_0x1a40('0x1d')][a11_0x1a40('0x1e')];delete _0x755233[a11_0x1a40('0x1d')][a11_0x1a40('0x12')];delete _0x755233[a11_0x1a40('0x1d')]['updated_at'];delete _0x755233[a11_0x1a40('0x1d')][a11_0x1a40('0x1f')];const _0x552d73={'uuid':_0x755233['uuid']};const _0x3ee66d=jwt[a11_0x1a40('0x15')](_0x552d73,configJwt[a11_0x1a40('0x20')],configJwt['options']);_0x755233[a11_0x1a40('0x1d')][a11_0x1a40('0x17')]=_0x3ee66d;return responseUtils[a11_0x1a40('0x18')](_0x28bd70,_0x755233,0xc8);})[a11_0x1a40('0x21')](_0x3bdffa=>{return responseUtils['errorResponse'](_0x28bd70,_0x3bdffa[a11_0x1a40('0x1a')],0x1f4);});}})[a11_0x1a40('0x21')](_0x1ce111=>{return responseUtils['errorResponse'](_0x28bd70,_0x1ce111[a11_0x1a40('0x1a')],0x1f4);});}}exports[a11_0x1a40('0x22')]=AuthenticationController;
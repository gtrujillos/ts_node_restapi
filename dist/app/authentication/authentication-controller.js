var a11_0x56c5=['passwordNotMatchError','catch','stack','usernameTakenError','email','last_name','generateHash','dataValues','status','updated_at','created_at','uuid','default','defineProperty','jsonwebtoken','i18n','../../config/jwt.js','../../infrastructure/auth-utils','../../infrastructure/response-utils','string-format','model','bind','createAccount','login','findOne','body','first_name','username','then','errorResponse','validPassword','password','toJSON','sign','secret','options','token','successResponse'];(function(_0xf540c6,_0x35b0b6){var _0x34b348=function(_0x2ce5d9){while(--_0x2ce5d9){_0xf540c6['push'](_0xf540c6['shift']());}};_0x34b348(++_0x35b0b6);}(a11_0x56c5,0xa5));var a11_0xdb60=function(_0x1d4899,_0x2fb485){_0x1d4899=_0x1d4899-0x0;var _0x236618=a11_0x56c5[_0x1d4899];return _0x236618;};'use strict';Object[a11_0xdb60('0x0')](exports,'__esModule',{'value':!![]});const jwt=require(a11_0xdb60('0x1'));const i18n=require(a11_0xdb60('0x2'));const configJwt=require(a11_0xdb60('0x3'));const authUtils=require(a11_0xdb60('0x4'));const responseUtils=require(a11_0xdb60('0x5'));const LocaleStrings=require('../../resources/locale-strings');const format=require(a11_0xdb60('0x6'));class AuthenticationController{constructor(_0x36a2ec){this[a11_0xdb60('0x7')]=_0x36a2ec;this['login']=this['login'][a11_0xdb60('0x8')](this);this[a11_0xdb60('0x9')]=this['createAccount'][a11_0xdb60('0x8')](this);}[a11_0xdb60('0xa')](_0x3dfcee,_0x364681,_0x3e3694){this[a11_0xdb60('0x7')][a11_0xdb60('0xb')]({'where':{'username':_0x3dfcee[a11_0xdb60('0xc')]['username']},'attributes':['uuid',a11_0xdb60('0xd'),'last_name','email',a11_0xdb60('0xe'),'password']})[a11_0xdb60('0xf')](_0x2771f1=>{if(!_0x2771f1){return responseUtils[a11_0xdb60('0x10')](_0x364681,format(LocaleStrings['usernameNotFoundError'],_0x3dfcee[a11_0xdb60('0xc')]['username']),0x193);}if(authUtils[a11_0xdb60('0x11')](_0x3dfcee['body']['password'],_0x2771f1[a11_0xdb60('0x12')])){_0x2771f1=_0x2771f1[a11_0xdb60('0x13')]();const _0x491f60={'uuid':_0x2771f1['uuid']};const _0x15aa52=jwt[a11_0xdb60('0x14')](_0x491f60,configJwt[a11_0xdb60('0x15')],configJwt[a11_0xdb60('0x16')]);delete _0x2771f1[a11_0xdb60('0x12')];_0x2771f1[a11_0xdb60('0x17')]=_0x15aa52;return responseUtils[a11_0xdb60('0x18')](_0x364681,_0x2771f1,0xc8);}else{return responseUtils[a11_0xdb60('0x10')](_0x364681,format(LocaleStrings[a11_0xdb60('0x19')]),0x193);}})[a11_0xdb60('0x1a')](_0xed2778=>{return responseUtils[a11_0xdb60('0x10')](_0x364681,_0xed2778[a11_0xdb60('0x1b')],0x1f4);});}[a11_0xdb60('0x9')](_0x53b1f0,_0x5f349f,_0x3530de){this['model'][a11_0xdb60('0xb')]({'where':{'username':_0x53b1f0[a11_0xdb60('0xc')][a11_0xdb60('0xe')]}})[a11_0xdb60('0xf')](_0xb49746=>{if(_0xb49746){return responseUtils[a11_0xdb60('0x10')](_0x5f349f,format(LocaleStrings[a11_0xdb60('0x1c')],_0x53b1f0['body']['username']),0x193);}else{_0x53b1f0[a11_0xdb60('0xc')][a11_0xdb60('0x1d')]=_0x53b1f0[a11_0xdb60('0xc')][a11_0xdb60('0xe')];const _0x2842e4={'first_name':_0x53b1f0[a11_0xdb60('0xc')][a11_0xdb60('0xd')],'last_name':_0x53b1f0['body'][a11_0xdb60('0x1e')],'email':_0x53b1f0[a11_0xdb60('0xc')][a11_0xdb60('0x1d')],'username':_0x53b1f0[a11_0xdb60('0xc')][a11_0xdb60('0xe')],'password':authUtils[a11_0xdb60('0x1f')](_0x53b1f0[a11_0xdb60('0xc')][a11_0xdb60('0x12')])};this['model']['create'](_0x2842e4)[a11_0xdb60('0xf')](function(_0x483121,_0x4b04f2){delete _0x483121[a11_0xdb60('0x20')]['id'];delete _0x483121[a11_0xdb60('0x20')][a11_0xdb60('0x21')];delete _0x483121[a11_0xdb60('0x20')][a11_0xdb60('0x12')];delete _0x483121['dataValues'][a11_0xdb60('0x22')];delete _0x483121['dataValues'][a11_0xdb60('0x23')];const _0x4bb2be={'uuid':_0x483121[a11_0xdb60('0x24')]};const _0x71eff4=jwt[a11_0xdb60('0x14')](_0x4bb2be,configJwt[a11_0xdb60('0x15')],configJwt['options']);_0x483121['dataValues'][a11_0xdb60('0x17')]=_0x71eff4;return responseUtils[a11_0xdb60('0x18')](_0x5f349f,_0x483121,0xc8);})['catch'](_0x2e673c=>{return responseUtils['errorResponse'](_0x5f349f,_0x2e673c[a11_0xdb60('0x1b')],0x1f4);});}})[a11_0xdb60('0x1a')](_0x9331fa=>{return responseUtils[a11_0xdb60('0x10')](_0x5f349f,_0x9331fa['stack'],0x1f4);});}}exports[a11_0xdb60('0x25')]=AuthenticationController;
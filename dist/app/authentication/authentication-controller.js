var a11_0x11ac=['secret','options','token','successResponse','passwordNotMatchError','catch','stack','then','generateHash','create','dataValues','status','updated_at','created_at','defineProperty','__esModule','jsonwebtoken','i18n','../../config/jwt.js','../../infrastructure/auth-utils','../../infrastructure/response-utils','../../resources/locale-strings','login','bind','createAccount','model','findOne','body','username','uuid','first_name','last_name','email','password','errorResponse','usernameNotFoundError','toJSON','sign'];(function(_0x5ea6e9,_0x4b0045){var _0x410393=function(_0x3c36f){while(--_0x3c36f){_0x5ea6e9['push'](_0x5ea6e9['shift']());}};_0x410393(++_0x4b0045);}(a11_0x11ac,0xf2));var a11_0x34f5=function(_0x5aa676,_0x418aab){_0x5aa676=_0x5aa676-0x0;var _0x5e9e4b=a11_0x11ac[_0x5aa676];return _0x5e9e4b;};'use strict';Object[a11_0x34f5('0x0')](exports,a11_0x34f5('0x1'),{'value':!![]});const jwt=require(a11_0x34f5('0x2'));const i18n=require(a11_0x34f5('0x3'));const configJwt=require(a11_0x34f5('0x4'));const authUtils=require(a11_0x34f5('0x5'));const responseUtils=require(a11_0x34f5('0x6'));const LocaleStrings=require(a11_0x34f5('0x7'));const format=require('string-format');class AuthenticationController{constructor(_0x42b238){this['model']=_0x42b238;this['login']=this[a11_0x34f5('0x8')][a11_0x34f5('0x9')](this);this[a11_0x34f5('0xa')]=this['createAccount'][a11_0x34f5('0x9')](this);}['login'](_0x4b3f72,_0x2fd4e6,_0x264548){this[a11_0x34f5('0xb')][a11_0x34f5('0xc')]({'where':{'username':_0x4b3f72[a11_0x34f5('0xd')][a11_0x34f5('0xe')]},'attributes':[a11_0x34f5('0xf'),a11_0x34f5('0x10'),a11_0x34f5('0x11'),a11_0x34f5('0x12'),'username',a11_0x34f5('0x13')]})['then'](_0x38bdea=>{if(!_0x38bdea){return responseUtils[a11_0x34f5('0x14')](_0x2fd4e6,format(LocaleStrings[a11_0x34f5('0x15')],_0x4b3f72['body'][a11_0x34f5('0xe')]),0x193);}if(authUtils['validPassword'](_0x4b3f72['body'][a11_0x34f5('0x13')],_0x38bdea[a11_0x34f5('0x13')])){_0x38bdea=_0x38bdea[a11_0x34f5('0x16')]();const _0x196f4e={'uuid':_0x38bdea[a11_0x34f5('0xf')]};const _0x469484=jwt[a11_0x34f5('0x17')](_0x196f4e,configJwt[a11_0x34f5('0x18')],configJwt[a11_0x34f5('0x19')]);delete _0x38bdea[a11_0x34f5('0x13')];_0x38bdea[a11_0x34f5('0x1a')]=_0x469484;return responseUtils[a11_0x34f5('0x1b')](_0x2fd4e6,_0x38bdea,0xc8);}else{return responseUtils['errorResponse'](_0x2fd4e6,format(LocaleStrings[a11_0x34f5('0x1c')]),0x193);}})[a11_0x34f5('0x1d')](_0x1e606b=>{return responseUtils[a11_0x34f5('0x14')](_0x2fd4e6,_0x1e606b[a11_0x34f5('0x1e')],0x1f4);});}[a11_0x34f5('0xa')](_0x163f79,_0x12a1ce,_0x560481){this[a11_0x34f5('0xb')]['findOne']({'where':{'username':_0x163f79[a11_0x34f5('0xd')][a11_0x34f5('0xe')]}})[a11_0x34f5('0x1f')](_0x2855ae=>{if(_0x2855ae){return responseUtils[a11_0x34f5('0x14')](_0x12a1ce,format(LocaleStrings['usernameTakenError'],_0x163f79['body'][a11_0x34f5('0xe')]),0x193);}else{_0x163f79[a11_0x34f5('0xd')][a11_0x34f5('0x12')]=_0x163f79[a11_0x34f5('0xd')][a11_0x34f5('0xe')];const _0x5663a2={'first_name':_0x163f79[a11_0x34f5('0xd')][a11_0x34f5('0x10')],'last_name':_0x163f79[a11_0x34f5('0xd')][a11_0x34f5('0x11')],'email':_0x163f79[a11_0x34f5('0xd')]['email'],'username':_0x163f79[a11_0x34f5('0xd')][a11_0x34f5('0xe')],'password':authUtils[a11_0x34f5('0x20')](_0x163f79[a11_0x34f5('0xd')][a11_0x34f5('0x13')])};this[a11_0x34f5('0xb')][a11_0x34f5('0x21')](_0x5663a2)[a11_0x34f5('0x1f')](function(_0x484dcc,_0x37ac93){delete _0x484dcc['dataValues']['id'];delete _0x484dcc[a11_0x34f5('0x22')][a11_0x34f5('0x23')];delete _0x484dcc[a11_0x34f5('0x22')][a11_0x34f5('0x13')];delete _0x484dcc[a11_0x34f5('0x22')][a11_0x34f5('0x24')];delete _0x484dcc['dataValues'][a11_0x34f5('0x25')];const _0x108823={'uuid':_0x484dcc[a11_0x34f5('0xf')]};const _0x1ea229=jwt[a11_0x34f5('0x17')](_0x108823,configJwt[a11_0x34f5('0x18')],configJwt[a11_0x34f5('0x19')]);_0x484dcc[a11_0x34f5('0x22')][a11_0x34f5('0x1a')]=_0x1ea229;return responseUtils[a11_0x34f5('0x1b')](_0x12a1ce,_0x484dcc,0xc8);})[a11_0x34f5('0x1d')](_0x40d58b=>{return responseUtils[a11_0x34f5('0x14')](_0x12a1ce,_0x40d58b[a11_0x34f5('0x1e')],0x1f4);});}})[a11_0x34f5('0x1d')](_0x44ac67=>{return responseUtils[a11_0x34f5('0x14')](_0x12a1ce,_0x44ac67[a11_0x34f5('0x1e')],0x1f4);});}}exports['default']=AuthenticationController;
var a11_0xaa25=['string-format','login','bind','createAccount','model','body','first_name','last_name','email','username','password','then','errorResponse','toJSON','uuid','sign','secret','options','token','successResponse','passwordNotMatchError','catch','stack','usernameTakenError','generateHash','create','dataValues','status','updated_at','default','defineProperty','../../config/jwt.js','../../infrastructure/auth-utils','../../infrastructure/response-utils','../../resources/locale-strings'];(function(_0x1a2628,_0x528615){var _0x4025a2=function(_0x2a0bf2){while(--_0x2a0bf2){_0x1a2628['push'](_0x1a2628['shift']());}};_0x4025a2(++_0x528615);}(a11_0xaa25,0xf0));var a11_0x2edf=function(_0x2fbeca,_0x302170){_0x2fbeca=_0x2fbeca-0x0;var _0x1ae02f=a11_0xaa25[_0x2fbeca];return _0x1ae02f;};'use strict';Object[a11_0x2edf('0x0')](exports,'__esModule',{'value':!![]});const jwt=require('jsonwebtoken');const i18n=require('i18n');const configJwt=require(a11_0x2edf('0x1'));const authUtils=require(a11_0x2edf('0x2'));const responseUtils=require(a11_0x2edf('0x3'));const LocaleStrings=require(a11_0x2edf('0x4'));const format=require(a11_0x2edf('0x5'));class AuthenticationController{constructor(_0x5c00eb){this['model']=_0x5c00eb;this[a11_0x2edf('0x6')]=this[a11_0x2edf('0x6')][a11_0x2edf('0x7')](this);this[a11_0x2edf('0x8')]=this[a11_0x2edf('0x8')][a11_0x2edf('0x7')](this);}[a11_0x2edf('0x6')](_0x3d239a,_0x20780b,_0x57ea83){this[a11_0x2edf('0x9')]['findOne']({'where':{'username':_0x3d239a[a11_0x2edf('0xa')]['username']},'attributes':['uuid',a11_0x2edf('0xb'),a11_0x2edf('0xc'),a11_0x2edf('0xd'),a11_0x2edf('0xe'),a11_0x2edf('0xf')]})[a11_0x2edf('0x10')](_0x3500c2=>{if(!_0x3500c2){return responseUtils[a11_0x2edf('0x11')](_0x20780b,format(LocaleStrings['usernameNotFoundError'],_0x3d239a['body'][a11_0x2edf('0xe')]),0x193);}if(authUtils['validPassword'](_0x3d239a[a11_0x2edf('0xa')]['password'],_0x3500c2['password'])){_0x3500c2=_0x3500c2[a11_0x2edf('0x12')]();const _0x3eb8e7={'uuid':_0x3500c2[a11_0x2edf('0x13')]};const _0xbcef2c=jwt[a11_0x2edf('0x14')](_0x3eb8e7,configJwt[a11_0x2edf('0x15')],configJwt[a11_0x2edf('0x16')]);delete _0x3500c2[a11_0x2edf('0xf')];_0x3500c2[a11_0x2edf('0x17')]=_0xbcef2c;return responseUtils[a11_0x2edf('0x18')](_0x20780b,_0x3500c2,0xc8);}else{return responseUtils[a11_0x2edf('0x11')](_0x20780b,format(LocaleStrings[a11_0x2edf('0x19')]),0x193);}})[a11_0x2edf('0x1a')](_0x14813c=>{return responseUtils['errorResponse'](_0x20780b,_0x14813c[a11_0x2edf('0x1b')],0x1f4);});}[a11_0x2edf('0x8')](_0x412c7c,_0x494c99,_0x5177d9){this[a11_0x2edf('0x9')]['findOne']({'where':{'username':_0x412c7c[a11_0x2edf('0xa')][a11_0x2edf('0xe')]}})[a11_0x2edf('0x10')](_0x56e154=>{if(_0x56e154){return responseUtils[a11_0x2edf('0x11')](_0x494c99,format(LocaleStrings[a11_0x2edf('0x1c')],_0x412c7c['body']['username']),0x193);}else{_0x412c7c[a11_0x2edf('0xa')][a11_0x2edf('0xd')]=_0x412c7c[a11_0x2edf('0xa')][a11_0x2edf('0xe')];const _0x5ab7e4={'first_name':_0x412c7c['body'][a11_0x2edf('0xb')],'last_name':_0x412c7c[a11_0x2edf('0xa')]['last_name'],'email':_0x412c7c['body'][a11_0x2edf('0xd')],'username':_0x412c7c[a11_0x2edf('0xa')][a11_0x2edf('0xe')],'password':authUtils[a11_0x2edf('0x1d')](_0x412c7c['body']['password'])};this[a11_0x2edf('0x9')][a11_0x2edf('0x1e')](_0x5ab7e4)[a11_0x2edf('0x10')](function(_0x5bba0d,_0x267add){delete _0x5bba0d[a11_0x2edf('0x1f')]['id'];delete _0x5bba0d[a11_0x2edf('0x1f')][a11_0x2edf('0x20')];delete _0x5bba0d[a11_0x2edf('0x1f')][a11_0x2edf('0xf')];delete _0x5bba0d[a11_0x2edf('0x1f')][a11_0x2edf('0x21')];delete _0x5bba0d[a11_0x2edf('0x1f')]['created_at'];const _0x4900b9={'uuid':_0x5bba0d[a11_0x2edf('0x13')]};const _0x1e801c=jwt[a11_0x2edf('0x14')](_0x4900b9,configJwt[a11_0x2edf('0x15')],configJwt['options']);_0x5bba0d[a11_0x2edf('0x1f')][a11_0x2edf('0x17')]=_0x1e801c;return responseUtils[a11_0x2edf('0x18')](_0x494c99,_0x5bba0d,0xc8);})[a11_0x2edf('0x1a')](_0x3f8cd1=>{return responseUtils['errorResponse'](_0x494c99,_0x3f8cd1[a11_0x2edf('0x1b')],0x1f4);});}})[a11_0x2edf('0x1a')](_0xea47f3=>{return responseUtils[a11_0x2edf('0x11')](_0x494c99,_0xea47f3[a11_0x2edf('0x1b')],0x1f4);});}}exports[a11_0x2edf('0x22')]=AuthenticationController;
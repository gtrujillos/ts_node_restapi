var a30_0x2fa1=['dataValues','catch','stack','__importDefault','__esModule','defineProperty','../../infrastructure/crypt-utils','i18n','../../config/jwt.js','../../infrastructure/auth-utils','../../resources/locale-strings','string-format','model','login','createAccount','bind','findOne','body','username','first_name','last_name','email','password','errorResponse','usernameNotFoundError','default','validPassword','toJSON','sign','secret','options','then','usernameTakenError','hashPassword','create'];(function(_0x3110ef,_0x1063bc){var _0x33593e=function(_0x388248){while(--_0x388248){_0x3110ef['push'](_0x3110ef['shift']());}};_0x33593e(++_0x1063bc);}(a30_0x2fa1,0xd5));var a30_0x3abd=function(_0xb67384,_0x27295a){_0xb67384=_0xb67384-0x0;var _0x156d7c=a30_0x2fa1[_0xb67384];return _0x156d7c;};'use strict';var __importDefault=this&&this[a30_0x3abd('0x0')]||function(_0x798f3){return _0x798f3&&_0x798f3[a30_0x3abd('0x1')]?_0x798f3:{'default':_0x798f3};};Object[a30_0x3abd('0x2')](exports,a30_0x3abd('0x1'),{'value':!![]});const crypt_utils_1=__importDefault(require(a30_0x3abd('0x3')));const jwt=require('jsonwebtoken');const i18n=require(a30_0x3abd('0x4'));const configJwt=require(a30_0x3abd('0x5'));const authUtils=require(a30_0x3abd('0x6'));const responseUtils=require('../../infrastructure/response-utils');const LocaleStrings=require(a30_0x3abd('0x7'));const format=require(a30_0x3abd('0x8'));class AuthenticationController{constructor(_0xf8c12){this[a30_0x3abd('0x9')]=_0xf8c12;this[a30_0x3abd('0xa')]=this[a30_0x3abd('0xa')]['bind'](this);this['createAccount']=this[a30_0x3abd('0xb')][a30_0x3abd('0xc')](this);}[a30_0x3abd('0xa')](_0x331349,_0x57e969,_0x91553c){this[a30_0x3abd('0x9')][a30_0x3abd('0xd')]({'where':{'username':_0x331349[a30_0x3abd('0xe')][a30_0x3abd('0xf')]},'attributes':['id',a30_0x3abd('0x10'),a30_0x3abd('0x11'),a30_0x3abd('0x12'),a30_0x3abd('0xf'),a30_0x3abd('0x13')]})['then'](_0x4ac9de=>{if(!_0x4ac9de){return responseUtils[a30_0x3abd('0x14')](_0x57e969,format(LocaleStrings[a30_0x3abd('0x15')],_0x331349[a30_0x3abd('0xe')][a30_0x3abd('0xf')]),0x193);}if(crypt_utils_1[a30_0x3abd('0x16')][a30_0x3abd('0x17')](_0x331349[a30_0x3abd('0xe')][a30_0x3abd('0x13')],_0x4ac9de[a30_0x3abd('0x13')])){_0x4ac9de=_0x4ac9de[a30_0x3abd('0x18')]();const _0x502987={'id':_0x4ac9de['id']};const _0xae52be=jwt[a30_0x3abd('0x19')](_0x502987,configJwt[a30_0x3abd('0x1a')],configJwt[a30_0x3abd('0x1b')]);const _0x39eb95={'token':_0xae52be};return responseUtils['successResponse'](_0x57e969,_0x39eb95,0xc8);}else{return responseUtils[a30_0x3abd('0x14')](_0x57e969,format(LocaleStrings['passwordNotMatchError']),0x193);}})['catch'](_0x47e91a=>{return responseUtils['errorResponse'](_0x57e969,_0x47e91a['stack'],0x1f4);});}[a30_0x3abd('0xb')](_0x16d98f,_0x20747f,_0x2a76a7){this[a30_0x3abd('0x9')][a30_0x3abd('0xd')]({'where':{'username':_0x16d98f['body'][a30_0x3abd('0xf')]}})[a30_0x3abd('0x1c')](_0x4867d4=>{if(_0x4867d4){return responseUtils[a30_0x3abd('0x14')](_0x20747f,format(LocaleStrings[a30_0x3abd('0x1d')],_0x16d98f['body']['username']),0x193);}else{_0x16d98f[a30_0x3abd('0xe')][a30_0x3abd('0x12')]=_0x16d98f['body'][a30_0x3abd('0xf')];const _0x478a2b={'first_name':_0x16d98f['body'][a30_0x3abd('0x10')],'last_name':_0x16d98f[a30_0x3abd('0xe')][a30_0x3abd('0x11')],'email':_0x16d98f[a30_0x3abd('0xe')][a30_0x3abd('0x12')],'username':_0x16d98f[a30_0x3abd('0xe')]['username'],'password':crypt_utils_1[a30_0x3abd('0x16')][a30_0x3abd('0x1e')](_0x16d98f[a30_0x3abd('0xe')]['password'])};this['model'][a30_0x3abd('0x1f')](_0x478a2b)[a30_0x3abd('0x1c')](function(_0x3ab90d,_0x59d940){const _0x5f141a={'id':_0x3ab90d[a30_0x3abd('0x20')]['id']};const _0x4c982b=jwt[a30_0x3abd('0x19')](_0x5f141a,configJwt[a30_0x3abd('0x1a')],configJwt['options']);const _0x1f9634={'token':_0x4c982b};return responseUtils['successResponse'](_0x20747f,_0x1f9634,0xc8);})[a30_0x3abd('0x21')](_0x344af7=>{return responseUtils[a30_0x3abd('0x14')](_0x20747f,_0x344af7[a30_0x3abd('0x22')],0x1f4);});}})['catch'](_0x5e1f43=>{return responseUtils[a30_0x3abd('0x14')](_0x20747f,_0x5e1f43[a30_0x3abd('0x22')],0x1f4);});}}exports[a30_0x3abd('0x16')]=AuthenticationController;
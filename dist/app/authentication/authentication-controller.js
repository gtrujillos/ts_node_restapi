var a11_0x4c6b=['sign','secret','options','token','catch','stack','findOne','usernameTakenError','generateHash','create','dataValues','status','updated_at','created_at','successResponse','default','defineProperty','__esModule','jsonwebtoken','i18n','../../config/jwt.js','../../infrastructure/auth-utils','../../resources/locale-strings','string-format','model','login','bind','createAccount','body','last_name','email','username','password','then','errorResponse','validPassword','uuid'];(function(_0x44e619,_0x269782){var _0x497647=function(_0x295915){while(--_0x295915){_0x44e619['push'](_0x44e619['shift']());}};_0x497647(++_0x269782);}(a11_0x4c6b,0xee));var a11_0x2756=function(_0x208a89,_0x4fbcd9){_0x208a89=_0x208a89-0x0;var _0x487c52=a11_0x4c6b[_0x208a89];return _0x487c52;};'use strict';Object[a11_0x2756('0x0')](exports,a11_0x2756('0x1'),{'value':!![]});const jwt=require(a11_0x2756('0x2'));const i18n=require(a11_0x2756('0x3'));const configJwt=require(a11_0x2756('0x4'));const authUtils=require(a11_0x2756('0x5'));const responseUtils=require('../../infrastructure/response-utils');const LocaleStrings=require(a11_0x2756('0x6'));const format=require(a11_0x2756('0x7'));class AuthenticationController{constructor(_0x2ce270){this[a11_0x2756('0x8')]=_0x2ce270;this['login']=this[a11_0x2756('0x9')][a11_0x2756('0xa')](this);this[a11_0x2756('0xb')]=this[a11_0x2756('0xb')]['bind'](this);}[a11_0x2756('0x9')](_0x4e5427,_0x175c6d,_0x36496d){this['model']['findOne']({'where':{'username':_0x4e5427[a11_0x2756('0xc')]['username']},'attributes':['uuid','first_name',a11_0x2756('0xd'),a11_0x2756('0xe'),a11_0x2756('0xf'),a11_0x2756('0x10')]})[a11_0x2756('0x11')](_0x4bde28=>{if(!_0x4bde28){return responseUtils[a11_0x2756('0x12')](_0x175c6d,format(LocaleStrings['usernameNotFoundError'],_0x4e5427[a11_0x2756('0xc')]['username']),0x193);}if(authUtils[a11_0x2756('0x13')](_0x4e5427[a11_0x2756('0xc')]['password'],_0x4bde28['password'])){_0x4bde28=_0x4bde28['toJSON']();const _0x1620e3={'uuid':_0x4bde28[a11_0x2756('0x14')]};const _0x9c2850=jwt[a11_0x2756('0x15')](_0x1620e3,configJwt[a11_0x2756('0x16')],configJwt[a11_0x2756('0x17')]);delete _0x4bde28['password'];_0x4bde28[a11_0x2756('0x18')]=_0x9c2850;return responseUtils['successResponse'](_0x175c6d,_0x4bde28,0xc8);}else{return responseUtils[a11_0x2756('0x12')](_0x175c6d,format(LocaleStrings['passwordNotMatchError']),0x193);}})[a11_0x2756('0x19')](_0x22bf50=>{return responseUtils['errorResponse'](_0x175c6d,_0x22bf50[a11_0x2756('0x1a')],0x1f4);});}['createAccount'](_0x20e2cb,_0x2006c7,_0x3208b5){this[a11_0x2756('0x8')][a11_0x2756('0x1b')]({'where':{'username':_0x20e2cb['body'][a11_0x2756('0xf')]}})[a11_0x2756('0x11')](_0x5c1295=>{if(_0x5c1295){return responseUtils[a11_0x2756('0x12')](_0x2006c7,format(LocaleStrings[a11_0x2756('0x1c')],_0x20e2cb[a11_0x2756('0xc')][a11_0x2756('0xf')]),0x193);}else{_0x20e2cb[a11_0x2756('0xc')]['email']=_0x20e2cb[a11_0x2756('0xc')]['username'];const _0x6d8bd5={'first_name':_0x20e2cb['body']['first_name'],'last_name':_0x20e2cb[a11_0x2756('0xc')][a11_0x2756('0xd')],'email':_0x20e2cb[a11_0x2756('0xc')][a11_0x2756('0xe')],'username':_0x20e2cb[a11_0x2756('0xc')][a11_0x2756('0xf')],'password':authUtils[a11_0x2756('0x1d')](_0x20e2cb[a11_0x2756('0xc')][a11_0x2756('0x10')])};this[a11_0x2756('0x8')][a11_0x2756('0x1e')](_0x6d8bd5)[a11_0x2756('0x11')](function(_0x67a321,_0x37c449){delete _0x67a321[a11_0x2756('0x1f')]['id'];delete _0x67a321[a11_0x2756('0x1f')][a11_0x2756('0x20')];delete _0x67a321['dataValues'][a11_0x2756('0x10')];delete _0x67a321[a11_0x2756('0x1f')][a11_0x2756('0x21')];delete _0x67a321[a11_0x2756('0x1f')][a11_0x2756('0x22')];const _0x544727={'uuid':_0x67a321[a11_0x2756('0x14')]};const _0x4ee02b=jwt[a11_0x2756('0x15')](_0x544727,configJwt[a11_0x2756('0x16')],configJwt[a11_0x2756('0x17')]);_0x67a321[a11_0x2756('0x1f')][a11_0x2756('0x18')]=_0x4ee02b;return responseUtils[a11_0x2756('0x23')](_0x2006c7,_0x67a321,0xc8);})[a11_0x2756('0x19')](_0x1b3127=>{return responseUtils['errorResponse'](_0x2006c7,_0x1b3127[a11_0x2756('0x1a')],0x1f4);});}})['catch'](_0x4f1e14=>{return responseUtils['errorResponse'](_0x2006c7,_0x4f1e14[a11_0x2756('0x1a')],0x1f4);});}}exports[a11_0x2756('0x24')]=AuthenticationController;
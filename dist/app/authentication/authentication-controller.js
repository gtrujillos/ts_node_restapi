var a11_0x586d=['errorResponse','passwordNotMatchError','catch','stack','findOne','usernameTakenError','generateHash','create','dataValues','sign','secret','default','defineProperty','__esModule','i18n','../../infrastructure/auth-utils','string-format','model','login','bind','createAccount','body','uuid','first_name','last_name','email','username','password','then','usernameNotFoundError','validPassword','toJSON','options','token','successResponse'];(function(_0x19f6da,_0x1a7f3f){var _0x20ec8c=function(_0x30156c){while(--_0x30156c){_0x19f6da['push'](_0x19f6da['shift']());}};_0x20ec8c(++_0x1a7f3f);}(a11_0x586d,0x75));var a11_0x4cb4=function(_0x2f3e31,_0x3a89c9){_0x2f3e31=_0x2f3e31-0x0;var _0x2c6db2=a11_0x586d[_0x2f3e31];return _0x2c6db2;};'use strict';Object[a11_0x4cb4('0x0')](exports,a11_0x4cb4('0x1'),{'value':!![]});const jwt=require('jsonwebtoken');const i18n=require(a11_0x4cb4('0x2'));const configJwt=require('../../config/jwt.js');const authUtils=require(a11_0x4cb4('0x3'));const responseUtils=require('../../infrastructure/response-utils');const LocaleStrings=require('../../resources/locale-strings');const format=require(a11_0x4cb4('0x4'));class AuthenticationController{constructor(_0x2db288){this[a11_0x4cb4('0x5')]=_0x2db288;this[a11_0x4cb4('0x6')]=this[a11_0x4cb4('0x6')][a11_0x4cb4('0x7')](this);this['createAccount']=this[a11_0x4cb4('0x8')][a11_0x4cb4('0x7')](this);}[a11_0x4cb4('0x6')](_0x1b94d8,_0x4b3be9,_0x3d91a7){this[a11_0x4cb4('0x5')]['findOne']({'where':{'username':_0x1b94d8[a11_0x4cb4('0x9')]['username']},'attributes':[a11_0x4cb4('0xa'),a11_0x4cb4('0xb'),a11_0x4cb4('0xc'),a11_0x4cb4('0xd'),a11_0x4cb4('0xe'),a11_0x4cb4('0xf')]})[a11_0x4cb4('0x10')](_0x4775e=>{if(!_0x4775e){return responseUtils['errorResponse'](_0x4b3be9,format(LocaleStrings[a11_0x4cb4('0x11')],_0x1b94d8['body'][a11_0x4cb4('0xe')]),0x193);}if(authUtils[a11_0x4cb4('0x12')](_0x1b94d8[a11_0x4cb4('0x9')][a11_0x4cb4('0xf')],_0x4775e[a11_0x4cb4('0xf')])){_0x4775e=_0x4775e[a11_0x4cb4('0x13')]();const _0x5ddc0a={'uuid':_0x4775e[a11_0x4cb4('0xa')]};const _0x3f4264=jwt['sign'](_0x5ddc0a,configJwt['secret'],configJwt[a11_0x4cb4('0x14')]);delete _0x4775e[a11_0x4cb4('0xf')];_0x4775e[a11_0x4cb4('0x15')]=_0x3f4264;return responseUtils[a11_0x4cb4('0x16')](_0x4b3be9,_0x4775e,0xc8);}else{return responseUtils[a11_0x4cb4('0x17')](_0x4b3be9,format(LocaleStrings[a11_0x4cb4('0x18')]),0x193);}})[a11_0x4cb4('0x19')](_0x37da7e=>{return responseUtils[a11_0x4cb4('0x17')](_0x4b3be9,_0x37da7e[a11_0x4cb4('0x1a')],0x1f4);});}[a11_0x4cb4('0x8')](_0x4dceba,_0x536330,_0x4937a1){this[a11_0x4cb4('0x5')][a11_0x4cb4('0x1b')]({'where':{'username':_0x4dceba['body'][a11_0x4cb4('0xe')]}})[a11_0x4cb4('0x10')](_0x3e0f69=>{if(_0x3e0f69){return responseUtils[a11_0x4cb4('0x17')](_0x536330,format(LocaleStrings[a11_0x4cb4('0x1c')],_0x4dceba['body'][a11_0x4cb4('0xe')]),0x193);}else{_0x4dceba['body'][a11_0x4cb4('0xd')]=_0x4dceba[a11_0x4cb4('0x9')][a11_0x4cb4('0xe')];const _0x52c4ee={'first_name':_0x4dceba['body'][a11_0x4cb4('0xb')],'last_name':_0x4dceba[a11_0x4cb4('0x9')][a11_0x4cb4('0xc')],'email':_0x4dceba[a11_0x4cb4('0x9')]['email'],'username':_0x4dceba[a11_0x4cb4('0x9')][a11_0x4cb4('0xe')],'password':authUtils[a11_0x4cb4('0x1d')](_0x4dceba[a11_0x4cb4('0x9')][a11_0x4cb4('0xf')])};this[a11_0x4cb4('0x5')][a11_0x4cb4('0x1e')](_0x52c4ee)[a11_0x4cb4('0x10')](function(_0x2b3451,_0x40b63b){delete _0x2b3451[a11_0x4cb4('0x1f')]['id'];delete _0x2b3451[a11_0x4cb4('0x1f')]['status'];delete _0x2b3451[a11_0x4cb4('0x1f')][a11_0x4cb4('0xf')];delete _0x2b3451[a11_0x4cb4('0x1f')]['updated_at'];delete _0x2b3451[a11_0x4cb4('0x1f')]['created_at'];const _0x40a06b={'uuid':_0x2b3451[a11_0x4cb4('0xa')]};const _0x422442=jwt[a11_0x4cb4('0x20')](_0x40a06b,configJwt[a11_0x4cb4('0x21')],configJwt[a11_0x4cb4('0x14')]);_0x2b3451[a11_0x4cb4('0x1f')][a11_0x4cb4('0x15')]=_0x422442;return responseUtils[a11_0x4cb4('0x16')](_0x536330,_0x2b3451,0xc8);})[a11_0x4cb4('0x19')](_0x42f778=>{return responseUtils['errorResponse'](_0x536330,_0x42f778['stack'],0x1f4);});}})[a11_0x4cb4('0x19')](_0x933585=>{return responseUtils['errorResponse'](_0x536330,_0x933585[a11_0x4cb4('0x1a')],0x1f4);});}}exports[a11_0x4cb4('0x22')]=AuthenticationController;
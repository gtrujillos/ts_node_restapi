var a11_0x4156=['toJSON','sign','secret','options','token','successResponse','passwordNotMatchError','usernameTakenError','create','dataValues','status','created_at','catch','stack','default','defineProperty','__esModule','jsonwebtoken','i18n','../../config/jwt.js','../../infrastructure/auth-utils','../../infrastructure/response-utils','../../resources/locale-strings','model','login','bind','createAccount','findOne','body','username','uuid','last_name','email','password','then','errorResponse','usernameNotFoundError'];(function(_0x32c2ed,_0x3bb12a){var _0xb6c5f=function(_0x52a829){while(--_0x52a829){_0x32c2ed['push'](_0x32c2ed['shift']());}};_0xb6c5f(++_0x3bb12a);}(a11_0x4156,0xa3));var a11_0x5c1b=function(_0x2d158c,_0x5267c3){_0x2d158c=_0x2d158c-0x0;var _0x228c42=a11_0x4156[_0x2d158c];return _0x228c42;};'use strict';Object[a11_0x5c1b('0x0')](exports,a11_0x5c1b('0x1'),{'value':!![]});const jwt=require(a11_0x5c1b('0x2'));const i18n=require(a11_0x5c1b('0x3'));const configJwt=require(a11_0x5c1b('0x4'));const authUtils=require(a11_0x5c1b('0x5'));const responseUtils=require(a11_0x5c1b('0x6'));const LocaleStrings=require(a11_0x5c1b('0x7'));const format=require('string-format');class AuthenticationController{constructor(_0x331e61){this[a11_0x5c1b('0x8')]=_0x331e61;this[a11_0x5c1b('0x9')]=this[a11_0x5c1b('0x9')][a11_0x5c1b('0xa')](this);this[a11_0x5c1b('0xb')]=this['createAccount'][a11_0x5c1b('0xa')](this);}[a11_0x5c1b('0x9')](_0x113e9a,_0x21f679,_0x587d3f){this[a11_0x5c1b('0x8')][a11_0x5c1b('0xc')]({'where':{'username':_0x113e9a[a11_0x5c1b('0xd')][a11_0x5c1b('0xe')]},'attributes':[a11_0x5c1b('0xf'),'first_name',a11_0x5c1b('0x10'),a11_0x5c1b('0x11'),a11_0x5c1b('0xe'),a11_0x5c1b('0x12')]})[a11_0x5c1b('0x13')](_0x5f1f04=>{if(!_0x5f1f04){return responseUtils[a11_0x5c1b('0x14')](_0x21f679,format(LocaleStrings[a11_0x5c1b('0x15')],_0x113e9a[a11_0x5c1b('0xd')]['username']),0x193);}if(authUtils['validPassword'](_0x113e9a[a11_0x5c1b('0xd')][a11_0x5c1b('0x12')],_0x5f1f04['password'])){_0x5f1f04=_0x5f1f04[a11_0x5c1b('0x16')]();const _0x23f532={'uuid':_0x5f1f04[a11_0x5c1b('0xf')]};const _0x3d0511=jwt[a11_0x5c1b('0x17')](_0x23f532,configJwt[a11_0x5c1b('0x18')],configJwt[a11_0x5c1b('0x19')]);delete _0x5f1f04[a11_0x5c1b('0x12')];_0x5f1f04[a11_0x5c1b('0x1a')]=_0x3d0511;return responseUtils[a11_0x5c1b('0x1b')](_0x21f679,_0x5f1f04,0xc8);}else{return responseUtils['errorResponse'](_0x21f679,format(LocaleStrings[a11_0x5c1b('0x1c')]),0x193);}})['catch'](_0x5dbaf7=>{return responseUtils['errorResponse'](_0x21f679,_0x5dbaf7['stack'],0x1f4);});}[a11_0x5c1b('0xb')](_0x1fd2ae,_0x4cadad,_0x1deaf3){this['model'][a11_0x5c1b('0xc')]({'where':{'username':_0x1fd2ae[a11_0x5c1b('0xd')][a11_0x5c1b('0xe')]}})['then'](_0x287d82=>{if(_0x287d82){return responseUtils['errorResponse'](_0x4cadad,format(LocaleStrings[a11_0x5c1b('0x1d')],_0x1fd2ae['body'][a11_0x5c1b('0xe')]),0x193);}else{_0x1fd2ae[a11_0x5c1b('0xd')][a11_0x5c1b('0x11')]=_0x1fd2ae[a11_0x5c1b('0xd')][a11_0x5c1b('0xe')];const _0x3209b0={'first_name':_0x1fd2ae[a11_0x5c1b('0xd')]['first_name'],'last_name':_0x1fd2ae['body'][a11_0x5c1b('0x10')],'email':_0x1fd2ae['body'][a11_0x5c1b('0x11')],'username':_0x1fd2ae[a11_0x5c1b('0xd')]['username'],'password':authUtils['generateHash'](_0x1fd2ae[a11_0x5c1b('0xd')][a11_0x5c1b('0x12')])};this[a11_0x5c1b('0x8')][a11_0x5c1b('0x1e')](_0x3209b0)['then'](function(_0x271994,_0x33534d){delete _0x271994[a11_0x5c1b('0x1f')]['id'];delete _0x271994[a11_0x5c1b('0x1f')][a11_0x5c1b('0x20')];delete _0x271994['dataValues'][a11_0x5c1b('0x12')];delete _0x271994['dataValues']['updated_at'];delete _0x271994['dataValues'][a11_0x5c1b('0x21')];const _0x2727b8={'uuid':_0x271994[a11_0x5c1b('0xf')]};const _0x53ed35=jwt[a11_0x5c1b('0x17')](_0x2727b8,configJwt[a11_0x5c1b('0x18')],configJwt['options']);_0x271994[a11_0x5c1b('0x1f')][a11_0x5c1b('0x1a')]=_0x53ed35;return responseUtils[a11_0x5c1b('0x1b')](_0x4cadad,_0x271994,0xc8);})[a11_0x5c1b('0x22')](_0x34e28a=>{return responseUtils['errorResponse'](_0x4cadad,_0x34e28a[a11_0x5c1b('0x23')],0x1f4);});}})['catch'](_0x5177eb=>{return responseUtils[a11_0x5c1b('0x14')](_0x4cadad,_0x5177eb[a11_0x5c1b('0x23')],0x1f4);});}}exports[a11_0x5c1b('0x24')]=AuthenticationController;
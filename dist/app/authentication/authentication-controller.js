var a11_0xe5e3=['__esModule','jsonwebtoken','../../config/jwt.js','../../infrastructure/auth-utils','../../infrastructure/response-utils','../../resources/locale-strings','string-format','model','login','bind','createAccount','findOne','body','username','uuid','first_name','password','usernameNotFoundError','validPassword','toJSON','secret','options','token','successResponse','errorResponse','catch','stack','then','usernameTakenError','email','last_name','generateHash','create','dataValues','status','updated_at','created_at','sign','default','defineProperty'];(function(_0x47e11c,_0x14902a){var _0x35ba72=function(_0xa85c3b){while(--_0xa85c3b){_0x47e11c['push'](_0x47e11c['shift']());}};_0x35ba72(++_0x14902a);}(a11_0xe5e3,0x1b7));var a11_0x47ed=function(_0x15d60d,_0x382d1c){_0x15d60d=_0x15d60d-0x0;var _0x4d1420=a11_0xe5e3[_0x15d60d];return _0x4d1420;};'use strict';Object[a11_0x47ed('0x0')](exports,a11_0x47ed('0x1'),{'value':!![]});const jwt=require(a11_0x47ed('0x2'));const i18n=require('i18n');const configJwt=require(a11_0x47ed('0x3'));const authUtils=require(a11_0x47ed('0x4'));const responseUtils=require(a11_0x47ed('0x5'));const LocaleStrings=require(a11_0x47ed('0x6'));const format=require(a11_0x47ed('0x7'));class AuthenticationController{constructor(_0x430357){this[a11_0x47ed('0x8')]=_0x430357;this[a11_0x47ed('0x9')]=this[a11_0x47ed('0x9')][a11_0x47ed('0xa')](this);this[a11_0x47ed('0xb')]=this[a11_0x47ed('0xb')]['bind'](this);}[a11_0x47ed('0x9')](_0x2cf142,_0x2cb32f,_0x4b62a0){this[a11_0x47ed('0x8')][a11_0x47ed('0xc')]({'where':{'username':_0x2cf142[a11_0x47ed('0xd')][a11_0x47ed('0xe')]},'attributes':[a11_0x47ed('0xf'),a11_0x47ed('0x10'),'last_name','email',a11_0x47ed('0xe'),a11_0x47ed('0x11')]})['then'](_0xfea25f=>{if(!_0xfea25f){return responseUtils['errorResponse'](_0x2cb32f,format(LocaleStrings[a11_0x47ed('0x12')],_0x2cf142[a11_0x47ed('0xd')]['username']),0x193);}if(authUtils[a11_0x47ed('0x13')](_0x2cf142[a11_0x47ed('0xd')][a11_0x47ed('0x11')],_0xfea25f['password'])){_0xfea25f=_0xfea25f[a11_0x47ed('0x14')]();const _0x348f69={'uuid':_0xfea25f['uuid']};const _0x54fa10=jwt['sign'](_0x348f69,configJwt[a11_0x47ed('0x15')],configJwt[a11_0x47ed('0x16')]);delete _0xfea25f[a11_0x47ed('0x11')];_0xfea25f[a11_0x47ed('0x17')]=_0x54fa10;return responseUtils[a11_0x47ed('0x18')](_0x2cb32f,_0xfea25f,0xc8);}else{return responseUtils[a11_0x47ed('0x19')](_0x2cb32f,format(LocaleStrings['passwordNotMatchError']),0x193);}})[a11_0x47ed('0x1a')](_0x5bb4a0=>{return responseUtils['errorResponse'](_0x2cb32f,_0x5bb4a0[a11_0x47ed('0x1b')],0x1f4);});}[a11_0x47ed('0xb')](_0x5b5fc8,_0x40d2eb,_0x2ddee4){this[a11_0x47ed('0x8')][a11_0x47ed('0xc')]({'where':{'username':_0x5b5fc8[a11_0x47ed('0xd')][a11_0x47ed('0xe')]}})[a11_0x47ed('0x1c')](_0x3157b4=>{if(_0x3157b4){return responseUtils[a11_0x47ed('0x19')](_0x40d2eb,format(LocaleStrings[a11_0x47ed('0x1d')],_0x5b5fc8[a11_0x47ed('0xd')][a11_0x47ed('0xe')]),0x193);}else{_0x5b5fc8[a11_0x47ed('0xd')][a11_0x47ed('0x1e')]=_0x5b5fc8[a11_0x47ed('0xd')][a11_0x47ed('0xe')];const _0x23f154={'first_name':_0x5b5fc8[a11_0x47ed('0xd')]['first_name'],'last_name':_0x5b5fc8[a11_0x47ed('0xd')][a11_0x47ed('0x1f')],'email':_0x5b5fc8['body']['email'],'username':_0x5b5fc8[a11_0x47ed('0xd')][a11_0x47ed('0xe')],'password':authUtils[a11_0x47ed('0x20')](_0x5b5fc8['body']['password'])};this['model'][a11_0x47ed('0x21')](_0x23f154)['then'](function(_0x6c7864,_0x358ebb){delete _0x6c7864[a11_0x47ed('0x22')]['id'];delete _0x6c7864[a11_0x47ed('0x22')][a11_0x47ed('0x23')];delete _0x6c7864['dataValues'][a11_0x47ed('0x11')];delete _0x6c7864['dataValues'][a11_0x47ed('0x24')];delete _0x6c7864['dataValues'][a11_0x47ed('0x25')];const _0x23152e={'uuid':_0x6c7864[a11_0x47ed('0xf')]};const _0x326597=jwt[a11_0x47ed('0x26')](_0x23152e,configJwt[a11_0x47ed('0x15')],configJwt['options']);_0x6c7864[a11_0x47ed('0x22')]['token']=_0x326597;return responseUtils[a11_0x47ed('0x18')](_0x40d2eb,_0x6c7864,0xc8);})['catch'](_0x5ee1a0=>{return responseUtils['errorResponse'](_0x40d2eb,_0x5ee1a0[a11_0x47ed('0x1b')],0x1f4);});}})[a11_0x47ed('0x1a')](_0x430af0=>{return responseUtils['errorResponse'](_0x40d2eb,_0x430af0[a11_0x47ed('0x1b')],0x1f4);});}}exports[a11_0x47ed('0x27')]=AuthenticationController;
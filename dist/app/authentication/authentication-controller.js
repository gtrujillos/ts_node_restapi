var a11_0xe4b4=['createAccount','findOne','body','username','first_name','last_name','email','password','then','validPassword','uuid','sign','token','successResponse','errorResponse','passwordNotMatchError','catch','stack','usernameTakenError','generateHash','create','dataValues','status','updated_at','created_at','options','defineProperty','__esModule','i18n','../../config/jwt.js','../../infrastructure/auth-utils','../../infrastructure/response-utils','../../resources/locale-strings','model','login','bind'];(function(_0x580c7c,_0x453864){var _0x237347=function(_0x5bc4bd){while(--_0x5bc4bd){_0x580c7c['push'](_0x580c7c['shift']());}};_0x237347(++_0x453864);}(a11_0xe4b4,0xaa));var a11_0x3fff=function(_0xb4dbf6,_0x1ce295){_0xb4dbf6=_0xb4dbf6-0x0;var _0xb88c42=a11_0xe4b4[_0xb4dbf6];return _0xb88c42;};'use strict';Object[a11_0x3fff('0x0')](exports,a11_0x3fff('0x1'),{'value':!![]});const jwt=require('jsonwebtoken');const i18n=require(a11_0x3fff('0x2'));const configJwt=require(a11_0x3fff('0x3'));const authUtils=require(a11_0x3fff('0x4'));const responseUtils=require(a11_0x3fff('0x5'));const LocaleStrings=require(a11_0x3fff('0x6'));const format=require('string-format');class AuthenticationController{constructor(_0x4a7e04){this[a11_0x3fff('0x7')]=_0x4a7e04;this[a11_0x3fff('0x8')]=this[a11_0x3fff('0x8')][a11_0x3fff('0x9')](this);this[a11_0x3fff('0xa')]=this[a11_0x3fff('0xa')][a11_0x3fff('0x9')](this);}['login'](_0x7d41f5,_0x120010,_0x2fb949){this['model'][a11_0x3fff('0xb')]({'where':{'username':_0x7d41f5[a11_0x3fff('0xc')][a11_0x3fff('0xd')]},'attributes':['uuid',a11_0x3fff('0xe'),a11_0x3fff('0xf'),a11_0x3fff('0x10'),a11_0x3fff('0xd'),a11_0x3fff('0x11')]})[a11_0x3fff('0x12')](_0x2eb499=>{if(!_0x2eb499){return responseUtils['errorResponse'](_0x120010,format(LocaleStrings['usernameNotFoundError'],_0x7d41f5[a11_0x3fff('0xc')][a11_0x3fff('0xd')]),0x193);}if(authUtils[a11_0x3fff('0x13')](_0x7d41f5['body'][a11_0x3fff('0x11')],_0x2eb499['password'])){_0x2eb499=_0x2eb499['toJSON']();const _0xd6952e={'uuid':_0x2eb499[a11_0x3fff('0x14')]};const _0x1fe4df=jwt[a11_0x3fff('0x15')](_0xd6952e,configJwt['secret'],configJwt['options']);delete _0x2eb499[a11_0x3fff('0x11')];_0x2eb499[a11_0x3fff('0x16')]=_0x1fe4df;return responseUtils[a11_0x3fff('0x17')](_0x120010,_0x2eb499,0xc8);}else{return responseUtils[a11_0x3fff('0x18')](_0x120010,format(LocaleStrings[a11_0x3fff('0x19')]),0x193);}})[a11_0x3fff('0x1a')](_0x1b3f45=>{return responseUtils[a11_0x3fff('0x18')](_0x120010,_0x1b3f45[a11_0x3fff('0x1b')],0x1f4);});}['createAccount'](_0x5906d1,_0x35325f,_0x18e28e){this[a11_0x3fff('0x7')][a11_0x3fff('0xb')]({'where':{'username':_0x5906d1[a11_0x3fff('0xc')][a11_0x3fff('0xd')]}})[a11_0x3fff('0x12')](_0x54423a=>{if(_0x54423a){return responseUtils['errorResponse'](_0x35325f,format(LocaleStrings[a11_0x3fff('0x1c')],_0x5906d1[a11_0x3fff('0xc')][a11_0x3fff('0xd')]),0x193);}else{_0x5906d1[a11_0x3fff('0xc')][a11_0x3fff('0x10')]=_0x5906d1[a11_0x3fff('0xc')]['username'];const _0x557525={'first_name':_0x5906d1[a11_0x3fff('0xc')][a11_0x3fff('0xe')],'last_name':_0x5906d1[a11_0x3fff('0xc')]['last_name'],'email':_0x5906d1[a11_0x3fff('0xc')][a11_0x3fff('0x10')],'username':_0x5906d1[a11_0x3fff('0xc')][a11_0x3fff('0xd')],'password':authUtils[a11_0x3fff('0x1d')](_0x5906d1['body'][a11_0x3fff('0x11')])};this[a11_0x3fff('0x7')][a11_0x3fff('0x1e')](_0x557525)[a11_0x3fff('0x12')](function(_0x39ee07,_0x542819){delete _0x39ee07[a11_0x3fff('0x1f')]['id'];delete _0x39ee07['dataValues'][a11_0x3fff('0x20')];delete _0x39ee07['dataValues'][a11_0x3fff('0x11')];delete _0x39ee07[a11_0x3fff('0x1f')][a11_0x3fff('0x21')];delete _0x39ee07[a11_0x3fff('0x1f')][a11_0x3fff('0x22')];const _0x2fb27d={'uuid':_0x39ee07[a11_0x3fff('0x14')]};const _0x8f19f0=jwt[a11_0x3fff('0x15')](_0x2fb27d,configJwt['secret'],configJwt[a11_0x3fff('0x23')]);_0x39ee07[a11_0x3fff('0x1f')][a11_0x3fff('0x16')]=_0x8f19f0;return responseUtils[a11_0x3fff('0x17')](_0x35325f,_0x39ee07,0xc8);})[a11_0x3fff('0x1a')](_0x223f46=>{return responseUtils['errorResponse'](_0x35325f,_0x223f46['stack'],0x1f4);});}})[a11_0x3fff('0x1a')](_0x39f0ee=>{return responseUtils[a11_0x3fff('0x18')](_0x35325f,_0x39f0ee['stack'],0x1f4);});}}exports['default']=AuthenticationController;
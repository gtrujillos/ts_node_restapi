var a11_0x4a40=['body','username','uuid','first_name','last_name','password','then','errorResponse','usernameNotFoundError','validPassword','toJSON','sign','secret','options','token','passwordNotMatchError','usernameTakenError','email','create','dataValues','updated_at','created_at','successResponse','catch','stack','jsonwebtoken','i18n','../../config/jwt.js','../../infrastructure/auth-utils','../../resources/locale-strings','string-format','model','login','bind','createAccount','findOne'];(function(_0x5872e9,_0x3055f9){var _0x49ba69=function(_0x1e720a){while(--_0x1e720a){_0x5872e9['push'](_0x5872e9['shift']());}};_0x49ba69(++_0x3055f9);}(a11_0x4a40,0xf1));var a11_0x3f21=function(_0x4adc7d,_0x25f49c){_0x4adc7d=_0x4adc7d-0x0;var _0x591923=a11_0x4a40[_0x4adc7d];return _0x591923;};'use strict';Object['defineProperty'](exports,'__esModule',{'value':!![]});const jwt=require(a11_0x3f21('0x0'));const i18n=require(a11_0x3f21('0x1'));const configJwt=require(a11_0x3f21('0x2'));const authUtils=require(a11_0x3f21('0x3'));const responseUtils=require('../../infrastructure/response-utils');const LocaleStrings=require(a11_0x3f21('0x4'));const format=require(a11_0x3f21('0x5'));class AuthenticationController{constructor(_0x3a64d4){this[a11_0x3f21('0x6')]=_0x3a64d4;this[a11_0x3f21('0x7')]=this['login'][a11_0x3f21('0x8')](this);this[a11_0x3f21('0x9')]=this[a11_0x3f21('0x9')][a11_0x3f21('0x8')](this);}['login'](_0xe84dd4,_0x51f79f,_0x2d6aa6){this[a11_0x3f21('0x6')][a11_0x3f21('0xa')]({'where':{'username':_0xe84dd4[a11_0x3f21('0xb')][a11_0x3f21('0xc')]},'attributes':[a11_0x3f21('0xd'),a11_0x3f21('0xe'),a11_0x3f21('0xf'),'email',a11_0x3f21('0xc'),a11_0x3f21('0x10')]})[a11_0x3f21('0x11')](_0x2c7910=>{if(!_0x2c7910){return responseUtils[a11_0x3f21('0x12')](_0x51f79f,format(LocaleStrings[a11_0x3f21('0x13')],_0xe84dd4['body'][a11_0x3f21('0xc')]),0x193);}if(authUtils[a11_0x3f21('0x14')](_0xe84dd4[a11_0x3f21('0xb')][a11_0x3f21('0x10')],_0x2c7910[a11_0x3f21('0x10')])){_0x2c7910=_0x2c7910[a11_0x3f21('0x15')]();const _0x170a25={'uuid':_0x2c7910[a11_0x3f21('0xd')]};const _0x3a3235=jwt[a11_0x3f21('0x16')](_0x170a25,configJwt[a11_0x3f21('0x17')],configJwt[a11_0x3f21('0x18')]);delete _0x2c7910[a11_0x3f21('0x10')];_0x2c7910[a11_0x3f21('0x19')]=_0x3a3235;return responseUtils['successResponse'](_0x51f79f,_0x2c7910,0xc8);}else{return responseUtils[a11_0x3f21('0x12')](_0x51f79f,format(LocaleStrings[a11_0x3f21('0x1a')]),0x193);}})['catch'](_0x2884ad=>{return responseUtils['errorResponse'](_0x51f79f,_0x2884ad['stack'],0x1f4);});}[a11_0x3f21('0x9')](_0x56b517,_0x1a4f5f,_0x56f047){this[a11_0x3f21('0x6')][a11_0x3f21('0xa')]({'where':{'username':_0x56b517['body'][a11_0x3f21('0xc')]}})[a11_0x3f21('0x11')](_0x3a025b=>{if(_0x3a025b){return responseUtils[a11_0x3f21('0x12')](_0x1a4f5f,format(LocaleStrings[a11_0x3f21('0x1b')],_0x56b517[a11_0x3f21('0xb')][a11_0x3f21('0xc')]),0x193);}else{_0x56b517[a11_0x3f21('0xb')][a11_0x3f21('0x1c')]=_0x56b517[a11_0x3f21('0xb')][a11_0x3f21('0xc')];const _0x105f70={'first_name':_0x56b517[a11_0x3f21('0xb')][a11_0x3f21('0xe')],'last_name':_0x56b517['body'][a11_0x3f21('0xf')],'email':_0x56b517[a11_0x3f21('0xb')][a11_0x3f21('0x1c')],'username':_0x56b517[a11_0x3f21('0xb')]['username'],'password':authUtils['generateHash'](_0x56b517[a11_0x3f21('0xb')]['password'])};this['model'][a11_0x3f21('0x1d')](_0x105f70)[a11_0x3f21('0x11')](function(_0x49bdf3,_0x4aca3e){delete _0x49bdf3[a11_0x3f21('0x1e')]['id'];delete _0x49bdf3[a11_0x3f21('0x1e')]['status'];delete _0x49bdf3[a11_0x3f21('0x1e')][a11_0x3f21('0x10')];delete _0x49bdf3[a11_0x3f21('0x1e')][a11_0x3f21('0x1f')];delete _0x49bdf3[a11_0x3f21('0x1e')][a11_0x3f21('0x20')];const _0x478a10={'uuid':_0x49bdf3[a11_0x3f21('0xd')]};const _0x473678=jwt[a11_0x3f21('0x16')](_0x478a10,configJwt['secret'],configJwt[a11_0x3f21('0x18')]);_0x49bdf3[a11_0x3f21('0x1e')][a11_0x3f21('0x19')]=_0x473678;return responseUtils[a11_0x3f21('0x21')](_0x1a4f5f,_0x49bdf3,0xc8);})[a11_0x3f21('0x22')](_0x5c009d=>{return responseUtils['errorResponse'](_0x1a4f5f,_0x5c009d[a11_0x3f21('0x23')],0x1f4);});}})['catch'](_0x285485=>{return responseUtils[a11_0x3f21('0x12')](_0x1a4f5f,_0x285485['stack'],0x1f4);});}}exports['default']=AuthenticationController;
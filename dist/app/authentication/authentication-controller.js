var a11_0x47c3=['options','token','successResponse','errorResponse','passwordNotMatchError','catch','stack','email','generateHash','create','dataValues','status','updated_at','created_at','default','defineProperty','__esModule','jsonwebtoken','i18n','../../config/jwt.js','../../infrastructure/auth-utils','../../infrastructure/response-utils','../../resources/locale-strings','string-format','login','bind','createAccount','model','findOne','body','username','first_name','last_name','then','usernameNotFoundError','validPassword','password','toJSON','uuid','sign'];(function(_0x1d2209,_0x1f9a84){var _0x1b1540=function(_0xad418a){while(--_0xad418a){_0x1d2209['push'](_0x1d2209['shift']());}};_0x1b1540(++_0x1f9a84);}(a11_0x47c3,0x87));var a11_0xf3b3=function(_0x951a0,_0x5f4f88){_0x951a0=_0x951a0-0x0;var _0x216003=a11_0x47c3[_0x951a0];return _0x216003;};'use strict';Object[a11_0xf3b3('0x0')](exports,a11_0xf3b3('0x1'),{'value':!![]});const jwt=require(a11_0xf3b3('0x2'));const i18n=require(a11_0xf3b3('0x3'));const configJwt=require(a11_0xf3b3('0x4'));const authUtils=require(a11_0xf3b3('0x5'));const responseUtils=require(a11_0xf3b3('0x6'));const LocaleStrings=require(a11_0xf3b3('0x7'));const format=require(a11_0xf3b3('0x8'));class AuthenticationController{constructor(_0x2eb658){this['model']=_0x2eb658;this[a11_0xf3b3('0x9')]=this['login'][a11_0xf3b3('0xa')](this);this['createAccount']=this[a11_0xf3b3('0xb')]['bind'](this);}[a11_0xf3b3('0x9')](_0x207aa5,_0x3c450f,_0x78a15f){this[a11_0xf3b3('0xc')][a11_0xf3b3('0xd')]({'where':{'username':_0x207aa5[a11_0xf3b3('0xe')][a11_0xf3b3('0xf')]},'attributes':['uuid',a11_0xf3b3('0x10'),a11_0xf3b3('0x11'),'email','username','password']})[a11_0xf3b3('0x12')](_0x386631=>{if(!_0x386631){return responseUtils['errorResponse'](_0x3c450f,format(LocaleStrings[a11_0xf3b3('0x13')],_0x207aa5['body'][a11_0xf3b3('0xf')]),0x193);}if(authUtils[a11_0xf3b3('0x14')](_0x207aa5[a11_0xf3b3('0xe')][a11_0xf3b3('0x15')],_0x386631['password'])){_0x386631=_0x386631[a11_0xf3b3('0x16')]();const _0x42fbd6={'uuid':_0x386631[a11_0xf3b3('0x17')]};const _0x166c1f=jwt[a11_0xf3b3('0x18')](_0x42fbd6,configJwt['secret'],configJwt[a11_0xf3b3('0x19')]);delete _0x386631['password'];_0x386631[a11_0xf3b3('0x1a')]=_0x166c1f;return responseUtils[a11_0xf3b3('0x1b')](_0x3c450f,_0x386631,0xc8);}else{return responseUtils[a11_0xf3b3('0x1c')](_0x3c450f,format(LocaleStrings[a11_0xf3b3('0x1d')]),0x193);}})[a11_0xf3b3('0x1e')](_0x27cfff=>{return responseUtils['errorResponse'](_0x3c450f,_0x27cfff[a11_0xf3b3('0x1f')],0x1f4);});}['createAccount'](_0x174117,_0x5192dd,_0x387914){this[a11_0xf3b3('0xc')][a11_0xf3b3('0xd')]({'where':{'username':_0x174117[a11_0xf3b3('0xe')][a11_0xf3b3('0xf')]}})[a11_0xf3b3('0x12')](_0xa5f5ba=>{if(_0xa5f5ba){return responseUtils['errorResponse'](_0x5192dd,format(LocaleStrings['usernameTakenError'],_0x174117[a11_0xf3b3('0xe')][a11_0xf3b3('0xf')]),0x193);}else{_0x174117['body'][a11_0xf3b3('0x20')]=_0x174117[a11_0xf3b3('0xe')][a11_0xf3b3('0xf')];const _0x40fdcf={'first_name':_0x174117[a11_0xf3b3('0xe')][a11_0xf3b3('0x10')],'last_name':_0x174117[a11_0xf3b3('0xe')][a11_0xf3b3('0x11')],'email':_0x174117[a11_0xf3b3('0xe')][a11_0xf3b3('0x20')],'username':_0x174117['body'][a11_0xf3b3('0xf')],'password':authUtils[a11_0xf3b3('0x21')](_0x174117[a11_0xf3b3('0xe')][a11_0xf3b3('0x15')])};this['model'][a11_0xf3b3('0x22')](_0x40fdcf)[a11_0xf3b3('0x12')](function(_0x17bb11,_0x239605){delete _0x17bb11[a11_0xf3b3('0x23')]['id'];delete _0x17bb11[a11_0xf3b3('0x23')][a11_0xf3b3('0x24')];delete _0x17bb11['dataValues'][a11_0xf3b3('0x15')];delete _0x17bb11[a11_0xf3b3('0x23')][a11_0xf3b3('0x25')];delete _0x17bb11[a11_0xf3b3('0x23')][a11_0xf3b3('0x26')];const _0x346514={'uuid':_0x17bb11[a11_0xf3b3('0x17')]};const _0x42022d=jwt[a11_0xf3b3('0x18')](_0x346514,configJwt['secret'],configJwt[a11_0xf3b3('0x19')]);_0x17bb11['dataValues'][a11_0xf3b3('0x1a')]=_0x42022d;return responseUtils[a11_0xf3b3('0x1b')](_0x5192dd,_0x17bb11,0xc8);})['catch'](_0xfc6192=>{return responseUtils[a11_0xf3b3('0x1c')](_0x5192dd,_0xfc6192['stack'],0x1f4);});}})[a11_0xf3b3('0x1e')](_0x5e40a2=>{return responseUtils[a11_0xf3b3('0x1c')](_0x5192dd,_0x5e40a2[a11_0xf3b3('0x1f')],0x1f4);});}}exports[a11_0xf3b3('0x27')]=AuthenticationController;
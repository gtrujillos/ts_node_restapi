var a11_0x29aa=['body','username','uuid','first_name','last_name','email','password','then','errorResponse','usernameNotFoundError','validPassword','secret','token','successResponse','passwordNotMatchError','stack','findOne','create','dataValues','status','created_at','sign','options','default','defineProperty','__esModule','jsonwebtoken','i18n','../../config/jwt.js','../../infrastructure/auth-utils','../../infrastructure/response-utils','../../resources/locale-strings','string-format','login','bind','createAccount','model'];(function(_0x403cf3,_0x338b21){var _0x1dd70b=function(_0x211c7c){while(--_0x211c7c){_0x403cf3['push'](_0x403cf3['shift']());}};_0x1dd70b(++_0x338b21);}(a11_0x29aa,0x11b));var a11_0x58ba=function(_0x403077,_0x450cae){_0x403077=_0x403077-0x0;var _0x32e8d1=a11_0x29aa[_0x403077];return _0x32e8d1;};'use strict';Object[a11_0x58ba('0x0')](exports,a11_0x58ba('0x1'),{'value':!![]});const jwt=require(a11_0x58ba('0x2'));const i18n=require(a11_0x58ba('0x3'));const configJwt=require(a11_0x58ba('0x4'));const authUtils=require(a11_0x58ba('0x5'));const responseUtils=require(a11_0x58ba('0x6'));const LocaleStrings=require(a11_0x58ba('0x7'));const format=require(a11_0x58ba('0x8'));class AuthenticationController{constructor(_0x45dfb4){this['model']=_0x45dfb4;this[a11_0x58ba('0x9')]=this[a11_0x58ba('0x9')][a11_0x58ba('0xa')](this);this['createAccount']=this[a11_0x58ba('0xb')][a11_0x58ba('0xa')](this);}[a11_0x58ba('0x9')](_0x5bfd44,_0x173404,_0x44cd88){this[a11_0x58ba('0xc')]['findOne']({'where':{'username':_0x5bfd44[a11_0x58ba('0xd')][a11_0x58ba('0xe')]},'attributes':[a11_0x58ba('0xf'),a11_0x58ba('0x10'),a11_0x58ba('0x11'),a11_0x58ba('0x12'),a11_0x58ba('0xe'),a11_0x58ba('0x13')]})[a11_0x58ba('0x14')](_0x8f088c=>{if(!_0x8f088c){return responseUtils[a11_0x58ba('0x15')](_0x173404,format(LocaleStrings[a11_0x58ba('0x16')],_0x5bfd44[a11_0x58ba('0xd')][a11_0x58ba('0xe')]),0x193);}if(authUtils[a11_0x58ba('0x17')](_0x5bfd44[a11_0x58ba('0xd')][a11_0x58ba('0x13')],_0x8f088c[a11_0x58ba('0x13')])){_0x8f088c=_0x8f088c['toJSON']();const _0x21b279={'uuid':_0x8f088c[a11_0x58ba('0xf')]};const _0x3b597d=jwt['sign'](_0x21b279,configJwt[a11_0x58ba('0x18')],configJwt['options']);delete _0x8f088c['password'];_0x8f088c[a11_0x58ba('0x19')]=_0x3b597d;return responseUtils[a11_0x58ba('0x1a')](_0x173404,_0x8f088c,0xc8);}else{return responseUtils[a11_0x58ba('0x15')](_0x173404,format(LocaleStrings[a11_0x58ba('0x1b')]),0x193);}})['catch'](_0x55af0f=>{return responseUtils[a11_0x58ba('0x15')](_0x173404,_0x55af0f[a11_0x58ba('0x1c')],0x1f4);});}[a11_0x58ba('0xb')](_0x51b0fd,_0x5b028f,_0x2d9102){this[a11_0x58ba('0xc')][a11_0x58ba('0x1d')]({'where':{'username':_0x51b0fd['body'][a11_0x58ba('0xe')]}})[a11_0x58ba('0x14')](_0x3bcec9=>{if(_0x3bcec9){return responseUtils['errorResponse'](_0x5b028f,format(LocaleStrings['usernameTakenError'],_0x51b0fd['body']['username']),0x193);}else{_0x51b0fd[a11_0x58ba('0xd')][a11_0x58ba('0x12')]=_0x51b0fd[a11_0x58ba('0xd')][a11_0x58ba('0xe')];const _0xb8bc37={'first_name':_0x51b0fd[a11_0x58ba('0xd')][a11_0x58ba('0x10')],'last_name':_0x51b0fd[a11_0x58ba('0xd')][a11_0x58ba('0x11')],'email':_0x51b0fd['body'][a11_0x58ba('0x12')],'username':_0x51b0fd[a11_0x58ba('0xd')]['username'],'password':authUtils['generateHash'](_0x51b0fd['body'][a11_0x58ba('0x13')])};this[a11_0x58ba('0xc')][a11_0x58ba('0x1e')](_0xb8bc37)['then'](function(_0x4296a0,_0x369cfc){delete _0x4296a0[a11_0x58ba('0x1f')]['id'];delete _0x4296a0[a11_0x58ba('0x1f')][a11_0x58ba('0x20')];delete _0x4296a0[a11_0x58ba('0x1f')][a11_0x58ba('0x13')];delete _0x4296a0[a11_0x58ba('0x1f')]['updated_at'];delete _0x4296a0[a11_0x58ba('0x1f')][a11_0x58ba('0x21')];const _0x425d2a={'uuid':_0x4296a0[a11_0x58ba('0xf')]};const _0x7d9baf=jwt[a11_0x58ba('0x22')](_0x425d2a,configJwt[a11_0x58ba('0x18')],configJwt[a11_0x58ba('0x23')]);_0x4296a0[a11_0x58ba('0x1f')][a11_0x58ba('0x19')]=_0x7d9baf;return responseUtils[a11_0x58ba('0x1a')](_0x5b028f,_0x4296a0,0xc8);})['catch'](_0x5b706b=>{return responseUtils[a11_0x58ba('0x15')](_0x5b028f,_0x5b706b[a11_0x58ba('0x1c')],0x1f4);});}})['catch'](_0x43c230=>{return responseUtils[a11_0x58ba('0x15')](_0x5b028f,_0x43c230['stack'],0x1f4);});}}exports[a11_0x58ba('0x24')]=AuthenticationController;
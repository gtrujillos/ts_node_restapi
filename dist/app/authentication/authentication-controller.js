var a11_0x484a=['successResponse','errorResponse','catch','stack','usernameTakenError','generateHash','create','dataValues','status','updated_at','created_at','sign','secret','options','defineProperty','jsonwebtoken','i18n','../../config/jwt.js','../../infrastructure/auth-utils','../../infrastructure/response-utils','../../resources/locale-strings','string-format','model','login','bind','createAccount','findOne','body','username','uuid','last_name','email','password','then','usernameNotFoundError','token'];(function(_0x364726,_0x26b445){var _0x34249c=function(_0x5c4015){while(--_0x5c4015){_0x364726['push'](_0x364726['shift']());}};_0x34249c(++_0x26b445);}(a11_0x484a,0x1be));var a11_0x4402=function(_0xf28ca4,_0x2a055d){_0xf28ca4=_0xf28ca4-0x0;var _0x1c8ae3=a11_0x484a[_0xf28ca4];return _0x1c8ae3;};'use strict';Object[a11_0x4402('0x0')](exports,'__esModule',{'value':!![]});const jwt=require(a11_0x4402('0x1'));const i18n=require(a11_0x4402('0x2'));const configJwt=require(a11_0x4402('0x3'));const authUtils=require(a11_0x4402('0x4'));const responseUtils=require(a11_0x4402('0x5'));const LocaleStrings=require(a11_0x4402('0x6'));const format=require(a11_0x4402('0x7'));class AuthenticationController{constructor(_0x872f36){this[a11_0x4402('0x8')]=_0x872f36;this[a11_0x4402('0x9')]=this[a11_0x4402('0x9')][a11_0x4402('0xa')](this);this[a11_0x4402('0xb')]=this['createAccount'][a11_0x4402('0xa')](this);}[a11_0x4402('0x9')](_0x52203b,_0x103cb6,_0x12dc39){this[a11_0x4402('0x8')][a11_0x4402('0xc')]({'where':{'username':_0x52203b[a11_0x4402('0xd')][a11_0x4402('0xe')]},'attributes':[a11_0x4402('0xf'),'first_name',a11_0x4402('0x10'),a11_0x4402('0x11'),'username',a11_0x4402('0x12')]})[a11_0x4402('0x13')](_0x2c9e99=>{if(!_0x2c9e99){return responseUtils['errorResponse'](_0x103cb6,format(LocaleStrings[a11_0x4402('0x14')],_0x52203b[a11_0x4402('0xd')]['username']),0x193);}if(authUtils['validPassword'](_0x52203b[a11_0x4402('0xd')][a11_0x4402('0x12')],_0x2c9e99[a11_0x4402('0x12')])){_0x2c9e99=_0x2c9e99['toJSON']();const _0x508b29={'uuid':_0x2c9e99[a11_0x4402('0xf')]};const _0x816538=jwt['sign'](_0x508b29,configJwt['secret'],configJwt['options']);delete _0x2c9e99[a11_0x4402('0x12')];_0x2c9e99[a11_0x4402('0x15')]=_0x816538;return responseUtils[a11_0x4402('0x16')](_0x103cb6,_0x2c9e99,0xc8);}else{return responseUtils[a11_0x4402('0x17')](_0x103cb6,format(LocaleStrings['passwordNotMatchError']),0x193);}})[a11_0x4402('0x18')](_0x558572=>{return responseUtils[a11_0x4402('0x17')](_0x103cb6,_0x558572[a11_0x4402('0x19')],0x1f4);});}[a11_0x4402('0xb')](_0x1b5148,_0x63f1a7,_0x3a69c2){this[a11_0x4402('0x8')]['findOne']({'where':{'username':_0x1b5148[a11_0x4402('0xd')]['username']}})[a11_0x4402('0x13')](_0x144d50=>{if(_0x144d50){return responseUtils[a11_0x4402('0x17')](_0x63f1a7,format(LocaleStrings[a11_0x4402('0x1a')],_0x1b5148[a11_0x4402('0xd')]['username']),0x193);}else{_0x1b5148['body'][a11_0x4402('0x11')]=_0x1b5148[a11_0x4402('0xd')][a11_0x4402('0xe')];const _0xcbbc84={'first_name':_0x1b5148['body']['first_name'],'last_name':_0x1b5148[a11_0x4402('0xd')][a11_0x4402('0x10')],'email':_0x1b5148[a11_0x4402('0xd')]['email'],'username':_0x1b5148[a11_0x4402('0xd')][a11_0x4402('0xe')],'password':authUtils[a11_0x4402('0x1b')](_0x1b5148['body']['password'])};this[a11_0x4402('0x8')][a11_0x4402('0x1c')](_0xcbbc84)['then'](function(_0x155678,_0x29fd9b){delete _0x155678[a11_0x4402('0x1d')]['id'];delete _0x155678[a11_0x4402('0x1d')][a11_0x4402('0x1e')];delete _0x155678[a11_0x4402('0x1d')][a11_0x4402('0x12')];delete _0x155678[a11_0x4402('0x1d')][a11_0x4402('0x1f')];delete _0x155678[a11_0x4402('0x1d')][a11_0x4402('0x20')];const _0x1ba59f={'uuid':_0x155678['uuid']};const _0x145848=jwt[a11_0x4402('0x21')](_0x1ba59f,configJwt[a11_0x4402('0x22')],configJwt[a11_0x4402('0x23')]);_0x155678[a11_0x4402('0x1d')][a11_0x4402('0x15')]=_0x145848;return responseUtils[a11_0x4402('0x16')](_0x63f1a7,_0x155678,0xc8);})[a11_0x4402('0x18')](_0x423b26=>{return responseUtils[a11_0x4402('0x17')](_0x63f1a7,_0x423b26[a11_0x4402('0x19')],0x1f4);});}})[a11_0x4402('0x18')](_0x1512b7=>{return responseUtils[a11_0x4402('0x17')](_0x63f1a7,_0x1512b7['stack'],0x1f4);});}}exports['default']=AuthenticationController;
var a30_0x4a46=['then','errorResponse','usernameNotFoundError','body','default','toJSON','sign','secret','options','passwordNotMatchError','catch','hashPassword','dataValues','successResponse','stack','__esModule','../../infrastructure/crypt-utils','jsonwebtoken','i18n','../../infrastructure/auth-utils','../../infrastructure/response-utils','../../resources/locale-strings','string-format','model','login','bind','createAccount','findOne','username','first_name','last_name','email','password'];(function(_0x222e53,_0x520e7f){var _0x4543ac=function(_0x112085){while(--_0x112085){_0x222e53['push'](_0x222e53['shift']());}};_0x4543ac(++_0x520e7f);}(a30_0x4a46,0x17a));var a30_0x5a94=function(_0x35e685,_0x44cbce){_0x35e685=_0x35e685-0x0;var _0x3ec168=a30_0x4a46[_0x35e685];return _0x3ec168;};'use strict';var __importDefault=this&&this['__importDefault']||function(_0x13a0b6){return _0x13a0b6&&_0x13a0b6['__esModule']?_0x13a0b6:{'default':_0x13a0b6};};Object['defineProperty'](exports,a30_0x5a94('0x0'),{'value':!![]});const crypt_utils_1=__importDefault(require(a30_0x5a94('0x1')));const jwt=require(a30_0x5a94('0x2'));const i18n=require(a30_0x5a94('0x3'));const configJwt=require('../../config/jwt.js');const authUtils=require(a30_0x5a94('0x4'));const responseUtils=require(a30_0x5a94('0x5'));const LocaleStrings=require(a30_0x5a94('0x6'));const format=require(a30_0x5a94('0x7'));class AuthenticationController{constructor(_0x2de021){this[a30_0x5a94('0x8')]=_0x2de021;this[a30_0x5a94('0x9')]=this[a30_0x5a94('0x9')][a30_0x5a94('0xa')](this);this['createAccount']=this[a30_0x5a94('0xb')]['bind'](this);}['login'](_0x5726b3,_0xa98c9f,_0x356666){this[a30_0x5a94('0x8')][a30_0x5a94('0xc')]({'where':{'username':_0x5726b3['body'][a30_0x5a94('0xd')]},'attributes':['id',a30_0x5a94('0xe'),a30_0x5a94('0xf'),a30_0x5a94('0x10'),a30_0x5a94('0xd'),a30_0x5a94('0x11')]})[a30_0x5a94('0x12')](_0x46fff3=>{if(!_0x46fff3){return responseUtils[a30_0x5a94('0x13')](_0xa98c9f,format(LocaleStrings[a30_0x5a94('0x14')],_0x5726b3[a30_0x5a94('0x15')][a30_0x5a94('0xd')]),0x193);}if(crypt_utils_1[a30_0x5a94('0x16')]['validPassword'](_0x5726b3[a30_0x5a94('0x15')][a30_0x5a94('0x11')],_0x46fff3['password'])){_0x46fff3=_0x46fff3[a30_0x5a94('0x17')]();const _0x3985a1={'id':_0x46fff3['id']};const _0x43bbc4=jwt[a30_0x5a94('0x18')](_0x3985a1,configJwt[a30_0x5a94('0x19')],configJwt[a30_0x5a94('0x1a')]);const _0x32f7f4={'token':_0x43bbc4};return responseUtils['successResponse'](_0xa98c9f,_0x32f7f4,0xc8);}else{return responseUtils[a30_0x5a94('0x13')](_0xa98c9f,format(LocaleStrings[a30_0x5a94('0x1b')]),0x193);}})[a30_0x5a94('0x1c')](_0x262b40=>{return responseUtils[a30_0x5a94('0x13')](_0xa98c9f,_0x262b40,0x1f4);});}['createAccount'](_0x433f5a,_0x5a46ab,_0x241ade){this['model'][a30_0x5a94('0xc')]({'where':{'username':_0x433f5a[a30_0x5a94('0x15')][a30_0x5a94('0xd')]}})[a30_0x5a94('0x12')](_0x2a361b=>{if(_0x2a361b){return responseUtils[a30_0x5a94('0x13')](_0x5a46ab,format(LocaleStrings['usernameTakenError'],_0x433f5a[a30_0x5a94('0x15')][a30_0x5a94('0xd')]),0x193);}else{_0x433f5a['body'][a30_0x5a94('0x10')]=_0x433f5a[a30_0x5a94('0x15')][a30_0x5a94('0xd')];const _0x116e28={'first_name':_0x433f5a[a30_0x5a94('0x15')]['first_name'],'last_name':_0x433f5a[a30_0x5a94('0x15')][a30_0x5a94('0xf')],'email':_0x433f5a[a30_0x5a94('0x15')][a30_0x5a94('0x10')],'username':_0x433f5a[a30_0x5a94('0x15')][a30_0x5a94('0xd')],'password':crypt_utils_1[a30_0x5a94('0x16')][a30_0x5a94('0x1d')](_0x433f5a[a30_0x5a94('0x15')][a30_0x5a94('0x11')])};this['model']['create'](_0x116e28)[a30_0x5a94('0x12')](function(_0x1156b6,_0x4d52ee){const _0x309df1={'id':_0x1156b6[a30_0x5a94('0x1e')]['id']};const _0x3fe222=jwt[a30_0x5a94('0x18')](_0x309df1,configJwt[a30_0x5a94('0x19')],configJwt[a30_0x5a94('0x1a')]);const _0x2edcf6={'token':_0x3fe222};return responseUtils[a30_0x5a94('0x1f')](_0x5a46ab,_0x2edcf6,0xc8);})[a30_0x5a94('0x1c')](_0x169ac4=>{return responseUtils[a30_0x5a94('0x13')](_0x5a46ab,_0x169ac4[a30_0x5a94('0x20')],0x1f4);});}})[a30_0x5a94('0x1c')](_0xde3f93=>{return responseUtils[a30_0x5a94('0x13')](_0x5a46ab,_0xde3f93[a30_0x5a94('0x20')],0x1f4);});}}exports['default']=AuthenticationController;
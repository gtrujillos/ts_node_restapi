var a30_0x278e=['dataValues','stack','__importDefault','__esModule','defineProperty','../../infrastructure/crypt-utils','jsonwebtoken','i18n','../../infrastructure/auth-utils','../../infrastructure/response-utils','../../resources/locale-strings','string-format','model','login','createAccount','bind','findOne','body','username','last_name','email','password','errorResponse','default','validPassword','toJSON','sign','secret','options','successResponse','passwordNotMatchError','catch','then','usernameTakenError','first_name','hashPassword'];(function(_0x57b9bd,_0x43b1b3){var _0x58b85f=function(_0x5c02aa){while(--_0x5c02aa){_0x57b9bd['push'](_0x57b9bd['shift']());}};_0x58b85f(++_0x43b1b3);}(a30_0x278e,0x16a));var a30_0x5ef5=function(_0x572b5f,_0x2bb7d3){_0x572b5f=_0x572b5f-0x0;var _0x1c21f0=a30_0x278e[_0x572b5f];return _0x1c21f0;};'use strict';var __importDefault=this&&this[a30_0x5ef5('0x0')]||function(_0x556002){return _0x556002&&_0x556002[a30_0x5ef5('0x1')]?_0x556002:{'default':_0x556002};};Object[a30_0x5ef5('0x2')](exports,'__esModule',{'value':!![]});const crypt_utils_1=__importDefault(require(a30_0x5ef5('0x3')));const jwt=require(a30_0x5ef5('0x4'));const i18n=require(a30_0x5ef5('0x5'));const configJwt=require('../../config/jwt.js');const authUtils=require(a30_0x5ef5('0x6'));const responseUtils=require(a30_0x5ef5('0x7'));const LocaleStrings=require(a30_0x5ef5('0x8'));const format=require(a30_0x5ef5('0x9'));class AuthenticationController{constructor(_0x419371){this[a30_0x5ef5('0xa')]=_0x419371;this[a30_0x5ef5('0xb')]=this[a30_0x5ef5('0xb')]['bind'](this);this[a30_0x5ef5('0xc')]=this[a30_0x5ef5('0xc')][a30_0x5ef5('0xd')](this);}[a30_0x5ef5('0xb')](_0x2181f3,_0x14fd95,_0x2e24b0){this[a30_0x5ef5('0xa')][a30_0x5ef5('0xe')]({'where':{'username':_0x2181f3[a30_0x5ef5('0xf')][a30_0x5ef5('0x10')]},'attributes':['id','first_name',a30_0x5ef5('0x11'),a30_0x5ef5('0x12'),a30_0x5ef5('0x10'),a30_0x5ef5('0x13')]})['then'](_0x302c8=>{if(!_0x302c8){return responseUtils[a30_0x5ef5('0x14')](_0x14fd95,format(LocaleStrings['usernameNotFoundError'],_0x2181f3[a30_0x5ef5('0xf')][a30_0x5ef5('0x10')]),0x193);}if(crypt_utils_1[a30_0x5ef5('0x15')][a30_0x5ef5('0x16')](_0x2181f3[a30_0x5ef5('0xf')]['password'],_0x302c8[a30_0x5ef5('0x13')])){_0x302c8=_0x302c8[a30_0x5ef5('0x17')]();const _0x1e9f12={'id':_0x302c8['id']};const _0x35394d=jwt[a30_0x5ef5('0x18')](_0x1e9f12,configJwt[a30_0x5ef5('0x19')],configJwt[a30_0x5ef5('0x1a')]);const _0xf5d673={'token':_0x35394d};return responseUtils[a30_0x5ef5('0x1b')](_0x14fd95,_0xf5d673,0xc8);}else{return responseUtils[a30_0x5ef5('0x14')](_0x14fd95,format(LocaleStrings[a30_0x5ef5('0x1c')]),0x193);}})[a30_0x5ef5('0x1d')](_0x11ef3e=>{return responseUtils[a30_0x5ef5('0x14')](_0x14fd95,_0x11ef3e,0x1f4);});}['createAccount'](_0x5e69df,_0x3c2f82,_0x29ebfd){this['model'][a30_0x5ef5('0xe')]({'where':{'username':_0x5e69df['body']['username']}})[a30_0x5ef5('0x1e')](_0x2f4698=>{if(_0x2f4698){return responseUtils['errorResponse'](_0x3c2f82,format(LocaleStrings[a30_0x5ef5('0x1f')],_0x5e69df['body'][a30_0x5ef5('0x10')]),0x193);}else{_0x5e69df['body'][a30_0x5ef5('0x12')]=_0x5e69df['body'][a30_0x5ef5('0x10')];const _0x2be58b={'first_name':_0x5e69df[a30_0x5ef5('0xf')][a30_0x5ef5('0x20')],'last_name':_0x5e69df['body'][a30_0x5ef5('0x11')],'email':_0x5e69df['body'][a30_0x5ef5('0x12')],'username':_0x5e69df[a30_0x5ef5('0xf')][a30_0x5ef5('0x10')],'password':crypt_utils_1[a30_0x5ef5('0x15')][a30_0x5ef5('0x21')](_0x5e69df['body'][a30_0x5ef5('0x13')])};this['model']['create'](_0x2be58b)['then'](function(_0x3bac97,_0x19140f){const _0x1d2fad={'id':_0x3bac97[a30_0x5ef5('0x22')]['id']};const _0x3146ed=jwt['sign'](_0x1d2fad,configJwt[a30_0x5ef5('0x19')],configJwt[a30_0x5ef5('0x1a')]);const _0x4e72bb={'token':_0x3146ed};return responseUtils[a30_0x5ef5('0x1b')](_0x3c2f82,_0x4e72bb,0xc8);})[a30_0x5ef5('0x1d')](_0x5273d5=>{return responseUtils[a30_0x5ef5('0x14')](_0x3c2f82,_0x5273d5[a30_0x5ef5('0x23')],0x1f4);});}})[a30_0x5ef5('0x1d')](_0x252ebe=>{return responseUtils[a30_0x5ef5('0x14')](_0x3c2f82,_0x252ebe[a30_0x5ef5('0x23')],0x1f4);});}}exports[a30_0x5ef5('0x15')]=AuthenticationController;
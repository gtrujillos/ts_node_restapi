var a11_0x3130=['validPassword','password','sign','secret','token','errorResponse','stack','usernameTakenError','first_name','generateHash','dataValues','status','updated_at','created_at','successResponse','catch','default','defineProperty','jsonwebtoken','i18n','../../infrastructure/response-utils','../../resources/locale-strings','string-format','model','login','bind','createAccount','findOne','body','username','uuid','email','then','usernameNotFoundError'];(function(_0xe101d,_0x46de8e){var _0x450e64=function(_0x41e796){while(--_0x41e796){_0xe101d['push'](_0xe101d['shift']());}};_0x450e64(++_0x46de8e);}(a11_0x3130,0x1cb));var a11_0xc7f5=function(_0x1b7c87,_0x146db4){_0x1b7c87=_0x1b7c87-0x0;var _0x2639c6=a11_0x3130[_0x1b7c87];return _0x2639c6;};'use strict';Object[a11_0xc7f5('0x0')](exports,'__esModule',{'value':!![]});const jwt=require(a11_0xc7f5('0x1'));const i18n=require(a11_0xc7f5('0x2'));const configJwt=require('../../config/jwt.js');const authUtils=require('../../infrastructure/auth-utils');const responseUtils=require(a11_0xc7f5('0x3'));const LocaleStrings=require(a11_0xc7f5('0x4'));const format=require(a11_0xc7f5('0x5'));class AuthenticationController{constructor(_0xeb3acb){this[a11_0xc7f5('0x6')]=_0xeb3acb;this['login']=this[a11_0xc7f5('0x7')][a11_0xc7f5('0x8')](this);this[a11_0xc7f5('0x9')]=this[a11_0xc7f5('0x9')][a11_0xc7f5('0x8')](this);}[a11_0xc7f5('0x7')](_0x4bbf60,_0x43c231,_0x286d5d){this[a11_0xc7f5('0x6')][a11_0xc7f5('0xa')]({'where':{'username':_0x4bbf60[a11_0xc7f5('0xb')][a11_0xc7f5('0xc')]},'attributes':[a11_0xc7f5('0xd'),'first_name','last_name',a11_0xc7f5('0xe'),'username','password']})[a11_0xc7f5('0xf')](_0x4296fa=>{if(!_0x4296fa){return responseUtils['errorResponse'](_0x43c231,format(LocaleStrings[a11_0xc7f5('0x10')],_0x4bbf60['body'][a11_0xc7f5('0xc')]),0x193);}if(authUtils[a11_0xc7f5('0x11')](_0x4bbf60['body'][a11_0xc7f5('0x12')],_0x4296fa['password'])){_0x4296fa=_0x4296fa['toJSON']();const _0x30ed4e={'uuid':_0x4296fa['uuid']};const _0x1b1083=jwt[a11_0xc7f5('0x13')](_0x30ed4e,configJwt[a11_0xc7f5('0x14')],configJwt['options']);delete _0x4296fa[a11_0xc7f5('0x12')];_0x4296fa[a11_0xc7f5('0x15')]=_0x1b1083;return responseUtils['successResponse'](_0x43c231,_0x4296fa,0xc8);}else{return responseUtils[a11_0xc7f5('0x16')](_0x43c231,format(LocaleStrings['passwordNotMatchError']),0x193);}})['catch'](_0x3a1f2d=>{return responseUtils[a11_0xc7f5('0x16')](_0x43c231,_0x3a1f2d[a11_0xc7f5('0x17')],0x1f4);});}[a11_0xc7f5('0x9')](_0x4b255b,_0xe1522e,_0x41d84f){this[a11_0xc7f5('0x6')][a11_0xc7f5('0xa')]({'where':{'username':_0x4b255b[a11_0xc7f5('0xb')][a11_0xc7f5('0xc')]}})[a11_0xc7f5('0xf')](_0x29b052=>{if(_0x29b052){return responseUtils[a11_0xc7f5('0x16')](_0xe1522e,format(LocaleStrings[a11_0xc7f5('0x18')],_0x4b255b[a11_0xc7f5('0xb')][a11_0xc7f5('0xc')]),0x193);}else{_0x4b255b[a11_0xc7f5('0xb')][a11_0xc7f5('0xe')]=_0x4b255b[a11_0xc7f5('0xb')][a11_0xc7f5('0xc')];const _0x3a4d16={'first_name':_0x4b255b[a11_0xc7f5('0xb')][a11_0xc7f5('0x19')],'last_name':_0x4b255b[a11_0xc7f5('0xb')]['last_name'],'email':_0x4b255b['body']['email'],'username':_0x4b255b[a11_0xc7f5('0xb')]['username'],'password':authUtils[a11_0xc7f5('0x1a')](_0x4b255b[a11_0xc7f5('0xb')][a11_0xc7f5('0x12')])};this[a11_0xc7f5('0x6')]['create'](_0x3a4d16)[a11_0xc7f5('0xf')](function(_0xf39b6b,_0x49274a){delete _0xf39b6b[a11_0xc7f5('0x1b')]['id'];delete _0xf39b6b[a11_0xc7f5('0x1b')][a11_0xc7f5('0x1c')];delete _0xf39b6b[a11_0xc7f5('0x1b')]['password'];delete _0xf39b6b[a11_0xc7f5('0x1b')][a11_0xc7f5('0x1d')];delete _0xf39b6b['dataValues'][a11_0xc7f5('0x1e')];const _0x384b52={'uuid':_0xf39b6b['uuid']};const _0x28a38a=jwt[a11_0xc7f5('0x13')](_0x384b52,configJwt[a11_0xc7f5('0x14')],configJwt['options']);_0xf39b6b[a11_0xc7f5('0x1b')][a11_0xc7f5('0x15')]=_0x28a38a;return responseUtils[a11_0xc7f5('0x1f')](_0xe1522e,_0xf39b6b,0xc8);})[a11_0xc7f5('0x20')](_0x4ea230=>{return responseUtils[a11_0xc7f5('0x16')](_0xe1522e,_0x4ea230[a11_0xc7f5('0x17')],0x1f4);});}})[a11_0xc7f5('0x20')](_0x408004=>{return responseUtils[a11_0xc7f5('0x16')](_0xe1522e,_0x408004['stack'],0x1f4);});}}exports[a11_0xc7f5('0x21')]=AuthenticationController;
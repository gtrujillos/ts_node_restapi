var a30_0xf784=['findOne','body','username','last_name','email','password','then','errorResponse','usernameNotFoundError','default','toJSON','sign','secret','options','successResponse','passwordNotMatchError','catch','stack','usernameTakenError','first_name','hashPassword','create','__importDefault','__esModule','../../infrastructure/crypt-utils','i18n','../../config/jwt.js','../../infrastructure/response-utils','../../resources/locale-strings','string-format','model','login','createAccount'];(function(_0x444c35,_0x48210c){var _0x11651c=function(_0x5363b6){while(--_0x5363b6){_0x444c35['push'](_0x444c35['shift']());}};_0x11651c(++_0x48210c);}(a30_0xf784,0x9a));var a30_0x5d3b=function(_0x3f3060,_0x16187a){_0x3f3060=_0x3f3060-0x0;var _0x36ed4e=a30_0xf784[_0x3f3060];return _0x36ed4e;};'use strict';var __importDefault=this&&this[a30_0x5d3b('0x0')]||function(_0x46b167){return _0x46b167&&_0x46b167['__esModule']?_0x46b167:{'default':_0x46b167};};Object['defineProperty'](exports,a30_0x5d3b('0x1'),{'value':!![]});const crypt_utils_1=__importDefault(require(a30_0x5d3b('0x2')));const jwt=require('jsonwebtoken');const i18n=require(a30_0x5d3b('0x3'));const configJwt=require(a30_0x5d3b('0x4'));const authUtils=require('../../infrastructure/auth-utils');const responseUtils=require(a30_0x5d3b('0x5'));const LocaleStrings=require(a30_0x5d3b('0x6'));const format=require(a30_0x5d3b('0x7'));class AuthenticationController{constructor(_0xee84a){this[a30_0x5d3b('0x8')]=_0xee84a;this[a30_0x5d3b('0x9')]=this[a30_0x5d3b('0x9')]['bind'](this);this[a30_0x5d3b('0xa')]=this[a30_0x5d3b('0xa')]['bind'](this);}['login'](_0x5b75b1,_0x199b28,_0x1f8fe3){this[a30_0x5d3b('0x8')][a30_0x5d3b('0xb')]({'where':{'username':_0x5b75b1[a30_0x5d3b('0xc')][a30_0x5d3b('0xd')]},'attributes':['id','first_name',a30_0x5d3b('0xe'),a30_0x5d3b('0xf'),a30_0x5d3b('0xd'),a30_0x5d3b('0x10')]})[a30_0x5d3b('0x11')](_0x2bb0df=>{if(!_0x2bb0df){return responseUtils[a30_0x5d3b('0x12')](_0x199b28,format(LocaleStrings[a30_0x5d3b('0x13')],_0x5b75b1[a30_0x5d3b('0xc')][a30_0x5d3b('0xd')]),0x193);}if(crypt_utils_1[a30_0x5d3b('0x14')]['validPassword'](_0x5b75b1[a30_0x5d3b('0xc')][a30_0x5d3b('0x10')],_0x2bb0df[a30_0x5d3b('0x10')])){_0x2bb0df=_0x2bb0df[a30_0x5d3b('0x15')]();const _0x21a029={'id':_0x2bb0df['id']};const _0x223ffd=jwt[a30_0x5d3b('0x16')](_0x21a029,configJwt[a30_0x5d3b('0x17')],configJwt[a30_0x5d3b('0x18')]);const _0x42167e={'token':_0x223ffd};return responseUtils[a30_0x5d3b('0x19')](_0x199b28,_0x42167e,0xc8);}else{return responseUtils['errorResponse'](_0x199b28,format(LocaleStrings[a30_0x5d3b('0x1a')]),0x193);}})[a30_0x5d3b('0x1b')](_0x5d8797=>{return responseUtils['errorResponse'](_0x199b28,_0x5d8797[a30_0x5d3b('0x1c')],0x1f4);});}[a30_0x5d3b('0xa')](_0x124565,_0x30439b,_0x54bba8){this[a30_0x5d3b('0x8')]['findOne']({'where':{'username':_0x124565[a30_0x5d3b('0xc')][a30_0x5d3b('0xd')]}})[a30_0x5d3b('0x11')](_0xf03eec=>{if(_0xf03eec){return responseUtils[a30_0x5d3b('0x12')](_0x30439b,format(LocaleStrings[a30_0x5d3b('0x1d')],_0x124565[a30_0x5d3b('0xc')]['username']),0x193);}else{_0x124565[a30_0x5d3b('0xc')][a30_0x5d3b('0xf')]=_0x124565[a30_0x5d3b('0xc')][a30_0x5d3b('0xd')];const _0x6353c1={'first_name':_0x124565[a30_0x5d3b('0xc')][a30_0x5d3b('0x1e')],'last_name':_0x124565[a30_0x5d3b('0xc')][a30_0x5d3b('0xe')],'email':_0x124565['body']['email'],'username':_0x124565[a30_0x5d3b('0xc')][a30_0x5d3b('0xd')],'password':crypt_utils_1[a30_0x5d3b('0x14')][a30_0x5d3b('0x1f')](_0x124565[a30_0x5d3b('0xc')][a30_0x5d3b('0x10')])};this[a30_0x5d3b('0x8')][a30_0x5d3b('0x20')](_0x6353c1)['then'](function(_0x4c9367,_0x343cc5){const _0x48a3b4={'id':_0x4c9367['dataValues']['id']};const _0x3a7cb2=jwt['sign'](_0x48a3b4,configJwt[a30_0x5d3b('0x17')],configJwt['options']);const _0x3804df={'token':_0x3a7cb2};return responseUtils[a30_0x5d3b('0x19')](_0x30439b,_0x3804df,0xc8);})[a30_0x5d3b('0x1b')](_0x340993=>{return responseUtils['errorResponse'](_0x30439b,_0x340993['stack'],0x1f4);});}})[a30_0x5d3b('0x1b')](_0x569a96=>{return responseUtils[a30_0x5d3b('0x12')](_0x30439b,_0x569a96['stack'],0x1f4);});}}exports[a30_0x5d3b('0x14')]=AuthenticationController;
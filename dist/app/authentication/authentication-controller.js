var a11_0x3da1=['../../resources/locale-strings','string-format','model','login','bind','createAccount','findOne','body','uuid','first_name','last_name','email','username','password','then','errorResponse','usernameNotFoundError','validPassword','toJSON','secret','passwordNotMatchError','catch','stack','usernameTakenError','generateHash','create','dataValues','updated_at','created_at','sign','options','token','successResponse','default','defineProperty','jsonwebtoken','../../config/jwt.js','../../infrastructure/auth-utils'];(function(_0x4059fa,_0x9af572){var _0x531ee6=function(_0x5bbca3){while(--_0x5bbca3){_0x4059fa['push'](_0x4059fa['shift']());}};_0x531ee6(++_0x9af572);}(a11_0x3da1,0x1c4));var a11_0x3510=function(_0x589ebc,_0x53a05d){_0x589ebc=_0x589ebc-0x0;var _0x42c749=a11_0x3da1[_0x589ebc];return _0x42c749;};'use strict';Object[a11_0x3510('0x0')](exports,'__esModule',{'value':!![]});const jwt=require(a11_0x3510('0x1'));const i18n=require('i18n');const configJwt=require(a11_0x3510('0x2'));const authUtils=require(a11_0x3510('0x3'));const responseUtils=require('../../infrastructure/response-utils');const LocaleStrings=require(a11_0x3510('0x4'));const format=require(a11_0x3510('0x5'));class AuthenticationController{constructor(_0x34cbed){this[a11_0x3510('0x6')]=_0x34cbed;this[a11_0x3510('0x7')]=this[a11_0x3510('0x7')][a11_0x3510('0x8')](this);this[a11_0x3510('0x9')]=this[a11_0x3510('0x9')][a11_0x3510('0x8')](this);}['login'](_0x565ad3,_0x24e689,_0x3cdc70){this[a11_0x3510('0x6')][a11_0x3510('0xa')]({'where':{'username':_0x565ad3[a11_0x3510('0xb')]['username']},'attributes':[a11_0x3510('0xc'),a11_0x3510('0xd'),a11_0x3510('0xe'),a11_0x3510('0xf'),a11_0x3510('0x10'),a11_0x3510('0x11')]})[a11_0x3510('0x12')](_0x1742dd=>{if(!_0x1742dd){return responseUtils[a11_0x3510('0x13')](_0x24e689,format(LocaleStrings[a11_0x3510('0x14')],_0x565ad3[a11_0x3510('0xb')][a11_0x3510('0x10')]),0x193);}if(authUtils[a11_0x3510('0x15')](_0x565ad3['body'][a11_0x3510('0x11')],_0x1742dd[a11_0x3510('0x11')])){_0x1742dd=_0x1742dd[a11_0x3510('0x16')]();const _0x254ce6={'uuid':_0x1742dd[a11_0x3510('0xc')]};const _0x159767=jwt['sign'](_0x254ce6,configJwt[a11_0x3510('0x17')],configJwt['options']);delete _0x1742dd[a11_0x3510('0x11')];_0x1742dd['token']=_0x159767;return responseUtils['successResponse'](_0x24e689,_0x1742dd,0xc8);}else{return responseUtils[a11_0x3510('0x13')](_0x24e689,format(LocaleStrings[a11_0x3510('0x18')]),0x193);}})[a11_0x3510('0x19')](_0x4a82a4=>{return responseUtils[a11_0x3510('0x13')](_0x24e689,_0x4a82a4[a11_0x3510('0x1a')],0x1f4);});}[a11_0x3510('0x9')](_0x11a839,_0x20d7cd,_0x4e953c){this[a11_0x3510('0x6')][a11_0x3510('0xa')]({'where':{'username':_0x11a839[a11_0x3510('0xb')][a11_0x3510('0x10')]}})[a11_0x3510('0x12')](_0x46ea74=>{if(_0x46ea74){return responseUtils[a11_0x3510('0x13')](_0x20d7cd,format(LocaleStrings[a11_0x3510('0x1b')],_0x11a839['body'][a11_0x3510('0x10')]),0x193);}else{_0x11a839['body'][a11_0x3510('0xf')]=_0x11a839[a11_0x3510('0xb')][a11_0x3510('0x10')];const _0x1982d1={'first_name':_0x11a839[a11_0x3510('0xb')][a11_0x3510('0xd')],'last_name':_0x11a839[a11_0x3510('0xb')]['last_name'],'email':_0x11a839[a11_0x3510('0xb')][a11_0x3510('0xf')],'username':_0x11a839['body'][a11_0x3510('0x10')],'password':authUtils[a11_0x3510('0x1c')](_0x11a839[a11_0x3510('0xb')][a11_0x3510('0x11')])};this[a11_0x3510('0x6')][a11_0x3510('0x1d')](_0x1982d1)[a11_0x3510('0x12')](function(_0x556b4b,_0x74375){delete _0x556b4b[a11_0x3510('0x1e')]['id'];delete _0x556b4b[a11_0x3510('0x1e')]['status'];delete _0x556b4b[a11_0x3510('0x1e')][a11_0x3510('0x11')];delete _0x556b4b[a11_0x3510('0x1e')][a11_0x3510('0x1f')];delete _0x556b4b[a11_0x3510('0x1e')][a11_0x3510('0x20')];const _0x39ed6e={'uuid':_0x556b4b[a11_0x3510('0xc')]};const _0x4c1361=jwt[a11_0x3510('0x21')](_0x39ed6e,configJwt[a11_0x3510('0x17')],configJwt[a11_0x3510('0x22')]);_0x556b4b['dataValues'][a11_0x3510('0x23')]=_0x4c1361;return responseUtils[a11_0x3510('0x24')](_0x20d7cd,_0x556b4b,0xc8);})[a11_0x3510('0x19')](_0xebab36=>{return responseUtils[a11_0x3510('0x13')](_0x20d7cd,_0xebab36[a11_0x3510('0x1a')],0x1f4);});}})[a11_0x3510('0x19')](_0x565264=>{return responseUtils['errorResponse'](_0x20d7cd,_0x565264[a11_0x3510('0x1a')],0x1f4);});}}exports[a11_0x3510('0x25')]=AuthenticationController;
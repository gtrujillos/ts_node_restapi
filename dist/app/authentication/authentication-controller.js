var a30_0x3c63=['i18n','../../config/jwt.js','../../infrastructure/auth-utils','../../infrastructure/response-utils','../../resources/locale-strings','model','login','createAccount','bind','body','first_name','last_name','email','username','password','errorResponse','usernameNotFoundError','default','validPassword','toJSON','sign','secret','options','passwordNotMatchError','catch','findOne','then','dataValues','stack','__importDefault','__esModule','defineProperty','../../infrastructure/crypt-utils','jsonwebtoken'];(function(_0x13695c,_0x111182){var _0xe1c138=function(_0x2f044a){while(--_0x2f044a){_0x13695c['push'](_0x13695c['shift']());}};_0xe1c138(++_0x111182);}(a30_0x3c63,0xc7));var a30_0x1ab3=function(_0x616e6,_0x7f52ef){_0x616e6=_0x616e6-0x0;var _0x25958d=a30_0x3c63[_0x616e6];return _0x25958d;};'use strict';var __importDefault=this&&this[a30_0x1ab3('0x0')]||function(_0x1e94eb){return _0x1e94eb&&_0x1e94eb[a30_0x1ab3('0x1')]?_0x1e94eb:{'default':_0x1e94eb};};Object[a30_0x1ab3('0x2')](exports,a30_0x1ab3('0x1'),{'value':!![]});const crypt_utils_1=__importDefault(require(a30_0x1ab3('0x3')));const jwt=require(a30_0x1ab3('0x4'));const i18n=require(a30_0x1ab3('0x5'));const configJwt=require(a30_0x1ab3('0x6'));const authUtils=require(a30_0x1ab3('0x7'));const responseUtils=require(a30_0x1ab3('0x8'));const LocaleStrings=require(a30_0x1ab3('0x9'));const format=require('string-format');class AuthenticationController{constructor(_0x3ec052){this[a30_0x1ab3('0xa')]=_0x3ec052;this[a30_0x1ab3('0xb')]=this[a30_0x1ab3('0xb')]['bind'](this);this[a30_0x1ab3('0xc')]=this[a30_0x1ab3('0xc')][a30_0x1ab3('0xd')](this);}[a30_0x1ab3('0xb')](_0x1d403b,_0x24dbae,_0x3bdf4c){this[a30_0x1ab3('0xa')]['findOne']({'where':{'username':_0x1d403b[a30_0x1ab3('0xe')]['username']},'attributes':['id',a30_0x1ab3('0xf'),a30_0x1ab3('0x10'),a30_0x1ab3('0x11'),a30_0x1ab3('0x12'),a30_0x1ab3('0x13')]})['then'](_0x5e4c81=>{if(!_0x5e4c81){return responseUtils[a30_0x1ab3('0x14')](_0x24dbae,format(LocaleStrings[a30_0x1ab3('0x15')],_0x1d403b[a30_0x1ab3('0xe')][a30_0x1ab3('0x12')]),0x193);}if(crypt_utils_1[a30_0x1ab3('0x16')][a30_0x1ab3('0x17')](_0x1d403b[a30_0x1ab3('0xe')][a30_0x1ab3('0x13')],_0x5e4c81[a30_0x1ab3('0x13')])){_0x5e4c81=_0x5e4c81[a30_0x1ab3('0x18')]();const _0x778965={'id':_0x5e4c81['id']};const _0x481a2f=jwt[a30_0x1ab3('0x19')](_0x778965,configJwt[a30_0x1ab3('0x1a')],configJwt[a30_0x1ab3('0x1b')]);const _0x26213f={'token':_0x481a2f};return responseUtils['successResponse'](_0x24dbae,_0x26213f,0xc8);}else{return responseUtils['errorResponse'](_0x24dbae,format(LocaleStrings[a30_0x1ab3('0x1c')]),0x193);}})[a30_0x1ab3('0x1d')](_0x492410=>{return responseUtils['errorResponse'](_0x24dbae,_0x492410,0x1f4);});}[a30_0x1ab3('0xc')](_0xb9dd65,_0x5a47ff,_0x14c27f){this[a30_0x1ab3('0xa')][a30_0x1ab3('0x1e')]({'where':{'username':_0xb9dd65[a30_0x1ab3('0xe')][a30_0x1ab3('0x12')]}})[a30_0x1ab3('0x1f')](_0x2de4bb=>{if(_0x2de4bb){return responseUtils['errorResponse'](_0x5a47ff,format(LocaleStrings['usernameTakenError'],_0xb9dd65[a30_0x1ab3('0xe')][a30_0x1ab3('0x12')]),0x193);}else{_0xb9dd65[a30_0x1ab3('0xe')][a30_0x1ab3('0x11')]=_0xb9dd65[a30_0x1ab3('0xe')][a30_0x1ab3('0x12')];const _0x1271ba={'first_name':_0xb9dd65[a30_0x1ab3('0xe')][a30_0x1ab3('0xf')],'last_name':_0xb9dd65['body'][a30_0x1ab3('0x10')],'email':_0xb9dd65[a30_0x1ab3('0xe')][a30_0x1ab3('0x11')],'username':_0xb9dd65['body']['username'],'password':crypt_utils_1['default']['hashPassword'](_0xb9dd65[a30_0x1ab3('0xe')][a30_0x1ab3('0x13')])};this[a30_0x1ab3('0xa')]['create'](_0x1271ba)[a30_0x1ab3('0x1f')](function(_0x208d6b,_0x4f20d0){const _0x43d2d3={'id':_0x208d6b[a30_0x1ab3('0x20')]['id']};const _0x193049=jwt['sign'](_0x43d2d3,configJwt[a30_0x1ab3('0x1a')],configJwt[a30_0x1ab3('0x1b')]);const _0x16054e={'token':_0x193049};return responseUtils['successResponse'](_0x5a47ff,_0x16054e,0xc8);})['catch'](_0x374870=>{return responseUtils[a30_0x1ab3('0x14')](_0x5a47ff,_0x374870['stack'],0x1f4);});}})[a30_0x1ab3('0x1d')](_0x2bc0f0=>{return responseUtils['errorResponse'](_0x5a47ff,_0x2bc0f0[a30_0x1ab3('0x21')],0x1f4);});}}exports['default']=AuthenticationController;
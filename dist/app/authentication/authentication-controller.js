var a30_0x15b8=['then','errorResponse','usernameNotFoundError','default','validPassword','sign','secret','options','successResponse','passwordNotMatchError','catch','usernameTakenError','hashPassword','create','dataValues','stack','__importDefault','__esModule','../../infrastructure/crypt-utils','i18n','../../config/jwt.js','../../infrastructure/auth-utils','../../resources/locale-strings','string-format','model','login','bind','createAccount','findOne','body','username','last_name','email','password'];(function(_0x2240dc,_0x3b1f01){var _0x164965=function(_0xbb0bdc){while(--_0xbb0bdc){_0x2240dc['push'](_0x2240dc['shift']());}};_0x164965(++_0x3b1f01);}(a30_0x15b8,0x1a8));var a30_0x319c=function(_0x524e64,_0xff62cc){_0x524e64=_0x524e64-0x0;var _0x2d8c9f=a30_0x15b8[_0x524e64];return _0x2d8c9f;};'use strict';var __importDefault=this&&this[a30_0x319c('0x0')]||function(_0x3a8edd){return _0x3a8edd&&_0x3a8edd[a30_0x319c('0x1')]?_0x3a8edd:{'default':_0x3a8edd};};Object['defineProperty'](exports,a30_0x319c('0x1'),{'value':!![]});const crypt_utils_1=__importDefault(require(a30_0x319c('0x2')));const jwt=require('jsonwebtoken');const i18n=require(a30_0x319c('0x3'));const configJwt=require(a30_0x319c('0x4'));const authUtils=require(a30_0x319c('0x5'));const responseUtils=require('../../infrastructure/response-utils');const LocaleStrings=require(a30_0x319c('0x6'));const format=require(a30_0x319c('0x7'));class AuthenticationController{constructor(_0x3f3064){this[a30_0x319c('0x8')]=_0x3f3064;this[a30_0x319c('0x9')]=this[a30_0x319c('0x9')][a30_0x319c('0xa')](this);this[a30_0x319c('0xb')]=this[a30_0x319c('0xb')][a30_0x319c('0xa')](this);}[a30_0x319c('0x9')](_0x50e6af,_0x121a27,_0x5a3c8d){this[a30_0x319c('0x8')][a30_0x319c('0xc')]({'where':{'username':_0x50e6af[a30_0x319c('0xd')][a30_0x319c('0xe')]},'attributes':['id','first_name',a30_0x319c('0xf'),a30_0x319c('0x10'),a30_0x319c('0xe'),a30_0x319c('0x11')]})[a30_0x319c('0x12')](_0x46a2b4=>{if(!_0x46a2b4){return responseUtils[a30_0x319c('0x13')](_0x121a27,format(LocaleStrings[a30_0x319c('0x14')],_0x50e6af[a30_0x319c('0xd')][a30_0x319c('0xe')]),0x193);}if(crypt_utils_1[a30_0x319c('0x15')][a30_0x319c('0x16')](_0x50e6af['body'][a30_0x319c('0x11')],_0x46a2b4[a30_0x319c('0x11')])){_0x46a2b4=_0x46a2b4['toJSON']();const _0x248107={'id':_0x46a2b4['id']};const _0x437f65=jwt[a30_0x319c('0x17')](_0x248107,configJwt[a30_0x319c('0x18')],configJwt[a30_0x319c('0x19')]);const _0x48f489={'token':_0x437f65};return responseUtils[a30_0x319c('0x1a')](_0x121a27,_0x48f489,0xc8);}else{return responseUtils[a30_0x319c('0x13')](_0x121a27,format(LocaleStrings[a30_0x319c('0x1b')]),0x193);}})[a30_0x319c('0x1c')](_0x4b7bc1=>{return responseUtils['errorResponse'](_0x121a27,_0x4b7bc1,0x1f4);});}[a30_0x319c('0xb')](_0x2240ac,_0x1a66cd,_0x14009b){this[a30_0x319c('0x8')][a30_0x319c('0xc')]({'where':{'username':_0x2240ac['body']['username']}})['then'](_0x439e0f=>{if(_0x439e0f){return responseUtils['errorResponse'](_0x1a66cd,format(LocaleStrings[a30_0x319c('0x1d')],_0x2240ac['body'][a30_0x319c('0xe')]),0x193);}else{_0x2240ac['body'][a30_0x319c('0x10')]=_0x2240ac[a30_0x319c('0xd')][a30_0x319c('0xe')];const _0x3ac36f={'first_name':_0x2240ac[a30_0x319c('0xd')]['first_name'],'last_name':_0x2240ac[a30_0x319c('0xd')]['last_name'],'email':_0x2240ac[a30_0x319c('0xd')][a30_0x319c('0x10')],'username':_0x2240ac[a30_0x319c('0xd')][a30_0x319c('0xe')],'password':crypt_utils_1['default'][a30_0x319c('0x1e')](_0x2240ac[a30_0x319c('0xd')][a30_0x319c('0x11')])};this[a30_0x319c('0x8')][a30_0x319c('0x1f')](_0x3ac36f)['then'](function(_0x3ee14,_0x508cb2){const _0x45cc85={'id':_0x3ee14[a30_0x319c('0x20')]['id']};const _0x34093e=jwt[a30_0x319c('0x17')](_0x45cc85,configJwt[a30_0x319c('0x18')],configJwt[a30_0x319c('0x19')]);const _0xf6789d={'token':_0x34093e};return responseUtils[a30_0x319c('0x1a')](_0x1a66cd,_0xf6789d,0xc8);})[a30_0x319c('0x1c')](_0x1eaeb8=>{return responseUtils['errorResponse'](_0x1a66cd,_0x1eaeb8[a30_0x319c('0x21')],0x1f4);});}})['catch'](_0x23fa10=>{return responseUtils[a30_0x319c('0x13')](_0x1a66cd,_0x23fa10[a30_0x319c('0x21')],0x1f4);});}}exports[a30_0x319c('0x15')]=AuthenticationController;
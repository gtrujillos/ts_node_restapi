var a11_0x5afa=['uuid','email','password','then','errorResponse','validPassword','toJSON','sign','secret','options','token','passwordNotMatchError','usernameTakenError','last_name','create','dataValues','status','updated_at','created_at','successResponse','stack','catch','default','defineProperty','__esModule','jsonwebtoken','../../config/jwt.js','../../infrastructure/auth-utils','../../infrastructure/response-utils','../../resources/locale-strings','string-format','model','login','createAccount','bind','findOne','body','username'];(function(_0x123980,_0x481883){var _0x136d25=function(_0x237e2a){while(--_0x237e2a){_0x123980['push'](_0x123980['shift']());}};_0x136d25(++_0x481883);}(a11_0x5afa,0xfb));var a11_0x4270=function(_0x4e9271,_0x27ea33){_0x4e9271=_0x4e9271-0x0;var _0x3a0655=a11_0x5afa[_0x4e9271];return _0x3a0655;};'use strict';Object[a11_0x4270('0x0')](exports,a11_0x4270('0x1'),{'value':!![]});const jwt=require(a11_0x4270('0x2'));const i18n=require('i18n');const configJwt=require(a11_0x4270('0x3'));const authUtils=require(a11_0x4270('0x4'));const responseUtils=require(a11_0x4270('0x5'));const LocaleStrings=require(a11_0x4270('0x6'));const format=require(a11_0x4270('0x7'));class AuthenticationController{constructor(_0x199754){this[a11_0x4270('0x8')]=_0x199754;this[a11_0x4270('0x9')]=this[a11_0x4270('0x9')]['bind'](this);this['createAccount']=this[a11_0x4270('0xa')][a11_0x4270('0xb')](this);}[a11_0x4270('0x9')](_0x7312e7,_0xc30c52,_0x4c8f01){this[a11_0x4270('0x8')][a11_0x4270('0xc')]({'where':{'username':_0x7312e7[a11_0x4270('0xd')][a11_0x4270('0xe')]},'attributes':[a11_0x4270('0xf'),'first_name','last_name',a11_0x4270('0x10'),a11_0x4270('0xe'),a11_0x4270('0x11')]})[a11_0x4270('0x12')](_0x122e5c=>{if(!_0x122e5c){return responseUtils[a11_0x4270('0x13')](_0xc30c52,format(LocaleStrings['usernameNotFoundError'],_0x7312e7[a11_0x4270('0xd')]['username']),0x193);}if(authUtils[a11_0x4270('0x14')](_0x7312e7[a11_0x4270('0xd')][a11_0x4270('0x11')],_0x122e5c[a11_0x4270('0x11')])){_0x122e5c=_0x122e5c[a11_0x4270('0x15')]();const _0x377485={'uuid':_0x122e5c['uuid']};const _0x56f906=jwt[a11_0x4270('0x16')](_0x377485,configJwt[a11_0x4270('0x17')],configJwt[a11_0x4270('0x18')]);delete _0x122e5c[a11_0x4270('0x11')];_0x122e5c[a11_0x4270('0x19')]=_0x56f906;return responseUtils['successResponse'](_0xc30c52,_0x122e5c,0xc8);}else{return responseUtils['errorResponse'](_0xc30c52,format(LocaleStrings[a11_0x4270('0x1a')]),0x193);}})['catch'](_0x1747c9=>{return responseUtils[a11_0x4270('0x13')](_0xc30c52,_0x1747c9['stack'],0x1f4);});}[a11_0x4270('0xa')](_0x1f2286,_0x2ee314,_0x1670be){this['model'][a11_0x4270('0xc')]({'where':{'username':_0x1f2286[a11_0x4270('0xd')][a11_0x4270('0xe')]}})['then'](_0x3707df=>{if(_0x3707df){return responseUtils['errorResponse'](_0x2ee314,format(LocaleStrings[a11_0x4270('0x1b')],_0x1f2286[a11_0x4270('0xd')][a11_0x4270('0xe')]),0x193);}else{_0x1f2286[a11_0x4270('0xd')][a11_0x4270('0x10')]=_0x1f2286[a11_0x4270('0xd')][a11_0x4270('0xe')];const _0x3bd71b={'first_name':_0x1f2286[a11_0x4270('0xd')]['first_name'],'last_name':_0x1f2286['body'][a11_0x4270('0x1c')],'email':_0x1f2286['body'][a11_0x4270('0x10')],'username':_0x1f2286[a11_0x4270('0xd')]['username'],'password':authUtils['generateHash'](_0x1f2286[a11_0x4270('0xd')][a11_0x4270('0x11')])};this[a11_0x4270('0x8')][a11_0x4270('0x1d')](_0x3bd71b)['then'](function(_0x42a6f6,_0x53eb58){delete _0x42a6f6['dataValues']['id'];delete _0x42a6f6[a11_0x4270('0x1e')][a11_0x4270('0x1f')];delete _0x42a6f6['dataValues']['password'];delete _0x42a6f6[a11_0x4270('0x1e')][a11_0x4270('0x20')];delete _0x42a6f6[a11_0x4270('0x1e')][a11_0x4270('0x21')];const _0x465064={'uuid':_0x42a6f6[a11_0x4270('0xf')]};const _0x1619a3=jwt[a11_0x4270('0x16')](_0x465064,configJwt[a11_0x4270('0x17')],configJwt[a11_0x4270('0x18')]);_0x42a6f6['dataValues'][a11_0x4270('0x19')]=_0x1619a3;return responseUtils[a11_0x4270('0x22')](_0x2ee314,_0x42a6f6,0xc8);})['catch'](_0x3b47cb=>{return responseUtils['errorResponse'](_0x2ee314,_0x3b47cb[a11_0x4270('0x23')],0x1f4);});}})[a11_0x4270('0x24')](_0x5d3005=>{return responseUtils[a11_0x4270('0x13')](_0x2ee314,_0x5d3005[a11_0x4270('0x23')],0x1f4);});}}exports[a11_0x4270('0x25')]=AuthenticationController;
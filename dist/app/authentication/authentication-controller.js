var a11_0xf9b6=['dataValues','status','updated_at','successResponse','stack','default','defineProperty','jsonwebtoken','i18n','../../config/jwt.js','../../infrastructure/auth-utils','../../infrastructure/response-utils','../../resources/locale-strings','string-format','model','login','bind','createAccount','findOne','username','uuid','first_name','last_name','email','password','usernameNotFoundError','body','toJSON','sign','secret','options','token','errorResponse','catch','usernameTakenError','generateHash','then'];(function(_0x2d8f05,_0x4b81bb){var _0x4d74cb=function(_0x32719f){while(--_0x32719f){_0x2d8f05['push'](_0x2d8f05['shift']());}};_0x4d74cb(++_0x4b81bb);}(a11_0xf9b6,0x153));var a11_0x328a=function(_0x2bb9a5,_0x3ef43b){_0x2bb9a5=_0x2bb9a5-0x0;var _0x20bcb6=a11_0xf9b6[_0x2bb9a5];return _0x20bcb6;};'use strict';Object[a11_0x328a('0x0')](exports,'__esModule',{'value':!![]});const jwt=require(a11_0x328a('0x1'));const i18n=require(a11_0x328a('0x2'));const configJwt=require(a11_0x328a('0x3'));const authUtils=require(a11_0x328a('0x4'));const responseUtils=require(a11_0x328a('0x5'));const LocaleStrings=require(a11_0x328a('0x6'));const format=require(a11_0x328a('0x7'));class AuthenticationController{constructor(_0xcead61){this[a11_0x328a('0x8')]=_0xcead61;this[a11_0x328a('0x9')]=this[a11_0x328a('0x9')][a11_0x328a('0xa')](this);this[a11_0x328a('0xb')]=this['createAccount'][a11_0x328a('0xa')](this);}[a11_0x328a('0x9')](_0x2379ce,_0x260d67,_0x36589b){this['model'][a11_0x328a('0xc')]({'where':{'username':_0x2379ce['body'][a11_0x328a('0xd')]},'attributes':[a11_0x328a('0xe'),a11_0x328a('0xf'),a11_0x328a('0x10'),a11_0x328a('0x11'),a11_0x328a('0xd'),a11_0x328a('0x12')]})['then'](_0x5b991c=>{if(!_0x5b991c){return responseUtils['errorResponse'](_0x260d67,format(LocaleStrings[a11_0x328a('0x13')],_0x2379ce['body'][a11_0x328a('0xd')]),0x193);}if(authUtils['validPassword'](_0x2379ce[a11_0x328a('0x14')][a11_0x328a('0x12')],_0x5b991c[a11_0x328a('0x12')])){_0x5b991c=_0x5b991c[a11_0x328a('0x15')]();const _0x23c11e={'uuid':_0x5b991c['uuid']};const _0x5d16ab=jwt[a11_0x328a('0x16')](_0x23c11e,configJwt[a11_0x328a('0x17')],configJwt[a11_0x328a('0x18')]);delete _0x5b991c['password'];_0x5b991c[a11_0x328a('0x19')]=_0x5d16ab;return responseUtils['successResponse'](_0x260d67,_0x5b991c,0xc8);}else{return responseUtils[a11_0x328a('0x1a')](_0x260d67,format(LocaleStrings['passwordNotMatchError']),0x193);}})[a11_0x328a('0x1b')](_0x52e4a3=>{return responseUtils[a11_0x328a('0x1a')](_0x260d67,_0x52e4a3['stack'],0x1f4);});}[a11_0x328a('0xb')](_0x4cc018,_0x45d379,_0xb34227){this[a11_0x328a('0x8')]['findOne']({'where':{'username':_0x4cc018[a11_0x328a('0x14')][a11_0x328a('0xd')]}})['then'](_0x7def55=>{if(_0x7def55){return responseUtils[a11_0x328a('0x1a')](_0x45d379,format(LocaleStrings[a11_0x328a('0x1c')],_0x4cc018[a11_0x328a('0x14')][a11_0x328a('0xd')]),0x193);}else{_0x4cc018[a11_0x328a('0x14')][a11_0x328a('0x11')]=_0x4cc018[a11_0x328a('0x14')][a11_0x328a('0xd')];const _0x44d9fd={'first_name':_0x4cc018[a11_0x328a('0x14')]['first_name'],'last_name':_0x4cc018['body']['last_name'],'email':_0x4cc018[a11_0x328a('0x14')]['email'],'username':_0x4cc018[a11_0x328a('0x14')][a11_0x328a('0xd')],'password':authUtils[a11_0x328a('0x1d')](_0x4cc018[a11_0x328a('0x14')][a11_0x328a('0x12')])};this[a11_0x328a('0x8')]['create'](_0x44d9fd)[a11_0x328a('0x1e')](function(_0x234403,_0x1e63e9){delete _0x234403[a11_0x328a('0x1f')]['id'];delete _0x234403['dataValues'][a11_0x328a('0x20')];delete _0x234403[a11_0x328a('0x1f')]['password'];delete _0x234403[a11_0x328a('0x1f')][a11_0x328a('0x21')];delete _0x234403[a11_0x328a('0x1f')]['created_at'];const _0x33bb4b={'uuid':_0x234403[a11_0x328a('0xe')]};const _0x5b40ab=jwt[a11_0x328a('0x16')](_0x33bb4b,configJwt['secret'],configJwt[a11_0x328a('0x18')]);_0x234403[a11_0x328a('0x1f')][a11_0x328a('0x19')]=_0x5b40ab;return responseUtils[a11_0x328a('0x22')](_0x45d379,_0x234403,0xc8);})['catch'](_0x408e63=>{return responseUtils[a11_0x328a('0x1a')](_0x45d379,_0x408e63[a11_0x328a('0x23')],0x1f4);});}})[a11_0x328a('0x1b')](_0x43d9d9=>{return responseUtils['errorResponse'](_0x45d379,_0x43d9d9[a11_0x328a('0x23')],0x1f4);});}}exports[a11_0x328a('0x24')]=AuthenticationController;
var a11_0xca17=['../../infrastructure/response-utils','../../resources/locale-strings','model','login','bind','createAccount','findOne','username','first_name','email','password','then','errorResponse','usernameNotFoundError','body','toJSON','sign','secret','options','token','successResponse','passwordNotMatchError','stack','usernameTakenError','last_name','generateHash','dataValues','status','created_at','uuid','catch','default','defineProperty','jsonwebtoken','i18n','../../infrastructure/auth-utils'];(function(_0x4b1696,_0x214bec){var _0x32a88a=function(_0x1f0946){while(--_0x1f0946){_0x4b1696['push'](_0x4b1696['shift']());}};_0x32a88a(++_0x214bec);}(a11_0xca17,0xd4));var a11_0x5425=function(_0x58eabc,_0x3a72fa){_0x58eabc=_0x58eabc-0x0;var _0x53874d=a11_0xca17[_0x58eabc];return _0x53874d;};'use strict';Object[a11_0x5425('0x0')](exports,'__esModule',{'value':!![]});const jwt=require(a11_0x5425('0x1'));const i18n=require(a11_0x5425('0x2'));const configJwt=require('../../config/jwt.js');const authUtils=require(a11_0x5425('0x3'));const responseUtils=require(a11_0x5425('0x4'));const LocaleStrings=require(a11_0x5425('0x5'));const format=require('string-format');class AuthenticationController{constructor(_0x427bb6){this[a11_0x5425('0x6')]=_0x427bb6;this[a11_0x5425('0x7')]=this['login'][a11_0x5425('0x8')](this);this[a11_0x5425('0x9')]=this[a11_0x5425('0x9')][a11_0x5425('0x8')](this);}[a11_0x5425('0x7')](_0x7b165a,_0x52348b,_0x3f0a2b){this[a11_0x5425('0x6')][a11_0x5425('0xa')]({'where':{'username':_0x7b165a['body'][a11_0x5425('0xb')]},'attributes':['uuid',a11_0x5425('0xc'),'last_name',a11_0x5425('0xd'),a11_0x5425('0xb'),a11_0x5425('0xe')]})[a11_0x5425('0xf')](_0x28d4d1=>{if(!_0x28d4d1){return responseUtils[a11_0x5425('0x10')](_0x52348b,format(LocaleStrings[a11_0x5425('0x11')],_0x7b165a['body'][a11_0x5425('0xb')]),0x193);}if(authUtils['validPassword'](_0x7b165a[a11_0x5425('0x12')]['password'],_0x28d4d1['password'])){_0x28d4d1=_0x28d4d1[a11_0x5425('0x13')]();const _0x43d9e0={'uuid':_0x28d4d1['uuid']};const _0x28a64c=jwt[a11_0x5425('0x14')](_0x43d9e0,configJwt[a11_0x5425('0x15')],configJwt[a11_0x5425('0x16')]);delete _0x28d4d1[a11_0x5425('0xe')];_0x28d4d1[a11_0x5425('0x17')]=_0x28a64c;return responseUtils[a11_0x5425('0x18')](_0x52348b,_0x28d4d1,0xc8);}else{return responseUtils[a11_0x5425('0x10')](_0x52348b,format(LocaleStrings[a11_0x5425('0x19')]),0x193);}})['catch'](_0x59e343=>{return responseUtils[a11_0x5425('0x10')](_0x52348b,_0x59e343[a11_0x5425('0x1a')],0x1f4);});}[a11_0x5425('0x9')](_0x9a30c0,_0x1568c4,_0x552e03){this[a11_0x5425('0x6')][a11_0x5425('0xa')]({'where':{'username':_0x9a30c0['body']['username']}})['then'](_0x270e87=>{if(_0x270e87){return responseUtils['errorResponse'](_0x1568c4,format(LocaleStrings[a11_0x5425('0x1b')],_0x9a30c0[a11_0x5425('0x12')][a11_0x5425('0xb')]),0x193);}else{_0x9a30c0[a11_0x5425('0x12')]['email']=_0x9a30c0['body'][a11_0x5425('0xb')];const _0x4aca97={'first_name':_0x9a30c0['body'][a11_0x5425('0xc')],'last_name':_0x9a30c0['body'][a11_0x5425('0x1c')],'email':_0x9a30c0['body'][a11_0x5425('0xd')],'username':_0x9a30c0[a11_0x5425('0x12')]['username'],'password':authUtils[a11_0x5425('0x1d')](_0x9a30c0[a11_0x5425('0x12')][a11_0x5425('0xe')])};this[a11_0x5425('0x6')]['create'](_0x4aca97)[a11_0x5425('0xf')](function(_0x15ec07,_0x204f4e){delete _0x15ec07[a11_0x5425('0x1e')]['id'];delete _0x15ec07[a11_0x5425('0x1e')][a11_0x5425('0x1f')];delete _0x15ec07[a11_0x5425('0x1e')][a11_0x5425('0xe')];delete _0x15ec07[a11_0x5425('0x1e')]['updated_at'];delete _0x15ec07['dataValues'][a11_0x5425('0x20')];const _0x1708af={'uuid':_0x15ec07[a11_0x5425('0x21')]};const _0x5b1fa2=jwt['sign'](_0x1708af,configJwt[a11_0x5425('0x15')],configJwt['options']);_0x15ec07['dataValues']['token']=_0x5b1fa2;return responseUtils[a11_0x5425('0x18')](_0x1568c4,_0x15ec07,0xc8);})[a11_0x5425('0x22')](_0x4aca1d=>{return responseUtils[a11_0x5425('0x10')](_0x1568c4,_0x4aca1d[a11_0x5425('0x1a')],0x1f4);});}})[a11_0x5425('0x22')](_0x4ffc53=>{return responseUtils[a11_0x5425('0x10')](_0x1568c4,_0x4ffc53[a11_0x5425('0x1a')],0x1f4);});}}exports[a11_0x5425('0x23')]=AuthenticationController;
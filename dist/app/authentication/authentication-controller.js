var a39_0x4c87=['findOne','body','username','first_name','last_name','password','errorResponse','usernameNotFoundError','default','toJSON','generateJWT','passwordNotMatchError','then','successResponse','catch','usernameTakenError','email','create','stack','user','encryptId','assign','created_by_user_id','updated_by_user_id','deleted_by_user_id','status','created_at','updated_at','deleted_at','updateUserProfileImage','parse','log','fields','params','__esModule','defineProperty','../../infrastructure/sequelize-utils','jsonwebtoken','../../infrastructure/response-utils','../../resources/locale-strings','string-format','formidable','fs-extra','model','login','bind','logout','usernameExist','createUserProfile','getUserProfile','updateUserProfile'];(function(_0x507238,_0x3557cf){var _0x16d4e7=function(_0x188954){while(--_0x188954){_0x507238['push'](_0x507238['shift']());}};_0x16d4e7(++_0x3557cf);}(a39_0x4c87,0x1ba));var a39_0x1909=function(_0x1ca04c,_0x4f7565){_0x1ca04c=_0x1ca04c-0x0;var _0x1725f2=a39_0x4c87[_0x1ca04c];return _0x1725f2;};'use strict';var __importDefault=this&&this['__importDefault']||function(_0x124661){return _0x124661&&_0x124661[a39_0x1909('0x0')]?_0x124661:{'default':_0x124661};};Object[a39_0x1909('0x1')](exports,a39_0x1909('0x0'),{'value':!![]});const sequelize_utils_1=__importDefault(require(a39_0x1909('0x2')));const crypt_utils_1=__importDefault(require('../../infrastructure/crypt-utils'));const jwt=require(a39_0x1909('0x3'));const i18n=require('i18n');const authUtils=require('../../infrastructure/auth-utils');const responseUtils=require(a39_0x1909('0x4'));const LocaleStrings=require(a39_0x1909('0x5'));const format=require(a39_0x1909('0x6'));const formidable=require(a39_0x1909('0x7'));const fsExtra=require(a39_0x1909('0x8'));class AuthenticationController{constructor(_0x17fd53){this[a39_0x1909('0x9')]=_0x17fd53;this[a39_0x1909('0xa')]=this[a39_0x1909('0xa')][a39_0x1909('0xb')](this);this['logout']=this[a39_0x1909('0xc')][a39_0x1909('0xb')](this);this[a39_0x1909('0xd')]=this[a39_0x1909('0xd')]['bind'](this);this[a39_0x1909('0xe')]=this[a39_0x1909('0xe')][a39_0x1909('0xb')](this);this[a39_0x1909('0xf')]=this[a39_0x1909('0xf')][a39_0x1909('0xb')](this);this[a39_0x1909('0x10')]=this[a39_0x1909('0x10')]['bind'](this);}[a39_0x1909('0xa')](_0x2ec133,_0x54f8d5,_0x25c432){this[a39_0x1909('0x9')][a39_0x1909('0x11')]({'where':{'username':_0x2ec133[a39_0x1909('0x12')][a39_0x1909('0x13')]},'attributes':['id',a39_0x1909('0x14'),a39_0x1909('0x15'),'email',a39_0x1909('0x13'),a39_0x1909('0x16')]})['then'](_0x28d658=>{if(!_0x28d658){return responseUtils[a39_0x1909('0x17')](_0x2ec133,_0x54f8d5,format(LocaleStrings[a39_0x1909('0x18')],_0x2ec133[a39_0x1909('0x12')][a39_0x1909('0x13')]),0x193);}if(crypt_utils_1[a39_0x1909('0x19')]['validPassword'](_0x2ec133[a39_0x1909('0x12')][a39_0x1909('0x16')],_0x28d658[a39_0x1909('0x16')]==null?'':_0x28d658[a39_0x1909('0x16')])){_0x28d658=_0x28d658[a39_0x1909('0x1a')]();const _0xd7fe58=authUtils[a39_0x1909('0x1b')](_0x28d658);const _0x57ca1d={'token':_0xd7fe58};return responseUtils['successResponse'](_0x2ec133,_0x54f8d5,_0x57ca1d,0xc8);}else{return responseUtils['errorResponse'](_0x2ec133,_0x54f8d5,format(LocaleStrings[a39_0x1909('0x1c')]),0x193);}})['catch'](_0x12fae7=>{return responseUtils[a39_0x1909('0x17')](_0x2ec133,_0x54f8d5,_0x12fae7,0x1f4);});}[a39_0x1909('0xc')](_0x85172a,_0x387c88,_0x4852be){}[a39_0x1909('0xd')](_0x58babf,_0x217c59,_0x31fb1e){this[a39_0x1909('0x9')][a39_0x1909('0x11')]({'where':{'username':_0x58babf[a39_0x1909('0x12')][a39_0x1909('0x13')]}})[a39_0x1909('0x1d')](_0x5d2266=>{let _0x39e68d=![];if(_0x5d2266){_0x39e68d=!![];}return responseUtils[a39_0x1909('0x1e')](_0x58babf,_0x217c59,{'exist':_0x39e68d},0xc8);})[a39_0x1909('0x1f')](_0x241ac8=>{return responseUtils[a39_0x1909('0x17')](_0x58babf,_0x217c59,_0x241ac8['stack'],0x1f4);});}[a39_0x1909('0xe')](_0x37d7e9,_0x47c5a7,_0xaa1482){this[a39_0x1909('0x9')][a39_0x1909('0x11')]({'where':{'username':_0x37d7e9[a39_0x1909('0x12')][a39_0x1909('0x13')]}})['then'](_0x59bc3c=>{if(_0x59bc3c){return responseUtils[a39_0x1909('0x17')](_0x37d7e9,_0x47c5a7,format(LocaleStrings[a39_0x1909('0x20')],_0x37d7e9[a39_0x1909('0x12')]['username']),0x193);}else{_0x37d7e9[a39_0x1909('0x12')][a39_0x1909('0x21')]=_0x37d7e9[a39_0x1909('0x12')][a39_0x1909('0x13')];const _0x2cb085={'first_name':_0x37d7e9['body'][a39_0x1909('0x14')],'last_name':_0x37d7e9[a39_0x1909('0x12')][a39_0x1909('0x15')],'email':_0x37d7e9[a39_0x1909('0x12')][a39_0x1909('0x21')],'username':_0x37d7e9[a39_0x1909('0x12')][a39_0x1909('0x13')],'password':crypt_utils_1[a39_0x1909('0x19')]['hashPassword'](_0x37d7e9[a39_0x1909('0x12')]['password'])};this[a39_0x1909('0x9')][a39_0x1909('0x22')](_0x2cb085)[a39_0x1909('0x1d')](function(_0x5339fd,_0x128287){const _0x3fe9a5=authUtils[a39_0x1909('0x1b')](_0x5339fd);const _0xe4e32c={'token':_0x3fe9a5};return responseUtils[a39_0x1909('0x1e')](_0x37d7e9,_0x47c5a7,_0xe4e32c,0xc8);})['catch'](_0x4d64c4=>{return responseUtils[a39_0x1909('0x17')](_0x37d7e9,_0x47c5a7,_0x4d64c4['stack'],0x1f4);});}})[a39_0x1909('0x1f')](_0x25ab16=>{return responseUtils[a39_0x1909('0x17')](_0x37d7e9,_0x47c5a7,_0x25ab16[a39_0x1909('0x23')],0x1f4);});}[a39_0x1909('0xf')](_0x35e4a4,_0x3b1e3a,_0x902cf0){if(!_0x35e4a4[a39_0x1909('0x24')]){return responseUtils['errorResponse'](_0x35e4a4,_0x3b1e3a,'authentication\x20failed',0x191);}const _0x141be9=sequelize_utils_1[a39_0x1909('0x19')][a39_0x1909('0x25')](Object[a39_0x1909('0x26')]({},_0x35e4a4[a39_0x1909('0x24')],{}));delete _0x141be9[a39_0x1909('0x27')];delete _0x141be9[a39_0x1909('0x28')];delete _0x141be9[a39_0x1909('0x29')];delete _0x141be9['password'];delete _0x141be9[a39_0x1909('0x2a')];delete _0x141be9[a39_0x1909('0x2b')];delete _0x141be9[a39_0x1909('0x2c')];delete _0x141be9[a39_0x1909('0x2d')];return responseUtils['successResponse'](_0x35e4a4,_0x3b1e3a,_0x141be9,0xc8);}[a39_0x1909('0x10')](_0x1c954f,_0x26b7c8,_0x4de1dc){}[a39_0x1909('0x2e')](_0x43cfbb,_0xbe33bf,_0x3becc6){const _0x5cf968=formidable({'multiples':!![]});_0x5cf968[a39_0x1909('0x2f')](_0x43cfbb,(_0x4a3780,_0x5539f4,_0x2da73d)=>{console[a39_0x1909('0x30')](a39_0x1909('0x31'),_0x5539f4);console[a39_0x1909('0x30')]('files',_0x2da73d);if(_0x4a3780){return responseUtils[a39_0x1909('0x17')](_0xbe33bf,_0x4a3780[a39_0x1909('0x23')],0x1f4);}_0x43cfbb[a39_0x1909('0x32')]={'code':_0x5539f4['code']};return responseUtils[a39_0x1909('0x1e')](_0x43cfbb,_0xbe33bf,{},0xc8);});}}exports[a39_0x1909('0x19')]=AuthenticationController;
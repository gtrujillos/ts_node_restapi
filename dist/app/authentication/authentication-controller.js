var a11_0x99f7=['createAccount','model','body','username','last_name','password','errorResponse','usernameNotFoundError','toJSON','uuid','sign','secret','token','successResponse','catch','stack','findOne','then','usernameTakenError','email','generateHash','dataValues','updated_at','created_at','default','__esModule','jsonwebtoken','i18n','../../config/jwt.js','../../infrastructure/response-utils','../../resources/locale-strings','login','bind'];(function(_0x30de6c,_0x425e17){var _0x1b017e=function(_0x4e0006){while(--_0x4e0006){_0x30de6c['push'](_0x30de6c['shift']());}};_0x1b017e(++_0x425e17);}(a11_0x99f7,0xdf));var a11_0x53d1=function(_0x530289,_0xabbb70){_0x530289=_0x530289-0x0;var _0x450e8f=a11_0x99f7[_0x530289];return _0x450e8f;};'use strict';Object['defineProperty'](exports,a11_0x53d1('0x0'),{'value':!![]});const jwt=require(a11_0x53d1('0x1'));const i18n=require(a11_0x53d1('0x2'));const configJwt=require(a11_0x53d1('0x3'));const authUtils=require('../../infrastructure/auth-utils');const responseUtils=require(a11_0x53d1('0x4'));const LocaleStrings=require(a11_0x53d1('0x5'));const format=require('string-format');class AuthenticationController{constructor(_0x4a15dd){this['model']=_0x4a15dd;this[a11_0x53d1('0x6')]=this[a11_0x53d1('0x6')][a11_0x53d1('0x7')](this);this[a11_0x53d1('0x8')]=this[a11_0x53d1('0x8')][a11_0x53d1('0x7')](this);}[a11_0x53d1('0x6')](_0x564219,_0x367b72,_0x54d1d5){this[a11_0x53d1('0x9')]['findOne']({'where':{'username':_0x564219[a11_0x53d1('0xa')][a11_0x53d1('0xb')]},'attributes':['uuid','first_name',a11_0x53d1('0xc'),'email','username',a11_0x53d1('0xd')]})['then'](_0x4b43a9=>{if(!_0x4b43a9){return responseUtils[a11_0x53d1('0xe')](_0x367b72,format(LocaleStrings[a11_0x53d1('0xf')],_0x564219[a11_0x53d1('0xa')][a11_0x53d1('0xb')]),0x193);}if(authUtils['validPassword'](_0x564219['body'][a11_0x53d1('0xd')],_0x4b43a9['password'])){_0x4b43a9=_0x4b43a9[a11_0x53d1('0x10')]();const _0x478098={'uuid':_0x4b43a9[a11_0x53d1('0x11')]};const _0x1383a0=jwt[a11_0x53d1('0x12')](_0x478098,configJwt[a11_0x53d1('0x13')],configJwt['options']);delete _0x4b43a9[a11_0x53d1('0xd')];_0x4b43a9[a11_0x53d1('0x14')]=_0x1383a0;return responseUtils[a11_0x53d1('0x15')](_0x367b72,_0x4b43a9,0xc8);}else{return responseUtils[a11_0x53d1('0xe')](_0x367b72,format(LocaleStrings['passwordNotMatchError']),0x193);}})[a11_0x53d1('0x16')](_0x4e1009=>{return responseUtils['errorResponse'](_0x367b72,_0x4e1009[a11_0x53d1('0x17')],0x1f4);});}['createAccount'](_0x4f5da7,_0x3ee073,_0x5c2c9a){this[a11_0x53d1('0x9')][a11_0x53d1('0x18')]({'where':{'username':_0x4f5da7[a11_0x53d1('0xa')]['username']}})[a11_0x53d1('0x19')](_0x366e93=>{if(_0x366e93){return responseUtils[a11_0x53d1('0xe')](_0x3ee073,format(LocaleStrings[a11_0x53d1('0x1a')],_0x4f5da7[a11_0x53d1('0xa')][a11_0x53d1('0xb')]),0x193);}else{_0x4f5da7[a11_0x53d1('0xa')][a11_0x53d1('0x1b')]=_0x4f5da7[a11_0x53d1('0xa')][a11_0x53d1('0xb')];const _0x1b6797={'first_name':_0x4f5da7[a11_0x53d1('0xa')]['first_name'],'last_name':_0x4f5da7['body'][a11_0x53d1('0xc')],'email':_0x4f5da7[a11_0x53d1('0xa')]['email'],'username':_0x4f5da7[a11_0x53d1('0xa')][a11_0x53d1('0xb')],'password':authUtils[a11_0x53d1('0x1c')](_0x4f5da7[a11_0x53d1('0xa')]['password'])};this[a11_0x53d1('0x9')]['create'](_0x1b6797)['then'](function(_0x3c86b0,_0x380477){delete _0x3c86b0[a11_0x53d1('0x1d')]['id'];delete _0x3c86b0['dataValues']['status'];delete _0x3c86b0[a11_0x53d1('0x1d')][a11_0x53d1('0xd')];delete _0x3c86b0['dataValues'][a11_0x53d1('0x1e')];delete _0x3c86b0[a11_0x53d1('0x1d')][a11_0x53d1('0x1f')];const _0x54876e={'uuid':_0x3c86b0[a11_0x53d1('0x11')]};const _0xe45639=jwt[a11_0x53d1('0x12')](_0x54876e,configJwt[a11_0x53d1('0x13')],configJwt['options']);_0x3c86b0[a11_0x53d1('0x1d')]['token']=_0xe45639;return responseUtils['successResponse'](_0x3ee073,_0x3c86b0,0xc8);})['catch'](_0x401877=>{return responseUtils[a11_0x53d1('0xe')](_0x3ee073,_0x401877['stack'],0x1f4);});}})['catch'](_0xc60131=>{return responseUtils[a11_0x53d1('0xe')](_0x3ee073,_0xc60131[a11_0x53d1('0x17')],0x1f4);});}}exports[a11_0x53d1('0x20')]=AuthenticationController;
var a30_0x7ef2=['bind','createAccount','body','first_name','last_name','email','then','default','validPassword','password','sign','secret','options','errorResponse','passwordNotMatchError','findOne','usernameTakenError','username','hashPassword','create','dataValues','successResponse','catch','stack','__esModule','../../infrastructure/crypt-utils','jsonwebtoken','i18n','../../infrastructure/auth-utils','../../infrastructure/response-utils','model','login'];(function(_0x3a2c5e,_0x72cd75){var _0xb1661=function(_0x446111){while(--_0x446111){_0x3a2c5e['push'](_0x3a2c5e['shift']());}};_0xb1661(++_0x72cd75);}(a30_0x7ef2,0x78));var a30_0x32e4=function(_0x4b315c,_0x2d152c){_0x4b315c=_0x4b315c-0x0;var _0x35a9d1=a30_0x7ef2[_0x4b315c];return _0x35a9d1;};'use strict';var __importDefault=this&&this['__importDefault']||function(_0x38d26d){return _0x38d26d&&_0x38d26d[a30_0x32e4('0x0')]?_0x38d26d:{'default':_0x38d26d};};Object['defineProperty'](exports,'__esModule',{'value':!![]});const crypt_utils_1=__importDefault(require(a30_0x32e4('0x1')));const jwt=require(a30_0x32e4('0x2'));const i18n=require(a30_0x32e4('0x3'));const configJwt=require('../../config/jwt.js');const authUtils=require(a30_0x32e4('0x4'));const responseUtils=require(a30_0x32e4('0x5'));const LocaleStrings=require('../../resources/locale-strings');const format=require('string-format');class AuthenticationController{constructor(_0x1ab15e){this[a30_0x32e4('0x6')]=_0x1ab15e;this[a30_0x32e4('0x7')]=this[a30_0x32e4('0x7')][a30_0x32e4('0x8')](this);this[a30_0x32e4('0x9')]=this[a30_0x32e4('0x9')]['bind'](this);}[a30_0x32e4('0x7')](_0x189c79,_0x56aaa2,_0x11a58c){this[a30_0x32e4('0x6')]['findOne']({'where':{'username':_0x189c79[a30_0x32e4('0xa')]['username']},'attributes':['id',a30_0x32e4('0xb'),a30_0x32e4('0xc'),a30_0x32e4('0xd'),'username','password']})[a30_0x32e4('0xe')](_0x1861d2=>{if(!_0x1861d2){return responseUtils['errorResponse'](_0x56aaa2,format(LocaleStrings['usernameNotFoundError'],_0x189c79[a30_0x32e4('0xa')]['username']),0x193);}if(crypt_utils_1[a30_0x32e4('0xf')][a30_0x32e4('0x10')](_0x189c79['body'][a30_0x32e4('0x11')],_0x1861d2[a30_0x32e4('0x11')])){_0x1861d2=_0x1861d2['toJSON']();const _0x5845a0={'id':_0x1861d2['id']};const _0x16b02b=jwt[a30_0x32e4('0x12')](_0x5845a0,configJwt[a30_0x32e4('0x13')],configJwt[a30_0x32e4('0x14')]);const _0x1b77ba={'token':_0x16b02b};return responseUtils['successResponse'](_0x56aaa2,_0x1b77ba,0xc8);}else{return responseUtils[a30_0x32e4('0x15')](_0x56aaa2,format(LocaleStrings[a30_0x32e4('0x16')]),0x193);}})['catch'](_0x1132e2=>{return responseUtils[a30_0x32e4('0x15')](_0x56aaa2,_0x1132e2,0x1f4);});}['createAccount'](_0x2f2364,_0x110f46,_0x3cafc5){this['model'][a30_0x32e4('0x17')]({'where':{'username':_0x2f2364[a30_0x32e4('0xa')]['username']}})[a30_0x32e4('0xe')](_0x548c4e=>{if(_0x548c4e){return responseUtils['errorResponse'](_0x110f46,format(LocaleStrings[a30_0x32e4('0x18')],_0x2f2364[a30_0x32e4('0xa')][a30_0x32e4('0x19')]),0x193);}else{_0x2f2364[a30_0x32e4('0xa')]['email']=_0x2f2364[a30_0x32e4('0xa')][a30_0x32e4('0x19')];const _0x21e229={'first_name':_0x2f2364[a30_0x32e4('0xa')]['first_name'],'last_name':_0x2f2364[a30_0x32e4('0xa')][a30_0x32e4('0xc')],'email':_0x2f2364[a30_0x32e4('0xa')]['email'],'username':_0x2f2364[a30_0x32e4('0xa')][a30_0x32e4('0x19')],'password':crypt_utils_1['default'][a30_0x32e4('0x1a')](_0x2f2364[a30_0x32e4('0xa')][a30_0x32e4('0x11')])};this[a30_0x32e4('0x6')][a30_0x32e4('0x1b')](_0x21e229)['then'](function(_0x4d5e90,_0x14727c){const _0xcb533d={'id':_0x4d5e90[a30_0x32e4('0x1c')]['id']};const _0x4519d9=jwt[a30_0x32e4('0x12')](_0xcb533d,configJwt[a30_0x32e4('0x13')],configJwt[a30_0x32e4('0x14')]);const _0x297cf0={'token':_0x4519d9};return responseUtils[a30_0x32e4('0x1d')](_0x110f46,_0x297cf0,0xc8);})[a30_0x32e4('0x1e')](_0x427bf7=>{return responseUtils['errorResponse'](_0x110f46,_0x427bf7[a30_0x32e4('0x1f')],0x1f4);});}})[a30_0x32e4('0x1e')](_0x3aad83=>{return responseUtils[a30_0x32e4('0x15')](_0x110f46,_0x3aad83[a30_0x32e4('0x1f')],0x1f4);});}}exports[a30_0x32e4('0xf')]=AuthenticationController;
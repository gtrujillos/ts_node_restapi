var a11_0x2107=['default','defineProperty','jsonwebtoken','i18n','../../config/jwt.js','../../infrastructure/auth-utils','../../infrastructure/response-utils','../../resources/locale-strings','string-format','login','bind','createAccount','model','findOne','body','username','uuid','email','password','errorResponse','usernameNotFoundError','validPassword','sign','secret','options','successResponse','catch','stack','then','usernameTakenError','first_name','last_name','dataValues','status','created_at'];(function(_0x9b0852,_0x9332b7){var _0x540e59=function(_0x13d82c){while(--_0x13d82c){_0x9b0852['push'](_0x9b0852['shift']());}};_0x540e59(++_0x9332b7);}(a11_0x2107,0x1eb));var a11_0x51d0=function(_0x57c8c8,_0x441258){_0x57c8c8=_0x57c8c8-0x0;var _0xed0ccd=a11_0x2107[_0x57c8c8];return _0xed0ccd;};'use strict';Object[a11_0x51d0('0x0')](exports,'__esModule',{'value':!![]});const jwt=require(a11_0x51d0('0x1'));const i18n=require(a11_0x51d0('0x2'));const configJwt=require(a11_0x51d0('0x3'));const authUtils=require(a11_0x51d0('0x4'));const responseUtils=require(a11_0x51d0('0x5'));const LocaleStrings=require(a11_0x51d0('0x6'));const format=require(a11_0x51d0('0x7'));class AuthenticationController{constructor(_0x554c2e){this['model']=_0x554c2e;this[a11_0x51d0('0x8')]=this[a11_0x51d0('0x8')][a11_0x51d0('0x9')](this);this[a11_0x51d0('0xa')]=this[a11_0x51d0('0xa')][a11_0x51d0('0x9')](this);}['login'](_0x3643e6,_0x4f51ab,_0x506beb){this[a11_0x51d0('0xb')][a11_0x51d0('0xc')]({'where':{'username':_0x3643e6[a11_0x51d0('0xd')][a11_0x51d0('0xe')]},'attributes':[a11_0x51d0('0xf'),'first_name','last_name',a11_0x51d0('0x10'),a11_0x51d0('0xe'),a11_0x51d0('0x11')]})['then'](_0x7ded74=>{if(!_0x7ded74){return responseUtils[a11_0x51d0('0x12')](_0x4f51ab,format(LocaleStrings[a11_0x51d0('0x13')],_0x3643e6[a11_0x51d0('0xd')]['username']),0x193);}if(authUtils[a11_0x51d0('0x14')](_0x3643e6[a11_0x51d0('0xd')][a11_0x51d0('0x11')],_0x7ded74[a11_0x51d0('0x11')])){_0x7ded74=_0x7ded74['toJSON']();const _0x50eb6b={'uuid':_0x7ded74[a11_0x51d0('0xf')]};const _0xb91bcd=jwt[a11_0x51d0('0x15')](_0x50eb6b,configJwt[a11_0x51d0('0x16')],configJwt[a11_0x51d0('0x17')]);delete _0x7ded74[a11_0x51d0('0x11')];_0x7ded74['token']=_0xb91bcd;return responseUtils[a11_0x51d0('0x18')](_0x4f51ab,_0x7ded74,0xc8);}else{return responseUtils['errorResponse'](_0x4f51ab,format(LocaleStrings['passwordNotMatchError']),0x193);}})[a11_0x51d0('0x19')](_0x1592fd=>{return responseUtils[a11_0x51d0('0x12')](_0x4f51ab,_0x1592fd[a11_0x51d0('0x1a')],0x1f4);});}[a11_0x51d0('0xa')](_0x3b2c7a,_0x849f1f,_0x1aa216){this[a11_0x51d0('0xb')][a11_0x51d0('0xc')]({'where':{'username':_0x3b2c7a['body'][a11_0x51d0('0xe')]}})[a11_0x51d0('0x1b')](_0x33eb74=>{if(_0x33eb74){return responseUtils[a11_0x51d0('0x12')](_0x849f1f,format(LocaleStrings[a11_0x51d0('0x1c')],_0x3b2c7a[a11_0x51d0('0xd')][a11_0x51d0('0xe')]),0x193);}else{_0x3b2c7a['body'][a11_0x51d0('0x10')]=_0x3b2c7a[a11_0x51d0('0xd')][a11_0x51d0('0xe')];const _0x2f17c1={'first_name':_0x3b2c7a[a11_0x51d0('0xd')][a11_0x51d0('0x1d')],'last_name':_0x3b2c7a[a11_0x51d0('0xd')][a11_0x51d0('0x1e')],'email':_0x3b2c7a[a11_0x51d0('0xd')][a11_0x51d0('0x10')],'username':_0x3b2c7a[a11_0x51d0('0xd')][a11_0x51d0('0xe')],'password':authUtils['generateHash'](_0x3b2c7a[a11_0x51d0('0xd')]['password'])};this['model']['create'](_0x2f17c1)[a11_0x51d0('0x1b')](function(_0x5d654c,_0x29739a){delete _0x5d654c[a11_0x51d0('0x1f')]['id'];delete _0x5d654c[a11_0x51d0('0x1f')][a11_0x51d0('0x20')];delete _0x5d654c[a11_0x51d0('0x1f')][a11_0x51d0('0x11')];delete _0x5d654c[a11_0x51d0('0x1f')]['updated_at'];delete _0x5d654c['dataValues'][a11_0x51d0('0x21')];const _0x1d8d21={'uuid':_0x5d654c[a11_0x51d0('0xf')]};const _0xcb4797=jwt[a11_0x51d0('0x15')](_0x1d8d21,configJwt['secret'],configJwt[a11_0x51d0('0x17')]);_0x5d654c[a11_0x51d0('0x1f')]['token']=_0xcb4797;return responseUtils[a11_0x51d0('0x18')](_0x849f1f,_0x5d654c,0xc8);})[a11_0x51d0('0x19')](_0x506f2c=>{return responseUtils[a11_0x51d0('0x12')](_0x849f1f,_0x506f2c[a11_0x51d0('0x1a')],0x1f4);});}})['catch'](_0x219818=>{return responseUtils[a11_0x51d0('0x12')](_0x849f1f,_0x219818[a11_0x51d0('0x1a')],0x1f4);});}}exports[a11_0x51d0('0x22')]=AuthenticationController;
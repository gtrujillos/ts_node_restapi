var a11_0x7643=['secret','options','token','successResponse','catch','stack','usernameTakenError','generateHash','create','then','dataValues','status','created_at','default','defineProperty','__esModule','i18n','../../config/jwt.js','../../infrastructure/auth-utils','../../infrastructure/response-utils','string-format','login','bind','createAccount','model','findOne','body','first_name','email','username','password','errorResponse','usernameNotFoundError','validPassword','toJSON','uuid','sign'];(function(_0x1cf583,_0xd549e7){var _0x3165b5=function(_0x25c6d9){while(--_0x25c6d9){_0x1cf583['push'](_0x1cf583['shift']());}};_0x3165b5(++_0xd549e7);}(a11_0x7643,0x1ef));var a11_0x3223=function(_0x51c6c4,_0x31a289){_0x51c6c4=_0x51c6c4-0x0;var _0x1f8d6c=a11_0x7643[_0x51c6c4];return _0x1f8d6c;};'use strict';Object[a11_0x3223('0x0')](exports,a11_0x3223('0x1'),{'value':!![]});const jwt=require('jsonwebtoken');const i18n=require(a11_0x3223('0x2'));const configJwt=require(a11_0x3223('0x3'));const authUtils=require(a11_0x3223('0x4'));const responseUtils=require(a11_0x3223('0x5'));const LocaleStrings=require('../../resources/locale-strings');const format=require(a11_0x3223('0x6'));class AuthenticationController{constructor(_0x5cb481){this['model']=_0x5cb481;this[a11_0x3223('0x7')]=this[a11_0x3223('0x7')][a11_0x3223('0x8')](this);this[a11_0x3223('0x9')]=this[a11_0x3223('0x9')][a11_0x3223('0x8')](this);}[a11_0x3223('0x7')](_0x6937a7,_0x2395ba,_0x10bd4a){this[a11_0x3223('0xa')][a11_0x3223('0xb')]({'where':{'username':_0x6937a7[a11_0x3223('0xc')]['username']},'attributes':['uuid',a11_0x3223('0xd'),'last_name',a11_0x3223('0xe'),a11_0x3223('0xf'),a11_0x3223('0x10')]})['then'](_0x2c6cba=>{if(!_0x2c6cba){return responseUtils[a11_0x3223('0x11')](_0x2395ba,format(LocaleStrings[a11_0x3223('0x12')],_0x6937a7[a11_0x3223('0xc')][a11_0x3223('0xf')]),0x193);}if(authUtils[a11_0x3223('0x13')](_0x6937a7['body']['password'],_0x2c6cba[a11_0x3223('0x10')])){_0x2c6cba=_0x2c6cba[a11_0x3223('0x14')]();const _0x4ac075={'uuid':_0x2c6cba[a11_0x3223('0x15')]};const _0x9a19e2=jwt[a11_0x3223('0x16')](_0x4ac075,configJwt[a11_0x3223('0x17')],configJwt[a11_0x3223('0x18')]);delete _0x2c6cba[a11_0x3223('0x10')];_0x2c6cba[a11_0x3223('0x19')]=_0x9a19e2;return responseUtils[a11_0x3223('0x1a')](_0x2395ba,_0x2c6cba,0xc8);}else{return responseUtils[a11_0x3223('0x11')](_0x2395ba,format(LocaleStrings['passwordNotMatchError']),0x193);}})[a11_0x3223('0x1b')](_0x5e9126=>{return responseUtils['errorResponse'](_0x2395ba,_0x5e9126[a11_0x3223('0x1c')],0x1f4);});}[a11_0x3223('0x9')](_0x5aa759,_0x2e6da6,_0x160acc){this['model'][a11_0x3223('0xb')]({'where':{'username':_0x5aa759[a11_0x3223('0xc')][a11_0x3223('0xf')]}})['then'](_0x4596d7=>{if(_0x4596d7){return responseUtils[a11_0x3223('0x11')](_0x2e6da6,format(LocaleStrings[a11_0x3223('0x1d')],_0x5aa759[a11_0x3223('0xc')][a11_0x3223('0xf')]),0x193);}else{_0x5aa759[a11_0x3223('0xc')]['email']=_0x5aa759['body'][a11_0x3223('0xf')];const _0x39f9f9={'first_name':_0x5aa759[a11_0x3223('0xc')][a11_0x3223('0xd')],'last_name':_0x5aa759[a11_0x3223('0xc')]['last_name'],'email':_0x5aa759[a11_0x3223('0xc')][a11_0x3223('0xe')],'username':_0x5aa759[a11_0x3223('0xc')][a11_0x3223('0xf')],'password':authUtils[a11_0x3223('0x1e')](_0x5aa759['body'][a11_0x3223('0x10')])};this['model'][a11_0x3223('0x1f')](_0x39f9f9)[a11_0x3223('0x20')](function(_0x46ee1c,_0x2d1dbf){delete _0x46ee1c[a11_0x3223('0x21')]['id'];delete _0x46ee1c[a11_0x3223('0x21')][a11_0x3223('0x22')];delete _0x46ee1c[a11_0x3223('0x21')]['password'];delete _0x46ee1c['dataValues']['updated_at'];delete _0x46ee1c[a11_0x3223('0x21')][a11_0x3223('0x23')];const _0xbb66f4={'uuid':_0x46ee1c[a11_0x3223('0x15')]};const _0x41b08e=jwt['sign'](_0xbb66f4,configJwt[a11_0x3223('0x17')],configJwt['options']);_0x46ee1c['dataValues'][a11_0x3223('0x19')]=_0x41b08e;return responseUtils[a11_0x3223('0x1a')](_0x2e6da6,_0x46ee1c,0xc8);})[a11_0x3223('0x1b')](_0x13ca9c=>{return responseUtils[a11_0x3223('0x11')](_0x2e6da6,_0x13ca9c[a11_0x3223('0x1c')],0x1f4);});}})[a11_0x3223('0x1b')](_0x17095d=>{return responseUtils['errorResponse'](_0x2e6da6,_0x17095d[a11_0x3223('0x1c')],0x1f4);});}}exports[a11_0x3223('0x24')]=AuthenticationController;
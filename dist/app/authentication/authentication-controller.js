var a11_0x410b=['jsonwebtoken','../../infrastructure/auth-utils','../../infrastructure/response-utils','../../resources/locale-strings','string-format','model','login','bind','createAccount','findOne','body','username','uuid','first_name','last_name','email','errorResponse','usernameNotFoundError','password','toJSON','secret','options','token','successResponse','passwordNotMatchError','stack','then','usernameTakenError','generateHash','dataValues','updated_at','created_at','sign','catch','defineProperty','__esModule'];(function(_0x4ca3f0,_0x228b14){var _0x3a73e1=function(_0x70b5b6){while(--_0x70b5b6){_0x4ca3f0['push'](_0x4ca3f0['shift']());}};_0x3a73e1(++_0x228b14);}(a11_0x410b,0x18a));var a11_0x5cf2=function(_0x1f9cb3,_0x569efa){_0x1f9cb3=_0x1f9cb3-0x0;var _0x52a5a1=a11_0x410b[_0x1f9cb3];return _0x52a5a1;};'use strict';Object[a11_0x5cf2('0x0')](exports,a11_0x5cf2('0x1'),{'value':!![]});const jwt=require(a11_0x5cf2('0x2'));const i18n=require('i18n');const configJwt=require('../../config/jwt.js');const authUtils=require(a11_0x5cf2('0x3'));const responseUtils=require(a11_0x5cf2('0x4'));const LocaleStrings=require(a11_0x5cf2('0x5'));const format=require(a11_0x5cf2('0x6'));class AuthenticationController{constructor(_0x307e68){this[a11_0x5cf2('0x7')]=_0x307e68;this[a11_0x5cf2('0x8')]=this[a11_0x5cf2('0x8')][a11_0x5cf2('0x9')](this);this[a11_0x5cf2('0xa')]=this[a11_0x5cf2('0xa')]['bind'](this);}[a11_0x5cf2('0x8')](_0x546350,_0x3b3f4a,_0x5a5abf){this[a11_0x5cf2('0x7')][a11_0x5cf2('0xb')]({'where':{'username':_0x546350[a11_0x5cf2('0xc')][a11_0x5cf2('0xd')]},'attributes':[a11_0x5cf2('0xe'),a11_0x5cf2('0xf'),a11_0x5cf2('0x10'),a11_0x5cf2('0x11'),a11_0x5cf2('0xd'),'password']})['then'](_0xa24dc0=>{if(!_0xa24dc0){return responseUtils[a11_0x5cf2('0x12')](_0x3b3f4a,format(LocaleStrings[a11_0x5cf2('0x13')],_0x546350[a11_0x5cf2('0xc')][a11_0x5cf2('0xd')]),0x193);}if(authUtils['validPassword'](_0x546350[a11_0x5cf2('0xc')]['password'],_0xa24dc0[a11_0x5cf2('0x14')])){_0xa24dc0=_0xa24dc0[a11_0x5cf2('0x15')]();const _0x5f0261={'uuid':_0xa24dc0['uuid']};const _0x77c37e=jwt['sign'](_0x5f0261,configJwt[a11_0x5cf2('0x16')],configJwt[a11_0x5cf2('0x17')]);delete _0xa24dc0[a11_0x5cf2('0x14')];_0xa24dc0[a11_0x5cf2('0x18')]=_0x77c37e;return responseUtils[a11_0x5cf2('0x19')](_0x3b3f4a,_0xa24dc0,0xc8);}else{return responseUtils[a11_0x5cf2('0x12')](_0x3b3f4a,format(LocaleStrings[a11_0x5cf2('0x1a')]),0x193);}})['catch'](_0x2c337e=>{return responseUtils['errorResponse'](_0x3b3f4a,_0x2c337e[a11_0x5cf2('0x1b')],0x1f4);});}[a11_0x5cf2('0xa')](_0x494d0a,_0x4d5dcd,_0x2f48c6){this[a11_0x5cf2('0x7')][a11_0x5cf2('0xb')]({'where':{'username':_0x494d0a[a11_0x5cf2('0xc')][a11_0x5cf2('0xd')]}})[a11_0x5cf2('0x1c')](_0x49af35=>{if(_0x49af35){return responseUtils[a11_0x5cf2('0x12')](_0x4d5dcd,format(LocaleStrings[a11_0x5cf2('0x1d')],_0x494d0a[a11_0x5cf2('0xc')][a11_0x5cf2('0xd')]),0x193);}else{_0x494d0a[a11_0x5cf2('0xc')][a11_0x5cf2('0x11')]=_0x494d0a[a11_0x5cf2('0xc')]['username'];const _0x3174aa={'first_name':_0x494d0a[a11_0x5cf2('0xc')]['first_name'],'last_name':_0x494d0a[a11_0x5cf2('0xc')][a11_0x5cf2('0x10')],'email':_0x494d0a[a11_0x5cf2('0xc')][a11_0x5cf2('0x11')],'username':_0x494d0a[a11_0x5cf2('0xc')][a11_0x5cf2('0xd')],'password':authUtils[a11_0x5cf2('0x1e')](_0x494d0a[a11_0x5cf2('0xc')][a11_0x5cf2('0x14')])};this[a11_0x5cf2('0x7')]['create'](_0x3174aa)['then'](function(_0x5149f5,_0x11b399){delete _0x5149f5['dataValues']['id'];delete _0x5149f5[a11_0x5cf2('0x1f')]['status'];delete _0x5149f5[a11_0x5cf2('0x1f')][a11_0x5cf2('0x14')];delete _0x5149f5[a11_0x5cf2('0x1f')][a11_0x5cf2('0x20')];delete _0x5149f5[a11_0x5cf2('0x1f')][a11_0x5cf2('0x21')];const _0xaf0b4e={'uuid':_0x5149f5['uuid']};const _0x411bc4=jwt[a11_0x5cf2('0x22')](_0xaf0b4e,configJwt[a11_0x5cf2('0x16')],configJwt[a11_0x5cf2('0x17')]);_0x5149f5[a11_0x5cf2('0x1f')][a11_0x5cf2('0x18')]=_0x411bc4;return responseUtils[a11_0x5cf2('0x19')](_0x4d5dcd,_0x5149f5,0xc8);})[a11_0x5cf2('0x23')](_0x315d82=>{return responseUtils[a11_0x5cf2('0x12')](_0x4d5dcd,_0x315d82['stack'],0x1f4);});}})[a11_0x5cf2('0x23')](_0x170d8c=>{return responseUtils[a11_0x5cf2('0x12')](_0x4d5dcd,_0x170d8c[a11_0x5cf2('0x1b')],0x1f4);});}}exports['default']=AuthenticationController;
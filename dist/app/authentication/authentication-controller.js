var a11_0x153a=['toJSON','uuid','secret','options','token','successResponse','passwordNotMatchError','catch','usernameTakenError','email','dataValues','status','updated_at','created_at','stack','default','defineProperty','__esModule','jsonwebtoken','i18n','../../config/jwt.js','../../infrastructure/response-utils','../../resources/locale-strings','string-format','model','login','bind','createAccount','findOne','username','first_name','then','errorResponse','usernameNotFoundError','validPassword','body','password'];(function(_0x3d8974,_0x26bea3){var _0x5af6fa=function(_0x48b3d3){while(--_0x48b3d3){_0x3d8974['push'](_0x3d8974['shift']());}};_0x5af6fa(++_0x26bea3);}(a11_0x153a,0xa4));var a11_0x2211=function(_0x528075,_0x543a15){_0x528075=_0x528075-0x0;var _0x259441=a11_0x153a[_0x528075];return _0x259441;};'use strict';Object[a11_0x2211('0x0')](exports,a11_0x2211('0x1'),{'value':!![]});const jwt=require(a11_0x2211('0x2'));const i18n=require(a11_0x2211('0x3'));const configJwt=require(a11_0x2211('0x4'));const authUtils=require('../../infrastructure/auth-utils');const responseUtils=require(a11_0x2211('0x5'));const LocaleStrings=require(a11_0x2211('0x6'));const format=require(a11_0x2211('0x7'));class AuthenticationController{constructor(_0x3bf021){this[a11_0x2211('0x8')]=_0x3bf021;this[a11_0x2211('0x9')]=this[a11_0x2211('0x9')][a11_0x2211('0xa')](this);this['createAccount']=this[a11_0x2211('0xb')][a11_0x2211('0xa')](this);}['login'](_0x40efb5,_0x8b00d4,_0x2a3023){this[a11_0x2211('0x8')][a11_0x2211('0xc')]({'where':{'username':_0x40efb5['body'][a11_0x2211('0xd')]},'attributes':['uuid',a11_0x2211('0xe'),'last_name','email','username','password']})[a11_0x2211('0xf')](_0x57048d=>{if(!_0x57048d){return responseUtils[a11_0x2211('0x10')](_0x8b00d4,format(LocaleStrings[a11_0x2211('0x11')],_0x40efb5['body'][a11_0x2211('0xd')]),0x193);}if(authUtils[a11_0x2211('0x12')](_0x40efb5[a11_0x2211('0x13')][a11_0x2211('0x14')],_0x57048d[a11_0x2211('0x14')])){_0x57048d=_0x57048d[a11_0x2211('0x15')]();const _0x1a428a={'uuid':_0x57048d[a11_0x2211('0x16')]};const _0x1381d8=jwt['sign'](_0x1a428a,configJwt[a11_0x2211('0x17')],configJwt[a11_0x2211('0x18')]);delete _0x57048d[a11_0x2211('0x14')];_0x57048d[a11_0x2211('0x19')]=_0x1381d8;return responseUtils[a11_0x2211('0x1a')](_0x8b00d4,_0x57048d,0xc8);}else{return responseUtils[a11_0x2211('0x10')](_0x8b00d4,format(LocaleStrings[a11_0x2211('0x1b')]),0x193);}})[a11_0x2211('0x1c')](_0x1619e1=>{return responseUtils[a11_0x2211('0x10')](_0x8b00d4,_0x1619e1['stack'],0x1f4);});}[a11_0x2211('0xb')](_0x30d68a,_0x3cfb77,_0x1879c5){this[a11_0x2211('0x8')][a11_0x2211('0xc')]({'where':{'username':_0x30d68a['body']['username']}})['then'](_0x36fcdd=>{if(_0x36fcdd){return responseUtils[a11_0x2211('0x10')](_0x3cfb77,format(LocaleStrings[a11_0x2211('0x1d')],_0x30d68a['body'][a11_0x2211('0xd')]),0x193);}else{_0x30d68a['body'][a11_0x2211('0x1e')]=_0x30d68a['body'][a11_0x2211('0xd')];const _0x2c2f26={'first_name':_0x30d68a[a11_0x2211('0x13')][a11_0x2211('0xe')],'last_name':_0x30d68a['body']['last_name'],'email':_0x30d68a[a11_0x2211('0x13')][a11_0x2211('0x1e')],'username':_0x30d68a[a11_0x2211('0x13')][a11_0x2211('0xd')],'password':authUtils['generateHash'](_0x30d68a['body'][a11_0x2211('0x14')])};this[a11_0x2211('0x8')]['create'](_0x2c2f26)[a11_0x2211('0xf')](function(_0x4b940d,_0x20654e){delete _0x4b940d['dataValues']['id'];delete _0x4b940d[a11_0x2211('0x1f')][a11_0x2211('0x20')];delete _0x4b940d[a11_0x2211('0x1f')][a11_0x2211('0x14')];delete _0x4b940d[a11_0x2211('0x1f')][a11_0x2211('0x21')];delete _0x4b940d[a11_0x2211('0x1f')][a11_0x2211('0x22')];const _0x30773f={'uuid':_0x4b940d['uuid']};const _0x3fed96=jwt['sign'](_0x30773f,configJwt['secret'],configJwt[a11_0x2211('0x18')]);_0x4b940d[a11_0x2211('0x1f')][a11_0x2211('0x19')]=_0x3fed96;return responseUtils['successResponse'](_0x3cfb77,_0x4b940d,0xc8);})['catch'](_0x5cf086=>{return responseUtils[a11_0x2211('0x10')](_0x3cfb77,_0x5cf086[a11_0x2211('0x23')],0x1f4);});}})[a11_0x2211('0x1c')](_0x57906f=>{return responseUtils[a11_0x2211('0x10')](_0x3cfb77,_0x57906f[a11_0x2211('0x23')],0x1f4);});}}exports[a11_0x2211('0x24')]=AuthenticationController;
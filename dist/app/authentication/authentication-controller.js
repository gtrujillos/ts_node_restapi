var a11_0x4c11=['../../resources/locale-strings','string-format','login','bind','createAccount','model','findOne','username','first_name','last_name','email','password','then','usernameNotFoundError','body','validPassword','toJSON','uuid','successResponse','errorResponse','passwordNotMatchError','catch','stack','usernameTakenError','generateHash','dataValues','status','updated_at','created_at','sign','secret','options','token','default','defineProperty','__esModule','jsonwebtoken','i18n','../../config/jwt.js','../../infrastructure/auth-utils'];(function(_0x26bd06,_0x4544a6){var _0x4ad83b=function(_0x3115c1){while(--_0x3115c1){_0x26bd06['push'](_0x26bd06['shift']());}};_0x4ad83b(++_0x4544a6);}(a11_0x4c11,0xc2));var a11_0x4d71=function(_0x4d14af,_0x5eddd9){_0x4d14af=_0x4d14af-0x0;var _0x10b6a7=a11_0x4c11[_0x4d14af];return _0x10b6a7;};'use strict';Object[a11_0x4d71('0x0')](exports,a11_0x4d71('0x1'),{'value':!![]});const jwt=require(a11_0x4d71('0x2'));const i18n=require(a11_0x4d71('0x3'));const configJwt=require(a11_0x4d71('0x4'));const authUtils=require(a11_0x4d71('0x5'));const responseUtils=require('../../infrastructure/response-utils');const LocaleStrings=require(a11_0x4d71('0x6'));const format=require(a11_0x4d71('0x7'));class AuthenticationController{constructor(_0x4269cb){this['model']=_0x4269cb;this[a11_0x4d71('0x8')]=this[a11_0x4d71('0x8')][a11_0x4d71('0x9')](this);this[a11_0x4d71('0xa')]=this[a11_0x4d71('0xa')]['bind'](this);}['login'](_0x41609f,_0x184041,_0x2fc983){this[a11_0x4d71('0xb')][a11_0x4d71('0xc')]({'where':{'username':_0x41609f['body'][a11_0x4d71('0xd')]},'attributes':['uuid',a11_0x4d71('0xe'),a11_0x4d71('0xf'),a11_0x4d71('0x10'),a11_0x4d71('0xd'),a11_0x4d71('0x11')]})[a11_0x4d71('0x12')](_0x6170a3=>{if(!_0x6170a3){return responseUtils['errorResponse'](_0x184041,format(LocaleStrings[a11_0x4d71('0x13')],_0x41609f[a11_0x4d71('0x14')][a11_0x4d71('0xd')]),0x193);}if(authUtils[a11_0x4d71('0x15')](_0x41609f[a11_0x4d71('0x14')][a11_0x4d71('0x11')],_0x6170a3[a11_0x4d71('0x11')])){_0x6170a3=_0x6170a3[a11_0x4d71('0x16')]();const _0x443e8f={'uuid':_0x6170a3[a11_0x4d71('0x17')]};const _0x2ec01e=jwt['sign'](_0x443e8f,configJwt['secret'],configJwt['options']);delete _0x6170a3[a11_0x4d71('0x11')];_0x6170a3['token']=_0x2ec01e;return responseUtils[a11_0x4d71('0x18')](_0x184041,_0x6170a3,0xc8);}else{return responseUtils[a11_0x4d71('0x19')](_0x184041,format(LocaleStrings[a11_0x4d71('0x1a')]),0x193);}})[a11_0x4d71('0x1b')](_0x437b0c=>{return responseUtils[a11_0x4d71('0x19')](_0x184041,_0x437b0c[a11_0x4d71('0x1c')],0x1f4);});}['createAccount'](_0x5b24e7,_0x22d3e3,_0x495289){this[a11_0x4d71('0xb')][a11_0x4d71('0xc')]({'where':{'username':_0x5b24e7[a11_0x4d71('0x14')][a11_0x4d71('0xd')]}})[a11_0x4d71('0x12')](_0x3ca856=>{if(_0x3ca856){return responseUtils['errorResponse'](_0x22d3e3,format(LocaleStrings[a11_0x4d71('0x1d')],_0x5b24e7['body'][a11_0x4d71('0xd')]),0x193);}else{_0x5b24e7[a11_0x4d71('0x14')][a11_0x4d71('0x10')]=_0x5b24e7[a11_0x4d71('0x14')]['username'];const _0x1ea65d={'first_name':_0x5b24e7[a11_0x4d71('0x14')][a11_0x4d71('0xe')],'last_name':_0x5b24e7[a11_0x4d71('0x14')][a11_0x4d71('0xf')],'email':_0x5b24e7[a11_0x4d71('0x14')][a11_0x4d71('0x10')],'username':_0x5b24e7[a11_0x4d71('0x14')][a11_0x4d71('0xd')],'password':authUtils[a11_0x4d71('0x1e')](_0x5b24e7[a11_0x4d71('0x14')][a11_0x4d71('0x11')])};this[a11_0x4d71('0xb')]['create'](_0x1ea65d)['then'](function(_0x53406b,_0x5b172c){delete _0x53406b['dataValues']['id'];delete _0x53406b[a11_0x4d71('0x1f')][a11_0x4d71('0x20')];delete _0x53406b['dataValues']['password'];delete _0x53406b[a11_0x4d71('0x1f')][a11_0x4d71('0x21')];delete _0x53406b[a11_0x4d71('0x1f')][a11_0x4d71('0x22')];const _0x5ce464={'uuid':_0x53406b[a11_0x4d71('0x17')]};const _0x1fc931=jwt[a11_0x4d71('0x23')](_0x5ce464,configJwt[a11_0x4d71('0x24')],configJwt[a11_0x4d71('0x25')]);_0x53406b[a11_0x4d71('0x1f')][a11_0x4d71('0x26')]=_0x1fc931;return responseUtils[a11_0x4d71('0x18')](_0x22d3e3,_0x53406b,0xc8);})['catch'](_0x468968=>{return responseUtils['errorResponse'](_0x22d3e3,_0x468968[a11_0x4d71('0x1c')],0x1f4);});}})[a11_0x4d71('0x1b')](_0x3a216c=>{return responseUtils[a11_0x4d71('0x19')](_0x22d3e3,_0x3a216c['stack'],0x1f4);});}}exports[a11_0x4d71('0x27')]=AuthenticationController;
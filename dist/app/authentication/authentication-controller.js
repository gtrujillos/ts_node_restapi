var a30_0x1205=['bind','createAccount','findOne','body','username','last_name','email','then','usernameNotFoundError','validPassword','password','sign','secret','options','successResponse','errorResponse','passwordNotMatchError','catch','usernameTakenError','first_name','default','hashPassword','dataValues','stack','__importDefault','__esModule','defineProperty','../../infrastructure/crypt-utils','jsonwebtoken','i18n','../../config/jwt.js','../../infrastructure/auth-utils','../../infrastructure/response-utils','string-format','model','login'];(function(_0x4b3efe,_0x2c27cb){var _0x19c5f2=function(_0x53a902){while(--_0x53a902){_0x4b3efe['push'](_0x4b3efe['shift']());}};_0x19c5f2(++_0x2c27cb);}(a30_0x1205,0x180));var a30_0x418d=function(_0x2d918d,_0xdeb82a){_0x2d918d=_0x2d918d-0x0;var _0xa5dc8b=a30_0x1205[_0x2d918d];return _0xa5dc8b;};'use strict';var __importDefault=this&&this[a30_0x418d('0x0')]||function(_0x43f1ce){return _0x43f1ce&&_0x43f1ce[a30_0x418d('0x1')]?_0x43f1ce:{'default':_0x43f1ce};};Object[a30_0x418d('0x2')](exports,a30_0x418d('0x1'),{'value':!![]});const crypt_utils_1=__importDefault(require(a30_0x418d('0x3')));const jwt=require(a30_0x418d('0x4'));const i18n=require(a30_0x418d('0x5'));const configJwt=require(a30_0x418d('0x6'));const authUtils=require(a30_0x418d('0x7'));const responseUtils=require(a30_0x418d('0x8'));const LocaleStrings=require('../../resources/locale-strings');const format=require(a30_0x418d('0x9'));class AuthenticationController{constructor(_0xe20061){this[a30_0x418d('0xa')]=_0xe20061;this['login']=this[a30_0x418d('0xb')][a30_0x418d('0xc')](this);this['createAccount']=this[a30_0x418d('0xd')][a30_0x418d('0xc')](this);}[a30_0x418d('0xb')](_0x5ea0fd,_0x5c8b19,_0x4ca991){this[a30_0x418d('0xa')][a30_0x418d('0xe')]({'where':{'username':_0x5ea0fd[a30_0x418d('0xf')][a30_0x418d('0x10')]},'attributes':['id','first_name',a30_0x418d('0x11'),a30_0x418d('0x12'),a30_0x418d('0x10'),'password']})[a30_0x418d('0x13')](_0x594d0a=>{if(!_0x594d0a){return responseUtils['errorResponse'](_0x5c8b19,format(LocaleStrings[a30_0x418d('0x14')],_0x5ea0fd[a30_0x418d('0xf')][a30_0x418d('0x10')]),0x193);}if(crypt_utils_1['default'][a30_0x418d('0x15')](_0x5ea0fd[a30_0x418d('0xf')][a30_0x418d('0x16')],_0x594d0a[a30_0x418d('0x16')])){_0x594d0a=_0x594d0a['toJSON']();const _0x24177c={'id':_0x594d0a['id']};const _0x1ac8a6=jwt[a30_0x418d('0x17')](_0x24177c,configJwt[a30_0x418d('0x18')],configJwt[a30_0x418d('0x19')]);const _0x28f1a6={'token':_0x1ac8a6};return responseUtils[a30_0x418d('0x1a')](_0x5c8b19,_0x28f1a6,0xc8);}else{return responseUtils[a30_0x418d('0x1b')](_0x5c8b19,format(LocaleStrings[a30_0x418d('0x1c')]),0x193);}})[a30_0x418d('0x1d')](_0x518f6b=>{return responseUtils[a30_0x418d('0x1b')](_0x5c8b19,_0x518f6b,0x1f4);});}['createAccount'](_0x4cc239,_0x2e53ec,_0x56609c){this[a30_0x418d('0xa')]['findOne']({'where':{'username':_0x4cc239[a30_0x418d('0xf')][a30_0x418d('0x10')]}})['then'](_0xfcaad6=>{if(_0xfcaad6){return responseUtils['errorResponse'](_0x2e53ec,format(LocaleStrings[a30_0x418d('0x1e')],_0x4cc239[a30_0x418d('0xf')][a30_0x418d('0x10')]),0x193);}else{_0x4cc239[a30_0x418d('0xf')][a30_0x418d('0x12')]=_0x4cc239[a30_0x418d('0xf')][a30_0x418d('0x10')];const _0x12dfa1={'first_name':_0x4cc239['body'][a30_0x418d('0x1f')],'last_name':_0x4cc239[a30_0x418d('0xf')][a30_0x418d('0x11')],'email':_0x4cc239[a30_0x418d('0xf')]['email'],'username':_0x4cc239[a30_0x418d('0xf')][a30_0x418d('0x10')],'password':crypt_utils_1[a30_0x418d('0x20')][a30_0x418d('0x21')](_0x4cc239[a30_0x418d('0xf')][a30_0x418d('0x16')])};this[a30_0x418d('0xa')]['create'](_0x12dfa1)[a30_0x418d('0x13')](function(_0x182589,_0x3bedaf){const _0x80ed68={'id':_0x182589[a30_0x418d('0x22')]['id']};const _0x5ed246=jwt[a30_0x418d('0x17')](_0x80ed68,configJwt[a30_0x418d('0x18')],configJwt[a30_0x418d('0x19')]);const _0x1594a4={'token':_0x5ed246};return responseUtils[a30_0x418d('0x1a')](_0x2e53ec,_0x1594a4,0xc8);})[a30_0x418d('0x1d')](_0x3ec103=>{return responseUtils['errorResponse'](_0x2e53ec,_0x3ec103[a30_0x418d('0x23')],0x1f4);});}})[a30_0x418d('0x1d')](_0x41101f=>{return responseUtils[a30_0x418d('0x1b')](_0x2e53ec,_0x41101f['stack'],0x1f4);});}}exports['default']=AuthenticationController;
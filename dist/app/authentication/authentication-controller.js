var a11_0x541d=['sign','secret','options','token','errorResponse','catch','then','generateHash','create','dataValues','updated_at','created_at','successResponse','stack','default','defineProperty','__esModule','jsonwebtoken','i18n','../../config/jwt.js','../../infrastructure/auth-utils','../../infrastructure/response-utils','../../resources/locale-strings','model','login','bind','createAccount','findOne','body','username','first_name','last_name','password','validPassword','toJSON','uuid'];(function(_0x82e721,_0x3d2b9b){var _0xe98eef=function(_0x29ae4a){while(--_0x29ae4a){_0x82e721['push'](_0x82e721['shift']());}};_0xe98eef(++_0x3d2b9b);}(a11_0x541d,0xe7));var a11_0x24aa=function(_0xe63a8a,_0x562d93){_0xe63a8a=_0xe63a8a-0x0;var _0x2dafcb=a11_0x541d[_0xe63a8a];return _0x2dafcb;};'use strict';Object[a11_0x24aa('0x0')](exports,a11_0x24aa('0x1'),{'value':!![]});const jwt=require(a11_0x24aa('0x2'));const i18n=require(a11_0x24aa('0x3'));const configJwt=require(a11_0x24aa('0x4'));const authUtils=require(a11_0x24aa('0x5'));const responseUtils=require(a11_0x24aa('0x6'));const LocaleStrings=require(a11_0x24aa('0x7'));const format=require('string-format');class AuthenticationController{constructor(_0x5ec586){this[a11_0x24aa('0x8')]=_0x5ec586;this[a11_0x24aa('0x9')]=this[a11_0x24aa('0x9')][a11_0x24aa('0xa')](this);this[a11_0x24aa('0xb')]=this[a11_0x24aa('0xb')][a11_0x24aa('0xa')](this);}[a11_0x24aa('0x9')](_0x333eef,_0x29a547,_0x203ac7){this[a11_0x24aa('0x8')][a11_0x24aa('0xc')]({'where':{'username':_0x333eef[a11_0x24aa('0xd')][a11_0x24aa('0xe')]},'attributes':['uuid',a11_0x24aa('0xf'),a11_0x24aa('0x10'),'email','username',a11_0x24aa('0x11')]})['then'](_0x58b2b6=>{if(!_0x58b2b6){return responseUtils['errorResponse'](_0x29a547,format(LocaleStrings['usernameNotFoundError'],_0x333eef[a11_0x24aa('0xd')][a11_0x24aa('0xe')]),0x193);}if(authUtils[a11_0x24aa('0x12')](_0x333eef[a11_0x24aa('0xd')][a11_0x24aa('0x11')],_0x58b2b6[a11_0x24aa('0x11')])){_0x58b2b6=_0x58b2b6[a11_0x24aa('0x13')]();const _0x43cdbc={'uuid':_0x58b2b6[a11_0x24aa('0x14')]};const _0x3876cf=jwt[a11_0x24aa('0x15')](_0x43cdbc,configJwt[a11_0x24aa('0x16')],configJwt[a11_0x24aa('0x17')]);delete _0x58b2b6['password'];_0x58b2b6[a11_0x24aa('0x18')]=_0x3876cf;return responseUtils['successResponse'](_0x29a547,_0x58b2b6,0xc8);}else{return responseUtils[a11_0x24aa('0x19')](_0x29a547,format(LocaleStrings['passwordNotMatchError']),0x193);}})[a11_0x24aa('0x1a')](_0x4e11b2=>{return responseUtils[a11_0x24aa('0x19')](_0x29a547,_0x4e11b2['stack'],0x1f4);});}[a11_0x24aa('0xb')](_0x4c1e18,_0x276036,_0x538877){this[a11_0x24aa('0x8')][a11_0x24aa('0xc')]({'where':{'username':_0x4c1e18[a11_0x24aa('0xd')]['username']}})[a11_0x24aa('0x1b')](_0x12f6a9=>{if(_0x12f6a9){return responseUtils[a11_0x24aa('0x19')](_0x276036,format(LocaleStrings['usernameTakenError'],_0x4c1e18[a11_0x24aa('0xd')][a11_0x24aa('0xe')]),0x193);}else{_0x4c1e18[a11_0x24aa('0xd')]['email']=_0x4c1e18['body'][a11_0x24aa('0xe')];const _0x1ed532={'first_name':_0x4c1e18[a11_0x24aa('0xd')][a11_0x24aa('0xf')],'last_name':_0x4c1e18[a11_0x24aa('0xd')][a11_0x24aa('0x10')],'email':_0x4c1e18[a11_0x24aa('0xd')]['email'],'username':_0x4c1e18[a11_0x24aa('0xd')]['username'],'password':authUtils[a11_0x24aa('0x1c')](_0x4c1e18[a11_0x24aa('0xd')][a11_0x24aa('0x11')])};this['model'][a11_0x24aa('0x1d')](_0x1ed532)[a11_0x24aa('0x1b')](function(_0x24d182,_0x586fa4){delete _0x24d182[a11_0x24aa('0x1e')]['id'];delete _0x24d182[a11_0x24aa('0x1e')]['status'];delete _0x24d182[a11_0x24aa('0x1e')][a11_0x24aa('0x11')];delete _0x24d182[a11_0x24aa('0x1e')][a11_0x24aa('0x1f')];delete _0x24d182['dataValues'][a11_0x24aa('0x20')];const _0x369df4={'uuid':_0x24d182['uuid']};const _0x50d974=jwt[a11_0x24aa('0x15')](_0x369df4,configJwt['secret'],configJwt['options']);_0x24d182[a11_0x24aa('0x1e')][a11_0x24aa('0x18')]=_0x50d974;return responseUtils[a11_0x24aa('0x21')](_0x276036,_0x24d182,0xc8);})[a11_0x24aa('0x1a')](_0x2139a5=>{return responseUtils['errorResponse'](_0x276036,_0x2139a5[a11_0x24aa('0x22')],0x1f4);});}})['catch'](_0x369cb7=>{return responseUtils[a11_0x24aa('0x19')](_0x276036,_0x369cb7['stack'],0x1f4);});}}exports[a11_0x24aa('0x23')]=AuthenticationController;
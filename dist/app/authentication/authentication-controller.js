var a30_0x183e=['hashPassword','dataValues','stack','catch','__importDefault','__esModule','defineProperty','../../infrastructure/crypt-utils','i18n','../../config/jwt.js','../../infrastructure/auth-utils','../../infrastructure/response-utils','../../resources/locale-strings','string-format','model','bind','login','findOne','body','first_name','last_name','email','username','then','errorResponse','usernameNotFoundError','validPassword','password','sign','options','successResponse','passwordNotMatchError','createAccount','default'];(function(_0x497447,_0x5899fa){var _0x50627e=function(_0x296e0f){while(--_0x296e0f){_0x497447['push'](_0x497447['shift']());}};_0x50627e(++_0x5899fa);}(a30_0x183e,0x114));var a30_0x16ce=function(_0x528e04,_0x2a02ac){_0x528e04=_0x528e04-0x0;var _0x1b3cbf=a30_0x183e[_0x528e04];return _0x1b3cbf;};'use strict';var __importDefault=this&&this[a30_0x16ce('0x0')]||function(_0x435d24){return _0x435d24&&_0x435d24[a30_0x16ce('0x1')]?_0x435d24:{'default':_0x435d24};};Object[a30_0x16ce('0x2')](exports,a30_0x16ce('0x1'),{'value':!![]});const crypt_utils_1=__importDefault(require(a30_0x16ce('0x3')));const jwt=require('jsonwebtoken');const i18n=require(a30_0x16ce('0x4'));const configJwt=require(a30_0x16ce('0x5'));const authUtils=require(a30_0x16ce('0x6'));const responseUtils=require(a30_0x16ce('0x7'));const LocaleStrings=require(a30_0x16ce('0x8'));const format=require(a30_0x16ce('0x9'));class AuthenticationController{constructor(_0x3e04e7){this[a30_0x16ce('0xa')]=_0x3e04e7;this['login']=this['login'][a30_0x16ce('0xb')](this);this['createAccount']=this['createAccount'][a30_0x16ce('0xb')](this);}[a30_0x16ce('0xc')](_0x10c587,_0x33bcb7,_0x314817){this[a30_0x16ce('0xa')][a30_0x16ce('0xd')]({'where':{'username':_0x10c587[a30_0x16ce('0xe')]['username']},'attributes':['id',a30_0x16ce('0xf'),a30_0x16ce('0x10'),a30_0x16ce('0x11'),a30_0x16ce('0x12'),'password']})[a30_0x16ce('0x13')](_0x203d7d=>{if(!_0x203d7d){return responseUtils[a30_0x16ce('0x14')](_0x33bcb7,format(LocaleStrings[a30_0x16ce('0x15')],_0x10c587[a30_0x16ce('0xe')]['username']),0x193);}if(crypt_utils_1['default'][a30_0x16ce('0x16')](_0x10c587['body'][a30_0x16ce('0x17')],_0x203d7d[a30_0x16ce('0x17')])){_0x203d7d=_0x203d7d['toJSON']();const _0x2c4d33={'id':_0x203d7d['id']};const _0x48d0ec=jwt[a30_0x16ce('0x18')](_0x2c4d33,configJwt['secret'],configJwt[a30_0x16ce('0x19')]);const _0x18cd15={'token':_0x48d0ec};return responseUtils[a30_0x16ce('0x1a')](_0x33bcb7,_0x18cd15,0xc8);}else{return responseUtils[a30_0x16ce('0x14')](_0x33bcb7,format(LocaleStrings[a30_0x16ce('0x1b')]),0x193);}})['catch'](_0x4c0478=>{return responseUtils[a30_0x16ce('0x14')](_0x33bcb7,_0x4c0478,0x1f4);});}[a30_0x16ce('0x1c')](_0x433ea9,_0x446fe9,_0x3ca063){this[a30_0x16ce('0xa')][a30_0x16ce('0xd')]({'where':{'username':_0x433ea9['body'][a30_0x16ce('0x12')]}})[a30_0x16ce('0x13')](_0x35c665=>{if(_0x35c665){return responseUtils[a30_0x16ce('0x14')](_0x446fe9,format(LocaleStrings['usernameTakenError'],_0x433ea9[a30_0x16ce('0xe')][a30_0x16ce('0x12')]),0x193);}else{_0x433ea9[a30_0x16ce('0xe')][a30_0x16ce('0x11')]=_0x433ea9[a30_0x16ce('0xe')][a30_0x16ce('0x12')];const _0x55b044={'first_name':_0x433ea9[a30_0x16ce('0xe')][a30_0x16ce('0xf')],'last_name':_0x433ea9['body'][a30_0x16ce('0x10')],'email':_0x433ea9[a30_0x16ce('0xe')]['email'],'username':_0x433ea9[a30_0x16ce('0xe')]['username'],'password':crypt_utils_1[a30_0x16ce('0x1d')][a30_0x16ce('0x1e')](_0x433ea9[a30_0x16ce('0xe')][a30_0x16ce('0x17')])};this[a30_0x16ce('0xa')]['create'](_0x55b044)['then'](function(_0x47dfab,_0x309a1c){const _0x342359={'id':_0x47dfab[a30_0x16ce('0x1f')]['id']};const _0x42cfce=jwt[a30_0x16ce('0x18')](_0x342359,configJwt['secret'],configJwt['options']);const _0x5081fd={'token':_0x42cfce};return responseUtils[a30_0x16ce('0x1a')](_0x446fe9,_0x5081fd,0xc8);})['catch'](_0x41a083=>{return responseUtils['errorResponse'](_0x446fe9,_0x41a083[a30_0x16ce('0x20')],0x1f4);});}})[a30_0x16ce('0x21')](_0x415e90=>{return responseUtils['errorResponse'](_0x446fe9,_0x415e90[a30_0x16ce('0x20')],0x1f4);});}}exports[a30_0x16ce('0x1d')]=AuthenticationController;
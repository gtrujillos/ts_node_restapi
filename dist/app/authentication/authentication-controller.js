var a11_0x3d41=['generateHash','dataValues','updated_at','options','stack','__esModule','i18n','../../config/jwt.js','../../infrastructure/auth-utils','../../resources/locale-strings','string-format','model','login','bind','createAccount','findOne','uuid','first_name','last_name','email','username','password','then','usernameNotFoundError','body','toJSON','sign','secret','token','successResponse','passwordNotMatchError','catch','errorResponse'];(function(_0x2b212,_0x20674e){var _0x2288f9=function(_0x343ed0){while(--_0x343ed0){_0x2b212['push'](_0x2b212['shift']());}};_0x2288f9(++_0x20674e);}(a11_0x3d41,0x1b2));var a11_0x28e9=function(_0x2dcda2,_0x26da7d){_0x2dcda2=_0x2dcda2-0x0;var _0x37bc1b=a11_0x3d41[_0x2dcda2];return _0x37bc1b;};'use strict';Object['defineProperty'](exports,a11_0x28e9('0x0'),{'value':!![]});const jwt=require('jsonwebtoken');const i18n=require(a11_0x28e9('0x1'));const configJwt=require(a11_0x28e9('0x2'));const authUtils=require(a11_0x28e9('0x3'));const responseUtils=require('../../infrastructure/response-utils');const LocaleStrings=require(a11_0x28e9('0x4'));const format=require(a11_0x28e9('0x5'));class AuthenticationController{constructor(_0x456448){this[a11_0x28e9('0x6')]=_0x456448;this[a11_0x28e9('0x7')]=this[a11_0x28e9('0x7')][a11_0x28e9('0x8')](this);this[a11_0x28e9('0x9')]=this['createAccount'][a11_0x28e9('0x8')](this);}[a11_0x28e9('0x7')](_0xc5ab7f,_0x430617,_0x52b545){this[a11_0x28e9('0x6')][a11_0x28e9('0xa')]({'where':{'username':_0xc5ab7f['body']['username']},'attributes':[a11_0x28e9('0xb'),a11_0x28e9('0xc'),a11_0x28e9('0xd'),a11_0x28e9('0xe'),a11_0x28e9('0xf'),a11_0x28e9('0x10')]})[a11_0x28e9('0x11')](_0x1d51c1=>{if(!_0x1d51c1){return responseUtils['errorResponse'](_0x430617,format(LocaleStrings[a11_0x28e9('0x12')],_0xc5ab7f[a11_0x28e9('0x13')][a11_0x28e9('0xf')]),0x193);}if(authUtils['validPassword'](_0xc5ab7f[a11_0x28e9('0x13')][a11_0x28e9('0x10')],_0x1d51c1['password'])){_0x1d51c1=_0x1d51c1[a11_0x28e9('0x14')]();const _0x194ca7={'uuid':_0x1d51c1[a11_0x28e9('0xb')]};const _0x155316=jwt[a11_0x28e9('0x15')](_0x194ca7,configJwt[a11_0x28e9('0x16')],configJwt['options']);delete _0x1d51c1[a11_0x28e9('0x10')];_0x1d51c1[a11_0x28e9('0x17')]=_0x155316;return responseUtils[a11_0x28e9('0x18')](_0x430617,_0x1d51c1,0xc8);}else{return responseUtils['errorResponse'](_0x430617,format(LocaleStrings[a11_0x28e9('0x19')]),0x193);}})[a11_0x28e9('0x1a')](_0x3c2e4e=>{return responseUtils['errorResponse'](_0x430617,_0x3c2e4e['stack'],0x1f4);});}[a11_0x28e9('0x9')](_0x20000c,_0x171104,_0x3df959){this['model']['findOne']({'where':{'username':_0x20000c['body'][a11_0x28e9('0xf')]}})['then'](_0x1e53ab=>{if(_0x1e53ab){return responseUtils[a11_0x28e9('0x1b')](_0x171104,format(LocaleStrings['usernameTakenError'],_0x20000c[a11_0x28e9('0x13')][a11_0x28e9('0xf')]),0x193);}else{_0x20000c[a11_0x28e9('0x13')]['email']=_0x20000c[a11_0x28e9('0x13')][a11_0x28e9('0xf')];const _0x19591c={'first_name':_0x20000c['body'][a11_0x28e9('0xc')],'last_name':_0x20000c[a11_0x28e9('0x13')][a11_0x28e9('0xd')],'email':_0x20000c[a11_0x28e9('0x13')][a11_0x28e9('0xe')],'username':_0x20000c[a11_0x28e9('0x13')]['username'],'password':authUtils[a11_0x28e9('0x1c')](_0x20000c['body'][a11_0x28e9('0x10')])};this['model']['create'](_0x19591c)[a11_0x28e9('0x11')](function(_0x2d0ed4,_0x3de7a2){delete _0x2d0ed4[a11_0x28e9('0x1d')]['id'];delete _0x2d0ed4[a11_0x28e9('0x1d')]['status'];delete _0x2d0ed4[a11_0x28e9('0x1d')][a11_0x28e9('0x10')];delete _0x2d0ed4[a11_0x28e9('0x1d')][a11_0x28e9('0x1e')];delete _0x2d0ed4[a11_0x28e9('0x1d')]['created_at'];const _0x43c339={'uuid':_0x2d0ed4[a11_0x28e9('0xb')]};const _0x372ca2=jwt[a11_0x28e9('0x15')](_0x43c339,configJwt[a11_0x28e9('0x16')],configJwt[a11_0x28e9('0x1f')]);_0x2d0ed4[a11_0x28e9('0x1d')][a11_0x28e9('0x17')]=_0x372ca2;return responseUtils['successResponse'](_0x171104,_0x2d0ed4,0xc8);})[a11_0x28e9('0x1a')](_0x15dad1=>{return responseUtils[a11_0x28e9('0x1b')](_0x171104,_0x15dad1[a11_0x28e9('0x20')],0x1f4);});}})['catch'](_0x1cb5df=>{return responseUtils[a11_0x28e9('0x1b')](_0x171104,_0x1cb5df['stack'],0x1f4);});}}exports['default']=AuthenticationController;
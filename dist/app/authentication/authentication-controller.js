var a11_0x386c=['string-format','login','bind','createAccount','model','body','username','uuid','first_name','last_name','password','usernameNotFoundError','validPassword','sign','options','token','successResponse','errorResponse','catch','then','generateHash','dataValues','status','updated_at','created_at','secret','stack','default','defineProperty','__esModule','jsonwebtoken','i18n','../../config/jwt.js','../../infrastructure/auth-utils','../../infrastructure/response-utils','../../resources/locale-strings'];(function(_0x1df98e,_0x398722){var _0x34fc58=function(_0x267db9){while(--_0x267db9){_0x1df98e['push'](_0x1df98e['shift']());}};_0x34fc58(++_0x398722);}(a11_0x386c,0x1a8));var a11_0x5e6a=function(_0x1dffa6,_0x39617c){_0x1dffa6=_0x1dffa6-0x0;var _0x5ea93a=a11_0x386c[_0x1dffa6];return _0x5ea93a;};'use strict';Object[a11_0x5e6a('0x0')](exports,a11_0x5e6a('0x1'),{'value':!![]});const jwt=require(a11_0x5e6a('0x2'));const i18n=require(a11_0x5e6a('0x3'));const configJwt=require(a11_0x5e6a('0x4'));const authUtils=require(a11_0x5e6a('0x5'));const responseUtils=require(a11_0x5e6a('0x6'));const LocaleStrings=require(a11_0x5e6a('0x7'));const format=require(a11_0x5e6a('0x8'));class AuthenticationController{constructor(_0x5d9e8e){this['model']=_0x5d9e8e;this[a11_0x5e6a('0x9')]=this[a11_0x5e6a('0x9')][a11_0x5e6a('0xa')](this);this[a11_0x5e6a('0xb')]=this[a11_0x5e6a('0xb')][a11_0x5e6a('0xa')](this);}['login'](_0x4ba887,_0x3712ca,_0xc1271d){this[a11_0x5e6a('0xc')]['findOne']({'where':{'username':_0x4ba887[a11_0x5e6a('0xd')][a11_0x5e6a('0xe')]},'attributes':[a11_0x5e6a('0xf'),a11_0x5e6a('0x10'),a11_0x5e6a('0x11'),'email',a11_0x5e6a('0xe'),a11_0x5e6a('0x12')]})['then'](_0x421a5e=>{if(!_0x421a5e){return responseUtils['errorResponse'](_0x3712ca,format(LocaleStrings[a11_0x5e6a('0x13')],_0x4ba887[a11_0x5e6a('0xd')][a11_0x5e6a('0xe')]),0x193);}if(authUtils[a11_0x5e6a('0x14')](_0x4ba887[a11_0x5e6a('0xd')]['password'],_0x421a5e['password'])){_0x421a5e=_0x421a5e['toJSON']();const _0xa9caa2={'uuid':_0x421a5e[a11_0x5e6a('0xf')]};const _0x19980d=jwt[a11_0x5e6a('0x15')](_0xa9caa2,configJwt['secret'],configJwt[a11_0x5e6a('0x16')]);delete _0x421a5e[a11_0x5e6a('0x12')];_0x421a5e[a11_0x5e6a('0x17')]=_0x19980d;return responseUtils[a11_0x5e6a('0x18')](_0x3712ca,_0x421a5e,0xc8);}else{return responseUtils[a11_0x5e6a('0x19')](_0x3712ca,format(LocaleStrings['passwordNotMatchError']),0x193);}})[a11_0x5e6a('0x1a')](_0x2cc654=>{return responseUtils['errorResponse'](_0x3712ca,_0x2cc654['stack'],0x1f4);});}[a11_0x5e6a('0xb')](_0x481fb0,_0x54fbfd,_0x8ed387){this[a11_0x5e6a('0xc')]['findOne']({'where':{'username':_0x481fb0[a11_0x5e6a('0xd')][a11_0x5e6a('0xe')]}})[a11_0x5e6a('0x1b')](_0x5cec0e=>{if(_0x5cec0e){return responseUtils[a11_0x5e6a('0x19')](_0x54fbfd,format(LocaleStrings['usernameTakenError'],_0x481fb0['body'][a11_0x5e6a('0xe')]),0x193);}else{_0x481fb0[a11_0x5e6a('0xd')]['email']=_0x481fb0[a11_0x5e6a('0xd')][a11_0x5e6a('0xe')];const _0x27e82c={'first_name':_0x481fb0[a11_0x5e6a('0xd')][a11_0x5e6a('0x10')],'last_name':_0x481fb0[a11_0x5e6a('0xd')][a11_0x5e6a('0x11')],'email':_0x481fb0[a11_0x5e6a('0xd')]['email'],'username':_0x481fb0[a11_0x5e6a('0xd')][a11_0x5e6a('0xe')],'password':authUtils[a11_0x5e6a('0x1c')](_0x481fb0[a11_0x5e6a('0xd')]['password'])};this[a11_0x5e6a('0xc')]['create'](_0x27e82c)[a11_0x5e6a('0x1b')](function(_0xd8365f,_0xcb5ae9){delete _0xd8365f[a11_0x5e6a('0x1d')]['id'];delete _0xd8365f[a11_0x5e6a('0x1d')][a11_0x5e6a('0x1e')];delete _0xd8365f[a11_0x5e6a('0x1d')][a11_0x5e6a('0x12')];delete _0xd8365f[a11_0x5e6a('0x1d')][a11_0x5e6a('0x1f')];delete _0xd8365f['dataValues'][a11_0x5e6a('0x20')];const _0x5d39ba={'uuid':_0xd8365f['uuid']};const _0x598f99=jwt['sign'](_0x5d39ba,configJwt[a11_0x5e6a('0x21')],configJwt[a11_0x5e6a('0x16')]);_0xd8365f[a11_0x5e6a('0x1d')][a11_0x5e6a('0x17')]=_0x598f99;return responseUtils['successResponse'](_0x54fbfd,_0xd8365f,0xc8);})['catch'](_0x592382=>{return responseUtils[a11_0x5e6a('0x19')](_0x54fbfd,_0x592382['stack'],0x1f4);});}})['catch'](_0x33db40=>{return responseUtils['errorResponse'](_0x54fbfd,_0x33db40[a11_0x5e6a('0x22')],0x1f4);});}}exports[a11_0x5e6a('0x23')]=AuthenticationController;
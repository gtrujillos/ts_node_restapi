var a11_0x4ca3=['jsonwebtoken','i18n','../../config/jwt.js','../../infrastructure/auth-utils','../../resources/locale-strings','string-format','model','login','bind','createAccount','findOne','username','first_name','last_name','email','password','then','errorResponse','usernameNotFoundError','body','uuid','sign','secret','options','successResponse','passwordNotMatchError','catch','stack','usernameTakenError','create','dataValues','status','created_at','token','__esModule'];(function(_0x1087db,_0x57c655){var _0x586d41=function(_0x59a448){while(--_0x59a448){_0x1087db['push'](_0x1087db['shift']());}};_0x586d41(++_0x57c655);}(a11_0x4ca3,0x1a3));var a11_0x1fff=function(_0x2e4e91,_0xa9e967){_0x2e4e91=_0x2e4e91-0x0;var _0x36293c=a11_0x4ca3[_0x2e4e91];return _0x36293c;};'use strict';Object['defineProperty'](exports,a11_0x1fff('0x0'),{'value':!![]});const jwt=require(a11_0x1fff('0x1'));const i18n=require(a11_0x1fff('0x2'));const configJwt=require(a11_0x1fff('0x3'));const authUtils=require(a11_0x1fff('0x4'));const responseUtils=require('../../infrastructure/response-utils');const LocaleStrings=require(a11_0x1fff('0x5'));const format=require(a11_0x1fff('0x6'));class AuthenticationController{constructor(_0x5f5be6){this[a11_0x1fff('0x7')]=_0x5f5be6;this[a11_0x1fff('0x8')]=this[a11_0x1fff('0x8')][a11_0x1fff('0x9')](this);this['createAccount']=this[a11_0x1fff('0xa')][a11_0x1fff('0x9')](this);}[a11_0x1fff('0x8')](_0x5e78ed,_0x1164d0,_0x153f47){this[a11_0x1fff('0x7')][a11_0x1fff('0xb')]({'where':{'username':_0x5e78ed['body'][a11_0x1fff('0xc')]},'attributes':['uuid',a11_0x1fff('0xd'),a11_0x1fff('0xe'),a11_0x1fff('0xf'),a11_0x1fff('0xc'),a11_0x1fff('0x10')]})[a11_0x1fff('0x11')](_0x2f9f37=>{if(!_0x2f9f37){return responseUtils[a11_0x1fff('0x12')](_0x1164d0,format(LocaleStrings[a11_0x1fff('0x13')],_0x5e78ed[a11_0x1fff('0x14')][a11_0x1fff('0xc')]),0x193);}if(authUtils['validPassword'](_0x5e78ed[a11_0x1fff('0x14')][a11_0x1fff('0x10')],_0x2f9f37[a11_0x1fff('0x10')])){_0x2f9f37=_0x2f9f37['toJSON']();const _0x4bc1d4={'uuid':_0x2f9f37[a11_0x1fff('0x15')]};const _0x1f1783=jwt[a11_0x1fff('0x16')](_0x4bc1d4,configJwt[a11_0x1fff('0x17')],configJwt[a11_0x1fff('0x18')]);delete _0x2f9f37['password'];_0x2f9f37['token']=_0x1f1783;return responseUtils[a11_0x1fff('0x19')](_0x1164d0,_0x2f9f37,0xc8);}else{return responseUtils[a11_0x1fff('0x12')](_0x1164d0,format(LocaleStrings[a11_0x1fff('0x1a')]),0x193);}})[a11_0x1fff('0x1b')](_0x3b3023=>{return responseUtils[a11_0x1fff('0x12')](_0x1164d0,_0x3b3023[a11_0x1fff('0x1c')],0x1f4);});}[a11_0x1fff('0xa')](_0x3cfc12,_0x24ee02,_0x5d5d42){this[a11_0x1fff('0x7')][a11_0x1fff('0xb')]({'where':{'username':_0x3cfc12['body'][a11_0x1fff('0xc')]}})[a11_0x1fff('0x11')](_0xcc14bf=>{if(_0xcc14bf){return responseUtils[a11_0x1fff('0x12')](_0x24ee02,format(LocaleStrings[a11_0x1fff('0x1d')],_0x3cfc12['body'][a11_0x1fff('0xc')]),0x193);}else{_0x3cfc12[a11_0x1fff('0x14')][a11_0x1fff('0xf')]=_0x3cfc12['body'][a11_0x1fff('0xc')];const _0x183d0c={'first_name':_0x3cfc12[a11_0x1fff('0x14')][a11_0x1fff('0xd')],'last_name':_0x3cfc12[a11_0x1fff('0x14')][a11_0x1fff('0xe')],'email':_0x3cfc12[a11_0x1fff('0x14')][a11_0x1fff('0xf')],'username':_0x3cfc12['body'][a11_0x1fff('0xc')],'password':authUtils['generateHash'](_0x3cfc12[a11_0x1fff('0x14')][a11_0x1fff('0x10')])};this[a11_0x1fff('0x7')][a11_0x1fff('0x1e')](_0x183d0c)[a11_0x1fff('0x11')](function(_0x3dcecf,_0xca7d3){delete _0x3dcecf[a11_0x1fff('0x1f')]['id'];delete _0x3dcecf['dataValues'][a11_0x1fff('0x20')];delete _0x3dcecf[a11_0x1fff('0x1f')][a11_0x1fff('0x10')];delete _0x3dcecf[a11_0x1fff('0x1f')]['updated_at'];delete _0x3dcecf[a11_0x1fff('0x1f')][a11_0x1fff('0x21')];const _0x20c550={'uuid':_0x3dcecf[a11_0x1fff('0x15')]};const _0x1975a2=jwt[a11_0x1fff('0x16')](_0x20c550,configJwt['secret'],configJwt[a11_0x1fff('0x18')]);_0x3dcecf[a11_0x1fff('0x1f')][a11_0x1fff('0x22')]=_0x1975a2;return responseUtils[a11_0x1fff('0x19')](_0x24ee02,_0x3dcecf,0xc8);})[a11_0x1fff('0x1b')](_0x25b79b=>{return responseUtils[a11_0x1fff('0x12')](_0x24ee02,_0x25b79b['stack'],0x1f4);});}})[a11_0x1fff('0x1b')](_0x56c101=>{return responseUtils[a11_0x1fff('0x12')](_0x24ee02,_0x56c101[a11_0x1fff('0x1c')],0x1f4);});}}exports['default']=AuthenticationController;
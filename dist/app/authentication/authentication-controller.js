var a11_0x2bd0=['../../infrastructure/response-utils','../../resources/locale-strings','string-format','model','login','createAccount','findOne','body','username','uuid','first_name','last_name','email','errorResponse','validPassword','password','toJSON','sign','secret','options','token','passwordNotMatchError','catch','then','generateHash','create','dataValues','status','updated_at','created_at','successResponse','stack','default','defineProperty','__esModule','jsonwebtoken','../../config/jwt.js','../../infrastructure/auth-utils'];(function(_0x147779,_0x15ca3a){var _0xb66e18=function(_0x3af634){while(--_0x3af634){_0x147779['push'](_0x147779['shift']());}};_0xb66e18(++_0x15ca3a);}(a11_0x2bd0,0x177));var a11_0x2064=function(_0x2813a3,_0x4aedbe){_0x2813a3=_0x2813a3-0x0;var _0x2d2347=a11_0x2bd0[_0x2813a3];return _0x2d2347;};'use strict';Object[a11_0x2064('0x0')](exports,a11_0x2064('0x1'),{'value':!![]});const jwt=require(a11_0x2064('0x2'));const i18n=require('i18n');const configJwt=require(a11_0x2064('0x3'));const authUtils=require(a11_0x2064('0x4'));const responseUtils=require(a11_0x2064('0x5'));const LocaleStrings=require(a11_0x2064('0x6'));const format=require(a11_0x2064('0x7'));class AuthenticationController{constructor(_0x21ff57){this[a11_0x2064('0x8')]=_0x21ff57;this[a11_0x2064('0x9')]=this[a11_0x2064('0x9')]['bind'](this);this[a11_0x2064('0xa')]=this[a11_0x2064('0xa')]['bind'](this);}[a11_0x2064('0x9')](_0x48fa79,_0x39d117,_0x1b84a7){this[a11_0x2064('0x8')][a11_0x2064('0xb')]({'where':{'username':_0x48fa79[a11_0x2064('0xc')][a11_0x2064('0xd')]},'attributes':[a11_0x2064('0xe'),a11_0x2064('0xf'),a11_0x2064('0x10'),a11_0x2064('0x11'),'username','password']})['then'](_0x39de9f=>{if(!_0x39de9f){return responseUtils[a11_0x2064('0x12')](_0x39d117,format(LocaleStrings['usernameNotFoundError'],_0x48fa79[a11_0x2064('0xc')]['username']),0x193);}if(authUtils[a11_0x2064('0x13')](_0x48fa79[a11_0x2064('0xc')][a11_0x2064('0x14')],_0x39de9f[a11_0x2064('0x14')])){_0x39de9f=_0x39de9f[a11_0x2064('0x15')]();const _0x4254dc={'uuid':_0x39de9f[a11_0x2064('0xe')]};const _0x47ff24=jwt[a11_0x2064('0x16')](_0x4254dc,configJwt[a11_0x2064('0x17')],configJwt[a11_0x2064('0x18')]);delete _0x39de9f[a11_0x2064('0x14')];_0x39de9f[a11_0x2064('0x19')]=_0x47ff24;return responseUtils['successResponse'](_0x39d117,_0x39de9f,0xc8);}else{return responseUtils[a11_0x2064('0x12')](_0x39d117,format(LocaleStrings[a11_0x2064('0x1a')]),0x193);}})[a11_0x2064('0x1b')](_0xcd6985=>{return responseUtils[a11_0x2064('0x12')](_0x39d117,_0xcd6985['stack'],0x1f4);});}[a11_0x2064('0xa')](_0x180f0b,_0x3bf7d1,_0x749018){this[a11_0x2064('0x8')][a11_0x2064('0xb')]({'where':{'username':_0x180f0b[a11_0x2064('0xc')][a11_0x2064('0xd')]}})[a11_0x2064('0x1c')](_0xbf1a66=>{if(_0xbf1a66){return responseUtils[a11_0x2064('0x12')](_0x3bf7d1,format(LocaleStrings['usernameTakenError'],_0x180f0b['body'][a11_0x2064('0xd')]),0x193);}else{_0x180f0b[a11_0x2064('0xc')]['email']=_0x180f0b[a11_0x2064('0xc')][a11_0x2064('0xd')];const _0xd7b9d5={'first_name':_0x180f0b[a11_0x2064('0xc')][a11_0x2064('0xf')],'last_name':_0x180f0b['body']['last_name'],'email':_0x180f0b[a11_0x2064('0xc')][a11_0x2064('0x11')],'username':_0x180f0b[a11_0x2064('0xc')][a11_0x2064('0xd')],'password':authUtils[a11_0x2064('0x1d')](_0x180f0b['body'][a11_0x2064('0x14')])};this[a11_0x2064('0x8')][a11_0x2064('0x1e')](_0xd7b9d5)[a11_0x2064('0x1c')](function(_0x540c4c,_0x51f2a6){delete _0x540c4c[a11_0x2064('0x1f')]['id'];delete _0x540c4c[a11_0x2064('0x1f')][a11_0x2064('0x20')];delete _0x540c4c[a11_0x2064('0x1f')][a11_0x2064('0x14')];delete _0x540c4c[a11_0x2064('0x1f')][a11_0x2064('0x21')];delete _0x540c4c[a11_0x2064('0x1f')][a11_0x2064('0x22')];const _0x5b4e8f={'uuid':_0x540c4c[a11_0x2064('0xe')]};const _0x216b2f=jwt[a11_0x2064('0x16')](_0x5b4e8f,configJwt['secret'],configJwt[a11_0x2064('0x18')]);_0x540c4c[a11_0x2064('0x1f')][a11_0x2064('0x19')]=_0x216b2f;return responseUtils[a11_0x2064('0x23')](_0x3bf7d1,_0x540c4c,0xc8);})['catch'](_0x5b700d=>{return responseUtils[a11_0x2064('0x12')](_0x3bf7d1,_0x5b700d[a11_0x2064('0x24')],0x1f4);});}})['catch'](_0x8aa5b8=>{return responseUtils[a11_0x2064('0x12')](_0x3bf7d1,_0x8aa5b8['stack'],0x1f4);});}}exports[a11_0x2064('0x25')]=AuthenticationController;
var a11_0x502e=['options','token','errorResponse','passwordNotMatchError','catch','usernameTakenError','email','create','dataValues','status','updated_at','created_at','successResponse','stack','default','defineProperty','__esModule','i18n','../../config/jwt.js','../../infrastructure/auth-utils','../../infrastructure/response-utils','string-format','model','login','bind','createAccount','findOne','body','username','uuid','first_name','last_name','password','then','usernameNotFoundError','toJSON','secret'];(function(_0x58789d,_0x442980){var _0x29f837=function(_0x19ad43){while(--_0x19ad43){_0x58789d['push'](_0x58789d['shift']());}};_0x29f837(++_0x442980);}(a11_0x502e,0x112));var a11_0x7ec1=function(_0x582362,_0x4f1650){_0x582362=_0x582362-0x0;var _0x411303=a11_0x502e[_0x582362];return _0x411303;};'use strict';Object[a11_0x7ec1('0x0')](exports,a11_0x7ec1('0x1'),{'value':!![]});const jwt=require('jsonwebtoken');const i18n=require(a11_0x7ec1('0x2'));const configJwt=require(a11_0x7ec1('0x3'));const authUtils=require(a11_0x7ec1('0x4'));const responseUtils=require(a11_0x7ec1('0x5'));const LocaleStrings=require('../../resources/locale-strings');const format=require(a11_0x7ec1('0x6'));class AuthenticationController{constructor(_0xd1363a){this[a11_0x7ec1('0x7')]=_0xd1363a;this[a11_0x7ec1('0x8')]=this['login'][a11_0x7ec1('0x9')](this);this[a11_0x7ec1('0xa')]=this[a11_0x7ec1('0xa')][a11_0x7ec1('0x9')](this);}['login'](_0x3b7d42,_0x37a214,_0x45495d){this[a11_0x7ec1('0x7')][a11_0x7ec1('0xb')]({'where':{'username':_0x3b7d42[a11_0x7ec1('0xc')][a11_0x7ec1('0xd')]},'attributes':[a11_0x7ec1('0xe'),a11_0x7ec1('0xf'),a11_0x7ec1('0x10'),'email','username',a11_0x7ec1('0x11')]})[a11_0x7ec1('0x12')](_0x32cd91=>{if(!_0x32cd91){return responseUtils['errorResponse'](_0x37a214,format(LocaleStrings[a11_0x7ec1('0x13')],_0x3b7d42[a11_0x7ec1('0xc')][a11_0x7ec1('0xd')]),0x193);}if(authUtils['validPassword'](_0x3b7d42[a11_0x7ec1('0xc')]['password'],_0x32cd91[a11_0x7ec1('0x11')])){_0x32cd91=_0x32cd91[a11_0x7ec1('0x14')]();const _0x5ebad5={'uuid':_0x32cd91['uuid']};const _0x2bc160=jwt['sign'](_0x5ebad5,configJwt[a11_0x7ec1('0x15')],configJwt[a11_0x7ec1('0x16')]);delete _0x32cd91[a11_0x7ec1('0x11')];_0x32cd91[a11_0x7ec1('0x17')]=_0x2bc160;return responseUtils['successResponse'](_0x37a214,_0x32cd91,0xc8);}else{return responseUtils[a11_0x7ec1('0x18')](_0x37a214,format(LocaleStrings[a11_0x7ec1('0x19')]),0x193);}})[a11_0x7ec1('0x1a')](_0x10e431=>{return responseUtils['errorResponse'](_0x37a214,_0x10e431['stack'],0x1f4);});}[a11_0x7ec1('0xa')](_0x123f1c,_0x3954af,_0x29ba93){this['model']['findOne']({'where':{'username':_0x123f1c[a11_0x7ec1('0xc')][a11_0x7ec1('0xd')]}})['then'](_0x15e069=>{if(_0x15e069){return responseUtils[a11_0x7ec1('0x18')](_0x3954af,format(LocaleStrings[a11_0x7ec1('0x1b')],_0x123f1c[a11_0x7ec1('0xc')]['username']),0x193);}else{_0x123f1c[a11_0x7ec1('0xc')][a11_0x7ec1('0x1c')]=_0x123f1c[a11_0x7ec1('0xc')][a11_0x7ec1('0xd')];const _0x34d61f={'first_name':_0x123f1c[a11_0x7ec1('0xc')][a11_0x7ec1('0xf')],'last_name':_0x123f1c[a11_0x7ec1('0xc')][a11_0x7ec1('0x10')],'email':_0x123f1c[a11_0x7ec1('0xc')][a11_0x7ec1('0x1c')],'username':_0x123f1c[a11_0x7ec1('0xc')]['username'],'password':authUtils['generateHash'](_0x123f1c[a11_0x7ec1('0xc')][a11_0x7ec1('0x11')])};this[a11_0x7ec1('0x7')][a11_0x7ec1('0x1d')](_0x34d61f)[a11_0x7ec1('0x12')](function(_0x4fbf89,_0x4d65c2){delete _0x4fbf89[a11_0x7ec1('0x1e')]['id'];delete _0x4fbf89[a11_0x7ec1('0x1e')][a11_0x7ec1('0x1f')];delete _0x4fbf89[a11_0x7ec1('0x1e')][a11_0x7ec1('0x11')];delete _0x4fbf89[a11_0x7ec1('0x1e')][a11_0x7ec1('0x20')];delete _0x4fbf89[a11_0x7ec1('0x1e')][a11_0x7ec1('0x21')];const _0x36681c={'uuid':_0x4fbf89['uuid']};const _0x345b38=jwt['sign'](_0x36681c,configJwt[a11_0x7ec1('0x15')],configJwt[a11_0x7ec1('0x16')]);_0x4fbf89[a11_0x7ec1('0x1e')][a11_0x7ec1('0x17')]=_0x345b38;return responseUtils[a11_0x7ec1('0x22')](_0x3954af,_0x4fbf89,0xc8);})[a11_0x7ec1('0x1a')](_0x3f614d=>{return responseUtils[a11_0x7ec1('0x18')](_0x3954af,_0x3f614d[a11_0x7ec1('0x23')],0x1f4);});}})['catch'](_0x5bb9f8=>{return responseUtils['errorResponse'](_0x3954af,_0x5bb9f8['stack'],0x1f4);});}}exports[a11_0x7ec1('0x24')]=AuthenticationController;
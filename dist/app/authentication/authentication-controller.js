var a11_0x10f2=['dataValues','status','updated_at','created_at','catch','stack','defineProperty','__esModule','jsonwebtoken','../../config/jwt.js','../../infrastructure/auth-utils','../../infrastructure/response-utils','../../resources/locale-strings','string-format','model','login','createAccount','bind','findOne','username','first_name','last_name','email','then','errorResponse','usernameNotFoundError','body','password','toJSON','uuid','sign','secret','token','successResponse','passwordNotMatchError','usernameTakenError','generateHash','create'];(function(_0x3b3725,_0x1d40e8){var _0x2ac837=function(_0x977a0b){while(--_0x977a0b){_0x3b3725['push'](_0x3b3725['shift']());}};_0x2ac837(++_0x1d40e8);}(a11_0x10f2,0x1ce));var a11_0x2a35=function(_0x5a39a0,_0x5d54ed){_0x5a39a0=_0x5a39a0-0x0;var _0x47356c=a11_0x10f2[_0x5a39a0];return _0x47356c;};'use strict';Object[a11_0x2a35('0x0')](exports,a11_0x2a35('0x1'),{'value':!![]});const jwt=require(a11_0x2a35('0x2'));const i18n=require('i18n');const configJwt=require(a11_0x2a35('0x3'));const authUtils=require(a11_0x2a35('0x4'));const responseUtils=require(a11_0x2a35('0x5'));const LocaleStrings=require(a11_0x2a35('0x6'));const format=require(a11_0x2a35('0x7'));class AuthenticationController{constructor(_0x2e08c6){this[a11_0x2a35('0x8')]=_0x2e08c6;this['login']=this[a11_0x2a35('0x9')]['bind'](this);this['createAccount']=this[a11_0x2a35('0xa')][a11_0x2a35('0xb')](this);}[a11_0x2a35('0x9')](_0x1ba0d7,_0x477481,_0x2aaa92){this[a11_0x2a35('0x8')][a11_0x2a35('0xc')]({'where':{'username':_0x1ba0d7['body'][a11_0x2a35('0xd')]},'attributes':['uuid',a11_0x2a35('0xe'),a11_0x2a35('0xf'),a11_0x2a35('0x10'),a11_0x2a35('0xd'),'password']})[a11_0x2a35('0x11')](_0x496e43=>{if(!_0x496e43){return responseUtils[a11_0x2a35('0x12')](_0x477481,format(LocaleStrings[a11_0x2a35('0x13')],_0x1ba0d7[a11_0x2a35('0x14')][a11_0x2a35('0xd')]),0x193);}if(authUtils['validPassword'](_0x1ba0d7[a11_0x2a35('0x14')][a11_0x2a35('0x15')],_0x496e43[a11_0x2a35('0x15')])){_0x496e43=_0x496e43[a11_0x2a35('0x16')]();const _0x465ac1={'uuid':_0x496e43[a11_0x2a35('0x17')]};const _0x182225=jwt[a11_0x2a35('0x18')](_0x465ac1,configJwt[a11_0x2a35('0x19')],configJwt['options']);delete _0x496e43[a11_0x2a35('0x15')];_0x496e43[a11_0x2a35('0x1a')]=_0x182225;return responseUtils[a11_0x2a35('0x1b')](_0x477481,_0x496e43,0xc8);}else{return responseUtils['errorResponse'](_0x477481,format(LocaleStrings[a11_0x2a35('0x1c')]),0x193);}})['catch'](_0x45a308=>{return responseUtils[a11_0x2a35('0x12')](_0x477481,_0x45a308['stack'],0x1f4);});}['createAccount'](_0x4a41d5,_0x7a65d,_0x43af30){this['model'][a11_0x2a35('0xc')]({'where':{'username':_0x4a41d5[a11_0x2a35('0x14')][a11_0x2a35('0xd')]}})[a11_0x2a35('0x11')](_0x55429a=>{if(_0x55429a){return responseUtils[a11_0x2a35('0x12')](_0x7a65d,format(LocaleStrings[a11_0x2a35('0x1d')],_0x4a41d5[a11_0x2a35('0x14')][a11_0x2a35('0xd')]),0x193);}else{_0x4a41d5[a11_0x2a35('0x14')][a11_0x2a35('0x10')]=_0x4a41d5['body'][a11_0x2a35('0xd')];const _0x279bb5={'first_name':_0x4a41d5[a11_0x2a35('0x14')]['first_name'],'last_name':_0x4a41d5['body']['last_name'],'email':_0x4a41d5['body'][a11_0x2a35('0x10')],'username':_0x4a41d5[a11_0x2a35('0x14')][a11_0x2a35('0xd')],'password':authUtils[a11_0x2a35('0x1e')](_0x4a41d5[a11_0x2a35('0x14')][a11_0x2a35('0x15')])};this[a11_0x2a35('0x8')][a11_0x2a35('0x1f')](_0x279bb5)[a11_0x2a35('0x11')](function(_0x1e0970,_0x2f1a86){delete _0x1e0970[a11_0x2a35('0x20')]['id'];delete _0x1e0970[a11_0x2a35('0x20')][a11_0x2a35('0x21')];delete _0x1e0970['dataValues'][a11_0x2a35('0x15')];delete _0x1e0970[a11_0x2a35('0x20')][a11_0x2a35('0x22')];delete _0x1e0970[a11_0x2a35('0x20')][a11_0x2a35('0x23')];const _0x1da454={'uuid':_0x1e0970[a11_0x2a35('0x17')]};const _0x52636f=jwt['sign'](_0x1da454,configJwt['secret'],configJwt['options']);_0x1e0970[a11_0x2a35('0x20')][a11_0x2a35('0x1a')]=_0x52636f;return responseUtils[a11_0x2a35('0x1b')](_0x7a65d,_0x1e0970,0xc8);})[a11_0x2a35('0x24')](_0x132161=>{return responseUtils[a11_0x2a35('0x12')](_0x7a65d,_0x132161['stack'],0x1f4);});}})[a11_0x2a35('0x24')](_0x16dfa5=>{return responseUtils[a11_0x2a35('0x12')](_0x7a65d,_0x16dfa5[a11_0x2a35('0x25')],0x1f4);});}}exports['default']=AuthenticationController;
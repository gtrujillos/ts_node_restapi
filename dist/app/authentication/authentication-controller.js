var a3_0x30eb=['defineProperty','__esModule','../../infrastructure/sequelize-utils','../../infrastructure/crypt-utils','i18n','../../infrastructure/auth-utils','../../infrastructure/response-utils','../../resources/locale-strings','string-format','formidable','fs-extra','model','login','bind','logout','usernameExist','createUserProfile','updateUserProfile','body','first_name','last_name','password','then','errorResponse','usernameNotFoundError','username','default','validPassword','generateJWT','findOne','successResponse','stack','usernameTakenError','email','hashPassword','create','catch','getUserProfile','authentication\x20failed','assign','user','updated_by_user_id','deleted_by_user_id','status','updated_at','deleted_at','updateUserProfileImage','parse','fields','files','params','code','__importDefault'];(function(_0x9a9eea,_0x1ffe84){var _0x30968c=function(_0x274ea6){while(--_0x274ea6){_0x9a9eea['push'](_0x9a9eea['shift']());}};_0x30968c(++_0x1ffe84);}(a3_0x30eb,0x172));var a3_0x2f2e=function(_0x455bc9,_0x302c8c){_0x455bc9=_0x455bc9-0x0;var _0x25833c=a3_0x30eb[_0x455bc9];return _0x25833c;};'use strict';var __importDefault=this&&this[a3_0x2f2e('0x0')]||function(_0x120adb){return _0x120adb&&_0x120adb['__esModule']?_0x120adb:{'default':_0x120adb};};Object[a3_0x2f2e('0x1')](exports,a3_0x2f2e('0x2'),{'value':!![]});const sequelize_utils_1=__importDefault(require(a3_0x2f2e('0x3')));const crypt_utils_1=__importDefault(require(a3_0x2f2e('0x4')));const jwt=require('jsonwebtoken');const i18n=require(a3_0x2f2e('0x5'));const authUtils=require(a3_0x2f2e('0x6'));const responseUtils=require(a3_0x2f2e('0x7'));const LocaleStrings=require(a3_0x2f2e('0x8'));const format=require(a3_0x2f2e('0x9'));const formidable=require(a3_0x2f2e('0xa'));const fsExtra=require(a3_0x2f2e('0xb'));class AuthenticationController{constructor(_0x24ff5c){this[a3_0x2f2e('0xc')]=_0x24ff5c;this['login']=this[a3_0x2f2e('0xd')][a3_0x2f2e('0xe')](this);this['logout']=this[a3_0x2f2e('0xf')][a3_0x2f2e('0xe')](this);this[a3_0x2f2e('0x10')]=this[a3_0x2f2e('0x10')][a3_0x2f2e('0xe')](this);this[a3_0x2f2e('0x11')]=this['createUserProfile']['bind'](this);this['getUserProfile']=this['getUserProfile'][a3_0x2f2e('0xe')](this);this[a3_0x2f2e('0x12')]=this['updateUserProfile'][a3_0x2f2e('0xe')](this);}[a3_0x2f2e('0xd')](_0x291903,_0x5c1b98,_0x2ef0c2){this['model']['findOne']({'where':{'username':_0x291903[a3_0x2f2e('0x13')]['username']},'attributes':['id',a3_0x2f2e('0x14'),a3_0x2f2e('0x15'),'email','username',a3_0x2f2e('0x16')]})[a3_0x2f2e('0x17')](_0x337e46=>{if(!_0x337e46){return responseUtils[a3_0x2f2e('0x18')](_0x291903,_0x5c1b98,format(LocaleStrings[a3_0x2f2e('0x19')],_0x291903['body'][a3_0x2f2e('0x1a')]),0x193);}if(crypt_utils_1[a3_0x2f2e('0x1b')][a3_0x2f2e('0x1c')](_0x291903[a3_0x2f2e('0x13')][a3_0x2f2e('0x16')],_0x337e46[a3_0x2f2e('0x16')]==null?'':_0x337e46[a3_0x2f2e('0x16')])){_0x337e46=_0x337e46['toJSON']();const _0x3d49b6=authUtils[a3_0x2f2e('0x1d')](_0x337e46);const _0x1226a9={'token':_0x3d49b6};return responseUtils['successResponse'](_0x291903,_0x5c1b98,_0x1226a9,0xc8);}else{return responseUtils[a3_0x2f2e('0x18')](_0x291903,_0x5c1b98,format(LocaleStrings['passwordNotMatchError']),0x193);}})['catch'](_0x10b987=>{return responseUtils[a3_0x2f2e('0x18')](_0x291903,_0x5c1b98,_0x10b987,0x1f4);});}[a3_0x2f2e('0xf')](_0x1f5044,_0x272229,_0x33347f){}[a3_0x2f2e('0x10')](_0x4a7d23,_0x32bd3e,_0x43a9a3){this['model'][a3_0x2f2e('0x1e')]({'where':{'username':_0x4a7d23[a3_0x2f2e('0x13')][a3_0x2f2e('0x1a')]}})[a3_0x2f2e('0x17')](_0x2f19a3=>{let _0x37acfa=![];if(_0x2f19a3){_0x37acfa=!![];}return responseUtils[a3_0x2f2e('0x1f')](_0x4a7d23,_0x32bd3e,{'exist':_0x37acfa},0xc8);})['catch'](_0x34a80d=>{return responseUtils[a3_0x2f2e('0x18')](_0x4a7d23,_0x32bd3e,_0x34a80d[a3_0x2f2e('0x20')],0x1f4);});}[a3_0x2f2e('0x11')](_0x12cdcc,_0x33b50c,_0x3104ad){this[a3_0x2f2e('0xc')][a3_0x2f2e('0x1e')]({'where':{'username':_0x12cdcc['body'][a3_0x2f2e('0x1a')]}})[a3_0x2f2e('0x17')](_0x36c126=>{if(_0x36c126){return responseUtils['errorResponse'](_0x12cdcc,_0x33b50c,format(LocaleStrings[a3_0x2f2e('0x21')],_0x12cdcc[a3_0x2f2e('0x13')][a3_0x2f2e('0x1a')]),0x193);}else{_0x12cdcc[a3_0x2f2e('0x13')][a3_0x2f2e('0x22')]=_0x12cdcc[a3_0x2f2e('0x13')][a3_0x2f2e('0x1a')];const _0x4f6ca4={'first_name':_0x12cdcc[a3_0x2f2e('0x13')][a3_0x2f2e('0x14')],'last_name':_0x12cdcc[a3_0x2f2e('0x13')][a3_0x2f2e('0x15')],'email':_0x12cdcc[a3_0x2f2e('0x13')][a3_0x2f2e('0x22')],'username':_0x12cdcc[a3_0x2f2e('0x13')][a3_0x2f2e('0x1a')],'password':crypt_utils_1[a3_0x2f2e('0x1b')][a3_0x2f2e('0x23')](_0x12cdcc[a3_0x2f2e('0x13')][a3_0x2f2e('0x16')])};this[a3_0x2f2e('0xc')][a3_0x2f2e('0x24')](_0x4f6ca4)[a3_0x2f2e('0x17')](function(_0x4fa41b,_0x4e9258){const _0x4c11bc=authUtils['generateJWT'](_0x4fa41b);const _0x1f17ec={'token':_0x4c11bc};return responseUtils[a3_0x2f2e('0x1f')](_0x12cdcc,_0x33b50c,_0x1f17ec,0xc8);})[a3_0x2f2e('0x25')](_0x28687a=>{return responseUtils[a3_0x2f2e('0x18')](_0x12cdcc,_0x33b50c,_0x28687a[a3_0x2f2e('0x20')],0x1f4);});}})[a3_0x2f2e('0x25')](_0x6b6538=>{return responseUtils[a3_0x2f2e('0x18')](_0x12cdcc,_0x33b50c,_0x6b6538['stack'],0x1f4);});}[a3_0x2f2e('0x26')](_0x11e4e2,_0x3896b1,_0x201b89){if(!_0x11e4e2['user']){return responseUtils[a3_0x2f2e('0x18')](_0x11e4e2,_0x3896b1,a3_0x2f2e('0x27'),0x191);}const _0x4f1e13=sequelize_utils_1[a3_0x2f2e('0x1b')]['encryptId'](Object[a3_0x2f2e('0x28')]({},_0x11e4e2[a3_0x2f2e('0x29')],{}));delete _0x4f1e13['created_by_user_id'];delete _0x4f1e13[a3_0x2f2e('0x2a')];delete _0x4f1e13[a3_0x2f2e('0x2b')];delete _0x4f1e13[a3_0x2f2e('0x16')];delete _0x4f1e13[a3_0x2f2e('0x2c')];delete _0x4f1e13['created_at'];delete _0x4f1e13[a3_0x2f2e('0x2d')];delete _0x4f1e13[a3_0x2f2e('0x2e')];return responseUtils[a3_0x2f2e('0x1f')](_0x11e4e2,_0x3896b1,_0x4f1e13,0xc8);}[a3_0x2f2e('0x12')](_0x125876,_0x46c775,_0x482dce){}[a3_0x2f2e('0x2f')](_0x2593ec,_0x14bb2f,_0x35e022){const _0x502d2b=formidable({'multiples':!![]});_0x502d2b[a3_0x2f2e('0x30')](_0x2593ec,(_0x379492,_0x5260c1,_0x4885df)=>{console['log'](a3_0x2f2e('0x31'),_0x5260c1);console['log'](a3_0x2f2e('0x32'),_0x4885df);if(_0x379492){return responseUtils['errorResponse'](_0x14bb2f,_0x379492[a3_0x2f2e('0x20')],0x1f4);}_0x2593ec[a3_0x2f2e('0x33')]={'code':_0x5260c1[a3_0x2f2e('0x34')]};return responseUtils['successResponse'](_0x2593ec,_0x14bb2f,{},0xc8);});}}exports['default']=AuthenticationController;
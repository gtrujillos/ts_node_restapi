var a11_0x4950=['usernameNotFoundError','validPassword','secret','options','token','passwordNotMatchError','catch','stack','findOne','then','usernameTakenError','first_name','create','dataValues','updated_at','created_at','sign','successResponse','default','__esModule','i18n','../../infrastructure/auth-utils','../../infrastructure/response-utils','../../resources/locale-strings','string-format','model','login','bind','createAccount','body','username','uuid','last_name','email','password','errorResponse'];(function(_0x5334b9,_0x2a87a5){var _0x1b6bee=function(_0x1bf466){while(--_0x1bf466){_0x5334b9['push'](_0x5334b9['shift']());}};_0x1b6bee(++_0x2a87a5);}(a11_0x4950,0x157));var a11_0x2caf=function(_0x5ab6d4,_0x362e74){_0x5ab6d4=_0x5ab6d4-0x0;var _0x9fdde2=a11_0x4950[_0x5ab6d4];return _0x9fdde2;};'use strict';Object['defineProperty'](exports,a11_0x2caf('0x0'),{'value':!![]});const jwt=require('jsonwebtoken');const i18n=require(a11_0x2caf('0x1'));const configJwt=require('../../config/jwt.js');const authUtils=require(a11_0x2caf('0x2'));const responseUtils=require(a11_0x2caf('0x3'));const LocaleStrings=require(a11_0x2caf('0x4'));const format=require(a11_0x2caf('0x5'));class AuthenticationController{constructor(_0x36471b){this[a11_0x2caf('0x6')]=_0x36471b;this[a11_0x2caf('0x7')]=this['login'][a11_0x2caf('0x8')](this);this[a11_0x2caf('0x9')]=this[a11_0x2caf('0x9')][a11_0x2caf('0x8')](this);}['login'](_0x362d60,_0x54a0ab,_0x415abd){this['model']['findOne']({'where':{'username':_0x362d60[a11_0x2caf('0xa')][a11_0x2caf('0xb')]},'attributes':[a11_0x2caf('0xc'),'first_name',a11_0x2caf('0xd'),a11_0x2caf('0xe'),'username',a11_0x2caf('0xf')]})['then'](_0x4a2c32=>{if(!_0x4a2c32){return responseUtils[a11_0x2caf('0x10')](_0x54a0ab,format(LocaleStrings[a11_0x2caf('0x11')],_0x362d60[a11_0x2caf('0xa')][a11_0x2caf('0xb')]),0x193);}if(authUtils[a11_0x2caf('0x12')](_0x362d60[a11_0x2caf('0xa')][a11_0x2caf('0xf')],_0x4a2c32[a11_0x2caf('0xf')])){_0x4a2c32=_0x4a2c32['toJSON']();const _0x1dceae={'uuid':_0x4a2c32['uuid']};const _0x13cd02=jwt['sign'](_0x1dceae,configJwt[a11_0x2caf('0x13')],configJwt[a11_0x2caf('0x14')]);delete _0x4a2c32[a11_0x2caf('0xf')];_0x4a2c32[a11_0x2caf('0x15')]=_0x13cd02;return responseUtils['successResponse'](_0x54a0ab,_0x4a2c32,0xc8);}else{return responseUtils[a11_0x2caf('0x10')](_0x54a0ab,format(LocaleStrings[a11_0x2caf('0x16')]),0x193);}})[a11_0x2caf('0x17')](_0x32bd7e=>{return responseUtils['errorResponse'](_0x54a0ab,_0x32bd7e[a11_0x2caf('0x18')],0x1f4);});}[a11_0x2caf('0x9')](_0x59f84b,_0x31a6f5,_0x419f8f){this[a11_0x2caf('0x6')][a11_0x2caf('0x19')]({'where':{'username':_0x59f84b[a11_0x2caf('0xa')][a11_0x2caf('0xb')]}})[a11_0x2caf('0x1a')](_0x267ca8=>{if(_0x267ca8){return responseUtils[a11_0x2caf('0x10')](_0x31a6f5,format(LocaleStrings[a11_0x2caf('0x1b')],_0x59f84b[a11_0x2caf('0xa')][a11_0x2caf('0xb')]),0x193);}else{_0x59f84b[a11_0x2caf('0xa')]['email']=_0x59f84b[a11_0x2caf('0xa')][a11_0x2caf('0xb')];const _0x36b8d6={'first_name':_0x59f84b[a11_0x2caf('0xa')][a11_0x2caf('0x1c')],'last_name':_0x59f84b['body'][a11_0x2caf('0xd')],'email':_0x59f84b[a11_0x2caf('0xa')]['email'],'username':_0x59f84b[a11_0x2caf('0xa')][a11_0x2caf('0xb')],'password':authUtils['generateHash'](_0x59f84b['body'][a11_0x2caf('0xf')])};this[a11_0x2caf('0x6')][a11_0x2caf('0x1d')](_0x36b8d6)[a11_0x2caf('0x1a')](function(_0x1ab97a,_0x78387e){delete _0x1ab97a[a11_0x2caf('0x1e')]['id'];delete _0x1ab97a[a11_0x2caf('0x1e')]['status'];delete _0x1ab97a[a11_0x2caf('0x1e')][a11_0x2caf('0xf')];delete _0x1ab97a[a11_0x2caf('0x1e')][a11_0x2caf('0x1f')];delete _0x1ab97a[a11_0x2caf('0x1e')][a11_0x2caf('0x20')];const _0x53de6d={'uuid':_0x1ab97a['uuid']};const _0x285a40=jwt[a11_0x2caf('0x21')](_0x53de6d,configJwt['secret'],configJwt[a11_0x2caf('0x14')]);_0x1ab97a[a11_0x2caf('0x1e')]['token']=_0x285a40;return responseUtils[a11_0x2caf('0x22')](_0x31a6f5,_0x1ab97a,0xc8);})[a11_0x2caf('0x17')](_0x5ace7b=>{return responseUtils[a11_0x2caf('0x10')](_0x31a6f5,_0x5ace7b['stack'],0x1f4);});}})['catch'](_0x4a396f=>{return responseUtils[a11_0x2caf('0x10')](_0x31a6f5,_0x4a396f[a11_0x2caf('0x18')],0x1f4);});}}exports[a11_0x2caf('0x23')]=AuthenticationController;
var a11_0x1968=['i18n','../../config/jwt.js','../../infrastructure/auth-utils','string-format','model','login','createAccount','bind','findOne','uuid','first_name','email','username','password','then','errorResponse','usernameNotFoundError','body','validPassword','toJSON','sign','options','token','successResponse','catch','stack','usernameTakenError','last_name','generateHash','create','dataValues','updated_at','created_at','default','defineProperty','jsonwebtoken'];(function(_0x116f17,_0x59d5e2){var _0x334ecd=function(_0x38b00f){while(--_0x38b00f){_0x116f17['push'](_0x116f17['shift']());}};_0x334ecd(++_0x59d5e2);}(a11_0x1968,0x18a));var a11_0x64a8=function(_0x45f026,_0x28c39a){_0x45f026=_0x45f026-0x0;var _0x4cc457=a11_0x1968[_0x45f026];return _0x4cc457;};'use strict';Object[a11_0x64a8('0x0')](exports,'__esModule',{'value':!![]});const jwt=require(a11_0x64a8('0x1'));const i18n=require(a11_0x64a8('0x2'));const configJwt=require(a11_0x64a8('0x3'));const authUtils=require(a11_0x64a8('0x4'));const responseUtils=require('../../infrastructure/response-utils');const LocaleStrings=require('../../resources/locale-strings');const format=require(a11_0x64a8('0x5'));class AuthenticationController{constructor(_0x5454ee){this[a11_0x64a8('0x6')]=_0x5454ee;this['login']=this[a11_0x64a8('0x7')]['bind'](this);this[a11_0x64a8('0x8')]=this['createAccount'][a11_0x64a8('0x9')](this);}[a11_0x64a8('0x7')](_0x3b4b93,_0x7a8793,_0x197a9c){this['model'][a11_0x64a8('0xa')]({'where':{'username':_0x3b4b93['body']['username']},'attributes':[a11_0x64a8('0xb'),a11_0x64a8('0xc'),'last_name',a11_0x64a8('0xd'),a11_0x64a8('0xe'),a11_0x64a8('0xf')]})[a11_0x64a8('0x10')](_0x538faa=>{if(!_0x538faa){return responseUtils[a11_0x64a8('0x11')](_0x7a8793,format(LocaleStrings[a11_0x64a8('0x12')],_0x3b4b93[a11_0x64a8('0x13')][a11_0x64a8('0xe')]),0x193);}if(authUtils[a11_0x64a8('0x14')](_0x3b4b93[a11_0x64a8('0x13')][a11_0x64a8('0xf')],_0x538faa['password'])){_0x538faa=_0x538faa[a11_0x64a8('0x15')]();const _0x2f28be={'uuid':_0x538faa['uuid']};const _0x1856ea=jwt[a11_0x64a8('0x16')](_0x2f28be,configJwt['secret'],configJwt[a11_0x64a8('0x17')]);delete _0x538faa[a11_0x64a8('0xf')];_0x538faa[a11_0x64a8('0x18')]=_0x1856ea;return responseUtils[a11_0x64a8('0x19')](_0x7a8793,_0x538faa,0xc8);}else{return responseUtils[a11_0x64a8('0x11')](_0x7a8793,format(LocaleStrings['passwordNotMatchError']),0x193);}})[a11_0x64a8('0x1a')](_0x257569=>{return responseUtils['errorResponse'](_0x7a8793,_0x257569[a11_0x64a8('0x1b')],0x1f4);});}[a11_0x64a8('0x8')](_0x2bb967,_0x46956c,_0x4ba427){this[a11_0x64a8('0x6')][a11_0x64a8('0xa')]({'where':{'username':_0x2bb967['body'][a11_0x64a8('0xe')]}})[a11_0x64a8('0x10')](_0x4ceeac=>{if(_0x4ceeac){return responseUtils[a11_0x64a8('0x11')](_0x46956c,format(LocaleStrings[a11_0x64a8('0x1c')],_0x2bb967[a11_0x64a8('0x13')]['username']),0x193);}else{_0x2bb967[a11_0x64a8('0x13')][a11_0x64a8('0xd')]=_0x2bb967[a11_0x64a8('0x13')]['username'];const _0x159aa2={'first_name':_0x2bb967[a11_0x64a8('0x13')][a11_0x64a8('0xc')],'last_name':_0x2bb967[a11_0x64a8('0x13')][a11_0x64a8('0x1d')],'email':_0x2bb967[a11_0x64a8('0x13')][a11_0x64a8('0xd')],'username':_0x2bb967[a11_0x64a8('0x13')][a11_0x64a8('0xe')],'password':authUtils[a11_0x64a8('0x1e')](_0x2bb967['body'][a11_0x64a8('0xf')])};this[a11_0x64a8('0x6')][a11_0x64a8('0x1f')](_0x159aa2)[a11_0x64a8('0x10')](function(_0x58710d,_0x43857d){delete _0x58710d[a11_0x64a8('0x20')]['id'];delete _0x58710d[a11_0x64a8('0x20')]['status'];delete _0x58710d[a11_0x64a8('0x20')]['password'];delete _0x58710d[a11_0x64a8('0x20')][a11_0x64a8('0x21')];delete _0x58710d[a11_0x64a8('0x20')][a11_0x64a8('0x22')];const _0x14bceb={'uuid':_0x58710d[a11_0x64a8('0xb')]};const _0x428c21=jwt['sign'](_0x14bceb,configJwt['secret'],configJwt['options']);_0x58710d[a11_0x64a8('0x20')][a11_0x64a8('0x18')]=_0x428c21;return responseUtils['successResponse'](_0x46956c,_0x58710d,0xc8);})['catch'](_0xba3157=>{return responseUtils[a11_0x64a8('0x11')](_0x46956c,_0xba3157[a11_0x64a8('0x1b')],0x1f4);});}})[a11_0x64a8('0x1a')](_0x19410b=>{return responseUtils[a11_0x64a8('0x11')](_0x46956c,_0x19410b[a11_0x64a8('0x1b')],0x1f4);});}}exports[a11_0x64a8('0x23')]=AuthenticationController;
var a11_0x24d1=['uuid','secret','options','token','successResponse','passwordNotMatchError','stack','usernameTakenError','last_name','generateHash','create','status','dataValues','updated_at','catch','defineProperty','__esModule','i18n','../../config/jwt.js','../../infrastructure/auth-utils','../../infrastructure/response-utils','../../resources/locale-strings','string-format','model','login','bind','createAccount','findOne','body','username','first_name','email','then','errorResponse','usernameNotFoundError','validPassword','password','toJSON'];(function(_0x28aac9,_0x526473){var _0x281957=function(_0x335225){while(--_0x335225){_0x28aac9['push'](_0x28aac9['shift']());}};_0x281957(++_0x526473);}(a11_0x24d1,0x81));var a11_0x16a6=function(_0x1b2fca,_0x3dfcda){_0x1b2fca=_0x1b2fca-0x0;var _0x2be72a=a11_0x24d1[_0x1b2fca];return _0x2be72a;};'use strict';Object[a11_0x16a6('0x0')](exports,a11_0x16a6('0x1'),{'value':!![]});const jwt=require('jsonwebtoken');const i18n=require(a11_0x16a6('0x2'));const configJwt=require(a11_0x16a6('0x3'));const authUtils=require(a11_0x16a6('0x4'));const responseUtils=require(a11_0x16a6('0x5'));const LocaleStrings=require(a11_0x16a6('0x6'));const format=require(a11_0x16a6('0x7'));class AuthenticationController{constructor(_0x1dc94a){this[a11_0x16a6('0x8')]=_0x1dc94a;this[a11_0x16a6('0x9')]=this['login'][a11_0x16a6('0xa')](this);this['createAccount']=this[a11_0x16a6('0xb')][a11_0x16a6('0xa')](this);}['login'](_0x378d88,_0x33f30b,_0x42a12f){this[a11_0x16a6('0x8')][a11_0x16a6('0xc')]({'where':{'username':_0x378d88[a11_0x16a6('0xd')][a11_0x16a6('0xe')]},'attributes':['uuid',a11_0x16a6('0xf'),'last_name',a11_0x16a6('0x10'),a11_0x16a6('0xe'),'password']})[a11_0x16a6('0x11')](_0x538dc3=>{if(!_0x538dc3){return responseUtils[a11_0x16a6('0x12')](_0x33f30b,format(LocaleStrings[a11_0x16a6('0x13')],_0x378d88['body']['username']),0x193);}if(authUtils[a11_0x16a6('0x14')](_0x378d88[a11_0x16a6('0xd')][a11_0x16a6('0x15')],_0x538dc3['password'])){_0x538dc3=_0x538dc3[a11_0x16a6('0x16')]();const _0xc7064a={'uuid':_0x538dc3[a11_0x16a6('0x17')]};const _0x1c4bda=jwt['sign'](_0xc7064a,configJwt[a11_0x16a6('0x18')],configJwt[a11_0x16a6('0x19')]);delete _0x538dc3[a11_0x16a6('0x15')];_0x538dc3[a11_0x16a6('0x1a')]=_0x1c4bda;return responseUtils[a11_0x16a6('0x1b')](_0x33f30b,_0x538dc3,0xc8);}else{return responseUtils[a11_0x16a6('0x12')](_0x33f30b,format(LocaleStrings[a11_0x16a6('0x1c')]),0x193);}})['catch'](_0x1374d6=>{return responseUtils[a11_0x16a6('0x12')](_0x33f30b,_0x1374d6[a11_0x16a6('0x1d')],0x1f4);});}[a11_0x16a6('0xb')](_0x1708a8,_0x5813ad,_0x4b10a3){this[a11_0x16a6('0x8')][a11_0x16a6('0xc')]({'where':{'username':_0x1708a8['body'][a11_0x16a6('0xe')]}})[a11_0x16a6('0x11')](_0x187176=>{if(_0x187176){return responseUtils[a11_0x16a6('0x12')](_0x5813ad,format(LocaleStrings[a11_0x16a6('0x1e')],_0x1708a8[a11_0x16a6('0xd')][a11_0x16a6('0xe')]),0x193);}else{_0x1708a8[a11_0x16a6('0xd')][a11_0x16a6('0x10')]=_0x1708a8['body'][a11_0x16a6('0xe')];const _0x3e84cc={'first_name':_0x1708a8[a11_0x16a6('0xd')][a11_0x16a6('0xf')],'last_name':_0x1708a8['body'][a11_0x16a6('0x1f')],'email':_0x1708a8[a11_0x16a6('0xd')][a11_0x16a6('0x10')],'username':_0x1708a8['body'][a11_0x16a6('0xe')],'password':authUtils[a11_0x16a6('0x20')](_0x1708a8[a11_0x16a6('0xd')][a11_0x16a6('0x15')])};this[a11_0x16a6('0x8')][a11_0x16a6('0x21')](_0x3e84cc)[a11_0x16a6('0x11')](function(_0x23b982,_0x39d9f6){delete _0x23b982['dataValues']['id'];delete _0x23b982['dataValues'][a11_0x16a6('0x22')];delete _0x23b982[a11_0x16a6('0x23')]['password'];delete _0x23b982[a11_0x16a6('0x23')][a11_0x16a6('0x24')];delete _0x23b982['dataValues']['created_at'];const _0x34d3de={'uuid':_0x23b982[a11_0x16a6('0x17')]};const _0x353200=jwt['sign'](_0x34d3de,configJwt['secret'],configJwt[a11_0x16a6('0x19')]);_0x23b982[a11_0x16a6('0x23')][a11_0x16a6('0x1a')]=_0x353200;return responseUtils[a11_0x16a6('0x1b')](_0x5813ad,_0x23b982,0xc8);})['catch'](_0x1d4da7=>{return responseUtils[a11_0x16a6('0x12')](_0x5813ad,_0x1d4da7[a11_0x16a6('0x1d')],0x1f4);});}})[a11_0x16a6('0x25')](_0x47fdcf=>{return responseUtils[a11_0x16a6('0x12')](_0x5813ad,_0x47fdcf[a11_0x16a6('0x1d')],0x1f4);});}}exports['default']=AuthenticationController;
var a11_0x2d9c=['email','password','errorResponse','usernameNotFoundError','validPassword','sign','successResponse','catch','stack','createAccount','then','generateHash','dataValues','status','updated_at','created_at','secret','options','token','default','defineProperty','jsonwebtoken','i18n','../../config/jwt.js','../../infrastructure/auth-utils','../../resources/locale-strings','string-format','model','login','bind','findOne','body','username','uuid','first_name'];(function(_0x414e05,_0x4b0126){var _0xc94ab6=function(_0x5622b4){while(--_0x5622b4){_0x414e05['push'](_0x414e05['shift']());}};_0xc94ab6(++_0x4b0126);}(a11_0x2d9c,0x12c));var a11_0x16ef=function(_0xdb95ad,_0x285cbf){_0xdb95ad=_0xdb95ad-0x0;var _0x2dbc6d=a11_0x2d9c[_0xdb95ad];return _0x2dbc6d;};'use strict';Object[a11_0x16ef('0x0')](exports,'__esModule',{'value':!![]});const jwt=require(a11_0x16ef('0x1'));const i18n=require(a11_0x16ef('0x2'));const configJwt=require(a11_0x16ef('0x3'));const authUtils=require(a11_0x16ef('0x4'));const responseUtils=require('../../infrastructure/response-utils');const LocaleStrings=require(a11_0x16ef('0x5'));const format=require(a11_0x16ef('0x6'));class AuthenticationController{constructor(_0x1befa1){this[a11_0x16ef('0x7')]=_0x1befa1;this[a11_0x16ef('0x8')]=this['login'][a11_0x16ef('0x9')](this);this['createAccount']=this['createAccount'][a11_0x16ef('0x9')](this);}[a11_0x16ef('0x8')](_0x203db2,_0x1cd1ac,_0x40ab3c){this[a11_0x16ef('0x7')][a11_0x16ef('0xa')]({'where':{'username':_0x203db2[a11_0x16ef('0xb')][a11_0x16ef('0xc')]},'attributes':[a11_0x16ef('0xd'),a11_0x16ef('0xe'),'last_name',a11_0x16ef('0xf'),a11_0x16ef('0xc'),a11_0x16ef('0x10')]})['then'](_0xfb8423=>{if(!_0xfb8423){return responseUtils[a11_0x16ef('0x11')](_0x1cd1ac,format(LocaleStrings[a11_0x16ef('0x12')],_0x203db2[a11_0x16ef('0xb')]['username']),0x193);}if(authUtils[a11_0x16ef('0x13')](_0x203db2[a11_0x16ef('0xb')][a11_0x16ef('0x10')],_0xfb8423[a11_0x16ef('0x10')])){_0xfb8423=_0xfb8423['toJSON']();const _0x390646={'uuid':_0xfb8423[a11_0x16ef('0xd')]};const _0x1386ee=jwt[a11_0x16ef('0x14')](_0x390646,configJwt['secret'],configJwt['options']);delete _0xfb8423[a11_0x16ef('0x10')];_0xfb8423['token']=_0x1386ee;return responseUtils[a11_0x16ef('0x15')](_0x1cd1ac,_0xfb8423,0xc8);}else{return responseUtils[a11_0x16ef('0x11')](_0x1cd1ac,format(LocaleStrings['passwordNotMatchError']),0x193);}})[a11_0x16ef('0x16')](_0x1eef05=>{return responseUtils[a11_0x16ef('0x11')](_0x1cd1ac,_0x1eef05[a11_0x16ef('0x17')],0x1f4);});}[a11_0x16ef('0x18')](_0x2fcc67,_0x4e8f8f,_0x196f34){this[a11_0x16ef('0x7')][a11_0x16ef('0xa')]({'where':{'username':_0x2fcc67[a11_0x16ef('0xb')]['username']}})[a11_0x16ef('0x19')](_0x3263fd=>{if(_0x3263fd){return responseUtils[a11_0x16ef('0x11')](_0x4e8f8f,format(LocaleStrings['usernameTakenError'],_0x2fcc67[a11_0x16ef('0xb')]['username']),0x193);}else{_0x2fcc67['body']['email']=_0x2fcc67[a11_0x16ef('0xb')][a11_0x16ef('0xc')];const _0x43e020={'first_name':_0x2fcc67[a11_0x16ef('0xb')][a11_0x16ef('0xe')],'last_name':_0x2fcc67['body']['last_name'],'email':_0x2fcc67[a11_0x16ef('0xb')][a11_0x16ef('0xf')],'username':_0x2fcc67[a11_0x16ef('0xb')][a11_0x16ef('0xc')],'password':authUtils[a11_0x16ef('0x1a')](_0x2fcc67[a11_0x16ef('0xb')][a11_0x16ef('0x10')])};this[a11_0x16ef('0x7')]['create'](_0x43e020)['then'](function(_0x337e2b,_0x144e19){delete _0x337e2b[a11_0x16ef('0x1b')]['id'];delete _0x337e2b[a11_0x16ef('0x1b')][a11_0x16ef('0x1c')];delete _0x337e2b[a11_0x16ef('0x1b')][a11_0x16ef('0x10')];delete _0x337e2b['dataValues'][a11_0x16ef('0x1d')];delete _0x337e2b[a11_0x16ef('0x1b')][a11_0x16ef('0x1e')];const _0x4bc1e7={'uuid':_0x337e2b[a11_0x16ef('0xd')]};const _0xccb3bf=jwt['sign'](_0x4bc1e7,configJwt[a11_0x16ef('0x1f')],configJwt[a11_0x16ef('0x20')]);_0x337e2b['dataValues'][a11_0x16ef('0x21')]=_0xccb3bf;return responseUtils[a11_0x16ef('0x15')](_0x4e8f8f,_0x337e2b,0xc8);})[a11_0x16ef('0x16')](_0x4d8d17=>{return responseUtils[a11_0x16ef('0x11')](_0x4e8f8f,_0x4d8d17['stack'],0x1f4);});}})[a11_0x16ef('0x16')](_0x35887d=>{return responseUtils[a11_0x16ef('0x11')](_0x4e8f8f,_0x35887d[a11_0x16ef('0x17')],0x1f4);});}}exports[a11_0x16ef('0x22')]=AuthenticationController;
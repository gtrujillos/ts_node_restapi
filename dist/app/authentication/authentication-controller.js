var a11_0x17e5=['../../config/jwt.js','../../infrastructure/auth-utils','../../infrastructure/response-utils','../../resources/locale-strings','string-format','model','login','bind','createAccount','findOne','body','username','uuid','first_name','password','errorResponse','validPassword','sign','secret','options','token','successResponse','catch','stack','then','usernameTakenError','email','generateHash','create','dataValues','status','default','defineProperty','__esModule','jsonwebtoken','i18n'];(function(_0x3cee2c,_0x4f2d37){var _0x168b6e=function(_0xbc1893){while(--_0xbc1893){_0x3cee2c['push'](_0x3cee2c['shift']());}};_0x168b6e(++_0x4f2d37);}(a11_0x17e5,0x140));var a11_0x1fcf=function(_0x3328e2,_0x53cce8){_0x3328e2=_0x3328e2-0x0;var _0x26223e=a11_0x17e5[_0x3328e2];return _0x26223e;};'use strict';Object[a11_0x1fcf('0x0')](exports,a11_0x1fcf('0x1'),{'value':!![]});const jwt=require(a11_0x1fcf('0x2'));const i18n=require(a11_0x1fcf('0x3'));const configJwt=require(a11_0x1fcf('0x4'));const authUtils=require(a11_0x1fcf('0x5'));const responseUtils=require(a11_0x1fcf('0x6'));const LocaleStrings=require(a11_0x1fcf('0x7'));const format=require(a11_0x1fcf('0x8'));class AuthenticationController{constructor(_0x4bf642){this[a11_0x1fcf('0x9')]=_0x4bf642;this[a11_0x1fcf('0xa')]=this[a11_0x1fcf('0xa')][a11_0x1fcf('0xb')](this);this[a11_0x1fcf('0xc')]=this['createAccount'][a11_0x1fcf('0xb')](this);}[a11_0x1fcf('0xa')](_0x1d6075,_0x85e4ca,_0x54d447){this[a11_0x1fcf('0x9')][a11_0x1fcf('0xd')]({'where':{'username':_0x1d6075[a11_0x1fcf('0xe')][a11_0x1fcf('0xf')]},'attributes':[a11_0x1fcf('0x10'),a11_0x1fcf('0x11'),'last_name','email',a11_0x1fcf('0xf'),a11_0x1fcf('0x12')]})['then'](_0x1409a1=>{if(!_0x1409a1){return responseUtils[a11_0x1fcf('0x13')](_0x85e4ca,format(LocaleStrings['usernameNotFoundError'],_0x1d6075[a11_0x1fcf('0xe')]['username']),0x193);}if(authUtils[a11_0x1fcf('0x14')](_0x1d6075[a11_0x1fcf('0xe')][a11_0x1fcf('0x12')],_0x1409a1[a11_0x1fcf('0x12')])){_0x1409a1=_0x1409a1['toJSON']();const _0x3e2709={'uuid':_0x1409a1[a11_0x1fcf('0x10')]};const _0x486225=jwt[a11_0x1fcf('0x15')](_0x3e2709,configJwt[a11_0x1fcf('0x16')],configJwt[a11_0x1fcf('0x17')]);delete _0x1409a1[a11_0x1fcf('0x12')];_0x1409a1[a11_0x1fcf('0x18')]=_0x486225;return responseUtils[a11_0x1fcf('0x19')](_0x85e4ca,_0x1409a1,0xc8);}else{return responseUtils[a11_0x1fcf('0x13')](_0x85e4ca,format(LocaleStrings['passwordNotMatchError']),0x193);}})[a11_0x1fcf('0x1a')](_0x5078c1=>{return responseUtils[a11_0x1fcf('0x13')](_0x85e4ca,_0x5078c1[a11_0x1fcf('0x1b')],0x1f4);});}[a11_0x1fcf('0xc')](_0x491061,_0x3a148f,_0x2ea4f5){this['model']['findOne']({'where':{'username':_0x491061[a11_0x1fcf('0xe')][a11_0x1fcf('0xf')]}})[a11_0x1fcf('0x1c')](_0x4f83ec=>{if(_0x4f83ec){return responseUtils['errorResponse'](_0x3a148f,format(LocaleStrings[a11_0x1fcf('0x1d')],_0x491061[a11_0x1fcf('0xe')][a11_0x1fcf('0xf')]),0x193);}else{_0x491061['body'][a11_0x1fcf('0x1e')]=_0x491061[a11_0x1fcf('0xe')][a11_0x1fcf('0xf')];const _0x28c7a2={'first_name':_0x491061[a11_0x1fcf('0xe')][a11_0x1fcf('0x11')],'last_name':_0x491061[a11_0x1fcf('0xe')]['last_name'],'email':_0x491061[a11_0x1fcf('0xe')]['email'],'username':_0x491061['body']['username'],'password':authUtils[a11_0x1fcf('0x1f')](_0x491061[a11_0x1fcf('0xe')]['password'])};this[a11_0x1fcf('0x9')][a11_0x1fcf('0x20')](_0x28c7a2)['then'](function(_0x29e44f,_0xfcf4d5){delete _0x29e44f[a11_0x1fcf('0x21')]['id'];delete _0x29e44f[a11_0x1fcf('0x21')][a11_0x1fcf('0x22')];delete _0x29e44f[a11_0x1fcf('0x21')]['password'];delete _0x29e44f[a11_0x1fcf('0x21')]['updated_at'];delete _0x29e44f[a11_0x1fcf('0x21')]['created_at'];const _0x206949={'uuid':_0x29e44f[a11_0x1fcf('0x10')]};const _0xa8c01b=jwt['sign'](_0x206949,configJwt[a11_0x1fcf('0x16')],configJwt[a11_0x1fcf('0x17')]);_0x29e44f[a11_0x1fcf('0x21')][a11_0x1fcf('0x18')]=_0xa8c01b;return responseUtils[a11_0x1fcf('0x19')](_0x3a148f,_0x29e44f,0xc8);})[a11_0x1fcf('0x1a')](_0x223c83=>{return responseUtils[a11_0x1fcf('0x13')](_0x3a148f,_0x223c83['stack'],0x1f4);});}})[a11_0x1fcf('0x1a')](_0x1b8fb1=>{return responseUtils['errorResponse'](_0x3a148f,_0x1b8fb1['stack'],0x1f4);});}}exports[a11_0x1fcf('0x23')]=AuthenticationController;
var a11_0x4346=['options','token','successResponse','passwordNotMatchError','catch','stack','generateHash','create','dataValues','status','default','defineProperty','__esModule','jsonwebtoken','i18n','../../config/jwt.js','../../infrastructure/auth-utils','../../infrastructure/response-utils','../../resources/locale-strings','string-format','login','bind','createAccount','model','findOne','body','username','uuid','first_name','last_name','email','password','then','errorResponse','usernameNotFoundError','validPassword','toJSON','sign'];(function(_0x519992,_0x1e5c1b){var _0x189f5e=function(_0x283790){while(--_0x283790){_0x519992['push'](_0x519992['shift']());}};_0x189f5e(++_0x1e5c1b);}(a11_0x4346,0x1ad));var a11_0x2cd5=function(_0x521811,_0x43153e){_0x521811=_0x521811-0x0;var _0x17fa1e=a11_0x4346[_0x521811];return _0x17fa1e;};'use strict';Object[a11_0x2cd5('0x0')](exports,a11_0x2cd5('0x1'),{'value':!![]});const jwt=require(a11_0x2cd5('0x2'));const i18n=require(a11_0x2cd5('0x3'));const configJwt=require(a11_0x2cd5('0x4'));const authUtils=require(a11_0x2cd5('0x5'));const responseUtils=require(a11_0x2cd5('0x6'));const LocaleStrings=require(a11_0x2cd5('0x7'));const format=require(a11_0x2cd5('0x8'));class AuthenticationController{constructor(_0x509cd3){this['model']=_0x509cd3;this['login']=this[a11_0x2cd5('0x9')][a11_0x2cd5('0xa')](this);this['createAccount']=this[a11_0x2cd5('0xb')][a11_0x2cd5('0xa')](this);}['login'](_0x4b2b4e,_0x22aacc,_0x3a9c2e){this[a11_0x2cd5('0xc')][a11_0x2cd5('0xd')]({'where':{'username':_0x4b2b4e[a11_0x2cd5('0xe')][a11_0x2cd5('0xf')]},'attributes':[a11_0x2cd5('0x10'),a11_0x2cd5('0x11'),a11_0x2cd5('0x12'),a11_0x2cd5('0x13'),a11_0x2cd5('0xf'),a11_0x2cd5('0x14')]})[a11_0x2cd5('0x15')](_0x49ef5a=>{if(!_0x49ef5a){return responseUtils[a11_0x2cd5('0x16')](_0x22aacc,format(LocaleStrings[a11_0x2cd5('0x17')],_0x4b2b4e[a11_0x2cd5('0xe')][a11_0x2cd5('0xf')]),0x193);}if(authUtils[a11_0x2cd5('0x18')](_0x4b2b4e[a11_0x2cd5('0xe')][a11_0x2cd5('0x14')],_0x49ef5a[a11_0x2cd5('0x14')])){_0x49ef5a=_0x49ef5a[a11_0x2cd5('0x19')]();const _0x3f19c6={'uuid':_0x49ef5a['uuid']};const _0x376650=jwt[a11_0x2cd5('0x1a')](_0x3f19c6,configJwt['secret'],configJwt[a11_0x2cd5('0x1b')]);delete _0x49ef5a[a11_0x2cd5('0x14')];_0x49ef5a[a11_0x2cd5('0x1c')]=_0x376650;return responseUtils[a11_0x2cd5('0x1d')](_0x22aacc,_0x49ef5a,0xc8);}else{return responseUtils[a11_0x2cd5('0x16')](_0x22aacc,format(LocaleStrings[a11_0x2cd5('0x1e')]),0x193);}})[a11_0x2cd5('0x1f')](_0x4c96da=>{return responseUtils['errorResponse'](_0x22aacc,_0x4c96da[a11_0x2cd5('0x20')],0x1f4);});}[a11_0x2cd5('0xb')](_0x99f567,_0x3e53f0,_0x5c09d5){this[a11_0x2cd5('0xc')]['findOne']({'where':{'username':_0x99f567[a11_0x2cd5('0xe')][a11_0x2cd5('0xf')]}})[a11_0x2cd5('0x15')](_0x4fe701=>{if(_0x4fe701){return responseUtils[a11_0x2cd5('0x16')](_0x3e53f0,format(LocaleStrings['usernameTakenError'],_0x99f567['body'][a11_0x2cd5('0xf')]),0x193);}else{_0x99f567[a11_0x2cd5('0xe')][a11_0x2cd5('0x13')]=_0x99f567[a11_0x2cd5('0xe')][a11_0x2cd5('0xf')];const _0x12783d={'first_name':_0x99f567['body']['first_name'],'last_name':_0x99f567[a11_0x2cd5('0xe')][a11_0x2cd5('0x12')],'email':_0x99f567['body'][a11_0x2cd5('0x13')],'username':_0x99f567['body'][a11_0x2cd5('0xf')],'password':authUtils[a11_0x2cd5('0x21')](_0x99f567['body'][a11_0x2cd5('0x14')])};this[a11_0x2cd5('0xc')][a11_0x2cd5('0x22')](_0x12783d)[a11_0x2cd5('0x15')](function(_0x377ed5,_0x12c4d6){delete _0x377ed5[a11_0x2cd5('0x23')]['id'];delete _0x377ed5['dataValues'][a11_0x2cd5('0x24')];delete _0x377ed5[a11_0x2cd5('0x23')][a11_0x2cd5('0x14')];delete _0x377ed5[a11_0x2cd5('0x23')]['updated_at'];delete _0x377ed5[a11_0x2cd5('0x23')]['created_at'];const _0x463812={'uuid':_0x377ed5['uuid']};const _0x4326b2=jwt[a11_0x2cd5('0x1a')](_0x463812,configJwt['secret'],configJwt['options']);_0x377ed5['dataValues'][a11_0x2cd5('0x1c')]=_0x4326b2;return responseUtils[a11_0x2cd5('0x1d')](_0x3e53f0,_0x377ed5,0xc8);})['catch'](_0x3edd77=>{return responseUtils['errorResponse'](_0x3e53f0,_0x3edd77[a11_0x2cd5('0x20')],0x1f4);});}})[a11_0x2cd5('0x1f')](_0x3d1b50=>{return responseUtils[a11_0x2cd5('0x16')](_0x3e53f0,_0x3d1b50[a11_0x2cd5('0x20')],0x1f4);});}}exports[a11_0x2cd5('0x25')]=AuthenticationController;
var a11_0x1b97=['catch','defineProperty','__esModule','../../config/jwt.js','../../infrastructure/response-utils','../../resources/locale-strings','string-format','login','bind','createAccount','model','findOne','body','username','uuid','first_name','last_name','email','password','then','errorResponse','usernameNotFoundError','validPassword','sign','options','successResponse','usernameTakenError','generateHash','create','dataValues','status','updated_at','created_at','secret'];(function(_0x3cdd5b,_0x2bad75){var _0x54bbeb=function(_0x1a595d){while(--_0x1a595d){_0x3cdd5b['push'](_0x3cdd5b['shift']());}};_0x54bbeb(++_0x2bad75);}(a11_0x1b97,0x1bb));var a11_0x32ff=function(_0x189622,_0x3ce45b){_0x189622=_0x189622-0x0;var _0x452bed=a11_0x1b97[_0x189622];return _0x452bed;};'use strict';Object[a11_0x32ff('0x0')](exports,a11_0x32ff('0x1'),{'value':!![]});const jwt=require('jsonwebtoken');const i18n=require('i18n');const configJwt=require(a11_0x32ff('0x2'));const authUtils=require('../../infrastructure/auth-utils');const responseUtils=require(a11_0x32ff('0x3'));const LocaleStrings=require(a11_0x32ff('0x4'));const format=require(a11_0x32ff('0x5'));class AuthenticationController{constructor(_0x4b4add){this['model']=_0x4b4add;this[a11_0x32ff('0x6')]=this[a11_0x32ff('0x6')][a11_0x32ff('0x7')](this);this['createAccount']=this[a11_0x32ff('0x8')][a11_0x32ff('0x7')](this);}[a11_0x32ff('0x6')](_0x59bf0c,_0x301958,_0x2914fa){this[a11_0x32ff('0x9')][a11_0x32ff('0xa')]({'where':{'username':_0x59bf0c[a11_0x32ff('0xb')][a11_0x32ff('0xc')]},'attributes':[a11_0x32ff('0xd'),a11_0x32ff('0xe'),a11_0x32ff('0xf'),a11_0x32ff('0x10'),a11_0x32ff('0xc'),a11_0x32ff('0x11')]})[a11_0x32ff('0x12')](_0x4bf7aa=>{if(!_0x4bf7aa){return responseUtils[a11_0x32ff('0x13')](_0x301958,format(LocaleStrings[a11_0x32ff('0x14')],_0x59bf0c[a11_0x32ff('0xb')]['username']),0x193);}if(authUtils[a11_0x32ff('0x15')](_0x59bf0c[a11_0x32ff('0xb')][a11_0x32ff('0x11')],_0x4bf7aa[a11_0x32ff('0x11')])){_0x4bf7aa=_0x4bf7aa['toJSON']();const _0x2f104f={'uuid':_0x4bf7aa[a11_0x32ff('0xd')]};const _0x51d337=jwt[a11_0x32ff('0x16')](_0x2f104f,configJwt['secret'],configJwt[a11_0x32ff('0x17')]);delete _0x4bf7aa[a11_0x32ff('0x11')];_0x4bf7aa['token']=_0x51d337;return responseUtils[a11_0x32ff('0x18')](_0x301958,_0x4bf7aa,0xc8);}else{return responseUtils[a11_0x32ff('0x13')](_0x301958,format(LocaleStrings['passwordNotMatchError']),0x193);}})['catch'](_0x107826=>{return responseUtils[a11_0x32ff('0x13')](_0x301958,_0x107826['stack'],0x1f4);});}['createAccount'](_0x118bbe,_0x3050bd,_0x3c3ff1){this['model']['findOne']({'where':{'username':_0x118bbe[a11_0x32ff('0xb')][a11_0x32ff('0xc')]}})[a11_0x32ff('0x12')](_0x37fbb1=>{if(_0x37fbb1){return responseUtils[a11_0x32ff('0x13')](_0x3050bd,format(LocaleStrings[a11_0x32ff('0x19')],_0x118bbe[a11_0x32ff('0xb')][a11_0x32ff('0xc')]),0x193);}else{_0x118bbe[a11_0x32ff('0xb')][a11_0x32ff('0x10')]=_0x118bbe[a11_0x32ff('0xb')][a11_0x32ff('0xc')];const _0x4d3570={'first_name':_0x118bbe[a11_0x32ff('0xb')][a11_0x32ff('0xe')],'last_name':_0x118bbe[a11_0x32ff('0xb')][a11_0x32ff('0xf')],'email':_0x118bbe[a11_0x32ff('0xb')]['email'],'username':_0x118bbe[a11_0x32ff('0xb')][a11_0x32ff('0xc')],'password':authUtils[a11_0x32ff('0x1a')](_0x118bbe[a11_0x32ff('0xb')]['password'])};this['model'][a11_0x32ff('0x1b')](_0x4d3570)[a11_0x32ff('0x12')](function(_0x348b38,_0x15f207){delete _0x348b38[a11_0x32ff('0x1c')]['id'];delete _0x348b38[a11_0x32ff('0x1c')][a11_0x32ff('0x1d')];delete _0x348b38[a11_0x32ff('0x1c')]['password'];delete _0x348b38[a11_0x32ff('0x1c')][a11_0x32ff('0x1e')];delete _0x348b38[a11_0x32ff('0x1c')][a11_0x32ff('0x1f')];const _0x59edc9={'uuid':_0x348b38['uuid']};const _0x24e821=jwt[a11_0x32ff('0x16')](_0x59edc9,configJwt[a11_0x32ff('0x20')],configJwt[a11_0x32ff('0x17')]);_0x348b38[a11_0x32ff('0x1c')]['token']=_0x24e821;return responseUtils[a11_0x32ff('0x18')](_0x3050bd,_0x348b38,0xc8);})['catch'](_0x26d0fa=>{return responseUtils['errorResponse'](_0x3050bd,_0x26d0fa['stack'],0x1f4);});}})[a11_0x32ff('0x21')](_0x39be5f=>{return responseUtils[a11_0x32ff('0x13')](_0x3050bd,_0x39be5f['stack'],0x1f4);});}}exports['default']=AuthenticationController;
var a11_0x6a2b=['default','defineProperty','__esModule','jsonwebtoken','i18n','../../infrastructure/auth-utils','../../infrastructure/response-utils','../../resources/locale-strings','model','login','bind','createAccount','body','username','uuid','first_name','last_name','email','password','then','usernameNotFoundError','validPassword','toJSON','sign','secret','options','successResponse','errorResponse','passwordNotMatchError','stack','findOne','usernameTakenError','generateHash','dataValues','status','updated_at','created_at','token','catch'];(function(_0x29555c,_0x1cbfc0){var _0x240607=function(_0x2a7ab7){while(--_0x2a7ab7){_0x29555c['push'](_0x29555c['shift']());}};_0x240607(++_0x1cbfc0);}(a11_0x6a2b,0x1ae));var a11_0xd6a1=function(_0x32094f,_0x422d78){_0x32094f=_0x32094f-0x0;var _0x662e03=a11_0x6a2b[_0x32094f];return _0x662e03;};'use strict';Object[a11_0xd6a1('0x0')](exports,a11_0xd6a1('0x1'),{'value':!![]});const jwt=require(a11_0xd6a1('0x2'));const i18n=require(a11_0xd6a1('0x3'));const configJwt=require('../../config/jwt.js');const authUtils=require(a11_0xd6a1('0x4'));const responseUtils=require(a11_0xd6a1('0x5'));const LocaleStrings=require(a11_0xd6a1('0x6'));const format=require('string-format');class AuthenticationController{constructor(_0x219fd0){this[a11_0xd6a1('0x7')]=_0x219fd0;this[a11_0xd6a1('0x8')]=this['login'][a11_0xd6a1('0x9')](this);this[a11_0xd6a1('0xa')]=this[a11_0xd6a1('0xa')][a11_0xd6a1('0x9')](this);}[a11_0xd6a1('0x8')](_0x44ea45,_0x3ba494,_0x5bc1c9){this[a11_0xd6a1('0x7')]['findOne']({'where':{'username':_0x44ea45[a11_0xd6a1('0xb')][a11_0xd6a1('0xc')]},'attributes':[a11_0xd6a1('0xd'),a11_0xd6a1('0xe'),a11_0xd6a1('0xf'),a11_0xd6a1('0x10'),'username',a11_0xd6a1('0x11')]})[a11_0xd6a1('0x12')](_0x43f997=>{if(!_0x43f997){return responseUtils['errorResponse'](_0x3ba494,format(LocaleStrings[a11_0xd6a1('0x13')],_0x44ea45[a11_0xd6a1('0xb')][a11_0xd6a1('0xc')]),0x193);}if(authUtils[a11_0xd6a1('0x14')](_0x44ea45[a11_0xd6a1('0xb')][a11_0xd6a1('0x11')],_0x43f997[a11_0xd6a1('0x11')])){_0x43f997=_0x43f997[a11_0xd6a1('0x15')]();const _0x3d62c2={'uuid':_0x43f997[a11_0xd6a1('0xd')]};const _0x1bd1d2=jwt[a11_0xd6a1('0x16')](_0x3d62c2,configJwt[a11_0xd6a1('0x17')],configJwt[a11_0xd6a1('0x18')]);delete _0x43f997[a11_0xd6a1('0x11')];_0x43f997['token']=_0x1bd1d2;return responseUtils[a11_0xd6a1('0x19')](_0x3ba494,_0x43f997,0xc8);}else{return responseUtils[a11_0xd6a1('0x1a')](_0x3ba494,format(LocaleStrings[a11_0xd6a1('0x1b')]),0x193);}})['catch'](_0x329de3=>{return responseUtils[a11_0xd6a1('0x1a')](_0x3ba494,_0x329de3[a11_0xd6a1('0x1c')],0x1f4);});}['createAccount'](_0x4ce6d0,_0x15e798,_0x3cc6cb){this[a11_0xd6a1('0x7')][a11_0xd6a1('0x1d')]({'where':{'username':_0x4ce6d0['body']['username']}})[a11_0xd6a1('0x12')](_0x207a50=>{if(_0x207a50){return responseUtils['errorResponse'](_0x15e798,format(LocaleStrings[a11_0xd6a1('0x1e')],_0x4ce6d0[a11_0xd6a1('0xb')][a11_0xd6a1('0xc')]),0x193);}else{_0x4ce6d0[a11_0xd6a1('0xb')][a11_0xd6a1('0x10')]=_0x4ce6d0[a11_0xd6a1('0xb')][a11_0xd6a1('0xc')];const _0x15b172={'first_name':_0x4ce6d0[a11_0xd6a1('0xb')][a11_0xd6a1('0xe')],'last_name':_0x4ce6d0['body'][a11_0xd6a1('0xf')],'email':_0x4ce6d0['body'][a11_0xd6a1('0x10')],'username':_0x4ce6d0['body'][a11_0xd6a1('0xc')],'password':authUtils[a11_0xd6a1('0x1f')](_0x4ce6d0[a11_0xd6a1('0xb')][a11_0xd6a1('0x11')])};this[a11_0xd6a1('0x7')]['create'](_0x15b172)[a11_0xd6a1('0x12')](function(_0x11fc6f,_0x286f61){delete _0x11fc6f[a11_0xd6a1('0x20')]['id'];delete _0x11fc6f[a11_0xd6a1('0x20')][a11_0xd6a1('0x21')];delete _0x11fc6f[a11_0xd6a1('0x20')]['password'];delete _0x11fc6f[a11_0xd6a1('0x20')][a11_0xd6a1('0x22')];delete _0x11fc6f[a11_0xd6a1('0x20')][a11_0xd6a1('0x23')];const _0x1e6b76={'uuid':_0x11fc6f['uuid']};const _0xf55a54=jwt['sign'](_0x1e6b76,configJwt[a11_0xd6a1('0x17')],configJwt[a11_0xd6a1('0x18')]);_0x11fc6f[a11_0xd6a1('0x20')][a11_0xd6a1('0x24')]=_0xf55a54;return responseUtils[a11_0xd6a1('0x19')](_0x15e798,_0x11fc6f,0xc8);})[a11_0xd6a1('0x25')](_0x21e720=>{return responseUtils[a11_0xd6a1('0x1a')](_0x15e798,_0x21e720[a11_0xd6a1('0x1c')],0x1f4);});}})['catch'](_0x5a0710=>{return responseUtils['errorResponse'](_0x15e798,_0x5a0710['stack'],0x1f4);});}}exports[a11_0xd6a1('0x26')]=AuthenticationController;
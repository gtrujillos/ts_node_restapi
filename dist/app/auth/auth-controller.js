var a9_0x3fcb=['errorResponse','passwordNotMatchError','stack','findOne','usernameTakenError','email','catch','default','__esModule','jsonwebtoken','i18n','../../config/jwt.js','../../infrastructure/auth-utils','model','login','bind','createAccount','username','first_name','password','then','usernameNotFoundError','validPassword','body','toJSON','sign','secret','token','successResponse'];(function(_0x46db15,_0xa90001){var _0x41556a=function(_0x236bfa){while(--_0x236bfa){_0x46db15['push'](_0x46db15['shift']());}};_0x41556a(++_0xa90001);}(a9_0x3fcb,0x12a));var a9_0x6e59=function(_0x454f08,_0x1fefa3){_0x454f08=_0x454f08-0x0;var _0x1f37f3=a9_0x3fcb[_0x454f08];return _0x1f37f3;};'use strict';Object['defineProperty'](exports,a9_0x6e59('0x0'),{'value':!![]});const jwt=require(a9_0x6e59('0x1'));const i18n=require(a9_0x6e59('0x2'));const configJwt=require(a9_0x6e59('0x3'));const authUtils=require(a9_0x6e59('0x4'));const responseUtils=require('../../infrastructure/response-utils');const LocaleStrings=require('../../resources/locale-strings');class AuthConstroller{constructor(_0x55c7cb){this[a9_0x6e59('0x5')]=_0x55c7cb;this[a9_0x6e59('0x6')]=this['login'][a9_0x6e59('0x7')](this);this[a9_0x6e59('0x8')]=this['createAccount'][a9_0x6e59('0x7')](this);}[a9_0x6e59('0x6')](_0x38c60d,_0x147e75,_0x2230a2){this[a9_0x6e59('0x5')]['findOne']({'where':{'username':_0x38c60d['body'][a9_0x6e59('0x9')]},'attributes':['id',a9_0x6e59('0xa'),'last_name','email',a9_0x6e59('0x9'),a9_0x6e59('0xb')]})[a9_0x6e59('0xc')](_0x5745ba=>{if(!_0x5745ba){return responseUtils['errorResponse'](_0x147e75,LocaleStrings[a9_0x6e59('0xd')],0x193);}if(authUtils[a9_0x6e59('0xe')](_0x38c60d[a9_0x6e59('0xf')][a9_0x6e59('0xb')],_0x5745ba[a9_0x6e59('0xb')])){_0x5745ba=_0x5745ba[a9_0x6e59('0x10')]();const _0x1b7dd3={'id':_0x5745ba['id']};const _0x432062=jwt[a9_0x6e59('0x11')](_0x1b7dd3,configJwt[a9_0x6e59('0x12')]);delete _0x5745ba[a9_0x6e59('0xb')];_0x5745ba[a9_0x6e59('0x13')]=_0x432062;return responseUtils[a9_0x6e59('0x14')](_0x147e75,_0x5745ba,0xc8);}else{return responseUtils[a9_0x6e59('0x15')](_0x147e75,_0x147e75['__'](LocaleStrings[a9_0x6e59('0x16')]),0x193);}})['catch'](_0x28b218=>{return responseUtils[a9_0x6e59('0x15')](_0x147e75,_0x28b218[a9_0x6e59('0x17')],0x1f4);});}['createAccount'](_0x10a6e3,_0x5bc3f7,_0x10ef02){this[a9_0x6e59('0x5')][a9_0x6e59('0x18')]({'where':{'username':_0x10a6e3[a9_0x6e59('0xf')][a9_0x6e59('0x9')]}})[a9_0x6e59('0xc')](function(_0x6b8d10){if(_0x6b8d10){return responseUtils[a9_0x6e59('0x15')](_0x5bc3f7,_0x5bc3f7['__'](LocaleStrings[a9_0x6e59('0x19')],_0x10a6e3['body'][a9_0x6e59('0x9')]),0x193);}else{_0x10a6e3[a9_0x6e59('0xf')][a9_0x6e59('0x1a')]=_0x10a6e3[a9_0x6e59('0xf')]['username'];const _0x35e80b={'username':_0x10a6e3[a9_0x6e59('0xf')]['username'],'password':authUtils['generateHash'](_0x10a6e3['body'][a9_0x6e59('0xb')])};this[a9_0x6e59('0x5')]['create'](_0x35e80b)[a9_0x6e59('0xc')](function(_0x259fdb,_0x257999){return responseUtils[a9_0x6e59('0x14')](_0x5bc3f7,_0x259fdb,0xc8);})[a9_0x6e59('0x1b')](_0x33b627=>{return responseUtils[a9_0x6e59('0x15')](_0x5bc3f7,_0x33b627[a9_0x6e59('0x17')],0x1f4);});}})[a9_0x6e59('0x1b')](_0x72425d=>{return responseUtils[a9_0x6e59('0x15')](_0x5bc3f7,_0x72425d[a9_0x6e59('0x17')],0x1f4);});}}exports[a9_0x6e59('0x1c')]=AuthConstroller;
var a9_0x2c5d=['../../infrastructure/auth-utils','model','login','bind','createAccount','findOne','body','username','email','then','errorResponse','usernameNotFoundError','validPassword','password','toJSON','sign','secret','successResponse','stack','usernameTakenError','generateHash','create','catch','default','defineProperty','jsonwebtoken','i18n','../../config/jwt.js'];(function(_0x3f78f7,_0x2c0abd){var _0x4cb58c=function(_0x404f8d){while(--_0x404f8d){_0x3f78f7['push'](_0x3f78f7['shift']());}};_0x4cb58c(++_0x2c0abd);}(a9_0x2c5d,0x130));var a9_0x258f=function(_0x42e52d,_0x4db906){_0x42e52d=_0x42e52d-0x0;var _0x1431fd=a9_0x2c5d[_0x42e52d];return _0x1431fd;};'use strict';Object[a9_0x258f('0x0')](exports,'__esModule',{'value':!![]});const jwt=require(a9_0x258f('0x1'));const i18n=require(a9_0x258f('0x2'));const configJwt=require(a9_0x258f('0x3'));const authUtils=require(a9_0x258f('0x4'));const responseUtils=require('../../infrastructure/response-utils');const LocaleStrings=require('../../resources/locale-strings');class AuthConstroller{constructor(_0x2cc26c){this[a9_0x258f('0x5')]=_0x2cc26c;this['login']=this[a9_0x258f('0x6')][a9_0x258f('0x7')](this);this['createAccount']=this[a9_0x258f('0x8')]['bind'](this);}['login'](_0x569ca5,_0x3e0fe4,_0x5d9b93){this['model'][a9_0x258f('0x9')]({'where':{'username':_0x569ca5[a9_0x258f('0xa')][a9_0x258f('0xb')]},'attributes':['id','first_name','last_name',a9_0x258f('0xc'),'username','password']})[a9_0x258f('0xd')](_0xce6f15=>{if(!_0xce6f15){return responseUtils[a9_0x258f('0xe')](_0x3e0fe4,LocaleStrings[a9_0x258f('0xf')],0x193);}if(authUtils[a9_0x258f('0x10')](_0x569ca5[a9_0x258f('0xa')][a9_0x258f('0x11')],_0xce6f15[a9_0x258f('0x11')])){_0xce6f15=_0xce6f15[a9_0x258f('0x12')]();const _0x643761={'id':_0xce6f15['id']};const _0x18421d=jwt[a9_0x258f('0x13')](_0x643761,configJwt[a9_0x258f('0x14')]);delete _0xce6f15[a9_0x258f('0x11')];_0xce6f15['token']=_0x18421d;return responseUtils[a9_0x258f('0x15')](_0x3e0fe4,_0xce6f15,0xc8);}else{return responseUtils[a9_0x258f('0xe')](_0x3e0fe4,_0x3e0fe4['__'](LocaleStrings['passwordNotMatchError']),0x193);}})['catch'](_0x5cbfb7=>{return responseUtils[a9_0x258f('0xe')](_0x3e0fe4,_0x5cbfb7[a9_0x258f('0x16')],0x1f4);});}['createAccount'](_0x17d259,_0x4db937,_0x4b3073){this[a9_0x258f('0x5')][a9_0x258f('0x9')]({'where':{'username':_0x17d259[a9_0x258f('0xa')]['username']}})['then'](function(_0x52d2cc){if(_0x52d2cc){return responseUtils[a9_0x258f('0xe')](_0x4db937,_0x4db937['__'](LocaleStrings[a9_0x258f('0x17')],_0x17d259[a9_0x258f('0xa')][a9_0x258f('0xb')]),0x193);}else{_0x17d259[a9_0x258f('0xa')][a9_0x258f('0xc')]=_0x17d259[a9_0x258f('0xa')][a9_0x258f('0xb')];const _0x1a9862={'username':_0x17d259[a9_0x258f('0xa')][a9_0x258f('0xb')],'password':authUtils[a9_0x258f('0x18')](_0x17d259[a9_0x258f('0xa')]['password'])};this[a9_0x258f('0x5')][a9_0x258f('0x19')](_0x1a9862)[a9_0x258f('0xd')](function(_0x29c0f6,_0x57156c){return responseUtils['successResponse'](_0x4db937,_0x29c0f6,0xc8);})[a9_0x258f('0x1a')](_0x462cb6=>{return responseUtils[a9_0x258f('0xe')](_0x4db937,_0x462cb6[a9_0x258f('0x16')],0x1f4);});}})[a9_0x258f('0x1a')](_0x51fc0d=>{return responseUtils[a9_0x258f('0xe')](_0x4db937,_0x51fc0d[a9_0x258f('0x16')],0x1f4);});}}exports[a9_0x258f('0x1b')]=AuthConstroller;
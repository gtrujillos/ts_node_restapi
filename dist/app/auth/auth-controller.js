var a9_0x5b2f=['password','then','usernameNotFoundError','validPassword','body','toJSON','sign','secret','successResponse','passwordNotMatchError','errorResponse','stack','findOne','usernameTakenError','generateHash','create','catch','defineProperty','__esModule','jsonwebtoken','i18n','../../infrastructure/auth-utils','model','login','createAccount','username','first_name','last_name','email'];(function(_0x38ddae,_0x43a454){var _0x55fbe5=function(_0x2a7939){while(--_0x2a7939){_0x38ddae['push'](_0x38ddae['shift']());}};_0x55fbe5(++_0x43a454);}(a9_0x5b2f,0x1a7));var a9_0x5438=function(_0x20fbbf,_0x4bf985){_0x20fbbf=_0x20fbbf-0x0;var _0x4d8022=a9_0x5b2f[_0x20fbbf];return _0x4d8022;};'use strict';Object[a9_0x5438('0x0')](exports,a9_0x5438('0x1'),{'value':!![]});const jwt=require(a9_0x5438('0x2'));const i18n=require(a9_0x5438('0x3'));const configJwt=require('../../config/jwt.js');const authUtils=require(a9_0x5438('0x4'));const responseUtils=require('../../infrastructure/response-utils');const LocaleStrings=require('../../resources/locale-strings');class AuthConstroller{constructor(_0xc8e4fb){this[a9_0x5438('0x5')]=_0xc8e4fb;this[a9_0x5438('0x6')]=this[a9_0x5438('0x6')]['bind'](this);this[a9_0x5438('0x7')]=this['createAccount']['bind'](this);}[a9_0x5438('0x6')](_0x2e0603,_0x46ffbe,_0x25ca85){this[a9_0x5438('0x5')]['findOne']({'where':{'username':_0x2e0603['body'][a9_0x5438('0x8')]},'attributes':['id',a9_0x5438('0x9'),a9_0x5438('0xa'),a9_0x5438('0xb'),'username',a9_0x5438('0xc')]})[a9_0x5438('0xd')](_0x24bd4d=>{if(!_0x24bd4d){return responseUtils['errorResponse'](_0x46ffbe,LocaleStrings[a9_0x5438('0xe')],0x193);}if(authUtils[a9_0x5438('0xf')](_0x2e0603[a9_0x5438('0x10')][a9_0x5438('0xc')],_0x24bd4d[a9_0x5438('0xc')])){_0x24bd4d=_0x24bd4d[a9_0x5438('0x11')]();const _0x53e603={'id':_0x24bd4d['id']};const _0x29872d=jwt[a9_0x5438('0x12')](_0x53e603,configJwt[a9_0x5438('0x13')]);delete _0x24bd4d[a9_0x5438('0xc')];_0x24bd4d['token']=_0x29872d;return responseUtils[a9_0x5438('0x14')](_0x46ffbe,_0x24bd4d,0xc8);}else{return responseUtils['errorResponse'](_0x46ffbe,_0x46ffbe['__'](LocaleStrings[a9_0x5438('0x15')]),0x193);}})['catch'](_0xbe57b0=>{return responseUtils[a9_0x5438('0x16')](_0x46ffbe,_0xbe57b0[a9_0x5438('0x17')],0x1f4);});}['createAccount'](_0x43eae8,_0x2fc8d8,_0x351eff){this['model'][a9_0x5438('0x18')]({'where':{'username':_0x43eae8['body'][a9_0x5438('0x8')]}})[a9_0x5438('0xd')](function(_0x4b0ed4){if(_0x4b0ed4){return responseUtils[a9_0x5438('0x16')](_0x2fc8d8,_0x2fc8d8['__'](LocaleStrings[a9_0x5438('0x19')],_0x43eae8[a9_0x5438('0x10')][a9_0x5438('0x8')]),0x193);}else{_0x43eae8[a9_0x5438('0x10')][a9_0x5438('0xb')]=_0x43eae8[a9_0x5438('0x10')][a9_0x5438('0x8')];const _0x113a58={'username':_0x43eae8[a9_0x5438('0x10')][a9_0x5438('0x8')],'password':authUtils[a9_0x5438('0x1a')](_0x43eae8[a9_0x5438('0x10')]['password'])};this[a9_0x5438('0x5')][a9_0x5438('0x1b')](_0x113a58)[a9_0x5438('0xd')](function(_0x23405c,_0x5eaac0){return responseUtils[a9_0x5438('0x14')](_0x2fc8d8,_0x23405c,0xc8);})['catch'](_0x227be6=>{return responseUtils['errorResponse'](_0x2fc8d8,_0x227be6[a9_0x5438('0x17')],0x1f4);});}})[a9_0x5438('0x1c')](_0x12ce5a=>{return responseUtils[a9_0x5438('0x16')](_0x2fc8d8,_0x12ce5a[a9_0x5438('0x17')],0x1f4);});}}exports['default']=AuthConstroller;
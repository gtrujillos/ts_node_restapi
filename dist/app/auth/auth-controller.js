var a9_0x1d9c=['create','__esModule','jsonwebtoken','i18n','../../config/jwt.js','../../infrastructure/auth-utils','../../resources/locale-strings','model','login','bind','createAccount','body','username','first_name','password','then','errorResponse','usernameNotFoundError','validPassword','sign','secret','successResponse','passwordNotMatchError','catch','stack','findOne','usernameTakenError','email','generateHash'];(function(_0x4983e6,_0x6b44e7){var _0x171962=function(_0x5dd471){while(--_0x5dd471){_0x4983e6['push'](_0x4983e6['shift']());}};_0x171962(++_0x6b44e7);}(a9_0x1d9c,0x1d1));var a9_0x4938=function(_0x1a3670,_0x112df6){_0x1a3670=_0x1a3670-0x0;var _0x130642=a9_0x1d9c[_0x1a3670];return _0x130642;};'use strict';Object['defineProperty'](exports,a9_0x4938('0x0'),{'value':!![]});const jwt=require(a9_0x4938('0x1'));const i18n=require(a9_0x4938('0x2'));const configJwt=require(a9_0x4938('0x3'));const authUtils=require(a9_0x4938('0x4'));const responseUtils=require('../../infrastructure/response-utils');const LocaleStrings=require(a9_0x4938('0x5'));class AuthConstroller{constructor(_0x26f9e2){this[a9_0x4938('0x6')]=_0x26f9e2;this[a9_0x4938('0x7')]=this[a9_0x4938('0x7')][a9_0x4938('0x8')](this);this['createAccount']=this[a9_0x4938('0x9')]['bind'](this);}['login'](_0x296651,_0x1e1b3f,_0x5f062a){this['model']['findOne']({'where':{'username':_0x296651[a9_0x4938('0xa')][a9_0x4938('0xb')]},'attributes':['id',a9_0x4938('0xc'),'last_name','email',a9_0x4938('0xb'),a9_0x4938('0xd')]})[a9_0x4938('0xe')](_0x4cf0d1=>{if(!_0x4cf0d1){return responseUtils[a9_0x4938('0xf')](_0x1e1b3f,LocaleStrings[a9_0x4938('0x10')],0x193);}if(authUtils[a9_0x4938('0x11')](_0x296651[a9_0x4938('0xa')][a9_0x4938('0xd')],_0x4cf0d1[a9_0x4938('0xd')])){_0x4cf0d1=_0x4cf0d1['toJSON']();const _0x3d8b79={'id':_0x4cf0d1['id']};const _0x45790f=jwt[a9_0x4938('0x12')](_0x3d8b79,configJwt[a9_0x4938('0x13')]);delete _0x4cf0d1[a9_0x4938('0xd')];_0x4cf0d1['token']=_0x45790f;return responseUtils[a9_0x4938('0x14')](_0x1e1b3f,_0x4cf0d1,0xc8);}else{return responseUtils['errorResponse'](_0x1e1b3f,_0x1e1b3f['__'](LocaleStrings[a9_0x4938('0x15')]),0x193);}})[a9_0x4938('0x16')](_0x415bd8=>{return responseUtils[a9_0x4938('0xf')](_0x1e1b3f,_0x415bd8[a9_0x4938('0x17')],0x1f4);});}[a9_0x4938('0x9')](_0xd77afb,_0x1fc63d,_0x3b1ae0){this['model'][a9_0x4938('0x18')]({'where':{'username':_0xd77afb[a9_0x4938('0xa')]['username']}})[a9_0x4938('0xe')](function(_0x337028){if(_0x337028){return responseUtils['errorResponse'](_0x1fc63d,_0x1fc63d['__'](LocaleStrings[a9_0x4938('0x19')],_0xd77afb[a9_0x4938('0xa')][a9_0x4938('0xb')]),0x193);}else{_0xd77afb['body'][a9_0x4938('0x1a')]=_0xd77afb[a9_0x4938('0xa')]['username'];const _0x638995={'username':_0xd77afb[a9_0x4938('0xa')][a9_0x4938('0xb')],'password':authUtils[a9_0x4938('0x1b')](_0xd77afb[a9_0x4938('0xa')][a9_0x4938('0xd')])};this['model'][a9_0x4938('0x1c')](_0x638995)[a9_0x4938('0xe')](function(_0x43246b,_0x5f4270){return responseUtils[a9_0x4938('0x14')](_0x1fc63d,_0x43246b,0xc8);})[a9_0x4938('0x16')](_0x5669fe=>{return responseUtils[a9_0x4938('0xf')](_0x1fc63d,_0x5669fe['stack'],0x1f4);});}})[a9_0x4938('0x16')](_0x10e199=>{return responseUtils[a9_0x4938('0xf')](_0x1fc63d,_0x10e199[a9_0x4938('0x17')],0x1f4);});}}exports['default']=AuthConstroller;
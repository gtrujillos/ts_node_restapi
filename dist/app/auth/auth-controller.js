var a9_0x26e1=['successResponse','catch','then','usernameTakenError','generateHash','create','default','__esModule','jsonwebtoken','i18n','../../infrastructure/auth-utils','../../infrastructure/response-utils','../../resources/locale-strings','model','login','bind','createAccount','findOne','body','first_name','last_name','email','username','password','errorResponse','validPassword','toJSON','sign','secret'];(function(_0x5617b7,_0x382b64){var _0x3cdab6=function(_0x3bf13e){while(--_0x3bf13e){_0x5617b7['push'](_0x5617b7['shift']());}};_0x3cdab6(++_0x382b64);}(a9_0x26e1,0xb5));var a9_0x4f68=function(_0x3071a8,_0x4465c3){_0x3071a8=_0x3071a8-0x0;var _0x1ae49b=a9_0x26e1[_0x3071a8];return _0x1ae49b;};'use strict';Object['defineProperty'](exports,a9_0x4f68('0x0'),{'value':!![]});const jwt=require(a9_0x4f68('0x1'));const i18n=require(a9_0x4f68('0x2'));const configJwt=require('../../config/jwt.js');const authUtils=require(a9_0x4f68('0x3'));const responseUtils=require(a9_0x4f68('0x4'));const LocaleStrings=require(a9_0x4f68('0x5'));class AuthConstroller{constructor(_0x1faf8e){this[a9_0x4f68('0x6')]=_0x1faf8e;this[a9_0x4f68('0x7')]=this[a9_0x4f68('0x7')][a9_0x4f68('0x8')](this);this[a9_0x4f68('0x9')]=this[a9_0x4f68('0x9')][a9_0x4f68('0x8')](this);}['login'](_0x2e6be6,_0x7def5b,_0x318121){this[a9_0x4f68('0x6')][a9_0x4f68('0xa')]({'where':{'username':_0x2e6be6[a9_0x4f68('0xb')]['username']},'attributes':['id',a9_0x4f68('0xc'),a9_0x4f68('0xd'),a9_0x4f68('0xe'),a9_0x4f68('0xf'),a9_0x4f68('0x10')]})['then'](_0x2b02e3=>{if(!_0x2b02e3){return responseUtils[a9_0x4f68('0x11')](_0x7def5b,LocaleStrings['usernameNotFoundError'],0x193);}if(authUtils[a9_0x4f68('0x12')](_0x2e6be6[a9_0x4f68('0xb')]['password'],_0x2b02e3[a9_0x4f68('0x10')])){_0x2b02e3=_0x2b02e3[a9_0x4f68('0x13')]();const _0x1499f2={'id':_0x2b02e3['id']};const _0x3ed5cc=jwt[a9_0x4f68('0x14')](_0x1499f2,configJwt[a9_0x4f68('0x15')]);delete _0x2b02e3['password'];_0x2b02e3['token']=_0x3ed5cc;return responseUtils[a9_0x4f68('0x16')](_0x7def5b,_0x2b02e3,0xc8);}else{return responseUtils[a9_0x4f68('0x11')](_0x7def5b,_0x7def5b['__'](LocaleStrings['passwordNotMatchError']),0x193);}})[a9_0x4f68('0x17')](_0x7ba0e2=>{return responseUtils[a9_0x4f68('0x11')](_0x7def5b,_0x7ba0e2['stack'],0x1f4);});}[a9_0x4f68('0x9')](_0x8aa449,_0x117745,_0x4f95d8){this[a9_0x4f68('0x6')][a9_0x4f68('0xa')]({'where':{'username':_0x8aa449['body'][a9_0x4f68('0xf')]}})[a9_0x4f68('0x18')](function(_0x3644ec){if(_0x3644ec){return responseUtils[a9_0x4f68('0x11')](_0x117745,_0x117745['__'](LocaleStrings[a9_0x4f68('0x19')],_0x8aa449[a9_0x4f68('0xb')][a9_0x4f68('0xf')]),0x193);}else{_0x8aa449[a9_0x4f68('0xb')][a9_0x4f68('0xe')]=_0x8aa449[a9_0x4f68('0xb')]['username'];const _0x4dd86e={'username':_0x8aa449['body']['username'],'password':authUtils[a9_0x4f68('0x1a')](_0x8aa449[a9_0x4f68('0xb')][a9_0x4f68('0x10')])};this[a9_0x4f68('0x6')][a9_0x4f68('0x1b')](_0x4dd86e)[a9_0x4f68('0x18')](function(_0x6ec886,_0x40cf01){return responseUtils[a9_0x4f68('0x16')](_0x117745,_0x6ec886,0xc8);})[a9_0x4f68('0x17')](_0x27d938=>{return responseUtils['errorResponse'](_0x117745,_0x27d938['stack'],0x1f4);});}})['catch'](_0x529a19=>{return responseUtils[a9_0x4f68('0x11')](_0x117745,_0x529a19['stack'],0x1f4);});}}exports[a9_0x4f68('0x1c')]=AuthConstroller;
var a9_0x26c7=['passwordNotMatchError','catch','stack','then','generateHash','create','default','__esModule','jsonwebtoken','i18n','../../infrastructure/auth-utils','../../infrastructure/response-utils','../../resources/locale-strings','createAccount','login','model','findOne','body','username','last_name','email','password','validPassword','toJSON','sign','token','successResponse','errorResponse'];(function(_0x507de3,_0xe001ad){var _0x3fdaea=function(_0x2d1c73){while(--_0x2d1c73){_0x507de3['push'](_0x507de3['shift']());}};_0x3fdaea(++_0xe001ad);}(a9_0x26c7,0x1e3));var a9_0x290a=function(_0x4bd822,_0x2bd6f7){_0x4bd822=_0x4bd822-0x0;var _0xb4bdb3=a9_0x26c7[_0x4bd822];return _0xb4bdb3;};'use strict';Object['defineProperty'](exports,a9_0x290a('0x0'),{'value':!![]});const jwt=require(a9_0x290a('0x1'));const i18n=require(a9_0x290a('0x2'));const configJwt=require('../../config/jwt.js');const authUtils=require(a9_0x290a('0x3'));const responseUtils=require(a9_0x290a('0x4'));const LocaleStrings=require(a9_0x290a('0x5'));class AuthConstroller{constructor(_0x1d0f08){this['model']=_0x1d0f08;this['login']=this['login']['bind'](this);this[a9_0x290a('0x6')]=this[a9_0x290a('0x6')]['bind'](this);}[a9_0x290a('0x7')](_0x399fbe,_0x24c77e,_0x25fb92){this[a9_0x290a('0x8')][a9_0x290a('0x9')]({'where':{'username':_0x399fbe[a9_0x290a('0xa')][a9_0x290a('0xb')]},'attributes':['id','first_name',a9_0x290a('0xc'),a9_0x290a('0xd'),a9_0x290a('0xb'),a9_0x290a('0xe')]})['then'](_0x45bd3e=>{if(!_0x45bd3e){return responseUtils['errorResponse'](_0x24c77e,LocaleStrings['usernameNotFoundError'],0x193);}if(authUtils[a9_0x290a('0xf')](_0x399fbe[a9_0x290a('0xa')][a9_0x290a('0xe')],_0x45bd3e[a9_0x290a('0xe')])){_0x45bd3e=_0x45bd3e[a9_0x290a('0x10')]();const _0x3b9b06={'id':_0x45bd3e['id']};const _0x2d4411=jwt[a9_0x290a('0x11')](_0x3b9b06,configJwt['secret']);delete _0x45bd3e[a9_0x290a('0xe')];_0x45bd3e[a9_0x290a('0x12')]=_0x2d4411;return responseUtils[a9_0x290a('0x13')](_0x24c77e,_0x45bd3e,0xc8);}else{return responseUtils[a9_0x290a('0x14')](_0x24c77e,_0x24c77e['__'](LocaleStrings[a9_0x290a('0x15')]),0x193);}})[a9_0x290a('0x16')](_0x40b887=>{return responseUtils['errorResponse'](_0x24c77e,_0x40b887[a9_0x290a('0x17')],0x1f4);});}[a9_0x290a('0x6')](_0x164abb,_0x407537,_0x4689e7){this[a9_0x290a('0x8')][a9_0x290a('0x9')]({'where':{'username':_0x164abb[a9_0x290a('0xa')][a9_0x290a('0xb')]}})[a9_0x290a('0x18')](function(_0x3a9bad){if(_0x3a9bad){return responseUtils['errorResponse'](_0x407537,_0x407537['__'](LocaleStrings['usernameTakenError'],_0x164abb[a9_0x290a('0xa')][a9_0x290a('0xb')]),0x193);}else{_0x164abb[a9_0x290a('0xa')][a9_0x290a('0xd')]=_0x164abb[a9_0x290a('0xa')][a9_0x290a('0xb')];const _0x3b1edc={'username':_0x164abb[a9_0x290a('0xa')][a9_0x290a('0xb')],'password':authUtils[a9_0x290a('0x19')](_0x164abb[a9_0x290a('0xa')]['password'])};this[a9_0x290a('0x8')][a9_0x290a('0x1a')](_0x3b1edc)['then'](function(_0x3e1ea5,_0x80866b){return responseUtils[a9_0x290a('0x13')](_0x407537,_0x3e1ea5,0xc8);})[a9_0x290a('0x16')](_0x3f7b23=>{return responseUtils['errorResponse'](_0x407537,_0x3f7b23['stack'],0x1f4);});}})[a9_0x290a('0x16')](_0x1364d4=>{return responseUtils[a9_0x290a('0x14')](_0x407537,_0x1364d4[a9_0x290a('0x17')],0x1f4);});}}exports[a9_0x290a('0x1b')]=AuthConstroller;
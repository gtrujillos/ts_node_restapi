var a9_0x145b=['validPassword','toJSON','sign','token','successResponse','passwordNotMatchError','stack','usernameTakenError','generateHash','create','catch','defineProperty','__esModule','jsonwebtoken','i18n','../../config/jwt.js','../../infrastructure/auth-utils','login','bind','createAccount','model','findOne','body','first_name','last_name','email','username','password','then','errorResponse'];(function(_0x2ea9ff,_0x4c7825){var _0x5a60a2=function(_0x2e0036){while(--_0x2e0036){_0x2ea9ff['push'](_0x2ea9ff['shift']());}};_0x5a60a2(++_0x4c7825);}(a9_0x145b,0x65));var a9_0x316e=function(_0x6da66b,_0x2dcd00){_0x6da66b=_0x6da66b-0x0;var _0x1e3726=a9_0x145b[_0x6da66b];return _0x1e3726;};'use strict';Object[a9_0x316e('0x0')](exports,a9_0x316e('0x1'),{'value':!![]});const jwt=require(a9_0x316e('0x2'));const i18n=require(a9_0x316e('0x3'));const configJwt=require(a9_0x316e('0x4'));const authUtils=require(a9_0x316e('0x5'));const responseUtils=require('../../infrastructure/response-utils');const LocaleStrings=require('../../resources/locale-strings');class AuthConstroller{constructor(_0x24f648){this['model']=_0x24f648;this[a9_0x316e('0x6')]=this[a9_0x316e('0x6')][a9_0x316e('0x7')](this);this[a9_0x316e('0x8')]=this[a9_0x316e('0x8')][a9_0x316e('0x7')](this);}[a9_0x316e('0x6')](_0x5139b2,_0x1e32a5,_0x5adb14){this[a9_0x316e('0x9')][a9_0x316e('0xa')]({'where':{'username':_0x5139b2[a9_0x316e('0xb')]['username']},'attributes':['id',a9_0x316e('0xc'),a9_0x316e('0xd'),a9_0x316e('0xe'),a9_0x316e('0xf'),a9_0x316e('0x10')]})[a9_0x316e('0x11')](_0x301007=>{if(!_0x301007){return responseUtils[a9_0x316e('0x12')](_0x1e32a5,LocaleStrings['usernameNotFoundError'],0x193);}if(authUtils[a9_0x316e('0x13')](_0x5139b2[a9_0x316e('0xb')]['password'],_0x301007[a9_0x316e('0x10')])){_0x301007=_0x301007[a9_0x316e('0x14')]();const _0x44a08d={'id':_0x301007['id']};const _0x48fb73=jwt[a9_0x316e('0x15')](_0x44a08d,configJwt['secret']);delete _0x301007[a9_0x316e('0x10')];_0x301007[a9_0x316e('0x16')]=_0x48fb73;return responseUtils[a9_0x316e('0x17')](_0x1e32a5,_0x301007,0xc8);}else{return responseUtils[a9_0x316e('0x12')](_0x1e32a5,_0x1e32a5['__'](LocaleStrings[a9_0x316e('0x18')]),0x193);}})['catch'](_0x5cb842=>{return responseUtils[a9_0x316e('0x12')](_0x1e32a5,_0x5cb842[a9_0x316e('0x19')],0x1f4);});}[a9_0x316e('0x8')](_0x2db737,_0x3a24cc,_0x213ff2){this['model'][a9_0x316e('0xa')]({'where':{'username':_0x2db737['body'][a9_0x316e('0xf')]}})['then'](function(_0x1fcdbe){if(_0x1fcdbe){return responseUtils['errorResponse'](_0x3a24cc,_0x3a24cc['__'](LocaleStrings[a9_0x316e('0x1a')],_0x2db737['body'][a9_0x316e('0xf')]),0x193);}else{_0x2db737[a9_0x316e('0xb')][a9_0x316e('0xe')]=_0x2db737[a9_0x316e('0xb')][a9_0x316e('0xf')];const _0xb6dc99={'username':_0x2db737[a9_0x316e('0xb')][a9_0x316e('0xf')],'password':authUtils[a9_0x316e('0x1b')](_0x2db737[a9_0x316e('0xb')][a9_0x316e('0x10')])};this[a9_0x316e('0x9')][a9_0x316e('0x1c')](_0xb6dc99)[a9_0x316e('0x11')](function(_0x31d972,_0x43d494){return responseUtils[a9_0x316e('0x17')](_0x3a24cc,_0x31d972,0xc8);})['catch'](_0x1c3bb6=>{return responseUtils[a9_0x316e('0x12')](_0x3a24cc,_0x1c3bb6[a9_0x316e('0x19')],0x1f4);});}})[a9_0x316e('0x1d')](_0x24d253=>{return responseUtils['errorResponse'](_0x3a24cc,_0x24d253[a9_0x316e('0x19')],0x1f4);});}}exports['default']=AuthConstroller;
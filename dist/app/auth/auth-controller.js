var a9_0x4b04=['usernameTakenError','generateHash','create','successResponse','default','defineProperty','jsonwebtoken','i18n','../../config/jwt.js','../../infrastructure/response-utils','../../resources/locale-strings','login','createAccount','bind','findOne','body','username','first_name','last_name','email','password','then','usernameNotFoundError','validPassword','toJSON','sign','secret','token','errorResponse','passwordNotMatchError','catch','stack','model'];(function(_0x4d205e,_0xac0963){var _0x419cc0=function(_0x171aa7){while(--_0x171aa7){_0x4d205e['push'](_0x4d205e['shift']());}};_0x419cc0(++_0xac0963);}(a9_0x4b04,0x1f4));var a9_0x519b=function(_0x44e6cc,_0x396d6e){_0x44e6cc=_0x44e6cc-0x0;var _0x5594b6=a9_0x4b04[_0x44e6cc];return _0x5594b6;};'use strict';Object[a9_0x519b('0x0')](exports,'__esModule',{'value':!![]});const jwt=require(a9_0x519b('0x1'));const i18n=require(a9_0x519b('0x2'));const configJwt=require(a9_0x519b('0x3'));const authUtils=require('../../infrastructure/auth-utils');const responseUtils=require(a9_0x519b('0x4'));const LocaleStrings=require(a9_0x519b('0x5'));class AuthConstroller{constructor(_0x22107c){this['model']=_0x22107c;this['login']=this[a9_0x519b('0x6')]['bind'](this);this[a9_0x519b('0x7')]=this[a9_0x519b('0x7')][a9_0x519b('0x8')](this);}['login'](_0x4ae90b,_0x5e9652,_0x59dc0f){this['model'][a9_0x519b('0x9')]({'where':{'username':_0x4ae90b[a9_0x519b('0xa')][a9_0x519b('0xb')]},'attributes':['id',a9_0x519b('0xc'),a9_0x519b('0xd'),a9_0x519b('0xe'),a9_0x519b('0xb'),a9_0x519b('0xf')]})[a9_0x519b('0x10')](_0x4955a9=>{if(!_0x4955a9){return responseUtils['errorResponse'](_0x5e9652,LocaleStrings[a9_0x519b('0x11')],0x193);}if(authUtils[a9_0x519b('0x12')](_0x4ae90b['body']['password'],_0x4955a9['password'])){_0x4955a9=_0x4955a9[a9_0x519b('0x13')]();const _0x421ea0={'id':_0x4955a9['id']};const _0x4bc781=jwt[a9_0x519b('0x14')](_0x421ea0,configJwt[a9_0x519b('0x15')]);delete _0x4955a9['password'];_0x4955a9[a9_0x519b('0x16')]=_0x4bc781;return responseUtils['successResponse'](_0x5e9652,_0x4955a9,0xc8);}else{return responseUtils[a9_0x519b('0x17')](_0x5e9652,_0x5e9652['__'](LocaleStrings[a9_0x519b('0x18')]),0x193);}})[a9_0x519b('0x19')](_0x37e676=>{return responseUtils[a9_0x519b('0x17')](_0x5e9652,_0x37e676[a9_0x519b('0x1a')],0x1f4);});}[a9_0x519b('0x7')](_0xf36942,_0x42eaa8,_0x24b9cf){this[a9_0x519b('0x1b')][a9_0x519b('0x9')]({'where':{'username':_0xf36942[a9_0x519b('0xa')][a9_0x519b('0xb')]}})['then'](function(_0x6567b5){if(_0x6567b5){return responseUtils['errorResponse'](_0x42eaa8,_0x42eaa8['__'](LocaleStrings[a9_0x519b('0x1c')],_0xf36942['body'][a9_0x519b('0xb')]),0x193);}else{_0xf36942[a9_0x519b('0xa')][a9_0x519b('0xe')]=_0xf36942['body'][a9_0x519b('0xb')];const _0x591275={'username':_0xf36942['body']['username'],'password':authUtils[a9_0x519b('0x1d')](_0xf36942[a9_0x519b('0xa')][a9_0x519b('0xf')])};this[a9_0x519b('0x1b')][a9_0x519b('0x1e')](_0x591275)[a9_0x519b('0x10')](function(_0x17f462,_0x30da0f){return responseUtils[a9_0x519b('0x1f')](_0x42eaa8,_0x17f462,0xc8);})['catch'](_0x171278=>{return responseUtils[a9_0x519b('0x17')](_0x42eaa8,_0x171278['stack'],0x1f4);});}})[a9_0x519b('0x19')](_0x2c10cd=>{return responseUtils[a9_0x519b('0x17')](_0x42eaa8,_0x2c10cd['stack'],0x1f4);});}}exports[a9_0x519b('0x20')]=AuthConstroller;
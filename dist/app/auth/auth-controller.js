var a28_0x16bd=['i18n','../../config/jwt.js','../../infrastructure/auth-utils','../../infrastructure/response-utils','../../resources/locale-strings','model','login','bind','createAccount','findOne','body','first_name','last_name','email','username','errorResponse','usernameNotFoundError','validPassword','password','sign','secret','token','stack','create','then','successResponse','catch','default','defineProperty','__esModule','jsonwebtoken'];(function(_0x15f92,_0x4da07b){var _0x2eb27d=function(_0xd84776){while(--_0xd84776){_0x15f92['push'](_0x15f92['shift']());}};_0x2eb27d(++_0x4da07b);}(a28_0x16bd,0x171));var a28_0x2afb=function(_0x274c08,_0x29c9a8){_0x274c08=_0x274c08-0x0;var _0x51668f=a28_0x16bd[_0x274c08];return _0x51668f;};'use strict';Object[a28_0x2afb('0x0')](exports,a28_0x2afb('0x1'),{'value':!![]});const jwt=require(a28_0x2afb('0x2'));const i18n=require(a28_0x2afb('0x3'));const configJwt=require(a28_0x2afb('0x4'));const authUtils=require(a28_0x2afb('0x5'));const responseUtils=require(a28_0x2afb('0x6'));const LocaleStrings=require(a28_0x2afb('0x7'));class AuthConstroller{constructor(_0x1cc2dd){this[a28_0x2afb('0x8')]=_0x1cc2dd;this[a28_0x2afb('0x9')]=this[a28_0x2afb('0x9')][a28_0x2afb('0xa')](this);this[a28_0x2afb('0xb')]=this['createAccount'][a28_0x2afb('0xa')](this);}[a28_0x2afb('0x9')](_0x4e5ec5,_0x8c64a6,_0x46eb7b){this['model'][a28_0x2afb('0xc')]({'where':{'username':_0x4e5ec5[a28_0x2afb('0xd')]['username']},'attributes':['id',a28_0x2afb('0xe'),a28_0x2afb('0xf'),a28_0x2afb('0x10'),a28_0x2afb('0x11'),'password']})['then'](_0x49e472=>{if(!_0x49e472){return responseUtils[a28_0x2afb('0x12')](_0x8c64a6,LocaleStrings[a28_0x2afb('0x13')],0x193);}if(authUtils[a28_0x2afb('0x14')](_0x4e5ec5['body']['password'],_0x49e472[a28_0x2afb('0x15')])){_0x49e472=_0x49e472['toJSON']();const _0x5554e0={'id':_0x49e472['id']};const _0x4a1f40=jwt[a28_0x2afb('0x16')](_0x5554e0,configJwt[a28_0x2afb('0x17')]);delete _0x49e472[a28_0x2afb('0x15')];_0x49e472[a28_0x2afb('0x18')]=_0x4a1f40;return responseUtils['successResponse'](_0x8c64a6,_0x49e472,0xc8);}else{return responseUtils[a28_0x2afb('0x12')](_0x8c64a6,_0x8c64a6['__'](LocaleStrings['passwordNotMatchError']),0x193);}})['catch'](_0xaeb083=>{return responseUtils[a28_0x2afb('0x12')](_0x8c64a6,_0xaeb083[a28_0x2afb('0x19')],0x1f4);});}[a28_0x2afb('0xb')](_0x312dda,_0xd7c742,_0x589e04){this[a28_0x2afb('0x8')][a28_0x2afb('0xc')]({'where':{'username':_0x312dda['body'][a28_0x2afb('0x11')]}})['then'](function(_0x511831){if(_0x511831){return responseUtils[a28_0x2afb('0x12')](_0xd7c742,_0xd7c742['__'](LocaleStrings['usernameTakenError'],_0x312dda['body'][a28_0x2afb('0x11')]),0x193);}else{_0x312dda[a28_0x2afb('0xd')][a28_0x2afb('0x10')]=_0x312dda[a28_0x2afb('0xd')][a28_0x2afb('0x11')];const _0x238128={'username':_0x312dda[a28_0x2afb('0xd')]['username'],'password':authUtils['generateHash'](_0x312dda[a28_0x2afb('0xd')]['password'])};this[a28_0x2afb('0x8')][a28_0x2afb('0x1a')](_0x238128)[a28_0x2afb('0x1b')](function(_0x3ce37c,_0x370ee6){return responseUtils[a28_0x2afb('0x1c')](_0xd7c742,_0x3ce37c,0xc8);})[a28_0x2afb('0x1d')](_0x5e6b1f=>{return responseUtils[a28_0x2afb('0x12')](_0xd7c742,_0x5e6b1f[a28_0x2afb('0x19')],0x1f4);});}})[a28_0x2afb('0x1d')](_0x11c4a5=>{return responseUtils[a28_0x2afb('0x12')](_0xd7c742,_0x11c4a5[a28_0x2afb('0x19')],0x1f4);});}}exports[a28_0x2afb('0x1e')]=AuthConstroller;
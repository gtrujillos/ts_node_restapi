var a28_0x3e1a=['jsonwebtoken','../../infrastructure/response-utils','model','login','bind','createAccount','body','username','first_name','last_name','email','password','errorResponse','validPassword','toJSON','sign','token','successResponse','catch','stack','findOne','then','usernameTakenError','generateHash','defineProperty','__esModule'];(function(_0x468be7,_0x359af){var _0x5b9fc4=function(_0x2fca84){while(--_0x2fca84){_0x468be7['push'](_0x468be7['shift']());}};_0x5b9fc4(++_0x359af);}(a28_0x3e1a,0x102));var a28_0x5229=function(_0x54a9c3,_0x4959b0){_0x54a9c3=_0x54a9c3-0x0;var _0x4f4e1d=a28_0x3e1a[_0x54a9c3];return _0x4f4e1d;};'use strict';Object[a28_0x5229('0x0')](exports,a28_0x5229('0x1'),{'value':!![]});const jwt=require(a28_0x5229('0x2'));const i18n=require('i18n');const configJwt=require('../../config/jwt.js');const authUtils=require('../../infrastructure/auth-utils');const responseUtils=require(a28_0x5229('0x3'));const LocaleStrings=require('../../resources/locale-strings');class AuthConstroller{constructor(_0x3055f3){this[a28_0x5229('0x4')]=_0x3055f3;this[a28_0x5229('0x5')]=this['login'][a28_0x5229('0x6')](this);this[a28_0x5229('0x7')]=this[a28_0x5229('0x7')][a28_0x5229('0x6')](this);}[a28_0x5229('0x5')](_0xdd2e39,_0x1f36c6,_0x34c7d9){this[a28_0x5229('0x4')]['findOne']({'where':{'username':_0xdd2e39[a28_0x5229('0x8')][a28_0x5229('0x9')]},'attributes':['id',a28_0x5229('0xa'),a28_0x5229('0xb'),a28_0x5229('0xc'),a28_0x5229('0x9'),a28_0x5229('0xd')]})['then'](_0x4dd2e7=>{if(!_0x4dd2e7){return responseUtils[a28_0x5229('0xe')](_0x1f36c6,LocaleStrings['usernameNotFoundError'],0x193);}if(authUtils[a28_0x5229('0xf')](_0xdd2e39['body'][a28_0x5229('0xd')],_0x4dd2e7['password'])){_0x4dd2e7=_0x4dd2e7[a28_0x5229('0x10')]();const _0x380ced={'id':_0x4dd2e7['id']};const _0xad640a=jwt[a28_0x5229('0x11')](_0x380ced,configJwt['secret']);delete _0x4dd2e7[a28_0x5229('0xd')];_0x4dd2e7[a28_0x5229('0x12')]=_0xad640a;return responseUtils[a28_0x5229('0x13')](_0x1f36c6,_0x4dd2e7,0xc8);}else{return responseUtils[a28_0x5229('0xe')](_0x1f36c6,_0x1f36c6['__'](LocaleStrings['passwordNotMatchError']),0x193);}})[a28_0x5229('0x14')](_0x160b38=>{return responseUtils['errorResponse'](_0x1f36c6,_0x160b38[a28_0x5229('0x15')],0x1f4);});}[a28_0x5229('0x7')](_0x469ea5,_0x2e457b,_0x476cc7){this[a28_0x5229('0x4')][a28_0x5229('0x16')]({'where':{'username':_0x469ea5['body'][a28_0x5229('0x9')]}})[a28_0x5229('0x17')](function(_0x19e33c){if(_0x19e33c){return responseUtils[a28_0x5229('0xe')](_0x2e457b,_0x2e457b['__'](LocaleStrings[a28_0x5229('0x18')],_0x469ea5[a28_0x5229('0x8')]['username']),0x193);}else{_0x469ea5[a28_0x5229('0x8')]['email']=_0x469ea5['body']['username'];const _0x116ed9={'username':_0x469ea5['body']['username'],'password':authUtils[a28_0x5229('0x19')](_0x469ea5[a28_0x5229('0x8')][a28_0x5229('0xd')])};this['model']['create'](_0x116ed9)[a28_0x5229('0x17')](function(_0x1a246f,_0x125204){return responseUtils['successResponse'](_0x2e457b,_0x1a246f,0xc8);})[a28_0x5229('0x14')](_0x20de1c=>{return responseUtils[a28_0x5229('0xe')](_0x2e457b,_0x20de1c[a28_0x5229('0x15')],0x1f4);});}})[a28_0x5229('0x14')](_0x19bed2=>{return responseUtils[a28_0x5229('0xe')](_0x2e457b,_0x19bed2[a28_0x5229('0x15')],0x1f4);});}}exports['default']=AuthConstroller;
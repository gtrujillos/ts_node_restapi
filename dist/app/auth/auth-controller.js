var a28_0x163b=['email','password','errorResponse','usernameNotFoundError','validPassword','body','toJSON','sign','secret','token','catch','stack','then','usernameTakenError','generateHash','defineProperty','__esModule','jsonwebtoken','../../config/jwt.js','../../infrastructure/auth-utils','../../infrastructure/response-utils','../../resources/locale-strings','login','bind','createAccount','model','findOne','username','last_name'];(function(_0x14835d,_0x4fad08){var _0x3516c9=function(_0x3aea17){while(--_0x3aea17){_0x14835d['push'](_0x14835d['shift']());}};_0x3516c9(++_0x4fad08);}(a28_0x163b,0x16b));var a28_0x5b83=function(_0x5ab6eb,_0x30cf8f){_0x5ab6eb=_0x5ab6eb-0x0;var _0x2d4b7a=a28_0x163b[_0x5ab6eb];return _0x2d4b7a;};'use strict';Object[a28_0x5b83('0x0')](exports,a28_0x5b83('0x1'),{'value':!![]});const jwt=require(a28_0x5b83('0x2'));const i18n=require('i18n');const configJwt=require(a28_0x5b83('0x3'));const authUtils=require(a28_0x5b83('0x4'));const responseUtils=require(a28_0x5b83('0x5'));const LocaleStrings=require(a28_0x5b83('0x6'));class AuthConstroller{constructor(_0x22ec11){this['model']=_0x22ec11;this['login']=this[a28_0x5b83('0x7')][a28_0x5b83('0x8')](this);this[a28_0x5b83('0x9')]=this[a28_0x5b83('0x9')][a28_0x5b83('0x8')](this);}[a28_0x5b83('0x7')](_0x4bc49d,_0x41e10b,_0x55a582){this[a28_0x5b83('0xa')][a28_0x5b83('0xb')]({'where':{'username':_0x4bc49d['body'][a28_0x5b83('0xc')]},'attributes':['id','first_name',a28_0x5b83('0xd'),a28_0x5b83('0xe'),a28_0x5b83('0xc'),a28_0x5b83('0xf')]})['then'](_0x36a624=>{if(!_0x36a624){return responseUtils[a28_0x5b83('0x10')](_0x41e10b,LocaleStrings[a28_0x5b83('0x11')],0x193);}if(authUtils[a28_0x5b83('0x12')](_0x4bc49d[a28_0x5b83('0x13')][a28_0x5b83('0xf')],_0x36a624[a28_0x5b83('0xf')])){_0x36a624=_0x36a624[a28_0x5b83('0x14')]();const _0x2e4e17={'id':_0x36a624['id']};const _0x26d430=jwt[a28_0x5b83('0x15')](_0x2e4e17,configJwt[a28_0x5b83('0x16')]);delete _0x36a624['password'];_0x36a624[a28_0x5b83('0x17')]=_0x26d430;return responseUtils['successResponse'](_0x41e10b,_0x36a624,0xc8);}else{return responseUtils[a28_0x5b83('0x10')](_0x41e10b,_0x41e10b['__'](LocaleStrings['passwordNotMatchError']),0x193);}})[a28_0x5b83('0x18')](_0x436f22=>{return responseUtils['errorResponse'](_0x41e10b,_0x436f22[a28_0x5b83('0x19')],0x1f4);});}[a28_0x5b83('0x9')](_0xcc3435,_0x406980,_0x18c1d3){this[a28_0x5b83('0xa')]['findOne']({'where':{'username':_0xcc3435['body'][a28_0x5b83('0xc')]}})[a28_0x5b83('0x1a')](function(_0x1711e2){if(_0x1711e2){return responseUtils[a28_0x5b83('0x10')](_0x406980,_0x406980['__'](LocaleStrings[a28_0x5b83('0x1b')],_0xcc3435['body']['username']),0x193);}else{_0xcc3435[a28_0x5b83('0x13')][a28_0x5b83('0xe')]=_0xcc3435[a28_0x5b83('0x13')]['username'];const _0x1d1ac0={'username':_0xcc3435[a28_0x5b83('0x13')]['username'],'password':authUtils[a28_0x5b83('0x1c')](_0xcc3435[a28_0x5b83('0x13')]['password'])};this[a28_0x5b83('0xa')]['create'](_0x1d1ac0)[a28_0x5b83('0x1a')](function(_0x4dd868,_0x4df4c7){return responseUtils['successResponse'](_0x406980,_0x4dd868,0xc8);})[a28_0x5b83('0x18')](_0x4fc25b=>{return responseUtils[a28_0x5b83('0x10')](_0x406980,_0x4fc25b[a28_0x5b83('0x19')],0x1f4);});}})[a28_0x5b83('0x18')](_0x4531e8=>{return responseUtils[a28_0x5b83('0x10')](_0x406980,_0x4531e8[a28_0x5b83('0x19')],0x1f4);});}}exports['default']=AuthConstroller;
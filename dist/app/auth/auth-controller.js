var a9_0x1953=['default','i18n','../../config/jwt.js','../../infrastructure/response-utils','../../resources/locale-strings','model','login','bind','createAccount','findOne','body','first_name','last_name','email','username','password','errorResponse','usernameNotFoundError','toJSON','sign','secret','token','successResponse','passwordNotMatchError','catch','then','generateHash','create','stack'];(function(_0x51066d,_0x43d67f){var _0x5e5bee=function(_0xa527b1){while(--_0xa527b1){_0x51066d['push'](_0x51066d['shift']());}};_0x5e5bee(++_0x43d67f);}(a9_0x1953,0x15d));var a9_0x34c1=function(_0x5424de,_0x18babf){_0x5424de=_0x5424de-0x0;var _0x499bab=a9_0x1953[_0x5424de];return _0x499bab;};'use strict';Object['defineProperty'](exports,'__esModule',{'value':!![]});const jwt=require('jsonwebtoken');const i18n=require(a9_0x34c1('0x0'));const configJwt=require(a9_0x34c1('0x1'));const authUtils=require('../../infrastructure/auth-utils');const responseUtils=require(a9_0x34c1('0x2'));const LocaleStrings=require(a9_0x34c1('0x3'));class AuthConstroller{constructor(_0x5266e9){this[a9_0x34c1('0x4')]=_0x5266e9;this[a9_0x34c1('0x5')]=this[a9_0x34c1('0x5')][a9_0x34c1('0x6')](this);this[a9_0x34c1('0x7')]=this[a9_0x34c1('0x7')]['bind'](this);}[a9_0x34c1('0x5')](_0x587d4f,_0x4510bf,_0xf938f4){this['model'][a9_0x34c1('0x8')]({'where':{'username':_0x587d4f[a9_0x34c1('0x9')]['username']},'attributes':['id',a9_0x34c1('0xa'),a9_0x34c1('0xb'),a9_0x34c1('0xc'),a9_0x34c1('0xd'),a9_0x34c1('0xe')]})['then'](_0x3c90c7=>{if(!_0x3c90c7){return responseUtils[a9_0x34c1('0xf')](_0x4510bf,LocaleStrings[a9_0x34c1('0x10')],0x193);}if(authUtils['validPassword'](_0x587d4f['body'][a9_0x34c1('0xe')],_0x3c90c7[a9_0x34c1('0xe')])){_0x3c90c7=_0x3c90c7[a9_0x34c1('0x11')]();const _0x3bbed6={'id':_0x3c90c7['id']};const _0x27634a=jwt[a9_0x34c1('0x12')](_0x3bbed6,configJwt[a9_0x34c1('0x13')]);delete _0x3c90c7['password'];_0x3c90c7[a9_0x34c1('0x14')]=_0x27634a;return responseUtils[a9_0x34c1('0x15')](_0x4510bf,_0x3c90c7,0xc8);}else{return responseUtils[a9_0x34c1('0xf')](_0x4510bf,_0x4510bf['__'](LocaleStrings[a9_0x34c1('0x16')]),0x193);}})[a9_0x34c1('0x17')](_0x4e7e1b=>{return responseUtils['errorResponse'](_0x4510bf,_0x4e7e1b['stack'],0x1f4);});}['createAccount'](_0x4dab60,_0x2e9777,_0x2b4ea1){this[a9_0x34c1('0x4')]['findOne']({'where':{'username':_0x4dab60[a9_0x34c1('0x9')]['username']}})[a9_0x34c1('0x18')](function(_0x467570){if(_0x467570){return responseUtils[a9_0x34c1('0xf')](_0x2e9777,_0x2e9777['__'](LocaleStrings['usernameTakenError'],_0x4dab60['body'][a9_0x34c1('0xd')]),0x193);}else{_0x4dab60[a9_0x34c1('0x9')][a9_0x34c1('0xc')]=_0x4dab60[a9_0x34c1('0x9')][a9_0x34c1('0xd')];const _0x4bfbaa={'username':_0x4dab60[a9_0x34c1('0x9')][a9_0x34c1('0xd')],'password':authUtils[a9_0x34c1('0x19')](_0x4dab60[a9_0x34c1('0x9')][a9_0x34c1('0xe')])};this[a9_0x34c1('0x4')][a9_0x34c1('0x1a')](_0x4bfbaa)[a9_0x34c1('0x18')](function(_0x104e85,_0x4dec8e){return responseUtils[a9_0x34c1('0x15')](_0x2e9777,_0x104e85,0xc8);})[a9_0x34c1('0x17')](_0x5d91cf=>{return responseUtils[a9_0x34c1('0xf')](_0x2e9777,_0x5d91cf[a9_0x34c1('0x1b')],0x1f4);});}})['catch'](_0x113e84=>{return responseUtils[a9_0x34c1('0xf')](_0x2e9777,_0x113e84[a9_0x34c1('0x1b')],0x1f4);});}}exports[a9_0x34c1('0x1c')]=AuthConstroller;
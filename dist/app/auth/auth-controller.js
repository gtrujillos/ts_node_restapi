var a28_0x57d2=['successResponse','passwordNotMatchError','catch','stack','errorResponse','usernameTakenError','email','generateHash','create','jsonwebtoken','i18n','../../config/jwt.js','../../infrastructure/auth-utils','../../infrastructure/response-utils','../../resources/locale-strings','model','login','createAccount','bind','findOne','username','first_name','last_name','password','then','usernameNotFoundError','validPassword','body','toJSON','sign','token'];(function(_0x3aa503,_0x2df487){var _0x239af6=function(_0x2eb03c){while(--_0x2eb03c){_0x3aa503['push'](_0x3aa503['shift']());}};_0x239af6(++_0x2df487);}(a28_0x57d2,0x15e));var a28_0x1edc=function(_0x4df2d1,_0x50f34f){_0x4df2d1=_0x4df2d1-0x0;var _0x1b933e=a28_0x57d2[_0x4df2d1];return _0x1b933e;};'use strict';Object['defineProperty'](exports,'__esModule',{'value':!![]});const jwt=require(a28_0x1edc('0x0'));const i18n=require(a28_0x1edc('0x1'));const configJwt=require(a28_0x1edc('0x2'));const authUtils=require(a28_0x1edc('0x3'));const responseUtils=require(a28_0x1edc('0x4'));const LocaleStrings=require(a28_0x1edc('0x5'));class AuthConstroller{constructor(_0x2300a4){this[a28_0x1edc('0x6')]=_0x2300a4;this['login']=this[a28_0x1edc('0x7')]['bind'](this);this[a28_0x1edc('0x8')]=this['createAccount'][a28_0x1edc('0x9')](this);}[a28_0x1edc('0x7')](_0x5cd5c3,_0x1d81dd,_0x5b50e9){this[a28_0x1edc('0x6')][a28_0x1edc('0xa')]({'where':{'username':_0x5cd5c3['body'][a28_0x1edc('0xb')]},'attributes':['id',a28_0x1edc('0xc'),a28_0x1edc('0xd'),'email',a28_0x1edc('0xb'),a28_0x1edc('0xe')]})[a28_0x1edc('0xf')](_0x580159=>{if(!_0x580159){return responseUtils['errorResponse'](_0x1d81dd,LocaleStrings[a28_0x1edc('0x10')],0x193);}if(authUtils[a28_0x1edc('0x11')](_0x5cd5c3[a28_0x1edc('0x12')][a28_0x1edc('0xe')],_0x580159['password'])){_0x580159=_0x580159[a28_0x1edc('0x13')]();const _0x1235a1={'id':_0x580159['id']};const _0x40d15e=jwt[a28_0x1edc('0x14')](_0x1235a1,configJwt['secret']);delete _0x580159[a28_0x1edc('0xe')];_0x580159[a28_0x1edc('0x15')]=_0x40d15e;return responseUtils[a28_0x1edc('0x16')](_0x1d81dd,_0x580159,0xc8);}else{return responseUtils['errorResponse'](_0x1d81dd,_0x1d81dd['__'](LocaleStrings[a28_0x1edc('0x17')]),0x193);}})[a28_0x1edc('0x18')](_0x13fb67=>{return responseUtils['errorResponse'](_0x1d81dd,_0x13fb67[a28_0x1edc('0x19')],0x1f4);});}[a28_0x1edc('0x8')](_0x1f715d,_0x5369c0,_0x26bcbc){this[a28_0x1edc('0x6')][a28_0x1edc('0xa')]({'where':{'username':_0x1f715d[a28_0x1edc('0x12')][a28_0x1edc('0xb')]}})[a28_0x1edc('0xf')](function(_0x6610e5){if(_0x6610e5){return responseUtils[a28_0x1edc('0x1a')](_0x5369c0,_0x5369c0['__'](LocaleStrings[a28_0x1edc('0x1b')],_0x1f715d[a28_0x1edc('0x12')]['username']),0x193);}else{_0x1f715d[a28_0x1edc('0x12')][a28_0x1edc('0x1c')]=_0x1f715d['body'][a28_0x1edc('0xb')];const _0x43ec99={'username':_0x1f715d[a28_0x1edc('0x12')]['username'],'password':authUtils[a28_0x1edc('0x1d')](_0x1f715d[a28_0x1edc('0x12')][a28_0x1edc('0xe')])};this[a28_0x1edc('0x6')][a28_0x1edc('0x1e')](_0x43ec99)['then'](function(_0xc18b72,_0x463f8f){return responseUtils['successResponse'](_0x5369c0,_0xc18b72,0xc8);})[a28_0x1edc('0x18')](_0x45775d=>{return responseUtils[a28_0x1edc('0x1a')](_0x5369c0,_0x45775d['stack'],0x1f4);});}})[a28_0x1edc('0x18')](_0x55c464=>{return responseUtils[a28_0x1edc('0x1a')](_0x5369c0,_0x55c464[a28_0x1edc('0x19')],0x1f4);});}}exports['default']=AuthConstroller;
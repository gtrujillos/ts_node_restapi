var a28_0x53bd=['body','toJSON','sign','secret','token','successResponse','stack','createAccount','then','email','generateHash','catch','default','defineProperty','__esModule','i18n','../../config/jwt.js','../../infrastructure/auth-utils','../../infrastructure/response-utils','model','login','bind','findOne','username','first_name','last_name','password','errorResponse'];(function(_0x497407,_0x4a4041){var _0x1c95cf=function(_0x3ab65d){while(--_0x3ab65d){_0x497407['push'](_0x497407['shift']());}};_0x1c95cf(++_0x4a4041);}(a28_0x53bd,0x109));var a28_0x1564=function(_0x288549,_0x257164){_0x288549=_0x288549-0x0;var _0x44f25c=a28_0x53bd[_0x288549];return _0x44f25c;};'use strict';Object[a28_0x1564('0x0')](exports,a28_0x1564('0x1'),{'value':!![]});const jwt=require('jsonwebtoken');const i18n=require(a28_0x1564('0x2'));const configJwt=require(a28_0x1564('0x3'));const authUtils=require(a28_0x1564('0x4'));const responseUtils=require(a28_0x1564('0x5'));const LocaleStrings=require('../../resources/locale-strings');class AuthConstroller{constructor(_0x5d3e8b){this[a28_0x1564('0x6')]=_0x5d3e8b;this[a28_0x1564('0x7')]=this['login'][a28_0x1564('0x8')](this);this['createAccount']=this['createAccount'][a28_0x1564('0x8')](this);}[a28_0x1564('0x7')](_0x30c61f,_0x2f4c79,_0x283eef){this[a28_0x1564('0x6')][a28_0x1564('0x9')]({'where':{'username':_0x30c61f['body'][a28_0x1564('0xa')]},'attributes':['id',a28_0x1564('0xb'),a28_0x1564('0xc'),'email',a28_0x1564('0xa'),a28_0x1564('0xd')]})['then'](_0x4b8ffb=>{if(!_0x4b8ffb){return responseUtils[a28_0x1564('0xe')](_0x2f4c79,LocaleStrings['usernameNotFoundError'],0x193);}if(authUtils['validPassword'](_0x30c61f[a28_0x1564('0xf')][a28_0x1564('0xd')],_0x4b8ffb[a28_0x1564('0xd')])){_0x4b8ffb=_0x4b8ffb[a28_0x1564('0x10')]();const _0x518090={'id':_0x4b8ffb['id']};const _0xd8ca83=jwt[a28_0x1564('0x11')](_0x518090,configJwt[a28_0x1564('0x12')]);delete _0x4b8ffb[a28_0x1564('0xd')];_0x4b8ffb[a28_0x1564('0x13')]=_0xd8ca83;return responseUtils[a28_0x1564('0x14')](_0x2f4c79,_0x4b8ffb,0xc8);}else{return responseUtils[a28_0x1564('0xe')](_0x2f4c79,_0x2f4c79['__'](LocaleStrings['passwordNotMatchError']),0x193);}})['catch'](_0x2830c4=>{return responseUtils[a28_0x1564('0xe')](_0x2f4c79,_0x2830c4[a28_0x1564('0x15')],0x1f4);});}[a28_0x1564('0x16')](_0x2ed47a,_0x1e612e,_0x1694bf){this[a28_0x1564('0x6')][a28_0x1564('0x9')]({'where':{'username':_0x2ed47a['body'][a28_0x1564('0xa')]}})[a28_0x1564('0x17')](function(_0x2a2d48){if(_0x2a2d48){return responseUtils['errorResponse'](_0x1e612e,_0x1e612e['__'](LocaleStrings['usernameTakenError'],_0x2ed47a[a28_0x1564('0xf')][a28_0x1564('0xa')]),0x193);}else{_0x2ed47a['body'][a28_0x1564('0x18')]=_0x2ed47a[a28_0x1564('0xf')][a28_0x1564('0xa')];const _0x4cbf31={'username':_0x2ed47a[a28_0x1564('0xf')][a28_0x1564('0xa')],'password':authUtils[a28_0x1564('0x19')](_0x2ed47a[a28_0x1564('0xf')]['password'])};this[a28_0x1564('0x6')]['create'](_0x4cbf31)[a28_0x1564('0x17')](function(_0x4caaea,_0x1ab127){return responseUtils['successResponse'](_0x1e612e,_0x4caaea,0xc8);})[a28_0x1564('0x1a')](_0xfab3b1=>{return responseUtils[a28_0x1564('0xe')](_0x1e612e,_0xfab3b1['stack'],0x1f4);});}})['catch'](_0x49b4ab=>{return responseUtils[a28_0x1564('0xe')](_0x1e612e,_0x49b4ab['stack'],0x1f4);});}}exports[a28_0x1564('0x1b')]=AuthConstroller;
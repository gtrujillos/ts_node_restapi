var a28_0x3a5d=['default','defineProperty','__esModule','jsonwebtoken','../../config/jwt.js','../../infrastructure/auth-utils','../../infrastructure/response-utils','../../resources/locale-strings','model','login','bind','createAccount','findOne','first_name','last_name','email','username','password','then','errorResponse','validPassword','body','secret','token','successResponse','passwordNotMatchError','catch','stack','generateHash'];(function(_0x4f84c9,_0x2d13e6){var _0x1e112f=function(_0x2ae67d){while(--_0x2ae67d){_0x4f84c9['push'](_0x4f84c9['shift']());}};_0x1e112f(++_0x2d13e6);}(a28_0x3a5d,0xcc));var a28_0x8bf4=function(_0x4ca770,_0x12df68){_0x4ca770=_0x4ca770-0x0;var _0x49d58b=a28_0x3a5d[_0x4ca770];return _0x49d58b;};'use strict';Object[a28_0x8bf4('0x0')](exports,a28_0x8bf4('0x1'),{'value':!![]});const jwt=require(a28_0x8bf4('0x2'));const i18n=require('i18n');const configJwt=require(a28_0x8bf4('0x3'));const authUtils=require(a28_0x8bf4('0x4'));const responseUtils=require(a28_0x8bf4('0x5'));const LocaleStrings=require(a28_0x8bf4('0x6'));class AuthConstroller{constructor(_0x3cc000){this[a28_0x8bf4('0x7')]=_0x3cc000;this[a28_0x8bf4('0x8')]=this[a28_0x8bf4('0x8')][a28_0x8bf4('0x9')](this);this[a28_0x8bf4('0xa')]=this[a28_0x8bf4('0xa')][a28_0x8bf4('0x9')](this);}[a28_0x8bf4('0x8')](_0x2f6f31,_0x1b6d32,_0x25ef1e){this[a28_0x8bf4('0x7')][a28_0x8bf4('0xb')]({'where':{'username':_0x2f6f31['body']['username']},'attributes':['id',a28_0x8bf4('0xc'),a28_0x8bf4('0xd'),a28_0x8bf4('0xe'),a28_0x8bf4('0xf'),a28_0x8bf4('0x10')]})[a28_0x8bf4('0x11')](_0x320408=>{if(!_0x320408){return responseUtils[a28_0x8bf4('0x12')](_0x1b6d32,LocaleStrings['usernameNotFoundError'],0x193);}if(authUtils[a28_0x8bf4('0x13')](_0x2f6f31[a28_0x8bf4('0x14')]['password'],_0x320408['password'])){_0x320408=_0x320408['toJSON']();const _0x27822a={'id':_0x320408['id']};const _0x492781=jwt['sign'](_0x27822a,configJwt[a28_0x8bf4('0x15')]);delete _0x320408[a28_0x8bf4('0x10')];_0x320408[a28_0x8bf4('0x16')]=_0x492781;return responseUtils[a28_0x8bf4('0x17')](_0x1b6d32,_0x320408,0xc8);}else{return responseUtils['errorResponse'](_0x1b6d32,_0x1b6d32['__'](LocaleStrings[a28_0x8bf4('0x18')]),0x193);}})[a28_0x8bf4('0x19')](_0x1efa94=>{return responseUtils['errorResponse'](_0x1b6d32,_0x1efa94[a28_0x8bf4('0x1a')],0x1f4);});}['createAccount'](_0x22669b,_0x56eb12,_0x3ffb92){this[a28_0x8bf4('0x7')]['findOne']({'where':{'username':_0x22669b[a28_0x8bf4('0x14')][a28_0x8bf4('0xf')]}})[a28_0x8bf4('0x11')](function(_0x1b145b){if(_0x1b145b){return responseUtils['errorResponse'](_0x56eb12,_0x56eb12['__'](LocaleStrings['usernameTakenError'],_0x22669b[a28_0x8bf4('0x14')][a28_0x8bf4('0xf')]),0x193);}else{_0x22669b['body']['email']=_0x22669b[a28_0x8bf4('0x14')][a28_0x8bf4('0xf')];const _0x30dc7f={'username':_0x22669b[a28_0x8bf4('0x14')][a28_0x8bf4('0xf')],'password':authUtils[a28_0x8bf4('0x1b')](_0x22669b['body'][a28_0x8bf4('0x10')])};this[a28_0x8bf4('0x7')]['create'](_0x30dc7f)[a28_0x8bf4('0x11')](function(_0x3f7949,_0x260bc8){return responseUtils[a28_0x8bf4('0x17')](_0x56eb12,_0x3f7949,0xc8);})[a28_0x8bf4('0x19')](_0x3daa5d=>{return responseUtils['errorResponse'](_0x56eb12,_0x3daa5d['stack'],0x1f4);});}})[a28_0x8bf4('0x19')](_0xd7b8d=>{return responseUtils[a28_0x8bf4('0x12')](_0x56eb12,_0xd7b8d[a28_0x8bf4('0x1a')],0x1f4);});}}exports[a28_0x8bf4('0x1c')]=AuthConstroller;
var a9_0x5b1d=['../../infrastructure/auth-utils','../../infrastructure/response-utils','../../resources/locale-strings','model','login','bind','createAccount','body','username','first_name','last_name','email','password','then','usernameNotFoundError','validPassword','toJSON','secret','token','successResponse','passwordNotMatchError','catch','stack','findOne','errorResponse','usernameTakenError','generateHash','create','default','__esModule','jsonwebtoken'];(function(_0x275342,_0xb0945f){var _0x28f2e0=function(_0x2b07b1){while(--_0x2b07b1){_0x275342['push'](_0x275342['shift']());}};_0x28f2e0(++_0xb0945f);}(a9_0x5b1d,0x99));var a9_0x18fc=function(_0xbd7fc4,_0x4629b6){_0xbd7fc4=_0xbd7fc4-0x0;var _0x2b8346=a9_0x5b1d[_0xbd7fc4];return _0x2b8346;};'use strict';Object['defineProperty'](exports,a9_0x18fc('0x0'),{'value':!![]});const jwt=require(a9_0x18fc('0x1'));const i18n=require('i18n');const configJwt=require('../../config/jwt.js');const authUtils=require(a9_0x18fc('0x2'));const responseUtils=require(a9_0x18fc('0x3'));const LocaleStrings=require(a9_0x18fc('0x4'));class AuthConstroller{constructor(_0x297e65){this[a9_0x18fc('0x5')]=_0x297e65;this['login']=this[a9_0x18fc('0x6')][a9_0x18fc('0x7')](this);this[a9_0x18fc('0x8')]=this[a9_0x18fc('0x8')][a9_0x18fc('0x7')](this);}[a9_0x18fc('0x6')](_0x380cc9,_0x128e8a,_0x4d0bad){this[a9_0x18fc('0x5')]['findOne']({'where':{'username':_0x380cc9[a9_0x18fc('0x9')][a9_0x18fc('0xa')]},'attributes':['id',a9_0x18fc('0xb'),a9_0x18fc('0xc'),a9_0x18fc('0xd'),a9_0x18fc('0xa'),a9_0x18fc('0xe')]})[a9_0x18fc('0xf')](_0x3d4beb=>{if(!_0x3d4beb){return responseUtils['errorResponse'](_0x128e8a,LocaleStrings[a9_0x18fc('0x10')],0x193);}if(authUtils[a9_0x18fc('0x11')](_0x380cc9['body']['password'],_0x3d4beb[a9_0x18fc('0xe')])){_0x3d4beb=_0x3d4beb[a9_0x18fc('0x12')]();const _0x211f96={'id':_0x3d4beb['id']};const _0x53c3da=jwt['sign'](_0x211f96,configJwt[a9_0x18fc('0x13')]);delete _0x3d4beb[a9_0x18fc('0xe')];_0x3d4beb[a9_0x18fc('0x14')]=_0x53c3da;return responseUtils[a9_0x18fc('0x15')](_0x128e8a,_0x3d4beb,0xc8);}else{return responseUtils['errorResponse'](_0x128e8a,_0x128e8a['__'](LocaleStrings[a9_0x18fc('0x16')]),0x193);}})[a9_0x18fc('0x17')](_0x5491cf=>{return responseUtils['errorResponse'](_0x128e8a,_0x5491cf[a9_0x18fc('0x18')],0x1f4);});}[a9_0x18fc('0x8')](_0xb1fbea,_0x2a39ee,_0x3440bf){this[a9_0x18fc('0x5')][a9_0x18fc('0x19')]({'where':{'username':_0xb1fbea[a9_0x18fc('0x9')][a9_0x18fc('0xa')]}})[a9_0x18fc('0xf')](function(_0x5f1516){if(_0x5f1516){return responseUtils[a9_0x18fc('0x1a')](_0x2a39ee,_0x2a39ee['__'](LocaleStrings[a9_0x18fc('0x1b')],_0xb1fbea[a9_0x18fc('0x9')][a9_0x18fc('0xa')]),0x193);}else{_0xb1fbea[a9_0x18fc('0x9')][a9_0x18fc('0xd')]=_0xb1fbea[a9_0x18fc('0x9')]['username'];const _0x5cf1f0={'username':_0xb1fbea[a9_0x18fc('0x9')][a9_0x18fc('0xa')],'password':authUtils[a9_0x18fc('0x1c')](_0xb1fbea[a9_0x18fc('0x9')][a9_0x18fc('0xe')])};this[a9_0x18fc('0x5')][a9_0x18fc('0x1d')](_0x5cf1f0)[a9_0x18fc('0xf')](function(_0x3f4466,_0x1cb8f3){return responseUtils['successResponse'](_0x2a39ee,_0x3f4466,0xc8);})[a9_0x18fc('0x17')](_0x68f14e=>{return responseUtils[a9_0x18fc('0x1a')](_0x2a39ee,_0x68f14e[a9_0x18fc('0x18')],0x1f4);});}})['catch'](_0x3a8815=>{return responseUtils['errorResponse'](_0x2a39ee,_0x3a8815[a9_0x18fc('0x18')],0x1f4);});}}exports[a9_0x18fc('0x1e')]=AuthConstroller;
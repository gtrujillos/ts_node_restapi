var a9_0x40b7=['../../config/jwt.js','../../infrastructure/auth-utils','../../infrastructure/response-utils','model','login','bind','createAccount','findOne','body','username','first_name','last_name','email','then','errorResponse','usernameNotFoundError','password','toJSON','secret','successResponse','passwordNotMatchError','generateHash','catch','stack','default','__esModule','jsonwebtoken','i18n'];(function(_0x46354c,_0x2efd45){var _0x3d44bd=function(_0x197e0e){while(--_0x197e0e){_0x46354c['push'](_0x46354c['shift']());}};_0x3d44bd(++_0x2efd45);}(a9_0x40b7,0xa5));var a9_0x43ca=function(_0x46a7d1,_0x34739c){_0x46a7d1=_0x46a7d1-0x0;var _0x2f4b37=a9_0x40b7[_0x46a7d1];return _0x2f4b37;};'use strict';Object['defineProperty'](exports,a9_0x43ca('0x0'),{'value':!![]});const jwt=require(a9_0x43ca('0x1'));const i18n=require(a9_0x43ca('0x2'));const configJwt=require(a9_0x43ca('0x3'));const authUtils=require(a9_0x43ca('0x4'));const responseUtils=require(a9_0x43ca('0x5'));const LocaleStrings=require('../../resources/locale-strings');class AuthConstroller{constructor(_0x1b84db){this[a9_0x43ca('0x6')]=_0x1b84db;this[a9_0x43ca('0x7')]=this[a9_0x43ca('0x7')][a9_0x43ca('0x8')](this);this[a9_0x43ca('0x9')]=this[a9_0x43ca('0x9')][a9_0x43ca('0x8')](this);}['login'](_0x369964,_0x5902ee,_0x1d0c17){this[a9_0x43ca('0x6')][a9_0x43ca('0xa')]({'where':{'username':_0x369964[a9_0x43ca('0xb')][a9_0x43ca('0xc')]},'attributes':['id',a9_0x43ca('0xd'),a9_0x43ca('0xe'),a9_0x43ca('0xf'),a9_0x43ca('0xc'),'password']})[a9_0x43ca('0x10')](_0x35b24b=>{if(!_0x35b24b){return responseUtils[a9_0x43ca('0x11')](_0x5902ee,LocaleStrings[a9_0x43ca('0x12')],0x193);}if(authUtils['validPassword'](_0x369964['body'][a9_0x43ca('0x13')],_0x35b24b['password'])){_0x35b24b=_0x35b24b[a9_0x43ca('0x14')]();const _0x1e644d={'id':_0x35b24b['id']};const _0x4420e2=jwt['sign'](_0x1e644d,configJwt[a9_0x43ca('0x15')]);delete _0x35b24b['password'];_0x35b24b['token']=_0x4420e2;return responseUtils[a9_0x43ca('0x16')](_0x5902ee,_0x35b24b,0xc8);}else{return responseUtils[a9_0x43ca('0x11')](_0x5902ee,_0x5902ee['__'](LocaleStrings[a9_0x43ca('0x17')]),0x193);}})['catch'](_0x3a30e3=>{return responseUtils[a9_0x43ca('0x11')](_0x5902ee,_0x3a30e3['stack'],0x1f4);});}['createAccount'](_0x1ea192,_0x69c84d,_0x103880){this[a9_0x43ca('0x6')][a9_0x43ca('0xa')]({'where':{'username':_0x1ea192[a9_0x43ca('0xb')][a9_0x43ca('0xc')]}})[a9_0x43ca('0x10')](function(_0x5303f0){if(_0x5303f0){return responseUtils[a9_0x43ca('0x11')](_0x69c84d,_0x69c84d['__'](LocaleStrings['usernameTakenError'],_0x1ea192[a9_0x43ca('0xb')][a9_0x43ca('0xc')]),0x193);}else{_0x1ea192[a9_0x43ca('0xb')][a9_0x43ca('0xf')]=_0x1ea192[a9_0x43ca('0xb')][a9_0x43ca('0xc')];const _0x5eba66={'username':_0x1ea192[a9_0x43ca('0xb')][a9_0x43ca('0xc')],'password':authUtils[a9_0x43ca('0x18')](_0x1ea192[a9_0x43ca('0xb')]['password'])};this[a9_0x43ca('0x6')]['create'](_0x5eba66)[a9_0x43ca('0x10')](function(_0x13c73f,_0x48b3ca){return responseUtils['successResponse'](_0x69c84d,_0x13c73f,0xc8);})[a9_0x43ca('0x19')](_0x3c9593=>{return responseUtils[a9_0x43ca('0x11')](_0x69c84d,_0x3c9593[a9_0x43ca('0x1a')],0x1f4);});}})[a9_0x43ca('0x19')](_0x55701b=>{return responseUtils['errorResponse'](_0x69c84d,_0x55701b[a9_0x43ca('0x1a')],0x1f4);});}}exports[a9_0x43ca('0x1b')]=AuthConstroller;
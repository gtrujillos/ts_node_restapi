var a9_0x18d2=['last_name','password','usernameNotFoundError','validPassword','toJSON','secret','successResponse','errorResponse','passwordNotMatchError','stack','then','email','create','catch','defineProperty','__esModule','jsonwebtoken','i18n','../../infrastructure/auth-utils','../../infrastructure/response-utils','../../resources/locale-strings','model','login','createAccount','bind','findOne','body','username','first_name'];(function(_0x481822,_0x2f8439){var _0x1a11bf=function(_0x219858){while(--_0x219858){_0x481822['push'](_0x481822['shift']());}};_0x1a11bf(++_0x2f8439);}(a9_0x18d2,0x130));var a9_0x49ee=function(_0x2993de,_0x152008){_0x2993de=_0x2993de-0x0;var _0x5dc89f=a9_0x18d2[_0x2993de];return _0x5dc89f;};'use strict';Object[a9_0x49ee('0x0')](exports,a9_0x49ee('0x1'),{'value':!![]});const jwt=require(a9_0x49ee('0x2'));const i18n=require(a9_0x49ee('0x3'));const configJwt=require('../../config/jwt.js');const authUtils=require(a9_0x49ee('0x4'));const responseUtils=require(a9_0x49ee('0x5'));const LocaleStrings=require(a9_0x49ee('0x6'));class AuthConstroller{constructor(_0x2dc3bb){this[a9_0x49ee('0x7')]=_0x2dc3bb;this[a9_0x49ee('0x8')]=this[a9_0x49ee('0x8')]['bind'](this);this[a9_0x49ee('0x9')]=this[a9_0x49ee('0x9')][a9_0x49ee('0xa')](this);}[a9_0x49ee('0x8')](_0x18e0f5,_0x283d38,_0x5acb12){this[a9_0x49ee('0x7')][a9_0x49ee('0xb')]({'where':{'username':_0x18e0f5[a9_0x49ee('0xc')][a9_0x49ee('0xd')]},'attributes':['id',a9_0x49ee('0xe'),a9_0x49ee('0xf'),'email',a9_0x49ee('0xd'),a9_0x49ee('0x10')]})['then'](_0x15b73f=>{if(!_0x15b73f){return responseUtils['errorResponse'](_0x283d38,LocaleStrings[a9_0x49ee('0x11')],0x193);}if(authUtils[a9_0x49ee('0x12')](_0x18e0f5['body'][a9_0x49ee('0x10')],_0x15b73f[a9_0x49ee('0x10')])){_0x15b73f=_0x15b73f[a9_0x49ee('0x13')]();const _0x17f678={'id':_0x15b73f['id']};const _0x3626ad=jwt['sign'](_0x17f678,configJwt[a9_0x49ee('0x14')]);delete _0x15b73f[a9_0x49ee('0x10')];_0x15b73f['token']=_0x3626ad;return responseUtils[a9_0x49ee('0x15')](_0x283d38,_0x15b73f,0xc8);}else{return responseUtils[a9_0x49ee('0x16')](_0x283d38,_0x283d38['__'](LocaleStrings[a9_0x49ee('0x17')]),0x193);}})['catch'](_0x2bb537=>{return responseUtils['errorResponse'](_0x283d38,_0x2bb537[a9_0x49ee('0x18')],0x1f4);});}[a9_0x49ee('0x9')](_0x49fbd2,_0x5d2602,_0x2ad1e3){this[a9_0x49ee('0x7')][a9_0x49ee('0xb')]({'where':{'username':_0x49fbd2['body'][a9_0x49ee('0xd')]}})[a9_0x49ee('0x19')](function(_0x3998ec){if(_0x3998ec){return responseUtils[a9_0x49ee('0x16')](_0x5d2602,_0x5d2602['__'](LocaleStrings['usernameTakenError'],_0x49fbd2[a9_0x49ee('0xc')][a9_0x49ee('0xd')]),0x193);}else{_0x49fbd2[a9_0x49ee('0xc')][a9_0x49ee('0x1a')]=_0x49fbd2['body'][a9_0x49ee('0xd')];const _0xc61ec3={'username':_0x49fbd2['body']['username'],'password':authUtils['generateHash'](_0x49fbd2[a9_0x49ee('0xc')][a9_0x49ee('0x10')])};this[a9_0x49ee('0x7')][a9_0x49ee('0x1b')](_0xc61ec3)['then'](function(_0x49d5ff,_0x372dd4){return responseUtils[a9_0x49ee('0x15')](_0x5d2602,_0x49d5ff,0xc8);})[a9_0x49ee('0x1c')](_0x2e505d=>{return responseUtils[a9_0x49ee('0x16')](_0x5d2602,_0x2e505d['stack'],0x1f4);});}})[a9_0x49ee('0x1c')](_0x5b7b10=>{return responseUtils[a9_0x49ee('0x16')](_0x5d2602,_0x5b7b10[a9_0x49ee('0x18')],0x1f4);});}}exports['default']=AuthConstroller;
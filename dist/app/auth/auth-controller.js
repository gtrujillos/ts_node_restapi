var a28_0x28b4=['../../infrastructure/response-utils','../../resources/locale-strings','model','login','bind','createAccount','body','username','last_name','email','errorResponse','validPassword','password','toJSON','secret','token','successResponse','passwordNotMatchError','findOne','then','generateHash','create','stack','catch','default','defineProperty','__esModule','jsonwebtoken','i18n','../../config/jwt.js','../../infrastructure/auth-utils'];(function(_0x342fd6,_0x5a5fca){var _0x351c9f=function(_0x557125){while(--_0x557125){_0x342fd6['push'](_0x342fd6['shift']());}};_0x351c9f(++_0x5a5fca);}(a28_0x28b4,0x14f));var a28_0x23ac=function(_0x17d531,_0x1b12c6){_0x17d531=_0x17d531-0x0;var _0x3c133f=a28_0x28b4[_0x17d531];return _0x3c133f;};'use strict';Object[a28_0x23ac('0x0')](exports,a28_0x23ac('0x1'),{'value':!![]});const jwt=require(a28_0x23ac('0x2'));const i18n=require(a28_0x23ac('0x3'));const configJwt=require(a28_0x23ac('0x4'));const authUtils=require(a28_0x23ac('0x5'));const responseUtils=require(a28_0x23ac('0x6'));const LocaleStrings=require(a28_0x23ac('0x7'));class AuthConstroller{constructor(_0x59f5d5){this[a28_0x23ac('0x8')]=_0x59f5d5;this[a28_0x23ac('0x9')]=this[a28_0x23ac('0x9')][a28_0x23ac('0xa')](this);this[a28_0x23ac('0xb')]=this[a28_0x23ac('0xb')][a28_0x23ac('0xa')](this);}['login'](_0x1557b5,_0x364d57,_0x519003){this[a28_0x23ac('0x8')]['findOne']({'where':{'username':_0x1557b5[a28_0x23ac('0xc')][a28_0x23ac('0xd')]},'attributes':['id','first_name',a28_0x23ac('0xe'),a28_0x23ac('0xf'),a28_0x23ac('0xd'),'password']})['then'](_0x406224=>{if(!_0x406224){return responseUtils[a28_0x23ac('0x10')](_0x364d57,LocaleStrings['usernameNotFoundError'],0x193);}if(authUtils[a28_0x23ac('0x11')](_0x1557b5[a28_0x23ac('0xc')][a28_0x23ac('0x12')],_0x406224[a28_0x23ac('0x12')])){_0x406224=_0x406224[a28_0x23ac('0x13')]();const _0x3ccd8f={'id':_0x406224['id']};const _0x15eedb=jwt['sign'](_0x3ccd8f,configJwt[a28_0x23ac('0x14')]);delete _0x406224[a28_0x23ac('0x12')];_0x406224[a28_0x23ac('0x15')]=_0x15eedb;return responseUtils[a28_0x23ac('0x16')](_0x364d57,_0x406224,0xc8);}else{return responseUtils[a28_0x23ac('0x10')](_0x364d57,_0x364d57['__'](LocaleStrings[a28_0x23ac('0x17')]),0x193);}})['catch'](_0x1d8e70=>{return responseUtils[a28_0x23ac('0x10')](_0x364d57,_0x1d8e70['stack'],0x1f4);});}[a28_0x23ac('0xb')](_0x499bc9,_0x4b7873,_0x5d3eca){this[a28_0x23ac('0x8')][a28_0x23ac('0x18')]({'where':{'username':_0x499bc9[a28_0x23ac('0xc')][a28_0x23ac('0xd')]}})[a28_0x23ac('0x19')](function(_0x75dea5){if(_0x75dea5){return responseUtils['errorResponse'](_0x4b7873,_0x4b7873['__'](LocaleStrings['usernameTakenError'],_0x499bc9[a28_0x23ac('0xc')][a28_0x23ac('0xd')]),0x193);}else{_0x499bc9[a28_0x23ac('0xc')][a28_0x23ac('0xf')]=_0x499bc9['body'][a28_0x23ac('0xd')];const _0x47ecd7={'username':_0x499bc9[a28_0x23ac('0xc')][a28_0x23ac('0xd')],'password':authUtils[a28_0x23ac('0x1a')](_0x499bc9['body'][a28_0x23ac('0x12')])};this[a28_0x23ac('0x8')][a28_0x23ac('0x1b')](_0x47ecd7)['then'](function(_0xd11589,_0xfc6bc9){return responseUtils['successResponse'](_0x4b7873,_0xd11589,0xc8);})['catch'](_0x4db8f2=>{return responseUtils[a28_0x23ac('0x10')](_0x4b7873,_0x4db8f2[a28_0x23ac('0x1c')],0x1f4);});}})[a28_0x23ac('0x1d')](_0x3a5fbc=>{return responseUtils[a28_0x23ac('0x10')](_0x4b7873,_0x3a5fbc[a28_0x23ac('0x1c')],0x1f4);});}}exports[a28_0x23ac('0x1e')]=AuthConstroller;
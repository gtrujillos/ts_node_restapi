var a9_0x21ff=['stack','default','defineProperty','__esModule','jsonwebtoken','i18n','../../config/jwt.js','../../infrastructure/response-utils','../../resources/locale-strings','login','bind','createAccount','model','findOne','body','username','first_name','last_name','email','password','then','usernameNotFoundError','validPassword','toJSON','sign','secret','token','successResponse','passwordNotMatchError','catch','errorResponse','usernameTakenError','generateHash'];(function(_0xf3416d,_0x1381b6){var _0x5daf8d=function(_0x52bec9){while(--_0x52bec9){_0xf3416d['push'](_0xf3416d['shift']());}};_0x5daf8d(++_0x1381b6);}(a9_0x21ff,0xe9));var a9_0x4f15=function(_0x30c684,_0x46dd78){_0x30c684=_0x30c684-0x0;var _0x3780e3=a9_0x21ff[_0x30c684];return _0x3780e3;};'use strict';Object[a9_0x4f15('0x0')](exports,a9_0x4f15('0x1'),{'value':!![]});const jwt=require(a9_0x4f15('0x2'));const i18n=require(a9_0x4f15('0x3'));const configJwt=require(a9_0x4f15('0x4'));const authUtils=require('../../infrastructure/auth-utils');const responseUtils=require(a9_0x4f15('0x5'));const LocaleStrings=require(a9_0x4f15('0x6'));class AuthConstroller{constructor(_0x19883b){this['model']=_0x19883b;this[a9_0x4f15('0x7')]=this[a9_0x4f15('0x7')][a9_0x4f15('0x8')](this);this[a9_0x4f15('0x9')]=this[a9_0x4f15('0x9')][a9_0x4f15('0x8')](this);}['login'](_0x569b42,_0x1569cc,_0x2677fc){this[a9_0x4f15('0xa')][a9_0x4f15('0xb')]({'where':{'username':_0x569b42[a9_0x4f15('0xc')][a9_0x4f15('0xd')]},'attributes':['id',a9_0x4f15('0xe'),a9_0x4f15('0xf'),a9_0x4f15('0x10'),a9_0x4f15('0xd'),a9_0x4f15('0x11')]})[a9_0x4f15('0x12')](_0x20bce8=>{if(!_0x20bce8){return responseUtils['errorResponse'](_0x1569cc,LocaleStrings[a9_0x4f15('0x13')],0x193);}if(authUtils[a9_0x4f15('0x14')](_0x569b42[a9_0x4f15('0xc')][a9_0x4f15('0x11')],_0x20bce8[a9_0x4f15('0x11')])){_0x20bce8=_0x20bce8[a9_0x4f15('0x15')]();const _0x2d8723={'id':_0x20bce8['id']};const _0x42f8cf=jwt[a9_0x4f15('0x16')](_0x2d8723,configJwt[a9_0x4f15('0x17')]);delete _0x20bce8['password'];_0x20bce8[a9_0x4f15('0x18')]=_0x42f8cf;return responseUtils[a9_0x4f15('0x19')](_0x1569cc,_0x20bce8,0xc8);}else{return responseUtils['errorResponse'](_0x1569cc,_0x1569cc['__'](LocaleStrings[a9_0x4f15('0x1a')]),0x193);}})[a9_0x4f15('0x1b')](_0x278e63=>{return responseUtils['errorResponse'](_0x1569cc,_0x278e63['stack'],0x1f4);});}[a9_0x4f15('0x9')](_0x4cdd51,_0x3e24dc,_0x5e3579){this[a9_0x4f15('0xa')][a9_0x4f15('0xb')]({'where':{'username':_0x4cdd51[a9_0x4f15('0xc')][a9_0x4f15('0xd')]}})[a9_0x4f15('0x12')](function(_0x5ad907){if(_0x5ad907){return responseUtils[a9_0x4f15('0x1c')](_0x3e24dc,_0x3e24dc['__'](LocaleStrings[a9_0x4f15('0x1d')],_0x4cdd51[a9_0x4f15('0xc')][a9_0x4f15('0xd')]),0x193);}else{_0x4cdd51[a9_0x4f15('0xc')][a9_0x4f15('0x10')]=_0x4cdd51[a9_0x4f15('0xc')][a9_0x4f15('0xd')];const _0x248175={'username':_0x4cdd51[a9_0x4f15('0xc')][a9_0x4f15('0xd')],'password':authUtils[a9_0x4f15('0x1e')](_0x4cdd51[a9_0x4f15('0xc')][a9_0x4f15('0x11')])};this[a9_0x4f15('0xa')]['create'](_0x248175)[a9_0x4f15('0x12')](function(_0x501345,_0x266f73){return responseUtils[a9_0x4f15('0x19')](_0x3e24dc,_0x501345,0xc8);})['catch'](_0x72c608=>{return responseUtils[a9_0x4f15('0x1c')](_0x3e24dc,_0x72c608[a9_0x4f15('0x1f')],0x1f4);});}})[a9_0x4f15('0x1b')](_0xa054c7=>{return responseUtils['errorResponse'](_0x3e24dc,_0xa054c7['stack'],0x1f4);});}}exports[a9_0x4f15('0x20')]=AuthConstroller;
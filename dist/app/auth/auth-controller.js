var a9_0x29bc=['__esModule','jsonwebtoken','i18n','../../config/jwt.js','../../infrastructure/response-utils','../../resources/locale-strings','login','createAccount','bind','model','body','username','last_name','password','errorResponse','usernameNotFoundError','toJSON','sign','secret','token','successResponse','catch','stack','findOne','generateHash','create','then','defineProperty'];(function(_0x55ff57,_0x1c17ad){var _0x5c58f2=function(_0x555b2d){while(--_0x555b2d){_0x55ff57['push'](_0x55ff57['shift']());}};_0x5c58f2(++_0x1c17ad);}(a9_0x29bc,0x1bf));var a9_0x29f1=function(_0xb5a54d,_0x9a7955){_0xb5a54d=_0xb5a54d-0x0;var _0x531e9d=a9_0x29bc[_0xb5a54d];return _0x531e9d;};'use strict';Object[a9_0x29f1('0x0')](exports,a9_0x29f1('0x1'),{'value':!![]});const jwt=require(a9_0x29f1('0x2'));const i18n=require(a9_0x29f1('0x3'));const configJwt=require(a9_0x29f1('0x4'));const authUtils=require('../../infrastructure/auth-utils');const responseUtils=require(a9_0x29f1('0x5'));const LocaleStrings=require(a9_0x29f1('0x6'));class AuthConstroller{constructor(_0x557e53){this['model']=_0x557e53;this[a9_0x29f1('0x7')]=this[a9_0x29f1('0x7')]['bind'](this);this[a9_0x29f1('0x8')]=this[a9_0x29f1('0x8')][a9_0x29f1('0x9')](this);}[a9_0x29f1('0x7')](_0xa81def,_0x5c637c,_0x5957ea){this[a9_0x29f1('0xa')]['findOne']({'where':{'username':_0xa81def[a9_0x29f1('0xb')][a9_0x29f1('0xc')]},'attributes':['id','first_name',a9_0x29f1('0xd'),'email','username',a9_0x29f1('0xe')]})['then'](_0x44d95e=>{if(!_0x44d95e){return responseUtils[a9_0x29f1('0xf')](_0x5c637c,LocaleStrings[a9_0x29f1('0x10')],0x193);}if(authUtils['validPassword'](_0xa81def[a9_0x29f1('0xb')][a9_0x29f1('0xe')],_0x44d95e['password'])){_0x44d95e=_0x44d95e[a9_0x29f1('0x11')]();const _0xf91856={'id':_0x44d95e['id']};const _0x2a22f7=jwt[a9_0x29f1('0x12')](_0xf91856,configJwt[a9_0x29f1('0x13')]);delete _0x44d95e[a9_0x29f1('0xe')];_0x44d95e[a9_0x29f1('0x14')]=_0x2a22f7;return responseUtils[a9_0x29f1('0x15')](_0x5c637c,_0x44d95e,0xc8);}else{return responseUtils[a9_0x29f1('0xf')](_0x5c637c,_0x5c637c['__'](LocaleStrings['passwordNotMatchError']),0x193);}})[a9_0x29f1('0x16')](_0x2753b3=>{return responseUtils[a9_0x29f1('0xf')](_0x5c637c,_0x2753b3[a9_0x29f1('0x17')],0x1f4);});}[a9_0x29f1('0x8')](_0x37e72a,_0x55c67b,_0xd80383){this[a9_0x29f1('0xa')][a9_0x29f1('0x18')]({'where':{'username':_0x37e72a['body'][a9_0x29f1('0xc')]}})['then'](function(_0x511775){if(_0x511775){return responseUtils[a9_0x29f1('0xf')](_0x55c67b,_0x55c67b['__'](LocaleStrings['usernameTakenError'],_0x37e72a['body']['username']),0x193);}else{_0x37e72a['body']['email']=_0x37e72a[a9_0x29f1('0xb')][a9_0x29f1('0xc')];const _0x3e565e={'username':_0x37e72a[a9_0x29f1('0xb')]['username'],'password':authUtils[a9_0x29f1('0x19')](_0x37e72a[a9_0x29f1('0xb')][a9_0x29f1('0xe')])};this[a9_0x29f1('0xa')][a9_0x29f1('0x1a')](_0x3e565e)[a9_0x29f1('0x1b')](function(_0x30a1df,_0x5d3dec){return responseUtils[a9_0x29f1('0x15')](_0x55c67b,_0x30a1df,0xc8);})['catch'](_0x5d5877=>{return responseUtils['errorResponse'](_0x55c67b,_0x5d5877[a9_0x29f1('0x17')],0x1f4);});}})[a9_0x29f1('0x16')](_0x4b4319=>{return responseUtils[a9_0x29f1('0xf')](_0x55c67b,_0x4b4319[a9_0x29f1('0x17')],0x1f4);});}}exports['default']=AuthConstroller;
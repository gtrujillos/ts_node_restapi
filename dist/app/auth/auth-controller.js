var a28_0x162c=['__esModule','jsonwebtoken','../../config/jwt.js','../../infrastructure/auth-utils','model','login','createAccount','bind','findOne','body','username','first_name','last_name','email','password','then','usernameNotFoundError','toJSON','sign','secret','token','successResponse','passwordNotMatchError','stack','errorResponse','usernameTakenError','generateHash','create','catch','default','defineProperty'];(function(_0x74e78c,_0x38ff22){var _0x4032e7=function(_0x48f07b){while(--_0x48f07b){_0x74e78c['push'](_0x74e78c['shift']());}};_0x4032e7(++_0x38ff22);}(a28_0x162c,0xd8));var a28_0x36c3=function(_0x3b9690,_0x45e53c){_0x3b9690=_0x3b9690-0x0;var _0x46dc8a=a28_0x162c[_0x3b9690];return _0x46dc8a;};'use strict';Object[a28_0x36c3('0x0')](exports,a28_0x36c3('0x1'),{'value':!![]});const jwt=require(a28_0x36c3('0x2'));const i18n=require('i18n');const configJwt=require(a28_0x36c3('0x3'));const authUtils=require(a28_0x36c3('0x4'));const responseUtils=require('../../infrastructure/response-utils');const LocaleStrings=require('../../resources/locale-strings');class AuthConstroller{constructor(_0x28e7a4){this[a28_0x36c3('0x5')]=_0x28e7a4;this[a28_0x36c3('0x6')]=this['login']['bind'](this);this[a28_0x36c3('0x7')]=this[a28_0x36c3('0x7')][a28_0x36c3('0x8')](this);}['login'](_0x20d8fd,_0x374c0d,_0x6facd1){this[a28_0x36c3('0x5')][a28_0x36c3('0x9')]({'where':{'username':_0x20d8fd[a28_0x36c3('0xa')][a28_0x36c3('0xb')]},'attributes':['id',a28_0x36c3('0xc'),a28_0x36c3('0xd'),a28_0x36c3('0xe'),a28_0x36c3('0xb'),a28_0x36c3('0xf')]})[a28_0x36c3('0x10')](_0x1a84cb=>{if(!_0x1a84cb){return responseUtils['errorResponse'](_0x374c0d,LocaleStrings[a28_0x36c3('0x11')],0x193);}if(authUtils['validPassword'](_0x20d8fd[a28_0x36c3('0xa')]['password'],_0x1a84cb['password'])){_0x1a84cb=_0x1a84cb[a28_0x36c3('0x12')]();const _0x5365ab={'id':_0x1a84cb['id']};const _0x2f9337=jwt[a28_0x36c3('0x13')](_0x5365ab,configJwt[a28_0x36c3('0x14')]);delete _0x1a84cb['password'];_0x1a84cb[a28_0x36c3('0x15')]=_0x2f9337;return responseUtils[a28_0x36c3('0x16')](_0x374c0d,_0x1a84cb,0xc8);}else{return responseUtils['errorResponse'](_0x374c0d,_0x374c0d['__'](LocaleStrings[a28_0x36c3('0x17')]),0x193);}})['catch'](_0x50931c=>{return responseUtils['errorResponse'](_0x374c0d,_0x50931c[a28_0x36c3('0x18')],0x1f4);});}['createAccount'](_0xe64d69,_0x53586a,_0x29d065){this[a28_0x36c3('0x5')][a28_0x36c3('0x9')]({'where':{'username':_0xe64d69['body']['username']}})[a28_0x36c3('0x10')](function(_0x16b7c0){if(_0x16b7c0){return responseUtils[a28_0x36c3('0x19')](_0x53586a,_0x53586a['__'](LocaleStrings[a28_0x36c3('0x1a')],_0xe64d69[a28_0x36c3('0xa')][a28_0x36c3('0xb')]),0x193);}else{_0xe64d69[a28_0x36c3('0xa')][a28_0x36c3('0xe')]=_0xe64d69['body'][a28_0x36c3('0xb')];const _0x303155={'username':_0xe64d69[a28_0x36c3('0xa')]['username'],'password':authUtils[a28_0x36c3('0x1b')](_0xe64d69[a28_0x36c3('0xa')]['password'])};this['model'][a28_0x36c3('0x1c')](_0x303155)[a28_0x36c3('0x10')](function(_0x559a13,_0x1fcae8){return responseUtils[a28_0x36c3('0x16')](_0x53586a,_0x559a13,0xc8);})[a28_0x36c3('0x1d')](_0x109fba=>{return responseUtils[a28_0x36c3('0x19')](_0x53586a,_0x109fba[a28_0x36c3('0x18')],0x1f4);});}})[a28_0x36c3('0x1d')](_0x5d34e2=>{return responseUtils[a28_0x36c3('0x19')](_0x53586a,_0x5d34e2[a28_0x36c3('0x18')],0x1f4);});}}exports[a28_0x36c3('0x1e')]=AuthConstroller;
var a9_0x2fd5=['username','last_name','email','password','then','validPassword','toJSON','sign','token','successResponse','passwordNotMatchError','catch','errorResponse','stack','usernameTakenError','generateHash','create','default','defineProperty','__esModule','i18n','../../config/jwt.js','../../infrastructure/response-utils','../../resources/locale-strings','model','login','createAccount','bind','findOne','body'];(function(_0x2f50ef,_0x5d357e){var _0x53b695=function(_0x131d93){while(--_0x131d93){_0x2f50ef['push'](_0x2f50ef['shift']());}};_0x53b695(++_0x5d357e);}(a9_0x2fd5,0x17a));var a9_0xbaaf=function(_0xa72ea7,_0x4d4d50){_0xa72ea7=_0xa72ea7-0x0;var _0x1824d6=a9_0x2fd5[_0xa72ea7];return _0x1824d6;};'use strict';Object[a9_0xbaaf('0x0')](exports,a9_0xbaaf('0x1'),{'value':!![]});const jwt=require('jsonwebtoken');const i18n=require(a9_0xbaaf('0x2'));const configJwt=require(a9_0xbaaf('0x3'));const authUtils=require('../../infrastructure/auth-utils');const responseUtils=require(a9_0xbaaf('0x4'));const LocaleStrings=require(a9_0xbaaf('0x5'));class AuthConstroller{constructor(_0x16f269){this[a9_0xbaaf('0x6')]=_0x16f269;this[a9_0xbaaf('0x7')]=this['login']['bind'](this);this[a9_0xbaaf('0x8')]=this[a9_0xbaaf('0x8')][a9_0xbaaf('0x9')](this);}['login'](_0x8fa658,_0x543f8a,_0x49943d){this['model'][a9_0xbaaf('0xa')]({'where':{'username':_0x8fa658[a9_0xbaaf('0xb')][a9_0xbaaf('0xc')]},'attributes':['id','first_name',a9_0xbaaf('0xd'),a9_0xbaaf('0xe'),a9_0xbaaf('0xc'),a9_0xbaaf('0xf')]})[a9_0xbaaf('0x10')](_0x7b4017=>{if(!_0x7b4017){return responseUtils['errorResponse'](_0x543f8a,LocaleStrings['usernameNotFoundError'],0x193);}if(authUtils[a9_0xbaaf('0x11')](_0x8fa658['body']['password'],_0x7b4017[a9_0xbaaf('0xf')])){_0x7b4017=_0x7b4017[a9_0xbaaf('0x12')]();const _0x9bb373={'id':_0x7b4017['id']};const _0x50f3dd=jwt[a9_0xbaaf('0x13')](_0x9bb373,configJwt['secret']);delete _0x7b4017['password'];_0x7b4017[a9_0xbaaf('0x14')]=_0x50f3dd;return responseUtils[a9_0xbaaf('0x15')](_0x543f8a,_0x7b4017,0xc8);}else{return responseUtils['errorResponse'](_0x543f8a,_0x543f8a['__'](LocaleStrings[a9_0xbaaf('0x16')]),0x193);}})[a9_0xbaaf('0x17')](_0x31c16f=>{return responseUtils[a9_0xbaaf('0x18')](_0x543f8a,_0x31c16f[a9_0xbaaf('0x19')],0x1f4);});}['createAccount'](_0x253a36,_0x27fb45,_0x617c2c){this[a9_0xbaaf('0x6')][a9_0xbaaf('0xa')]({'where':{'username':_0x253a36[a9_0xbaaf('0xb')]['username']}})[a9_0xbaaf('0x10')](function(_0x17906c){if(_0x17906c){return responseUtils['errorResponse'](_0x27fb45,_0x27fb45['__'](LocaleStrings[a9_0xbaaf('0x1a')],_0x253a36[a9_0xbaaf('0xb')][a9_0xbaaf('0xc')]),0x193);}else{_0x253a36[a9_0xbaaf('0xb')][a9_0xbaaf('0xe')]=_0x253a36[a9_0xbaaf('0xb')][a9_0xbaaf('0xc')];const _0x4431a8={'username':_0x253a36['body']['username'],'password':authUtils[a9_0xbaaf('0x1b')](_0x253a36[a9_0xbaaf('0xb')]['password'])};this[a9_0xbaaf('0x6')][a9_0xbaaf('0x1c')](_0x4431a8)[a9_0xbaaf('0x10')](function(_0xd2793b,_0x1a5eaa){return responseUtils[a9_0xbaaf('0x15')](_0x27fb45,_0xd2793b,0xc8);})[a9_0xbaaf('0x17')](_0x577e41=>{return responseUtils[a9_0xbaaf('0x18')](_0x27fb45,_0x577e41[a9_0xbaaf('0x19')],0x1f4);});}})['catch'](_0x3ee16a=>{return responseUtils['errorResponse'](_0x27fb45,_0x3ee16a[a9_0xbaaf('0x19')],0x1f4);});}}exports[a9_0xbaaf('0x1d')]=AuthConstroller;
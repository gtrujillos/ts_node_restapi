var a9_0x18a2=['token','successResponse','catch','stack','body','generateHash','create','default','defineProperty','jsonwebtoken','i18n','../../config/jwt.js','../../infrastructure/auth-utils','../../resources/locale-strings','model','login','bind','createAccount','findOne','username','last_name','email','password','then','errorResponse','usernameNotFoundError','validPassword','toJSON','sign','secret'];(function(_0x383c29,_0x113dd0){var _0x2aab33=function(_0x3f1c77){while(--_0x3f1c77){_0x383c29['push'](_0x383c29['shift']());}};_0x2aab33(++_0x113dd0);}(a9_0x18a2,0x170));var a9_0xb010=function(_0x3eac86,_0x447181){_0x3eac86=_0x3eac86-0x0;var _0x5de507=a9_0x18a2[_0x3eac86];return _0x5de507;};'use strict';Object[a9_0xb010('0x0')](exports,'__esModule',{'value':!![]});const jwt=require(a9_0xb010('0x1'));const i18n=require(a9_0xb010('0x2'));const configJwt=require(a9_0xb010('0x3'));const authUtils=require(a9_0xb010('0x4'));const responseUtils=require('../../infrastructure/response-utils');const LocaleStrings=require(a9_0xb010('0x5'));class AuthConstroller{constructor(_0x57c8ea){this[a9_0xb010('0x6')]=_0x57c8ea;this[a9_0xb010('0x7')]=this[a9_0xb010('0x7')][a9_0xb010('0x8')](this);this[a9_0xb010('0x9')]=this['createAccount'][a9_0xb010('0x8')](this);}[a9_0xb010('0x7')](_0x5c9e49,_0x4d2dfa,_0x49e599){this[a9_0xb010('0x6')][a9_0xb010('0xa')]({'where':{'username':_0x5c9e49['body'][a9_0xb010('0xb')]},'attributes':['id','first_name',a9_0xb010('0xc'),a9_0xb010('0xd'),a9_0xb010('0xb'),a9_0xb010('0xe')]})[a9_0xb010('0xf')](_0x3a9e33=>{if(!_0x3a9e33){return responseUtils[a9_0xb010('0x10')](_0x4d2dfa,LocaleStrings[a9_0xb010('0x11')],0x193);}if(authUtils[a9_0xb010('0x12')](_0x5c9e49['body'][a9_0xb010('0xe')],_0x3a9e33[a9_0xb010('0xe')])){_0x3a9e33=_0x3a9e33[a9_0xb010('0x13')]();const _0x310d83={'id':_0x3a9e33['id']};const _0x28322d=jwt[a9_0xb010('0x14')](_0x310d83,configJwt[a9_0xb010('0x15')]);delete _0x3a9e33['password'];_0x3a9e33[a9_0xb010('0x16')]=_0x28322d;return responseUtils[a9_0xb010('0x17')](_0x4d2dfa,_0x3a9e33,0xc8);}else{return responseUtils['errorResponse'](_0x4d2dfa,_0x4d2dfa['__'](LocaleStrings['passwordNotMatchError']),0x193);}})[a9_0xb010('0x18')](_0xe7240a=>{return responseUtils['errorResponse'](_0x4d2dfa,_0xe7240a[a9_0xb010('0x19')],0x1f4);});}[a9_0xb010('0x9')](_0x1758da,_0x1bb043,_0x1b2cb5){this[a9_0xb010('0x6')][a9_0xb010('0xa')]({'where':{'username':_0x1758da[a9_0xb010('0x1a')][a9_0xb010('0xb')]}})[a9_0xb010('0xf')](function(_0x5d21ca){if(_0x5d21ca){return responseUtils['errorResponse'](_0x1bb043,_0x1bb043['__'](LocaleStrings['usernameTakenError'],_0x1758da['body'][a9_0xb010('0xb')]),0x193);}else{_0x1758da[a9_0xb010('0x1a')][a9_0xb010('0xd')]=_0x1758da[a9_0xb010('0x1a')]['username'];const _0x3e8219={'username':_0x1758da['body']['username'],'password':authUtils[a9_0xb010('0x1b')](_0x1758da[a9_0xb010('0x1a')][a9_0xb010('0xe')])};this['model'][a9_0xb010('0x1c')](_0x3e8219)[a9_0xb010('0xf')](function(_0x125583,_0x1273a3){return responseUtils[a9_0xb010('0x17')](_0x1bb043,_0x125583,0xc8);})[a9_0xb010('0x18')](_0x49b91d=>{return responseUtils['errorResponse'](_0x1bb043,_0x49b91d['stack'],0x1f4);});}})['catch'](_0x5c2f89=>{return responseUtils['errorResponse'](_0x1bb043,_0x5c2f89[a9_0xb010('0x19')],0x1f4);});}}exports[a9_0xb010('0x1d')]=AuthConstroller;
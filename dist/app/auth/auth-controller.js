var a9_0x11e3=['../../resources/locale-strings','login','bind','createAccount','model','findOne','first_name','last_name','email','then','errorResponse','usernameNotFoundError','validPassword','body','sign','secret','password','token','successResponse','passwordNotMatchError','stack','username','generateHash','create','catch','__esModule','jsonwebtoken','../../config/jwt.js','../../infrastructure/auth-utils'];(function(_0x10635c,_0x2208f){var _0x33b57f=function(_0x3412f2){while(--_0x3412f2){_0x10635c['push'](_0x10635c['shift']());}};_0x33b57f(++_0x2208f);}(a9_0x11e3,0xaa));var a9_0x2550=function(_0x1b394a,_0x35978d){_0x1b394a=_0x1b394a-0x0;var _0x2c6f4b=a9_0x11e3[_0x1b394a];return _0x2c6f4b;};'use strict';Object['defineProperty'](exports,a9_0x2550('0x0'),{'value':!![]});const jwt=require(a9_0x2550('0x1'));const i18n=require('i18n');const configJwt=require(a9_0x2550('0x2'));const authUtils=require(a9_0x2550('0x3'));const responseUtils=require('../../infrastructure/response-utils');const LocaleStrings=require(a9_0x2550('0x4'));class AuthConstroller{constructor(_0x1ab938){this['model']=_0x1ab938;this[a9_0x2550('0x5')]=this[a9_0x2550('0x5')][a9_0x2550('0x6')](this);this['createAccount']=this[a9_0x2550('0x7')]['bind'](this);}[a9_0x2550('0x5')](_0x1e9e1a,_0x30ca1f,_0xd5db2){this[a9_0x2550('0x8')][a9_0x2550('0x9')]({'where':{'username':_0x1e9e1a['body']['username']},'attributes':['id',a9_0x2550('0xa'),a9_0x2550('0xb'),a9_0x2550('0xc'),'username','password']})[a9_0x2550('0xd')](_0x21f69f=>{if(!_0x21f69f){return responseUtils[a9_0x2550('0xe')](_0x30ca1f,LocaleStrings[a9_0x2550('0xf')],0x193);}if(authUtils[a9_0x2550('0x10')](_0x1e9e1a[a9_0x2550('0x11')]['password'],_0x21f69f['password'])){_0x21f69f=_0x21f69f['toJSON']();const _0x55efc0={'id':_0x21f69f['id']};const _0x5e1bad=jwt[a9_0x2550('0x12')](_0x55efc0,configJwt[a9_0x2550('0x13')]);delete _0x21f69f[a9_0x2550('0x14')];_0x21f69f[a9_0x2550('0x15')]=_0x5e1bad;return responseUtils[a9_0x2550('0x16')](_0x30ca1f,_0x21f69f,0xc8);}else{return responseUtils[a9_0x2550('0xe')](_0x30ca1f,_0x30ca1f['__'](LocaleStrings[a9_0x2550('0x17')]),0x193);}})['catch'](_0x1691d6=>{return responseUtils[a9_0x2550('0xe')](_0x30ca1f,_0x1691d6[a9_0x2550('0x18')],0x1f4);});}[a9_0x2550('0x7')](_0x292503,_0x37b5a0,_0x46ff3a){this[a9_0x2550('0x8')][a9_0x2550('0x9')]({'where':{'username':_0x292503[a9_0x2550('0x11')][a9_0x2550('0x19')]}})[a9_0x2550('0xd')](function(_0x5e176e){if(_0x5e176e){return responseUtils[a9_0x2550('0xe')](_0x37b5a0,_0x37b5a0['__'](LocaleStrings['usernameTakenError'],_0x292503['body']['username']),0x193);}else{_0x292503[a9_0x2550('0x11')][a9_0x2550('0xc')]=_0x292503[a9_0x2550('0x11')]['username'];const _0x4994f2={'username':_0x292503[a9_0x2550('0x11')][a9_0x2550('0x19')],'password':authUtils[a9_0x2550('0x1a')](_0x292503[a9_0x2550('0x11')][a9_0x2550('0x14')])};this['model'][a9_0x2550('0x1b')](_0x4994f2)[a9_0x2550('0xd')](function(_0x1e3702,_0xa93661){return responseUtils[a9_0x2550('0x16')](_0x37b5a0,_0x1e3702,0xc8);})[a9_0x2550('0x1c')](_0x26e7ff=>{return responseUtils[a9_0x2550('0xe')](_0x37b5a0,_0x26e7ff[a9_0x2550('0x18')],0x1f4);});}})[a9_0x2550('0x1c')](_0xe3d7dc=>{return responseUtils[a9_0x2550('0xe')](_0x37b5a0,_0xe3d7dc[a9_0x2550('0x18')],0x1f4);});}}exports['default']=AuthConstroller;
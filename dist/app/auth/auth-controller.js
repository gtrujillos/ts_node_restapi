var a9_0x5c52=['then','errorResponse','body','toJSON','sign','secret','passwordNotMatchError','catch','successResponse','stack','default','defineProperty','__esModule','jsonwebtoken','i18n','../../config/jwt.js','../../infrastructure/auth-utils','../../infrastructure/response-utils','../../resources/locale-strings','model','login','createAccount','findOne','username','first_name','last_name','email','password'];(function(_0x16073b,_0x441a3d){var _0x39d0b2=function(_0x4b028d){while(--_0x4b028d){_0x16073b['push'](_0x16073b['shift']());}};_0x39d0b2(++_0x441a3d);}(a9_0x5c52,0x13f));var a9_0x66ec=function(_0x3626b1,_0x33b517){_0x3626b1=_0x3626b1-0x0;var _0x40bb29=a9_0x5c52[_0x3626b1];return _0x40bb29;};'use strict';Object[a9_0x66ec('0x0')](exports,a9_0x66ec('0x1'),{'value':!![]});const jwt=require(a9_0x66ec('0x2'));const i18n=require(a9_0x66ec('0x3'));const configJwt=require(a9_0x66ec('0x4'));const authUtils=require(a9_0x66ec('0x5'));const responseUtils=require(a9_0x66ec('0x6'));const LocaleStrings=require(a9_0x66ec('0x7'));class AuthConstroller{constructor(_0x2108b5){this[a9_0x66ec('0x8')]=_0x2108b5;this[a9_0x66ec('0x9')]=this[a9_0x66ec('0x9')]['bind'](this);this[a9_0x66ec('0xa')]=this[a9_0x66ec('0xa')]['bind'](this);}[a9_0x66ec('0x9')](_0x36404d,_0x27e9af,_0x325634){this['model'][a9_0x66ec('0xb')]({'where':{'username':_0x36404d['body'][a9_0x66ec('0xc')]},'attributes':['id',a9_0x66ec('0xd'),a9_0x66ec('0xe'),a9_0x66ec('0xf'),a9_0x66ec('0xc'),a9_0x66ec('0x10')]})[a9_0x66ec('0x11')](_0x1ad655=>{if(!_0x1ad655){return responseUtils[a9_0x66ec('0x12')](_0x27e9af,LocaleStrings['usernameNotFoundError'],0x193);}if(authUtils['validPassword'](_0x36404d[a9_0x66ec('0x13')][a9_0x66ec('0x10')],_0x1ad655[a9_0x66ec('0x10')])){_0x1ad655=_0x1ad655[a9_0x66ec('0x14')]();const _0x46797a={'id':_0x1ad655['id']};const _0x471db8=jwt[a9_0x66ec('0x15')](_0x46797a,configJwt[a9_0x66ec('0x16')]);delete _0x1ad655[a9_0x66ec('0x10')];_0x1ad655['token']=_0x471db8;return responseUtils['successResponse'](_0x27e9af,_0x1ad655,0xc8);}else{return responseUtils['errorResponse'](_0x27e9af,_0x27e9af['__'](LocaleStrings[a9_0x66ec('0x17')]),0x193);}})[a9_0x66ec('0x18')](_0x4bbda0=>{return responseUtils[a9_0x66ec('0x12')](_0x27e9af,_0x4bbda0['stack'],0x1f4);});}[a9_0x66ec('0xa')](_0x161ef0,_0x4db090,_0x5dd2e1){this[a9_0x66ec('0x8')][a9_0x66ec('0xb')]({'where':{'username':_0x161ef0[a9_0x66ec('0x13')][a9_0x66ec('0xc')]}})[a9_0x66ec('0x11')](function(_0x3153df){if(_0x3153df){return responseUtils[a9_0x66ec('0x12')](_0x4db090,_0x4db090['__'](LocaleStrings['usernameTakenError'],_0x161ef0[a9_0x66ec('0x13')][a9_0x66ec('0xc')]),0x193);}else{_0x161ef0[a9_0x66ec('0x13')][a9_0x66ec('0xf')]=_0x161ef0['body']['username'];const _0x4c6b6d={'username':_0x161ef0['body'][a9_0x66ec('0xc')],'password':authUtils['generateHash'](_0x161ef0['body'][a9_0x66ec('0x10')])};this['model']['create'](_0x4c6b6d)[a9_0x66ec('0x11')](function(_0x2840bb,_0x2c6ce5){return responseUtils[a9_0x66ec('0x19')](_0x4db090,_0x2840bb,0xc8);})[a9_0x66ec('0x18')](_0x2915b3=>{return responseUtils['errorResponse'](_0x4db090,_0x2915b3[a9_0x66ec('0x1a')],0x1f4);});}})[a9_0x66ec('0x18')](_0x2a77c4=>{return responseUtils[a9_0x66ec('0x12')](_0x4db090,_0x2a77c4[a9_0x66ec('0x1a')],0x1f4);});}}exports[a9_0x66ec('0x1b')]=AuthConstroller;
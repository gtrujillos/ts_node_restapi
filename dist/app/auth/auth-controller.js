var a28_0x4e8a=['findOne','body','username','first_name','email','password','then','errorResponse','usernameNotFoundError','validPassword','toJSON','secret','passwordNotMatchError','catch','stack','usernameTakenError','generateHash','create','successResponse','defineProperty','jsonwebtoken','i18n','model','login','bind','createAccount'];(function(_0x3be149,_0x40f12b){var _0x409264=function(_0x2cf498){while(--_0x2cf498){_0x3be149['push'](_0x3be149['shift']());}};_0x409264(++_0x40f12b);}(a28_0x4e8a,0x7b));var a28_0x569f=function(_0x55f662,_0x4a0411){_0x55f662=_0x55f662-0x0;var _0x4f2c80=a28_0x4e8a[_0x55f662];return _0x4f2c80;};'use strict';Object[a28_0x569f('0x0')](exports,'__esModule',{'value':!![]});const jwt=require(a28_0x569f('0x1'));const i18n=require(a28_0x569f('0x2'));const configJwt=require('../../config/jwt.js');const authUtils=require('../../infrastructure/auth-utils');const responseUtils=require('../../infrastructure/response-utils');const LocaleStrings=require('../../resources/locale-strings');class AuthConstroller{constructor(_0x32a7d8){this[a28_0x569f('0x3')]=_0x32a7d8;this[a28_0x569f('0x4')]=this[a28_0x569f('0x4')][a28_0x569f('0x5')](this);this['createAccount']=this[a28_0x569f('0x6')][a28_0x569f('0x5')](this);}['login'](_0x3fc67c,_0x3c9ee7,_0x258a57){this[a28_0x569f('0x3')][a28_0x569f('0x7')]({'where':{'username':_0x3fc67c[a28_0x569f('0x8')][a28_0x569f('0x9')]},'attributes':['id',a28_0x569f('0xa'),'last_name',a28_0x569f('0xb'),'username',a28_0x569f('0xc')]})[a28_0x569f('0xd')](_0x3ddfa5=>{if(!_0x3ddfa5){return responseUtils[a28_0x569f('0xe')](_0x3c9ee7,LocaleStrings[a28_0x569f('0xf')],0x193);}if(authUtils[a28_0x569f('0x10')](_0x3fc67c[a28_0x569f('0x8')]['password'],_0x3ddfa5[a28_0x569f('0xc')])){_0x3ddfa5=_0x3ddfa5[a28_0x569f('0x11')]();const _0x2a0944={'id':_0x3ddfa5['id']};const _0x4c0c71=jwt['sign'](_0x2a0944,configJwt[a28_0x569f('0x12')]);delete _0x3ddfa5['password'];_0x3ddfa5['token']=_0x4c0c71;return responseUtils['successResponse'](_0x3c9ee7,_0x3ddfa5,0xc8);}else{return responseUtils[a28_0x569f('0xe')](_0x3c9ee7,_0x3c9ee7['__'](LocaleStrings[a28_0x569f('0x13')]),0x193);}})[a28_0x569f('0x14')](_0x525def=>{return responseUtils[a28_0x569f('0xe')](_0x3c9ee7,_0x525def[a28_0x569f('0x15')],0x1f4);});}[a28_0x569f('0x6')](_0xcb4ebe,_0x1ba685,_0x19573b){this[a28_0x569f('0x3')]['findOne']({'where':{'username':_0xcb4ebe[a28_0x569f('0x8')]['username']}})['then'](function(_0x50a37f){if(_0x50a37f){return responseUtils[a28_0x569f('0xe')](_0x1ba685,_0x1ba685['__'](LocaleStrings[a28_0x569f('0x16')],_0xcb4ebe[a28_0x569f('0x8')][a28_0x569f('0x9')]),0x193);}else{_0xcb4ebe[a28_0x569f('0x8')][a28_0x569f('0xb')]=_0xcb4ebe[a28_0x569f('0x8')][a28_0x569f('0x9')];const _0x3e2f02={'username':_0xcb4ebe[a28_0x569f('0x8')][a28_0x569f('0x9')],'password':authUtils[a28_0x569f('0x17')](_0xcb4ebe[a28_0x569f('0x8')]['password'])};this['model'][a28_0x569f('0x18')](_0x3e2f02)[a28_0x569f('0xd')](function(_0x4a3a39,_0x5811a2){return responseUtils[a28_0x569f('0x19')](_0x1ba685,_0x4a3a39,0xc8);})[a28_0x569f('0x14')](_0x46d7ce=>{return responseUtils[a28_0x569f('0xe')](_0x1ba685,_0x46d7ce[a28_0x569f('0x15')],0x1f4);});}})[a28_0x569f('0x14')](_0x4f42dc=>{return responseUtils[a28_0x569f('0xe')](_0x1ba685,_0x4f42dc[a28_0x569f('0x15')],0x1f4);});}}exports['default']=AuthConstroller;
var a9_0x4953=['jsonwebtoken','i18n','../../infrastructure/auth-utils','login','bind','createAccount','model','findOne','body','first_name','username','password','then','errorResponse','toJSON','sign','secret','token','successResponse','passwordNotMatchError','catch','stack','generateHash','create','default','defineProperty','__esModule'];(function(_0x2a6fb0,_0x5ebc8f){var _0x59a009=function(_0x3a349e){while(--_0x3a349e){_0x2a6fb0['push'](_0x2a6fb0['shift']());}};_0x59a009(++_0x5ebc8f);}(a9_0x4953,0x15d));var a9_0x5c64=function(_0x19a97f,_0x3b35a5){_0x19a97f=_0x19a97f-0x0;var _0x37cbd7=a9_0x4953[_0x19a97f];return _0x37cbd7;};'use strict';Object[a9_0x5c64('0x0')](exports,a9_0x5c64('0x1'),{'value':!![]});const jwt=require(a9_0x5c64('0x2'));const i18n=require(a9_0x5c64('0x3'));const configJwt=require('../../config/jwt.js');const authUtils=require(a9_0x5c64('0x4'));const responseUtils=require('../../infrastructure/response-utils');const LocaleStrings=require('../../resources/locale-strings');class AuthConstroller{constructor(_0x5c177c){this['model']=_0x5c177c;this[a9_0x5c64('0x5')]=this[a9_0x5c64('0x5')][a9_0x5c64('0x6')](this);this[a9_0x5c64('0x7')]=this[a9_0x5c64('0x7')][a9_0x5c64('0x6')](this);}[a9_0x5c64('0x5')](_0x30f7c5,_0x49febf,_0x35472a){this[a9_0x5c64('0x8')][a9_0x5c64('0x9')]({'where':{'username':_0x30f7c5[a9_0x5c64('0xa')]['username']},'attributes':['id',a9_0x5c64('0xb'),'last_name','email',a9_0x5c64('0xc'),a9_0x5c64('0xd')]})[a9_0x5c64('0xe')](_0x4191e7=>{if(!_0x4191e7){return responseUtils[a9_0x5c64('0xf')](_0x49febf,LocaleStrings['usernameNotFoundError'],0x193);}if(authUtils['validPassword'](_0x30f7c5[a9_0x5c64('0xa')][a9_0x5c64('0xd')],_0x4191e7[a9_0x5c64('0xd')])){_0x4191e7=_0x4191e7[a9_0x5c64('0x10')]();const _0x1e6f3d={'id':_0x4191e7['id']};const _0x139077=jwt[a9_0x5c64('0x11')](_0x1e6f3d,configJwt[a9_0x5c64('0x12')]);delete _0x4191e7[a9_0x5c64('0xd')];_0x4191e7[a9_0x5c64('0x13')]=_0x139077;return responseUtils[a9_0x5c64('0x14')](_0x49febf,_0x4191e7,0xc8);}else{return responseUtils[a9_0x5c64('0xf')](_0x49febf,_0x49febf['__'](LocaleStrings[a9_0x5c64('0x15')]),0x193);}})[a9_0x5c64('0x16')](_0x39df02=>{return responseUtils[a9_0x5c64('0xf')](_0x49febf,_0x39df02[a9_0x5c64('0x17')],0x1f4);});}[a9_0x5c64('0x7')](_0x268df5,_0x295782,_0x2f15a0){this[a9_0x5c64('0x8')][a9_0x5c64('0x9')]({'where':{'username':_0x268df5[a9_0x5c64('0xa')][a9_0x5c64('0xc')]}})[a9_0x5c64('0xe')](function(_0x27d78f){if(_0x27d78f){return responseUtils['errorResponse'](_0x295782,_0x295782['__'](LocaleStrings['usernameTakenError'],_0x268df5['body'][a9_0x5c64('0xc')]),0x193);}else{_0x268df5[a9_0x5c64('0xa')]['email']=_0x268df5['body']['username'];const _0x18c26f={'username':_0x268df5['body'][a9_0x5c64('0xc')],'password':authUtils[a9_0x5c64('0x18')](_0x268df5[a9_0x5c64('0xa')]['password'])};this[a9_0x5c64('0x8')][a9_0x5c64('0x19')](_0x18c26f)[a9_0x5c64('0xe')](function(_0x51ed3b,_0x52962e){return responseUtils[a9_0x5c64('0x14')](_0x295782,_0x51ed3b,0xc8);})[a9_0x5c64('0x16')](_0xa845f7=>{return responseUtils[a9_0x5c64('0xf')](_0x295782,_0xa845f7[a9_0x5c64('0x17')],0x1f4);});}})[a9_0x5c64('0x16')](_0x48b13b=>{return responseUtils['errorResponse'](_0x295782,_0x48b13b[a9_0x5c64('0x17')],0x1f4);});}}exports[a9_0x5c64('0x1a')]=AuthConstroller;
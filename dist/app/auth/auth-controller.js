var a9_0x1193=['token','stack','usernameTakenError','generateHash','create','successResponse','catch','defineProperty','__esModule','jsonwebtoken','../../config/jwt.js','../../infrastructure/auth-utils','../../infrastructure/response-utils','../../resources/locale-strings','model','login','bind','createAccount','findOne','username','first_name','last_name','email','then','errorResponse','usernameNotFoundError','validPassword','body','password','toJSON','sign'];(function(_0x1f4c70,_0x1db66d){var _0x827a70=function(_0x44e3c1){while(--_0x44e3c1){_0x1f4c70['push'](_0x1f4c70['shift']());}};_0x827a70(++_0x1db66d);}(a9_0x1193,0xff));var a9_0x52a8=function(_0x2dff28,_0x2d1cfa){_0x2dff28=_0x2dff28-0x0;var _0x2462fa=a9_0x1193[_0x2dff28];return _0x2462fa;};'use strict';Object[a9_0x52a8('0x0')](exports,a9_0x52a8('0x1'),{'value':!![]});const jwt=require(a9_0x52a8('0x2'));const i18n=require('i18n');const configJwt=require(a9_0x52a8('0x3'));const authUtils=require(a9_0x52a8('0x4'));const responseUtils=require(a9_0x52a8('0x5'));const LocaleStrings=require(a9_0x52a8('0x6'));class AuthConstroller{constructor(_0x25aed9){this[a9_0x52a8('0x7')]=_0x25aed9;this['login']=this[a9_0x52a8('0x8')][a9_0x52a8('0x9')](this);this[a9_0x52a8('0xa')]=this[a9_0x52a8('0xa')][a9_0x52a8('0x9')](this);}[a9_0x52a8('0x8')](_0x15a365,_0x332595,_0x21b265){this['model'][a9_0x52a8('0xb')]({'where':{'username':_0x15a365['body'][a9_0x52a8('0xc')]},'attributes':['id',a9_0x52a8('0xd'),a9_0x52a8('0xe'),a9_0x52a8('0xf'),a9_0x52a8('0xc'),'password']})[a9_0x52a8('0x10')](_0x158f18=>{if(!_0x158f18){return responseUtils[a9_0x52a8('0x11')](_0x332595,LocaleStrings[a9_0x52a8('0x12')],0x193);}if(authUtils[a9_0x52a8('0x13')](_0x15a365[a9_0x52a8('0x14')]['password'],_0x158f18[a9_0x52a8('0x15')])){_0x158f18=_0x158f18[a9_0x52a8('0x16')]();const _0x4c4e34={'id':_0x158f18['id']};const _0x5eb56d=jwt[a9_0x52a8('0x17')](_0x4c4e34,configJwt['secret']);delete _0x158f18[a9_0x52a8('0x15')];_0x158f18[a9_0x52a8('0x18')]=_0x5eb56d;return responseUtils['successResponse'](_0x332595,_0x158f18,0xc8);}else{return responseUtils[a9_0x52a8('0x11')](_0x332595,_0x332595['__'](LocaleStrings['passwordNotMatchError']),0x193);}})['catch'](_0x37c2e5=>{return responseUtils['errorResponse'](_0x332595,_0x37c2e5[a9_0x52a8('0x19')],0x1f4);});}[a9_0x52a8('0xa')](_0x504a3a,_0x49687c,_0x2a9c52){this[a9_0x52a8('0x7')]['findOne']({'where':{'username':_0x504a3a[a9_0x52a8('0x14')][a9_0x52a8('0xc')]}})[a9_0x52a8('0x10')](function(_0x425045){if(_0x425045){return responseUtils[a9_0x52a8('0x11')](_0x49687c,_0x49687c['__'](LocaleStrings[a9_0x52a8('0x1a')],_0x504a3a[a9_0x52a8('0x14')][a9_0x52a8('0xc')]),0x193);}else{_0x504a3a[a9_0x52a8('0x14')][a9_0x52a8('0xf')]=_0x504a3a[a9_0x52a8('0x14')]['username'];const _0x11d08e={'username':_0x504a3a[a9_0x52a8('0x14')]['username'],'password':authUtils[a9_0x52a8('0x1b')](_0x504a3a[a9_0x52a8('0x14')][a9_0x52a8('0x15')])};this['model'][a9_0x52a8('0x1c')](_0x11d08e)[a9_0x52a8('0x10')](function(_0x1583e8,_0x159ed8){return responseUtils[a9_0x52a8('0x1d')](_0x49687c,_0x1583e8,0xc8);})[a9_0x52a8('0x1e')](_0x399b1b=>{return responseUtils['errorResponse'](_0x49687c,_0x399b1b[a9_0x52a8('0x19')],0x1f4);});}})[a9_0x52a8('0x1e')](_0x123f6=>{return responseUtils[a9_0x52a8('0x11')](_0x49687c,_0x123f6[a9_0x52a8('0x19')],0x1f4);});}}exports['default']=AuthConstroller;
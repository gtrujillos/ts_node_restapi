var a28_0xf640=['__esModule','jsonwebtoken','i18n','../../config/jwt.js','../../infrastructure/response-utils','model','login','bind','createAccount','findOne','username','first_name','last_name','email','password','errorResponse','usernameNotFoundError','validPassword','secret','token','passwordNotMatchError','catch','stack','body','then','usernameTakenError','generateHash','create','successResponse','default','defineProperty'];(function(_0x317bbb,_0x3ab9fa){var _0x343d11=function(_0xccca28){while(--_0xccca28){_0x317bbb['push'](_0x317bbb['shift']());}};_0x343d11(++_0x3ab9fa);}(a28_0xf640,0x135));var a28_0x1c14=function(_0x589467,_0x39c9dc){_0x589467=_0x589467-0x0;var _0x5aa986=a28_0xf640[_0x589467];return _0x5aa986;};'use strict';Object[a28_0x1c14('0x0')](exports,a28_0x1c14('0x1'),{'value':!![]});const jwt=require(a28_0x1c14('0x2'));const i18n=require(a28_0x1c14('0x3'));const configJwt=require(a28_0x1c14('0x4'));const authUtils=require('../../infrastructure/auth-utils');const responseUtils=require(a28_0x1c14('0x5'));const LocaleStrings=require('../../resources/locale-strings');class AuthConstroller{constructor(_0x343bf6){this[a28_0x1c14('0x6')]=_0x343bf6;this[a28_0x1c14('0x7')]=this[a28_0x1c14('0x7')][a28_0x1c14('0x8')](this);this['createAccount']=this[a28_0x1c14('0x9')][a28_0x1c14('0x8')](this);}[a28_0x1c14('0x7')](_0x21d79a,_0x475222,_0x41199d){this[a28_0x1c14('0x6')][a28_0x1c14('0xa')]({'where':{'username':_0x21d79a['body'][a28_0x1c14('0xb')]},'attributes':['id',a28_0x1c14('0xc'),a28_0x1c14('0xd'),a28_0x1c14('0xe'),a28_0x1c14('0xb'),a28_0x1c14('0xf')]})['then'](_0x374894=>{if(!_0x374894){return responseUtils[a28_0x1c14('0x10')](_0x475222,LocaleStrings[a28_0x1c14('0x11')],0x193);}if(authUtils[a28_0x1c14('0x12')](_0x21d79a['body']['password'],_0x374894[a28_0x1c14('0xf')])){_0x374894=_0x374894['toJSON']();const _0x386519={'id':_0x374894['id']};const _0x58a456=jwt['sign'](_0x386519,configJwt[a28_0x1c14('0x13')]);delete _0x374894['password'];_0x374894[a28_0x1c14('0x14')]=_0x58a456;return responseUtils['successResponse'](_0x475222,_0x374894,0xc8);}else{return responseUtils[a28_0x1c14('0x10')](_0x475222,_0x475222['__'](LocaleStrings[a28_0x1c14('0x15')]),0x193);}})[a28_0x1c14('0x16')](_0x1f190a=>{return responseUtils[a28_0x1c14('0x10')](_0x475222,_0x1f190a[a28_0x1c14('0x17')],0x1f4);});}[a28_0x1c14('0x9')](_0xecee8b,_0xfc57de,_0x3e32cb){this[a28_0x1c14('0x6')]['findOne']({'where':{'username':_0xecee8b[a28_0x1c14('0x18')][a28_0x1c14('0xb')]}})[a28_0x1c14('0x19')](function(_0x35eacc){if(_0x35eacc){return responseUtils[a28_0x1c14('0x10')](_0xfc57de,_0xfc57de['__'](LocaleStrings[a28_0x1c14('0x1a')],_0xecee8b[a28_0x1c14('0x18')][a28_0x1c14('0xb')]),0x193);}else{_0xecee8b['body'][a28_0x1c14('0xe')]=_0xecee8b[a28_0x1c14('0x18')][a28_0x1c14('0xb')];const _0x3b4c4a={'username':_0xecee8b['body'][a28_0x1c14('0xb')],'password':authUtils[a28_0x1c14('0x1b')](_0xecee8b['body']['password'])};this[a28_0x1c14('0x6')][a28_0x1c14('0x1c')](_0x3b4c4a)[a28_0x1c14('0x19')](function(_0x5075d0,_0x53f7b6){return responseUtils[a28_0x1c14('0x1d')](_0xfc57de,_0x5075d0,0xc8);})[a28_0x1c14('0x16')](_0x391903=>{return responseUtils['errorResponse'](_0xfc57de,_0x391903[a28_0x1c14('0x17')],0x1f4);});}})[a28_0x1c14('0x16')](_0x5b8a65=>{return responseUtils['errorResponse'](_0xfc57de,_0x5b8a65[a28_0x1c14('0x17')],0x1f4);});}}exports[a28_0x1c14('0x1e')]=AuthConstroller;
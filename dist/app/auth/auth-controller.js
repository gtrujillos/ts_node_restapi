var a9_0x5f43=['errorResponse','usernameNotFoundError','validPassword','toJSON','sign','secret','token','stack','body','then','create','successResponse','catch','default','defineProperty','__esModule','i18n','../../config/jwt.js','../../infrastructure/auth-utils','../../resources/locale-strings','model','login','bind','createAccount','findOne','first_name','last_name','email','username','password'];(function(_0x1ae1f7,_0x5f69ec){var _0x4aaec5=function(_0x557e0d){while(--_0x557e0d){_0x1ae1f7['push'](_0x1ae1f7['shift']());}};_0x4aaec5(++_0x5f69ec);}(a9_0x5f43,0x194));var a9_0xaf7c=function(_0x5eb43f,_0x3cb8aa){_0x5eb43f=_0x5eb43f-0x0;var _0x1a2e26=a9_0x5f43[_0x5eb43f];return _0x1a2e26;};'use strict';Object[a9_0xaf7c('0x0')](exports,a9_0xaf7c('0x1'),{'value':!![]});const jwt=require('jsonwebtoken');const i18n=require(a9_0xaf7c('0x2'));const configJwt=require(a9_0xaf7c('0x3'));const authUtils=require(a9_0xaf7c('0x4'));const responseUtils=require('../../infrastructure/response-utils');const LocaleStrings=require(a9_0xaf7c('0x5'));class AuthConstroller{constructor(_0x53199c){this[a9_0xaf7c('0x6')]=_0x53199c;this[a9_0xaf7c('0x7')]=this[a9_0xaf7c('0x7')][a9_0xaf7c('0x8')](this);this[a9_0xaf7c('0x9')]=this[a9_0xaf7c('0x9')][a9_0xaf7c('0x8')](this);}[a9_0xaf7c('0x7')](_0x8c0cf7,_0x5a65b6,_0x1b0be1){this[a9_0xaf7c('0x6')][a9_0xaf7c('0xa')]({'where':{'username':_0x8c0cf7['body']['username']},'attributes':['id',a9_0xaf7c('0xb'),a9_0xaf7c('0xc'),a9_0xaf7c('0xd'),a9_0xaf7c('0xe'),a9_0xaf7c('0xf')]})['then'](_0x56eb69=>{if(!_0x56eb69){return responseUtils[a9_0xaf7c('0x10')](_0x5a65b6,LocaleStrings[a9_0xaf7c('0x11')],0x193);}if(authUtils[a9_0xaf7c('0x12')](_0x8c0cf7['body']['password'],_0x56eb69[a9_0xaf7c('0xf')])){_0x56eb69=_0x56eb69[a9_0xaf7c('0x13')]();const _0x414a2c={'id':_0x56eb69['id']};const _0xb1e79c=jwt[a9_0xaf7c('0x14')](_0x414a2c,configJwt[a9_0xaf7c('0x15')]);delete _0x56eb69[a9_0xaf7c('0xf')];_0x56eb69[a9_0xaf7c('0x16')]=_0xb1e79c;return responseUtils['successResponse'](_0x5a65b6,_0x56eb69,0xc8);}else{return responseUtils[a9_0xaf7c('0x10')](_0x5a65b6,_0x5a65b6['__'](LocaleStrings['passwordNotMatchError']),0x193);}})['catch'](_0x377b02=>{return responseUtils['errorResponse'](_0x5a65b6,_0x377b02[a9_0xaf7c('0x17')],0x1f4);});}[a9_0xaf7c('0x9')](_0x2c0712,_0x210ada,_0x18b469){this[a9_0xaf7c('0x6')][a9_0xaf7c('0xa')]({'where':{'username':_0x2c0712[a9_0xaf7c('0x18')][a9_0xaf7c('0xe')]}})[a9_0xaf7c('0x19')](function(_0x10a702){if(_0x10a702){return responseUtils['errorResponse'](_0x210ada,_0x210ada['__'](LocaleStrings['usernameTakenError'],_0x2c0712[a9_0xaf7c('0x18')]['username']),0x193);}else{_0x2c0712[a9_0xaf7c('0x18')][a9_0xaf7c('0xd')]=_0x2c0712[a9_0xaf7c('0x18')][a9_0xaf7c('0xe')];const _0x176042={'username':_0x2c0712['body'][a9_0xaf7c('0xe')],'password':authUtils['generateHash'](_0x2c0712[a9_0xaf7c('0x18')][a9_0xaf7c('0xf')])};this[a9_0xaf7c('0x6')][a9_0xaf7c('0x1a')](_0x176042)[a9_0xaf7c('0x19')](function(_0x108a24,_0x13b869){return responseUtils[a9_0xaf7c('0x1b')](_0x210ada,_0x108a24,0xc8);})[a9_0xaf7c('0x1c')](_0x37cdfe=>{return responseUtils[a9_0xaf7c('0x10')](_0x210ada,_0x37cdfe[a9_0xaf7c('0x17')],0x1f4);});}})[a9_0xaf7c('0x1c')](_0x3cc00a=>{return responseUtils[a9_0xaf7c('0x10')](_0x210ada,_0x3cc00a[a9_0xaf7c('0x17')],0x1f4);});}}exports[a9_0xaf7c('0x1d')]=AuthConstroller;
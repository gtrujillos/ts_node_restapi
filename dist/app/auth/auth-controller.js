var a9_0x1e82=['../../infrastructure/response-utils','../../resources/locale-strings','model','login','bind','createAccount','body','last_name','email','username','then','errorResponse','usernameNotFoundError','password','toJSON','sign','token','successResponse','findOne','usernameTakenError','create','catch','stack','default','defineProperty','__esModule','jsonwebtoken','i18n','../../config/jwt.js'];(function(_0x1a2628,_0x528615){var _0x4025a2=function(_0x2a0bf2){while(--_0x2a0bf2){_0x1a2628['push'](_0x1a2628['shift']());}};_0x4025a2(++_0x528615);}(a9_0x1e82,0xe3));var a9_0x5922=function(_0x2d8f05,_0x4b81bb){_0x2d8f05=_0x2d8f05-0x0;var _0x4d74cb=a9_0x1e82[_0x2d8f05];return _0x4d74cb;};'use strict';Object[a9_0x5922('0x0')](exports,a9_0x5922('0x1'),{'value':!![]});const jwt=require(a9_0x5922('0x2'));const i18n=require(a9_0x5922('0x3'));const configJwt=require(a9_0x5922('0x4'));const authUtils=require('../../infrastructure/auth-utils');const responseUtils=require(a9_0x5922('0x5'));const LocaleStrings=require(a9_0x5922('0x6'));class AuthConstroller{constructor(_0x412a21){this[a9_0x5922('0x7')]=_0x412a21;this[a9_0x5922('0x8')]=this[a9_0x5922('0x8')][a9_0x5922('0x9')](this);this[a9_0x5922('0xa')]=this[a9_0x5922('0xa')][a9_0x5922('0x9')](this);}[a9_0x5922('0x8')](_0x1ca56c,_0x15f8dc,_0x1217bb){this['model']['findOne']({'where':{'username':_0x1ca56c[a9_0x5922('0xb')]['username']},'attributes':['id','first_name',a9_0x5922('0xc'),a9_0x5922('0xd'),a9_0x5922('0xe'),'password']})[a9_0x5922('0xf')](_0x5c0e1e=>{if(!_0x5c0e1e){return responseUtils[a9_0x5922('0x10')](_0x15f8dc,LocaleStrings[a9_0x5922('0x11')],0x193);}if(authUtils['validPassword'](_0x1ca56c[a9_0x5922('0xb')][a9_0x5922('0x12')],_0x5c0e1e[a9_0x5922('0x12')])){_0x5c0e1e=_0x5c0e1e[a9_0x5922('0x13')]();const _0x4fc64f={'id':_0x5c0e1e['id']};const _0x11bcb3=jwt[a9_0x5922('0x14')](_0x4fc64f,configJwt['secret']);delete _0x5c0e1e[a9_0x5922('0x12')];_0x5c0e1e[a9_0x5922('0x15')]=_0x11bcb3;return responseUtils[a9_0x5922('0x16')](_0x15f8dc,_0x5c0e1e,0xc8);}else{return responseUtils[a9_0x5922('0x10')](_0x15f8dc,_0x15f8dc['__'](LocaleStrings['passwordNotMatchError']),0x193);}})['catch'](_0x5ecedf=>{return responseUtils[a9_0x5922('0x10')](_0x15f8dc,_0x5ecedf['stack'],0x1f4);});}['createAccount'](_0x54eb60,_0x5317c5,_0x551fe1){this[a9_0x5922('0x7')][a9_0x5922('0x17')]({'where':{'username':_0x54eb60['body'][a9_0x5922('0xe')]}})[a9_0x5922('0xf')](function(_0x355880){if(_0x355880){return responseUtils[a9_0x5922('0x10')](_0x5317c5,_0x5317c5['__'](LocaleStrings[a9_0x5922('0x18')],_0x54eb60[a9_0x5922('0xb')][a9_0x5922('0xe')]),0x193);}else{_0x54eb60[a9_0x5922('0xb')]['email']=_0x54eb60['body'][a9_0x5922('0xe')];const _0x5bf432={'username':_0x54eb60[a9_0x5922('0xb')]['username'],'password':authUtils['generateHash'](_0x54eb60[a9_0x5922('0xb')]['password'])};this[a9_0x5922('0x7')][a9_0x5922('0x19')](_0x5bf432)[a9_0x5922('0xf')](function(_0x5ed5c9,_0x5280b4){return responseUtils[a9_0x5922('0x16')](_0x5317c5,_0x5ed5c9,0xc8);})[a9_0x5922('0x1a')](_0x3be240=>{return responseUtils['errorResponse'](_0x5317c5,_0x3be240[a9_0x5922('0x1b')],0x1f4);});}})['catch'](_0x4b1ec1=>{return responseUtils[a9_0x5922('0x10')](_0x5317c5,_0x4b1ec1[a9_0x5922('0x1b')],0x1f4);});}}exports[a9_0x5922('0x1c')]=AuthConstroller;
var a28_0x2827=['createAccount','findOne','body','username','last_name','email','password','then','errorResponse','usernameNotFoundError','toJSON','sign','successResponse','catch','stack','generateHash','create','default','__esModule','i18n','../../infrastructure/response-utils','../../resources/locale-strings','model','login','bind'];(function(_0x1f9c22,_0x151f77){var _0x2df55b=function(_0x3b8d2c){while(--_0x3b8d2c){_0x1f9c22['push'](_0x1f9c22['shift']());}};_0x2df55b(++_0x151f77);}(a28_0x2827,0x8f));var a28_0x5b03=function(_0x52a207,_0x1fc94e){_0x52a207=_0x52a207-0x0;var _0x35f496=a28_0x2827[_0x52a207];return _0x35f496;};'use strict';Object['defineProperty'](exports,a28_0x5b03('0x0'),{'value':!![]});const jwt=require('jsonwebtoken');const i18n=require(a28_0x5b03('0x1'));const configJwt=require('../../config/jwt.js');const authUtils=require('../../infrastructure/auth-utils');const responseUtils=require(a28_0x5b03('0x2'));const LocaleStrings=require(a28_0x5b03('0x3'));class AuthConstroller{constructor(_0x500a64){this[a28_0x5b03('0x4')]=_0x500a64;this[a28_0x5b03('0x5')]=this[a28_0x5b03('0x5')][a28_0x5b03('0x6')](this);this[a28_0x5b03('0x7')]=this['createAccount'][a28_0x5b03('0x6')](this);}['login'](_0x14b060,_0xcf4c0a,_0x44828f){this[a28_0x5b03('0x4')][a28_0x5b03('0x8')]({'where':{'username':_0x14b060[a28_0x5b03('0x9')][a28_0x5b03('0xa')]},'attributes':['id','first_name',a28_0x5b03('0xb'),a28_0x5b03('0xc'),a28_0x5b03('0xa'),a28_0x5b03('0xd')]})[a28_0x5b03('0xe')](_0x2c8700=>{if(!_0x2c8700){return responseUtils[a28_0x5b03('0xf')](_0xcf4c0a,LocaleStrings[a28_0x5b03('0x10')],0x193);}if(authUtils['validPassword'](_0x14b060[a28_0x5b03('0x9')]['password'],_0x2c8700[a28_0x5b03('0xd')])){_0x2c8700=_0x2c8700[a28_0x5b03('0x11')]();const _0x5e50bd={'id':_0x2c8700['id']};const _0x2142af=jwt[a28_0x5b03('0x12')](_0x5e50bd,configJwt['secret']);delete _0x2c8700['password'];_0x2c8700['token']=_0x2142af;return responseUtils[a28_0x5b03('0x13')](_0xcf4c0a,_0x2c8700,0xc8);}else{return responseUtils['errorResponse'](_0xcf4c0a,_0xcf4c0a['__'](LocaleStrings['passwordNotMatchError']),0x193);}})[a28_0x5b03('0x14')](_0x289c85=>{return responseUtils[a28_0x5b03('0xf')](_0xcf4c0a,_0x289c85[a28_0x5b03('0x15')],0x1f4);});}[a28_0x5b03('0x7')](_0x1564b4,_0x345b00,_0x8ac7b9){this['model'][a28_0x5b03('0x8')]({'where':{'username':_0x1564b4[a28_0x5b03('0x9')][a28_0x5b03('0xa')]}})[a28_0x5b03('0xe')](function(_0x134311){if(_0x134311){return responseUtils['errorResponse'](_0x345b00,_0x345b00['__'](LocaleStrings['usernameTakenError'],_0x1564b4[a28_0x5b03('0x9')][a28_0x5b03('0xa')]),0x193);}else{_0x1564b4['body'][a28_0x5b03('0xc')]=_0x1564b4[a28_0x5b03('0x9')]['username'];const _0x35b786={'username':_0x1564b4[a28_0x5b03('0x9')][a28_0x5b03('0xa')],'password':authUtils[a28_0x5b03('0x16')](_0x1564b4[a28_0x5b03('0x9')][a28_0x5b03('0xd')])};this[a28_0x5b03('0x4')][a28_0x5b03('0x17')](_0x35b786)[a28_0x5b03('0xe')](function(_0x54a42b,_0x2abbb8){return responseUtils[a28_0x5b03('0x13')](_0x345b00,_0x54a42b,0xc8);})['catch'](_0xa9d128=>{return responseUtils[a28_0x5b03('0xf')](_0x345b00,_0xa9d128[a28_0x5b03('0x15')],0x1f4);});}})[a28_0x5b03('0x14')](_0x5b8d1d=>{return responseUtils['errorResponse'](_0x345b00,_0x5b8d1d['stack'],0x1f4);});}}exports[a28_0x5b03('0x18')]=AuthConstroller;
var a28_0x167e=['email','then','usernameNotFoundError','validPassword','password','toJSON','secret','token','successResponse','errorResponse','catch','usernameTakenError','generateHash','stack','default','defineProperty','jsonwebtoken','i18n','../../config/jwt.js','../../infrastructure/response-utils','../../resources/locale-strings','model','login','bind','createAccount','findOne','body','username','first_name','last_name'];(function(_0x28941e,_0xf2d255){var _0x926906=function(_0x2c76aa){while(--_0x2c76aa){_0x28941e['push'](_0x28941e['shift']());}};_0x926906(++_0xf2d255);}(a28_0x167e,0x1d1));var a28_0x3cc4=function(_0x42bd82,_0x1c408a){_0x42bd82=_0x42bd82-0x0;var _0x308a9d=a28_0x167e[_0x42bd82];return _0x308a9d;};'use strict';Object[a28_0x3cc4('0x0')](exports,'__esModule',{'value':!![]});const jwt=require(a28_0x3cc4('0x1'));const i18n=require(a28_0x3cc4('0x2'));const configJwt=require(a28_0x3cc4('0x3'));const authUtils=require('../../infrastructure/auth-utils');const responseUtils=require(a28_0x3cc4('0x4'));const LocaleStrings=require(a28_0x3cc4('0x5'));class AuthConstroller{constructor(_0x103dbd){this[a28_0x3cc4('0x6')]=_0x103dbd;this[a28_0x3cc4('0x7')]=this['login'][a28_0x3cc4('0x8')](this);this[a28_0x3cc4('0x9')]=this['createAccount'][a28_0x3cc4('0x8')](this);}[a28_0x3cc4('0x7')](_0xe4ab15,_0x18b75b,_0x15964e){this['model'][a28_0x3cc4('0xa')]({'where':{'username':_0xe4ab15[a28_0x3cc4('0xb')][a28_0x3cc4('0xc')]},'attributes':['id',a28_0x3cc4('0xd'),a28_0x3cc4('0xe'),a28_0x3cc4('0xf'),a28_0x3cc4('0xc'),'password']})[a28_0x3cc4('0x10')](_0x544e41=>{if(!_0x544e41){return responseUtils['errorResponse'](_0x18b75b,LocaleStrings[a28_0x3cc4('0x11')],0x193);}if(authUtils[a28_0x3cc4('0x12')](_0xe4ab15['body']['password'],_0x544e41[a28_0x3cc4('0x13')])){_0x544e41=_0x544e41[a28_0x3cc4('0x14')]();const _0x881ca5={'id':_0x544e41['id']};const _0x954527=jwt['sign'](_0x881ca5,configJwt[a28_0x3cc4('0x15')]);delete _0x544e41[a28_0x3cc4('0x13')];_0x544e41[a28_0x3cc4('0x16')]=_0x954527;return responseUtils[a28_0x3cc4('0x17')](_0x18b75b,_0x544e41,0xc8);}else{return responseUtils[a28_0x3cc4('0x18')](_0x18b75b,_0x18b75b['__'](LocaleStrings['passwordNotMatchError']),0x193);}})[a28_0x3cc4('0x19')](_0x5e4644=>{return responseUtils[a28_0x3cc4('0x18')](_0x18b75b,_0x5e4644['stack'],0x1f4);});}[a28_0x3cc4('0x9')](_0x3d3d78,_0x2a8fe8,_0xd94460){this[a28_0x3cc4('0x6')][a28_0x3cc4('0xa')]({'where':{'username':_0x3d3d78[a28_0x3cc4('0xb')][a28_0x3cc4('0xc')]}})[a28_0x3cc4('0x10')](function(_0x2cb300){if(_0x2cb300){return responseUtils[a28_0x3cc4('0x18')](_0x2a8fe8,_0x2a8fe8['__'](LocaleStrings[a28_0x3cc4('0x1a')],_0x3d3d78[a28_0x3cc4('0xb')][a28_0x3cc4('0xc')]),0x193);}else{_0x3d3d78[a28_0x3cc4('0xb')][a28_0x3cc4('0xf')]=_0x3d3d78[a28_0x3cc4('0xb')][a28_0x3cc4('0xc')];const _0x1f21a8={'username':_0x3d3d78[a28_0x3cc4('0xb')]['username'],'password':authUtils[a28_0x3cc4('0x1b')](_0x3d3d78[a28_0x3cc4('0xb')]['password'])};this['model']['create'](_0x1f21a8)['then'](function(_0x12aca3,_0x5e36e0){return responseUtils[a28_0x3cc4('0x17')](_0x2a8fe8,_0x12aca3,0xc8);})[a28_0x3cc4('0x19')](_0x4bad76=>{return responseUtils[a28_0x3cc4('0x18')](_0x2a8fe8,_0x4bad76[a28_0x3cc4('0x1c')],0x1f4);});}})['catch'](_0x4f6c4b=>{return responseUtils['errorResponse'](_0x2a8fe8,_0x4f6c4b[a28_0x3cc4('0x1c')],0x1f4);});}}exports[a28_0x3cc4('0x1d')]=AuthConstroller;
var a9_0x4fb9=['usernameNotFoundError','body','token','successResponse','errorResponse','passwordNotMatchError','catch','stack','createAccount','create','default','__esModule','jsonwebtoken','../../infrastructure/auth-utils','login','bind','model','findOne','first_name','last_name','email','username','password','then'];(function(_0x217a76,_0xb2a8e0){var _0x36fea4=function(_0xac1388){while(--_0xac1388){_0x217a76['push'](_0x217a76['shift']());}};_0x36fea4(++_0xb2a8e0);}(a9_0x4fb9,0x1d3));var a9_0x588b=function(_0x2bb515,_0x276e8d){_0x2bb515=_0x2bb515-0x0;var _0x43c53d=a9_0x4fb9[_0x2bb515];return _0x43c53d;};'use strict';Object['defineProperty'](exports,a9_0x588b('0x0'),{'value':!![]});const jwt=require(a9_0x588b('0x1'));const i18n=require('i18n');const configJwt=require('../../config/jwt.js');const authUtils=require(a9_0x588b('0x2'));const responseUtils=require('../../infrastructure/response-utils');const LocaleStrings=require('../../resources/locale-strings');class AuthConstroller{constructor(_0x3a3736){this['model']=_0x3a3736;this['login']=this[a9_0x588b('0x3')][a9_0x588b('0x4')](this);this['createAccount']=this['createAccount']['bind'](this);}[a9_0x588b('0x3')](_0x34df98,_0x3c87e4,_0x5bea31){this[a9_0x588b('0x5')][a9_0x588b('0x6')]({'where':{'username':_0x34df98['body']['username']},'attributes':['id',a9_0x588b('0x7'),a9_0x588b('0x8'),a9_0x588b('0x9'),a9_0x588b('0xa'),a9_0x588b('0xb')]})[a9_0x588b('0xc')](_0x1134a7=>{if(!_0x1134a7){return responseUtils['errorResponse'](_0x3c87e4,LocaleStrings[a9_0x588b('0xd')],0x193);}if(authUtils['validPassword'](_0x34df98[a9_0x588b('0xe')][a9_0x588b('0xb')],_0x1134a7[a9_0x588b('0xb')])){_0x1134a7=_0x1134a7['toJSON']();const _0x185bf1={'id':_0x1134a7['id']};const _0x20f8c2=jwt['sign'](_0x185bf1,configJwt['secret']);delete _0x1134a7[a9_0x588b('0xb')];_0x1134a7[a9_0x588b('0xf')]=_0x20f8c2;return responseUtils[a9_0x588b('0x10')](_0x3c87e4,_0x1134a7,0xc8);}else{return responseUtils[a9_0x588b('0x11')](_0x3c87e4,_0x3c87e4['__'](LocaleStrings[a9_0x588b('0x12')]),0x193);}})[a9_0x588b('0x13')](_0x27e5d3=>{return responseUtils[a9_0x588b('0x11')](_0x3c87e4,_0x27e5d3[a9_0x588b('0x14')],0x1f4);});}[a9_0x588b('0x15')](_0x55554e,_0x39f262,_0x293246){this[a9_0x588b('0x5')][a9_0x588b('0x6')]({'where':{'username':_0x55554e[a9_0x588b('0xe')][a9_0x588b('0xa')]}})[a9_0x588b('0xc')](function(_0xbc704a){if(_0xbc704a){return responseUtils[a9_0x588b('0x11')](_0x39f262,_0x39f262['__'](LocaleStrings['usernameTakenError'],_0x55554e[a9_0x588b('0xe')][a9_0x588b('0xa')]),0x193);}else{_0x55554e[a9_0x588b('0xe')][a9_0x588b('0x9')]=_0x55554e['body']['username'];const _0x296288={'username':_0x55554e[a9_0x588b('0xe')][a9_0x588b('0xa')],'password':authUtils['generateHash'](_0x55554e[a9_0x588b('0xe')]['password'])};this[a9_0x588b('0x5')][a9_0x588b('0x16')](_0x296288)[a9_0x588b('0xc')](function(_0x44a1e1,_0x2ff836){return responseUtils['successResponse'](_0x39f262,_0x44a1e1,0xc8);})[a9_0x588b('0x13')](_0x4af61a=>{return responseUtils['errorResponse'](_0x39f262,_0x4af61a[a9_0x588b('0x14')],0x1f4);});}})[a9_0x588b('0x13')](_0x557b3a=>{return responseUtils['errorResponse'](_0x39f262,_0x557b3a['stack'],0x1f4);});}}exports[a9_0x588b('0x17')]=AuthConstroller;
var a9_0x20f7=['bind','createAccount','model','findOne','body','username','first_name','last_name','email','password','errorResponse','usernameNotFoundError','toJSON','secret','successResponse','passwordNotMatchError','catch','stack','usernameTakenError','generateHash','default','defineProperty','__esModule','i18n','../../infrastructure/auth-utils','../../infrastructure/response-utils','../../resources/locale-strings','login'];(function(_0x2386c9,_0x1fba7b){var _0x344c7f=function(_0x36edca){while(--_0x36edca){_0x2386c9['push'](_0x2386c9['shift']());}};_0x344c7f(++_0x1fba7b);}(a9_0x20f7,0x12d));var a9_0x1d60=function(_0x5a40d3,_0x5ea8ea){_0x5a40d3=_0x5a40d3-0x0;var _0x373238=a9_0x20f7[_0x5a40d3];return _0x373238;};'use strict';Object[a9_0x1d60('0x0')](exports,a9_0x1d60('0x1'),{'value':!![]});const jwt=require('jsonwebtoken');const i18n=require(a9_0x1d60('0x2'));const configJwt=require('../../config/jwt.js');const authUtils=require(a9_0x1d60('0x3'));const responseUtils=require(a9_0x1d60('0x4'));const LocaleStrings=require(a9_0x1d60('0x5'));class AuthConstroller{constructor(_0x28e0a4){this['model']=_0x28e0a4;this[a9_0x1d60('0x6')]=this[a9_0x1d60('0x6')][a9_0x1d60('0x7')](this);this[a9_0x1d60('0x8')]=this[a9_0x1d60('0x8')][a9_0x1d60('0x7')](this);}[a9_0x1d60('0x6')](_0x1da1a3,_0x5c3bfb,_0x486609){this[a9_0x1d60('0x9')][a9_0x1d60('0xa')]({'where':{'username':_0x1da1a3[a9_0x1d60('0xb')][a9_0x1d60('0xc')]},'attributes':['id',a9_0x1d60('0xd'),a9_0x1d60('0xe'),a9_0x1d60('0xf'),a9_0x1d60('0xc'),a9_0x1d60('0x10')]})['then'](_0x16c5e9=>{if(!_0x16c5e9){return responseUtils[a9_0x1d60('0x11')](_0x5c3bfb,LocaleStrings[a9_0x1d60('0x12')],0x193);}if(authUtils['validPassword'](_0x1da1a3[a9_0x1d60('0xb')][a9_0x1d60('0x10')],_0x16c5e9[a9_0x1d60('0x10')])){_0x16c5e9=_0x16c5e9[a9_0x1d60('0x13')]();const _0x45a770={'id':_0x16c5e9['id']};const _0x23650b=jwt['sign'](_0x45a770,configJwt[a9_0x1d60('0x14')]);delete _0x16c5e9[a9_0x1d60('0x10')];_0x16c5e9['token']=_0x23650b;return responseUtils[a9_0x1d60('0x15')](_0x5c3bfb,_0x16c5e9,0xc8);}else{return responseUtils[a9_0x1d60('0x11')](_0x5c3bfb,_0x5c3bfb['__'](LocaleStrings[a9_0x1d60('0x16')]),0x193);}})[a9_0x1d60('0x17')](_0x252134=>{return responseUtils[a9_0x1d60('0x11')](_0x5c3bfb,_0x252134[a9_0x1d60('0x18')],0x1f4);});}[a9_0x1d60('0x8')](_0x3f6219,_0x2ad03b,_0x7fff45){this[a9_0x1d60('0x9')][a9_0x1d60('0xa')]({'where':{'username':_0x3f6219['body'][a9_0x1d60('0xc')]}})['then'](function(_0x449290){if(_0x449290){return responseUtils['errorResponse'](_0x2ad03b,_0x2ad03b['__'](LocaleStrings[a9_0x1d60('0x19')],_0x3f6219[a9_0x1d60('0xb')][a9_0x1d60('0xc')]),0x193);}else{_0x3f6219[a9_0x1d60('0xb')][a9_0x1d60('0xf')]=_0x3f6219['body'][a9_0x1d60('0xc')];const _0x5ecf5d={'username':_0x3f6219[a9_0x1d60('0xb')][a9_0x1d60('0xc')],'password':authUtils[a9_0x1d60('0x1a')](_0x3f6219[a9_0x1d60('0xb')][a9_0x1d60('0x10')])};this[a9_0x1d60('0x9')]['create'](_0x5ecf5d)['then'](function(_0x517259,_0xa18b19){return responseUtils[a9_0x1d60('0x15')](_0x2ad03b,_0x517259,0xc8);})['catch'](_0x31381c=>{return responseUtils[a9_0x1d60('0x11')](_0x2ad03b,_0x31381c[a9_0x1d60('0x18')],0x1f4);});}})[a9_0x1d60('0x17')](_0x5138de=>{return responseUtils[a9_0x1d60('0x11')](_0x2ad03b,_0x5138de[a9_0x1d60('0x18')],0x1f4);});}}exports[a9_0x1d60('0x1b')]=AuthConstroller;
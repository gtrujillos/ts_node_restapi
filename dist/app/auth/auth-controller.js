var a9_0x5c53=['generateHash','create','default','defineProperty','__esModule','jsonwebtoken','i18n','../../infrastructure/auth-utils','../../infrastructure/response-utils','../../resources/locale-strings','model','login','bind','createAccount','findOne','body','username','first_name','last_name','email','then','errorResponse','usernameNotFoundError','validPassword','password','toJSON','sign','secret','catch','stack','usernameTakenError'];(function(_0x5ba0f1,_0x1c6039){var _0x5e0255=function(_0xaa1319){while(--_0xaa1319){_0x5ba0f1['push'](_0x5ba0f1['shift']());}};_0x5e0255(++_0x1c6039);}(a9_0x5c53,0x1f3));var a9_0x3ce5=function(_0x5cefe4,_0x53f067){_0x5cefe4=_0x5cefe4-0x0;var _0x19b08f=a9_0x5c53[_0x5cefe4];return _0x19b08f;};'use strict';Object[a9_0x3ce5('0x0')](exports,a9_0x3ce5('0x1'),{'value':!![]});const jwt=require(a9_0x3ce5('0x2'));const i18n=require(a9_0x3ce5('0x3'));const configJwt=require('../../config/jwt.js');const authUtils=require(a9_0x3ce5('0x4'));const responseUtils=require(a9_0x3ce5('0x5'));const LocaleStrings=require(a9_0x3ce5('0x6'));class AuthConstroller{constructor(_0x32111e){this[a9_0x3ce5('0x7')]=_0x32111e;this[a9_0x3ce5('0x8')]=this[a9_0x3ce5('0x8')][a9_0x3ce5('0x9')](this);this[a9_0x3ce5('0xa')]=this[a9_0x3ce5('0xa')][a9_0x3ce5('0x9')](this);}[a9_0x3ce5('0x8')](_0x3a1d3a,_0x13c071,_0x3b3381){this[a9_0x3ce5('0x7')][a9_0x3ce5('0xb')]({'where':{'username':_0x3a1d3a[a9_0x3ce5('0xc')][a9_0x3ce5('0xd')]},'attributes':['id',a9_0x3ce5('0xe'),a9_0x3ce5('0xf'),a9_0x3ce5('0x10'),'username','password']})[a9_0x3ce5('0x11')](_0x204141=>{if(!_0x204141){return responseUtils[a9_0x3ce5('0x12')](_0x13c071,LocaleStrings[a9_0x3ce5('0x13')],0x193);}if(authUtils[a9_0x3ce5('0x14')](_0x3a1d3a['body']['password'],_0x204141[a9_0x3ce5('0x15')])){_0x204141=_0x204141[a9_0x3ce5('0x16')]();const _0x5225eb={'id':_0x204141['id']};const _0x1e068f=jwt[a9_0x3ce5('0x17')](_0x5225eb,configJwt[a9_0x3ce5('0x18')]);delete _0x204141[a9_0x3ce5('0x15')];_0x204141['token']=_0x1e068f;return responseUtils['successResponse'](_0x13c071,_0x204141,0xc8);}else{return responseUtils[a9_0x3ce5('0x12')](_0x13c071,_0x13c071['__'](LocaleStrings['passwordNotMatchError']),0x193);}})[a9_0x3ce5('0x19')](_0x226502=>{return responseUtils[a9_0x3ce5('0x12')](_0x13c071,_0x226502[a9_0x3ce5('0x1a')],0x1f4);});}[a9_0x3ce5('0xa')](_0x27c935,_0x16efc8,_0x174f8c){this[a9_0x3ce5('0x7')]['findOne']({'where':{'username':_0x27c935['body']['username']}})[a9_0x3ce5('0x11')](function(_0x4bd9b1){if(_0x4bd9b1){return responseUtils[a9_0x3ce5('0x12')](_0x16efc8,_0x16efc8['__'](LocaleStrings[a9_0x3ce5('0x1b')],_0x27c935[a9_0x3ce5('0xc')][a9_0x3ce5('0xd')]),0x193);}else{_0x27c935[a9_0x3ce5('0xc')][a9_0x3ce5('0x10')]=_0x27c935[a9_0x3ce5('0xc')][a9_0x3ce5('0xd')];const _0x490b31={'username':_0x27c935['body']['username'],'password':authUtils[a9_0x3ce5('0x1c')](_0x27c935['body'][a9_0x3ce5('0x15')])};this['model'][a9_0x3ce5('0x1d')](_0x490b31)['then'](function(_0x2bc835,_0x3de320){return responseUtils['successResponse'](_0x16efc8,_0x2bc835,0xc8);})[a9_0x3ce5('0x19')](_0x35fb25=>{return responseUtils[a9_0x3ce5('0x12')](_0x16efc8,_0x35fb25[a9_0x3ce5('0x1a')],0x1f4);});}})[a9_0x3ce5('0x19')](_0x2b668f=>{return responseUtils['errorResponse'](_0x16efc8,_0x2b668f['stack'],0x1f4);});}}exports[a9_0x3ce5('0x1e')]=AuthConstroller;
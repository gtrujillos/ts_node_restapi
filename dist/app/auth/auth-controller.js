var a9_0x4a7a=['../../config/jwt.js','../../infrastructure/response-utils','../../resources/locale-strings','login','bind','createAccount','model','findOne','body','first_name','last_name','email','username','password','usernameNotFoundError','validPassword','sign','secret','token','successResponse','passwordNotMatchError','catch','errorResponse','stack','then','generateHash','create','__esModule','jsonwebtoken','i18n'];(function(_0x5182fc,_0x328c84){var _0x58240d=function(_0x5e43bd){while(--_0x5e43bd){_0x5182fc['push'](_0x5182fc['shift']());}};_0x58240d(++_0x328c84);}(a9_0x4a7a,0xb1));var a9_0x28f3=function(_0x46d037,_0x341081){_0x46d037=_0x46d037-0x0;var _0x258e4b=a9_0x4a7a[_0x46d037];return _0x258e4b;};'use strict';Object['defineProperty'](exports,a9_0x28f3('0x0'),{'value':!![]});const jwt=require(a9_0x28f3('0x1'));const i18n=require(a9_0x28f3('0x2'));const configJwt=require(a9_0x28f3('0x3'));const authUtils=require('../../infrastructure/auth-utils');const responseUtils=require(a9_0x28f3('0x4'));const LocaleStrings=require(a9_0x28f3('0x5'));class AuthConstroller{constructor(_0x2ff2f1){this['model']=_0x2ff2f1;this['login']=this[a9_0x28f3('0x6')][a9_0x28f3('0x7')](this);this['createAccount']=this[a9_0x28f3('0x8')][a9_0x28f3('0x7')](this);}[a9_0x28f3('0x6')](_0xccebf2,_0x2c2d5d,_0x1740e0){this[a9_0x28f3('0x9')][a9_0x28f3('0xa')]({'where':{'username':_0xccebf2[a9_0x28f3('0xb')]['username']},'attributes':['id',a9_0x28f3('0xc'),a9_0x28f3('0xd'),a9_0x28f3('0xe'),a9_0x28f3('0xf'),a9_0x28f3('0x10')]})['then'](_0x34d784=>{if(!_0x34d784){return responseUtils['errorResponse'](_0x2c2d5d,LocaleStrings[a9_0x28f3('0x11')],0x193);}if(authUtils[a9_0x28f3('0x12')](_0xccebf2['body'][a9_0x28f3('0x10')],_0x34d784['password'])){_0x34d784=_0x34d784['toJSON']();const _0x286705={'id':_0x34d784['id']};const _0x1aa863=jwt[a9_0x28f3('0x13')](_0x286705,configJwt[a9_0x28f3('0x14')]);delete _0x34d784[a9_0x28f3('0x10')];_0x34d784[a9_0x28f3('0x15')]=_0x1aa863;return responseUtils[a9_0x28f3('0x16')](_0x2c2d5d,_0x34d784,0xc8);}else{return responseUtils['errorResponse'](_0x2c2d5d,_0x2c2d5d['__'](LocaleStrings[a9_0x28f3('0x17')]),0x193);}})[a9_0x28f3('0x18')](_0x4e907e=>{return responseUtils[a9_0x28f3('0x19')](_0x2c2d5d,_0x4e907e[a9_0x28f3('0x1a')],0x1f4);});}['createAccount'](_0x32fa22,_0x21f3da,_0x27e669){this[a9_0x28f3('0x9')][a9_0x28f3('0xa')]({'where':{'username':_0x32fa22[a9_0x28f3('0xb')][a9_0x28f3('0xf')]}})[a9_0x28f3('0x1b')](function(_0xf160b1){if(_0xf160b1){return responseUtils[a9_0x28f3('0x19')](_0x21f3da,_0x21f3da['__'](LocaleStrings['usernameTakenError'],_0x32fa22[a9_0x28f3('0xb')][a9_0x28f3('0xf')]),0x193);}else{_0x32fa22['body'][a9_0x28f3('0xe')]=_0x32fa22[a9_0x28f3('0xb')][a9_0x28f3('0xf')];const _0x1f94cc={'username':_0x32fa22[a9_0x28f3('0xb')]['username'],'password':authUtils[a9_0x28f3('0x1c')](_0x32fa22[a9_0x28f3('0xb')][a9_0x28f3('0x10')])};this[a9_0x28f3('0x9')][a9_0x28f3('0x1d')](_0x1f94cc)['then'](function(_0x5b7202,_0x1537a0){return responseUtils[a9_0x28f3('0x16')](_0x21f3da,_0x5b7202,0xc8);})[a9_0x28f3('0x18')](_0x324d3c=>{return responseUtils[a9_0x28f3('0x19')](_0x21f3da,_0x324d3c[a9_0x28f3('0x1a')],0x1f4);});}})['catch'](_0x2edb46=>{return responseUtils[a9_0x28f3('0x19')](_0x21f3da,_0x2edb46[a9_0x28f3('0x1a')],0x1f4);});}}exports['default']=AuthConstroller;
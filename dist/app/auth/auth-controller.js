var a9_0x5030=['toJSON','sign','secret','token','passwordNotMatchError','catch','stack','usernameTakenError','create','successResponse','defineProperty','__esModule','jsonwebtoken','i18n','../../infrastructure/response-utils','../../resources/locale-strings','model','login','bind','createAccount','findOne','body','email','username','password','then','errorResponse'];(function(_0x5d41e0,_0x426541){var _0xd02ba5=function(_0x5a8056){while(--_0x5a8056){_0x5d41e0['push'](_0x5d41e0['shift']());}};_0xd02ba5(++_0x426541);}(a9_0x5030,0x184));var a9_0x2e1f=function(_0x3ac3c0,_0x2eeeeb){_0x3ac3c0=_0x3ac3c0-0x0;var _0x3fa179=a9_0x5030[_0x3ac3c0];return _0x3fa179;};'use strict';Object[a9_0x2e1f('0x0')](exports,a9_0x2e1f('0x1'),{'value':!![]});const jwt=require(a9_0x2e1f('0x2'));const i18n=require(a9_0x2e1f('0x3'));const configJwt=require('../../config/jwt.js');const authUtils=require('../../infrastructure/auth-utils');const responseUtils=require(a9_0x2e1f('0x4'));const LocaleStrings=require(a9_0x2e1f('0x5'));class AuthConstroller{constructor(_0xd4609a){this[a9_0x2e1f('0x6')]=_0xd4609a;this[a9_0x2e1f('0x7')]=this[a9_0x2e1f('0x7')][a9_0x2e1f('0x8')](this);this[a9_0x2e1f('0x9')]=this[a9_0x2e1f('0x9')][a9_0x2e1f('0x8')](this);}['login'](_0x29d975,_0x174510,_0x555021){this[a9_0x2e1f('0x6')][a9_0x2e1f('0xa')]({'where':{'username':_0x29d975[a9_0x2e1f('0xb')]['username']},'attributes':['id','first_name','last_name',a9_0x2e1f('0xc'),a9_0x2e1f('0xd'),a9_0x2e1f('0xe')]})[a9_0x2e1f('0xf')](_0x523f6b=>{if(!_0x523f6b){return responseUtils[a9_0x2e1f('0x10')](_0x174510,LocaleStrings['usernameNotFoundError'],0x193);}if(authUtils['validPassword'](_0x29d975[a9_0x2e1f('0xb')]['password'],_0x523f6b[a9_0x2e1f('0xe')])){_0x523f6b=_0x523f6b[a9_0x2e1f('0x11')]();const _0x548159={'id':_0x523f6b['id']};const _0x18bb90=jwt[a9_0x2e1f('0x12')](_0x548159,configJwt[a9_0x2e1f('0x13')]);delete _0x523f6b[a9_0x2e1f('0xe')];_0x523f6b[a9_0x2e1f('0x14')]=_0x18bb90;return responseUtils['successResponse'](_0x174510,_0x523f6b,0xc8);}else{return responseUtils[a9_0x2e1f('0x10')](_0x174510,_0x174510['__'](LocaleStrings[a9_0x2e1f('0x15')]),0x193);}})[a9_0x2e1f('0x16')](_0x2e10d0=>{return responseUtils['errorResponse'](_0x174510,_0x2e10d0[a9_0x2e1f('0x17')],0x1f4);});}[a9_0x2e1f('0x9')](_0x3bdff5,_0x491a07,_0x504269){this[a9_0x2e1f('0x6')][a9_0x2e1f('0xa')]({'where':{'username':_0x3bdff5[a9_0x2e1f('0xb')]['username']}})['then'](function(_0x57f6ab){if(_0x57f6ab){return responseUtils[a9_0x2e1f('0x10')](_0x491a07,_0x491a07['__'](LocaleStrings[a9_0x2e1f('0x18')],_0x3bdff5['body'][a9_0x2e1f('0xd')]),0x193);}else{_0x3bdff5[a9_0x2e1f('0xb')][a9_0x2e1f('0xc')]=_0x3bdff5[a9_0x2e1f('0xb')][a9_0x2e1f('0xd')];const _0x4dc4c1={'username':_0x3bdff5[a9_0x2e1f('0xb')][a9_0x2e1f('0xd')],'password':authUtils['generateHash'](_0x3bdff5[a9_0x2e1f('0xb')]['password'])};this[a9_0x2e1f('0x6')][a9_0x2e1f('0x19')](_0x4dc4c1)[a9_0x2e1f('0xf')](function(_0x4e3aac,_0x307d02){return responseUtils[a9_0x2e1f('0x1a')](_0x491a07,_0x4e3aac,0xc8);})['catch'](_0x799fd9=>{return responseUtils[a9_0x2e1f('0x10')](_0x491a07,_0x799fd9[a9_0x2e1f('0x17')],0x1f4);});}})[a9_0x2e1f('0x16')](_0x35c72c=>{return responseUtils['errorResponse'](_0x491a07,_0x35c72c[a9_0x2e1f('0x17')],0x1f4);});}}exports['default']=AuthConstroller;
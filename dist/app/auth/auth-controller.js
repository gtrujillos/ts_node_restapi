var a9_0x4519=['usernameTakenError','generateHash','create','default','defineProperty','__esModule','../../infrastructure/response-utils','../../resources/locale-strings','login','bind','createAccount','model','findOne','body','username','first_name','email','then','errorResponse','usernameNotFoundError','password','toJSON','sign','secret','token','successResponse','passwordNotMatchError','stack'];(function(_0x8630f9,_0x391d5e){var _0x3382cd=function(_0x5ed1b8){while(--_0x5ed1b8){_0x8630f9['push'](_0x8630f9['shift']());}};_0x3382cd(++_0x391d5e);}(a9_0x4519,0x100));var a9_0x56bc=function(_0x193692,_0x2a3f35){_0x193692=_0x193692-0x0;var _0xa23b40=a9_0x4519[_0x193692];return _0xa23b40;};'use strict';Object[a9_0x56bc('0x0')](exports,a9_0x56bc('0x1'),{'value':!![]});const jwt=require('jsonwebtoken');const i18n=require('i18n');const configJwt=require('../../config/jwt.js');const authUtils=require('../../infrastructure/auth-utils');const responseUtils=require(a9_0x56bc('0x2'));const LocaleStrings=require(a9_0x56bc('0x3'));class AuthConstroller{constructor(_0x3a5282){this['model']=_0x3a5282;this['login']=this[a9_0x56bc('0x4')][a9_0x56bc('0x5')](this);this[a9_0x56bc('0x6')]=this[a9_0x56bc('0x6')][a9_0x56bc('0x5')](this);}['login'](_0x42ae95,_0x3a8fea,_0x4ccef8){this[a9_0x56bc('0x7')][a9_0x56bc('0x8')]({'where':{'username':_0x42ae95[a9_0x56bc('0x9')][a9_0x56bc('0xa')]},'attributes':['id',a9_0x56bc('0xb'),'last_name',a9_0x56bc('0xc'),'username','password']})[a9_0x56bc('0xd')](_0x3891d3=>{if(!_0x3891d3){return responseUtils[a9_0x56bc('0xe')](_0x3a8fea,LocaleStrings[a9_0x56bc('0xf')],0x193);}if(authUtils['validPassword'](_0x42ae95[a9_0x56bc('0x9')][a9_0x56bc('0x10')],_0x3891d3[a9_0x56bc('0x10')])){_0x3891d3=_0x3891d3[a9_0x56bc('0x11')]();const _0x5c651a={'id':_0x3891d3['id']};const _0x188b57=jwt[a9_0x56bc('0x12')](_0x5c651a,configJwt[a9_0x56bc('0x13')]);delete _0x3891d3[a9_0x56bc('0x10')];_0x3891d3[a9_0x56bc('0x14')]=_0x188b57;return responseUtils[a9_0x56bc('0x15')](_0x3a8fea,_0x3891d3,0xc8);}else{return responseUtils[a9_0x56bc('0xe')](_0x3a8fea,_0x3a8fea['__'](LocaleStrings[a9_0x56bc('0x16')]),0x193);}})['catch'](_0x45ec0f=>{return responseUtils[a9_0x56bc('0xe')](_0x3a8fea,_0x45ec0f[a9_0x56bc('0x17')],0x1f4);});}[a9_0x56bc('0x6')](_0x2c25aa,_0xdc4504,_0x4e33ae){this['model'][a9_0x56bc('0x8')]({'where':{'username':_0x2c25aa[a9_0x56bc('0x9')][a9_0x56bc('0xa')]}})[a9_0x56bc('0xd')](function(_0x21347f){if(_0x21347f){return responseUtils[a9_0x56bc('0xe')](_0xdc4504,_0xdc4504['__'](LocaleStrings[a9_0x56bc('0x18')],_0x2c25aa[a9_0x56bc('0x9')][a9_0x56bc('0xa')]),0x193);}else{_0x2c25aa['body'][a9_0x56bc('0xc')]=_0x2c25aa['body'][a9_0x56bc('0xa')];const _0x1d3ab9={'username':_0x2c25aa[a9_0x56bc('0x9')][a9_0x56bc('0xa')],'password':authUtils[a9_0x56bc('0x19')](_0x2c25aa[a9_0x56bc('0x9')][a9_0x56bc('0x10')])};this['model'][a9_0x56bc('0x1a')](_0x1d3ab9)[a9_0x56bc('0xd')](function(_0x157c9e,_0x35763c){return responseUtils[a9_0x56bc('0x15')](_0xdc4504,_0x157c9e,0xc8);})['catch'](_0x5862dc=>{return responseUtils[a9_0x56bc('0xe')](_0xdc4504,_0x5862dc['stack'],0x1f4);});}})['catch'](_0x105cde=>{return responseUtils[a9_0x56bc('0xe')](_0xdc4504,_0x105cde[a9_0x56bc('0x17')],0x1f4);});}}exports[a9_0x56bc('0x1b')]=AuthConstroller;
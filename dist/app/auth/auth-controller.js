var a9_0x229f=['successResponse','passwordNotMatchError','stack','create','defineProperty','jsonwebtoken','i18n','../../infrastructure/auth-utils','../../infrastructure/response-utils','../../resources/locale-strings','model','login','bind','createAccount','body','username','first_name','last_name','email','password','then','errorResponse','usernameNotFoundError','validPassword','toJSON','sign','secret'];(function(_0x122330,_0x18b501){var _0x280e09=function(_0x13ad4a){while(--_0x13ad4a){_0x122330['push'](_0x122330['shift']());}};_0x280e09(++_0x18b501);}(a9_0x229f,0x199));var a9_0x4a16=function(_0x575da8,_0x50121c){_0x575da8=_0x575da8-0x0;var _0xe29628=a9_0x229f[_0x575da8];return _0xe29628;};'use strict';Object[a9_0x4a16('0x0')](exports,'__esModule',{'value':!![]});const jwt=require(a9_0x4a16('0x1'));const i18n=require(a9_0x4a16('0x2'));const configJwt=require('../../config/jwt.js');const authUtils=require(a9_0x4a16('0x3'));const responseUtils=require(a9_0x4a16('0x4'));const LocaleStrings=require(a9_0x4a16('0x5'));class AuthConstroller{constructor(_0x4cbae7){this[a9_0x4a16('0x6')]=_0x4cbae7;this[a9_0x4a16('0x7')]=this[a9_0x4a16('0x7')][a9_0x4a16('0x8')](this);this[a9_0x4a16('0x9')]=this['createAccount'][a9_0x4a16('0x8')](this);}[a9_0x4a16('0x7')](_0x3e31c4,_0x3ccde9,_0x85d394){this[a9_0x4a16('0x6')]['findOne']({'where':{'username':_0x3e31c4[a9_0x4a16('0xa')][a9_0x4a16('0xb')]},'attributes':['id',a9_0x4a16('0xc'),a9_0x4a16('0xd'),a9_0x4a16('0xe'),'username',a9_0x4a16('0xf')]})[a9_0x4a16('0x10')](_0x19f371=>{if(!_0x19f371){return responseUtils[a9_0x4a16('0x11')](_0x3ccde9,LocaleStrings[a9_0x4a16('0x12')],0x193);}if(authUtils[a9_0x4a16('0x13')](_0x3e31c4[a9_0x4a16('0xa')][a9_0x4a16('0xf')],_0x19f371[a9_0x4a16('0xf')])){_0x19f371=_0x19f371[a9_0x4a16('0x14')]();const _0x1224fb={'id':_0x19f371['id']};const _0xa399ec=jwt[a9_0x4a16('0x15')](_0x1224fb,configJwt[a9_0x4a16('0x16')]);delete _0x19f371[a9_0x4a16('0xf')];_0x19f371['token']=_0xa399ec;return responseUtils[a9_0x4a16('0x17')](_0x3ccde9,_0x19f371,0xc8);}else{return responseUtils[a9_0x4a16('0x11')](_0x3ccde9,_0x3ccde9['__'](LocaleStrings[a9_0x4a16('0x18')]),0x193);}})['catch'](_0x2919fc=>{return responseUtils[a9_0x4a16('0x11')](_0x3ccde9,_0x2919fc[a9_0x4a16('0x19')],0x1f4);});}[a9_0x4a16('0x9')](_0xe850a7,_0x2ae485,_0x44cc42){this[a9_0x4a16('0x6')]['findOne']({'where':{'username':_0xe850a7[a9_0x4a16('0xa')][a9_0x4a16('0xb')]}})['then'](function(_0x36c6a9){if(_0x36c6a9){return responseUtils[a9_0x4a16('0x11')](_0x2ae485,_0x2ae485['__'](LocaleStrings['usernameTakenError'],_0xe850a7[a9_0x4a16('0xa')][a9_0x4a16('0xb')]),0x193);}else{_0xe850a7[a9_0x4a16('0xa')][a9_0x4a16('0xe')]=_0xe850a7['body'][a9_0x4a16('0xb')];const _0x32df01={'username':_0xe850a7['body']['username'],'password':authUtils['generateHash'](_0xe850a7[a9_0x4a16('0xa')]['password'])};this['model'][a9_0x4a16('0x1a')](_0x32df01)[a9_0x4a16('0x10')](function(_0x31d03e,_0x3d4adf){return responseUtils[a9_0x4a16('0x17')](_0x2ae485,_0x31d03e,0xc8);})['catch'](_0x161f35=>{return responseUtils[a9_0x4a16('0x11')](_0x2ae485,_0x161f35[a9_0x4a16('0x19')],0x1f4);});}})['catch'](_0x5a137d=>{return responseUtils[a9_0x4a16('0x11')](_0x2ae485,_0x5a137d[a9_0x4a16('0x19')],0x1f4);});}}exports['default']=AuthConstroller;
var a9_0x3a0c=['createAccount','findOne','username','first_name','last_name','email','password','then','errorResponse','usernameNotFoundError','validPassword','body','sign','secret','token','successResponse','passwordNotMatchError','catch','stack','usernameTakenError','generateHash','default','defineProperty','__esModule','jsonwebtoken','i18n','../../config/jwt.js','../../infrastructure/auth-utils','../../infrastructure/response-utils','../../resources/locale-strings','login','bind'];(function(_0x1fb6e2,_0xca30ec){var _0x456a0e=function(_0x1f14d8){while(--_0x1f14d8){_0x1fb6e2['push'](_0x1fb6e2['shift']());}};_0x456a0e(++_0xca30ec);}(a9_0x3a0c,0x1b6));var a9_0x5094=function(_0x1a2ae8,_0x335f1b){_0x1a2ae8=_0x1a2ae8-0x0;var _0x431d8f=a9_0x3a0c[_0x1a2ae8];return _0x431d8f;};'use strict';Object[a9_0x5094('0x0')](exports,a9_0x5094('0x1'),{'value':!![]});const jwt=require(a9_0x5094('0x2'));const i18n=require(a9_0x5094('0x3'));const configJwt=require(a9_0x5094('0x4'));const authUtils=require(a9_0x5094('0x5'));const responseUtils=require(a9_0x5094('0x6'));const LocaleStrings=require(a9_0x5094('0x7'));class AuthConstroller{constructor(_0x32a7b7){this['model']=_0x32a7b7;this[a9_0x5094('0x8')]=this[a9_0x5094('0x8')][a9_0x5094('0x9')](this);this[a9_0x5094('0xa')]=this[a9_0x5094('0xa')]['bind'](this);}['login'](_0x2b7dec,_0x2e061a,_0x2e20a6){this['model'][a9_0x5094('0xb')]({'where':{'username':_0x2b7dec['body'][a9_0x5094('0xc')]},'attributes':['id',a9_0x5094('0xd'),a9_0x5094('0xe'),a9_0x5094('0xf'),a9_0x5094('0xc'),a9_0x5094('0x10')]})[a9_0x5094('0x11')](_0x33d9ce=>{if(!_0x33d9ce){return responseUtils[a9_0x5094('0x12')](_0x2e061a,LocaleStrings[a9_0x5094('0x13')],0x193);}if(authUtils[a9_0x5094('0x14')](_0x2b7dec[a9_0x5094('0x15')][a9_0x5094('0x10')],_0x33d9ce[a9_0x5094('0x10')])){_0x33d9ce=_0x33d9ce['toJSON']();const _0x59a584={'id':_0x33d9ce['id']};const _0x31f28e=jwt[a9_0x5094('0x16')](_0x59a584,configJwt[a9_0x5094('0x17')]);delete _0x33d9ce[a9_0x5094('0x10')];_0x33d9ce[a9_0x5094('0x18')]=_0x31f28e;return responseUtils[a9_0x5094('0x19')](_0x2e061a,_0x33d9ce,0xc8);}else{return responseUtils['errorResponse'](_0x2e061a,_0x2e061a['__'](LocaleStrings[a9_0x5094('0x1a')]),0x193);}})[a9_0x5094('0x1b')](_0x240703=>{return responseUtils['errorResponse'](_0x2e061a,_0x240703[a9_0x5094('0x1c')],0x1f4);});}['createAccount'](_0x14628e,_0x5eb558,_0x56cc06){this['model'][a9_0x5094('0xb')]({'where':{'username':_0x14628e[a9_0x5094('0x15')]['username']}})[a9_0x5094('0x11')](function(_0x22bac1){if(_0x22bac1){return responseUtils[a9_0x5094('0x12')](_0x5eb558,_0x5eb558['__'](LocaleStrings[a9_0x5094('0x1d')],_0x14628e['body'][a9_0x5094('0xc')]),0x193);}else{_0x14628e[a9_0x5094('0x15')]['email']=_0x14628e[a9_0x5094('0x15')][a9_0x5094('0xc')];const _0x430525={'username':_0x14628e[a9_0x5094('0x15')][a9_0x5094('0xc')],'password':authUtils[a9_0x5094('0x1e')](_0x14628e[a9_0x5094('0x15')][a9_0x5094('0x10')])};this['model']['create'](_0x430525)[a9_0x5094('0x11')](function(_0x1d498f,_0xefbbfe){return responseUtils['successResponse'](_0x5eb558,_0x1d498f,0xc8);})['catch'](_0x251744=>{return responseUtils[a9_0x5094('0x12')](_0x5eb558,_0x251744['stack'],0x1f4);});}})['catch'](_0x586cee=>{return responseUtils['errorResponse'](_0x5eb558,_0x586cee[a9_0x5094('0x1c')],0x1f4);});}}exports[a9_0x5094('0x1f')]=AuthConstroller;
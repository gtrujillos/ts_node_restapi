var a9_0x463f=['email','username','password','then','errorResponse','body','toJSON','sign','successResponse','passwordNotMatchError','catch','generateHash','create','stack','default','defineProperty','jsonwebtoken','i18n','../../config/jwt.js','../../infrastructure/auth-utils','../../infrastructure/response-utils','../../resources/locale-strings','model','login','createAccount','bind','findOne','last_name'];(function(_0x172635,_0x49fe09){var _0x867d6a=function(_0x16d0f2){while(--_0x16d0f2){_0x172635['push'](_0x172635['shift']());}};_0x867d6a(++_0x49fe09);}(a9_0x463f,0x1cf));var a9_0x2213=function(_0xf9790e,_0x7cc0fb){_0xf9790e=_0xf9790e-0x0;var _0x3c8d70=a9_0x463f[_0xf9790e];return _0x3c8d70;};'use strict';Object[a9_0x2213('0x0')](exports,'__esModule',{'value':!![]});const jwt=require(a9_0x2213('0x1'));const i18n=require(a9_0x2213('0x2'));const configJwt=require(a9_0x2213('0x3'));const authUtils=require(a9_0x2213('0x4'));const responseUtils=require(a9_0x2213('0x5'));const LocaleStrings=require(a9_0x2213('0x6'));class AuthConstroller{constructor(_0x4534b4){this[a9_0x2213('0x7')]=_0x4534b4;this[a9_0x2213('0x8')]=this[a9_0x2213('0x8')]['bind'](this);this['createAccount']=this[a9_0x2213('0x9')][a9_0x2213('0xa')](this);}[a9_0x2213('0x8')](_0x55293c,_0xba90da,_0x11a8e4){this['model'][a9_0x2213('0xb')]({'where':{'username':_0x55293c['body']['username']},'attributes':['id','first_name',a9_0x2213('0xc'),a9_0x2213('0xd'),a9_0x2213('0xe'),a9_0x2213('0xf')]})[a9_0x2213('0x10')](_0x19ea08=>{if(!_0x19ea08){return responseUtils[a9_0x2213('0x11')](_0xba90da,LocaleStrings['usernameNotFoundError'],0x193);}if(authUtils['validPassword'](_0x55293c[a9_0x2213('0x12')][a9_0x2213('0xf')],_0x19ea08['password'])){_0x19ea08=_0x19ea08[a9_0x2213('0x13')]();const _0x48f8d8={'id':_0x19ea08['id']};const _0x150c0f=jwt[a9_0x2213('0x14')](_0x48f8d8,configJwt['secret']);delete _0x19ea08[a9_0x2213('0xf')];_0x19ea08['token']=_0x150c0f;return responseUtils[a9_0x2213('0x15')](_0xba90da,_0x19ea08,0xc8);}else{return responseUtils[a9_0x2213('0x11')](_0xba90da,_0xba90da['__'](LocaleStrings[a9_0x2213('0x16')]),0x193);}})[a9_0x2213('0x17')](_0x5dbe97=>{return responseUtils[a9_0x2213('0x11')](_0xba90da,_0x5dbe97['stack'],0x1f4);});}['createAccount'](_0x53895a,_0x26869d,_0x17ee9d){this['model'][a9_0x2213('0xb')]({'where':{'username':_0x53895a[a9_0x2213('0x12')][a9_0x2213('0xe')]}})['then'](function(_0xfd0df4){if(_0xfd0df4){return responseUtils['errorResponse'](_0x26869d,_0x26869d['__'](LocaleStrings['usernameTakenError'],_0x53895a[a9_0x2213('0x12')][a9_0x2213('0xe')]),0x193);}else{_0x53895a['body'][a9_0x2213('0xd')]=_0x53895a[a9_0x2213('0x12')][a9_0x2213('0xe')];const _0x26549c={'username':_0x53895a[a9_0x2213('0x12')][a9_0x2213('0xe')],'password':authUtils[a9_0x2213('0x18')](_0x53895a[a9_0x2213('0x12')][a9_0x2213('0xf')])};this[a9_0x2213('0x7')][a9_0x2213('0x19')](_0x26549c)[a9_0x2213('0x10')](function(_0x542ac1,_0x2762d1){return responseUtils[a9_0x2213('0x15')](_0x26869d,_0x542ac1,0xc8);})['catch'](_0x4ff448=>{return responseUtils[a9_0x2213('0x11')](_0x26869d,_0x4ff448[a9_0x2213('0x1a')],0x1f4);});}})[a9_0x2213('0x17')](_0x1fe2bb=>{return responseUtils[a9_0x2213('0x11')](_0x26869d,_0x1fe2bb[a9_0x2213('0x1a')],0x1f4);});}}exports[a9_0x2213('0x1b')]=AuthConstroller;
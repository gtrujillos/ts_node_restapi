var a28_0x12fa=['errorResponse','passwordNotMatchError','catch','stack','findOne','usernameTakenError','create','default','defineProperty','__esModule','i18n','../../config/jwt.js','../../infrastructure/auth-utils','../../infrastructure/response-utils','../../resources/locale-strings','login','bind','createAccount','model','body','username','first_name','last_name','password','then','usernameNotFoundError','validPassword','sign','secret','successResponse'];(function(_0x5dd744,_0x29014b){var _0x1f5bfc=function(_0x5c7acb){while(--_0x5c7acb){_0x5dd744['push'](_0x5dd744['shift']());}};_0x1f5bfc(++_0x29014b);}(a28_0x12fa,0x80));var a28_0x134f=function(_0x194a80,_0x490bd0){_0x194a80=_0x194a80-0x0;var _0x1b0c94=a28_0x12fa[_0x194a80];return _0x1b0c94;};'use strict';Object[a28_0x134f('0x0')](exports,a28_0x134f('0x1'),{'value':!![]});const jwt=require('jsonwebtoken');const i18n=require(a28_0x134f('0x2'));const configJwt=require(a28_0x134f('0x3'));const authUtils=require(a28_0x134f('0x4'));const responseUtils=require(a28_0x134f('0x5'));const LocaleStrings=require(a28_0x134f('0x6'));class AuthConstroller{constructor(_0x12e468){this['model']=_0x12e468;this[a28_0x134f('0x7')]=this[a28_0x134f('0x7')][a28_0x134f('0x8')](this);this[a28_0x134f('0x9')]=this[a28_0x134f('0x9')][a28_0x134f('0x8')](this);}[a28_0x134f('0x7')](_0x5a6795,_0x297abe,_0x3c33f7){this[a28_0x134f('0xa')]['findOne']({'where':{'username':_0x5a6795[a28_0x134f('0xb')][a28_0x134f('0xc')]},'attributes':['id',a28_0x134f('0xd'),a28_0x134f('0xe'),'email',a28_0x134f('0xc'),a28_0x134f('0xf')]})[a28_0x134f('0x10')](_0x38b1e3=>{if(!_0x38b1e3){return responseUtils['errorResponse'](_0x297abe,LocaleStrings[a28_0x134f('0x11')],0x193);}if(authUtils[a28_0x134f('0x12')](_0x5a6795['body'][a28_0x134f('0xf')],_0x38b1e3[a28_0x134f('0xf')])){_0x38b1e3=_0x38b1e3['toJSON']();const _0x2270a1={'id':_0x38b1e3['id']};const _0x593c8f=jwt[a28_0x134f('0x13')](_0x2270a1,configJwt[a28_0x134f('0x14')]);delete _0x38b1e3[a28_0x134f('0xf')];_0x38b1e3['token']=_0x593c8f;return responseUtils[a28_0x134f('0x15')](_0x297abe,_0x38b1e3,0xc8);}else{return responseUtils[a28_0x134f('0x16')](_0x297abe,_0x297abe['__'](LocaleStrings[a28_0x134f('0x17')]),0x193);}})[a28_0x134f('0x18')](_0x2e9b61=>{return responseUtils['errorResponse'](_0x297abe,_0x2e9b61[a28_0x134f('0x19')],0x1f4);});}[a28_0x134f('0x9')](_0x37645a,_0x3ffa7e,_0x15f6d8){this[a28_0x134f('0xa')][a28_0x134f('0x1a')]({'where':{'username':_0x37645a[a28_0x134f('0xb')][a28_0x134f('0xc')]}})[a28_0x134f('0x10')](function(_0x34b9b5){if(_0x34b9b5){return responseUtils['errorResponse'](_0x3ffa7e,_0x3ffa7e['__'](LocaleStrings[a28_0x134f('0x1b')],_0x37645a[a28_0x134f('0xb')]['username']),0x193);}else{_0x37645a[a28_0x134f('0xb')]['email']=_0x37645a[a28_0x134f('0xb')][a28_0x134f('0xc')];const _0x46d4e8={'username':_0x37645a[a28_0x134f('0xb')][a28_0x134f('0xc')],'password':authUtils['generateHash'](_0x37645a[a28_0x134f('0xb')]['password'])};this[a28_0x134f('0xa')][a28_0x134f('0x1c')](_0x46d4e8)[a28_0x134f('0x10')](function(_0x3d53c9,_0x2a9d2b){return responseUtils[a28_0x134f('0x15')](_0x3ffa7e,_0x3d53c9,0xc8);})[a28_0x134f('0x18')](_0xb857be=>{return responseUtils[a28_0x134f('0x16')](_0x3ffa7e,_0xb857be['stack'],0x1f4);});}})[a28_0x134f('0x18')](_0x3db0ed=>{return responseUtils['errorResponse'](_0x3ffa7e,_0x3db0ed[a28_0x134f('0x19')],0x1f4);});}}exports[a28_0x134f('0x1d')]=AuthConstroller;
var a28_0x2bdf=['../../infrastructure/response-utils','../../resources/locale-strings','login','bind','createAccount','model','findOne','body','username','last_name','email','password','then','errorResponse','validPassword','sign','secret','token','successResponse','passwordNotMatchError','catch','stack','usernameTakenError','generateHash','create','__esModule','jsonwebtoken','i18n','../../config/jwt.js','../../infrastructure/auth-utils'];(function(_0x16576a,_0x33e3dc){var _0x189040=function(_0x41181c){while(--_0x41181c){_0x16576a['push'](_0x16576a['shift']());}};_0x189040(++_0x33e3dc);}(a28_0x2bdf,0x163));var a28_0x53fd=function(_0x1b398c,_0x840b47){_0x1b398c=_0x1b398c-0x0;var _0x51fc84=a28_0x2bdf[_0x1b398c];return _0x51fc84;};'use strict';Object['defineProperty'](exports,a28_0x53fd('0x0'),{'value':!![]});const jwt=require(a28_0x53fd('0x1'));const i18n=require(a28_0x53fd('0x2'));const configJwt=require(a28_0x53fd('0x3'));const authUtils=require(a28_0x53fd('0x4'));const responseUtils=require(a28_0x53fd('0x5'));const LocaleStrings=require(a28_0x53fd('0x6'));class AuthConstroller{constructor(_0x2c9783){this['model']=_0x2c9783;this['login']=this[a28_0x53fd('0x7')][a28_0x53fd('0x8')](this);this['createAccount']=this[a28_0x53fd('0x9')][a28_0x53fd('0x8')](this);}[a28_0x53fd('0x7')](_0x23a421,_0x1ee1cd,_0x172056){this[a28_0x53fd('0xa')][a28_0x53fd('0xb')]({'where':{'username':_0x23a421[a28_0x53fd('0xc')][a28_0x53fd('0xd')]},'attributes':['id','first_name',a28_0x53fd('0xe'),a28_0x53fd('0xf'),a28_0x53fd('0xd'),a28_0x53fd('0x10')]})[a28_0x53fd('0x11')](_0x28a74e=>{if(!_0x28a74e){return responseUtils[a28_0x53fd('0x12')](_0x1ee1cd,LocaleStrings['usernameNotFoundError'],0x193);}if(authUtils[a28_0x53fd('0x13')](_0x23a421[a28_0x53fd('0xc')][a28_0x53fd('0x10')],_0x28a74e[a28_0x53fd('0x10')])){_0x28a74e=_0x28a74e['toJSON']();const _0x1fda2c={'id':_0x28a74e['id']};const _0x2a5d25=jwt[a28_0x53fd('0x14')](_0x1fda2c,configJwt[a28_0x53fd('0x15')]);delete _0x28a74e[a28_0x53fd('0x10')];_0x28a74e[a28_0x53fd('0x16')]=_0x2a5d25;return responseUtils[a28_0x53fd('0x17')](_0x1ee1cd,_0x28a74e,0xc8);}else{return responseUtils[a28_0x53fd('0x12')](_0x1ee1cd,_0x1ee1cd['__'](LocaleStrings[a28_0x53fd('0x18')]),0x193);}})[a28_0x53fd('0x19')](_0x4775db=>{return responseUtils[a28_0x53fd('0x12')](_0x1ee1cd,_0x4775db[a28_0x53fd('0x1a')],0x1f4);});}[a28_0x53fd('0x9')](_0x2f154,_0x125595,_0xf8666f){this[a28_0x53fd('0xa')][a28_0x53fd('0xb')]({'where':{'username':_0x2f154[a28_0x53fd('0xc')][a28_0x53fd('0xd')]}})['then'](function(_0x1d0651){if(_0x1d0651){return responseUtils[a28_0x53fd('0x12')](_0x125595,_0x125595['__'](LocaleStrings[a28_0x53fd('0x1b')],_0x2f154['body'][a28_0x53fd('0xd')]),0x193);}else{_0x2f154[a28_0x53fd('0xc')]['email']=_0x2f154[a28_0x53fd('0xc')][a28_0x53fd('0xd')];const _0x314f70={'username':_0x2f154[a28_0x53fd('0xc')][a28_0x53fd('0xd')],'password':authUtils[a28_0x53fd('0x1c')](_0x2f154[a28_0x53fd('0xc')][a28_0x53fd('0x10')])};this['model'][a28_0x53fd('0x1d')](_0x314f70)[a28_0x53fd('0x11')](function(_0x20622c,_0x3a4390){return responseUtils[a28_0x53fd('0x17')](_0x125595,_0x20622c,0xc8);})[a28_0x53fd('0x19')](_0x2b32c1=>{return responseUtils['errorResponse'](_0x125595,_0x2b32c1[a28_0x53fd('0x1a')],0x1f4);});}})['catch'](_0x216bcb=>{return responseUtils[a28_0x53fd('0x12')](_0x125595,_0x216bcb[a28_0x53fd('0x1a')],0x1f4);});}}exports['default']=AuthConstroller;
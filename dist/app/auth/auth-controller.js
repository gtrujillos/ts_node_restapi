var a28_0x5036=['catch','usernameTakenError','email','generateHash','create','successResponse','stack','default','defineProperty','__esModule','jsonwebtoken','i18n','../../config/jwt.js','../../infrastructure/auth-utils','../../resources/locale-strings','login','createAccount','model','findOne','body','username','first_name','then','errorResponse','usernameNotFoundError','validPassword','password','toJSON','sign','secret','token','passwordNotMatchError'];(function(_0x1288d8,_0x56dae8){var _0x50d727=function(_0x417c0a){while(--_0x417c0a){_0x1288d8['push'](_0x1288d8['shift']());}};_0x50d727(++_0x56dae8);}(a28_0x5036,0x88));var a28_0x3c0d=function(_0x1ad279,_0x61451e){_0x1ad279=_0x1ad279-0x0;var _0x2287ca=a28_0x5036[_0x1ad279];return _0x2287ca;};'use strict';Object[a28_0x3c0d('0x0')](exports,a28_0x3c0d('0x1'),{'value':!![]});const jwt=require(a28_0x3c0d('0x2'));const i18n=require(a28_0x3c0d('0x3'));const configJwt=require(a28_0x3c0d('0x4'));const authUtils=require(a28_0x3c0d('0x5'));const responseUtils=require('../../infrastructure/response-utils');const LocaleStrings=require(a28_0x3c0d('0x6'));class AuthConstroller{constructor(_0x2d8c70){this['model']=_0x2d8c70;this[a28_0x3c0d('0x7')]=this['login']['bind'](this);this['createAccount']=this[a28_0x3c0d('0x8')]['bind'](this);}[a28_0x3c0d('0x7')](_0x23b5c4,_0x47097c,_0xef37aa){this[a28_0x3c0d('0x9')][a28_0x3c0d('0xa')]({'where':{'username':_0x23b5c4[a28_0x3c0d('0xb')][a28_0x3c0d('0xc')]},'attributes':['id',a28_0x3c0d('0xd'),'last_name','email','username','password']})[a28_0x3c0d('0xe')](_0x31159c=>{if(!_0x31159c){return responseUtils[a28_0x3c0d('0xf')](_0x47097c,LocaleStrings[a28_0x3c0d('0x10')],0x193);}if(authUtils[a28_0x3c0d('0x11')](_0x23b5c4[a28_0x3c0d('0xb')][a28_0x3c0d('0x12')],_0x31159c[a28_0x3c0d('0x12')])){_0x31159c=_0x31159c[a28_0x3c0d('0x13')]();const _0x21002f={'id':_0x31159c['id']};const _0x55440a=jwt[a28_0x3c0d('0x14')](_0x21002f,configJwt[a28_0x3c0d('0x15')]);delete _0x31159c[a28_0x3c0d('0x12')];_0x31159c[a28_0x3c0d('0x16')]=_0x55440a;return responseUtils['successResponse'](_0x47097c,_0x31159c,0xc8);}else{return responseUtils[a28_0x3c0d('0xf')](_0x47097c,_0x47097c['__'](LocaleStrings[a28_0x3c0d('0x17')]),0x193);}})[a28_0x3c0d('0x18')](_0x811401=>{return responseUtils[a28_0x3c0d('0xf')](_0x47097c,_0x811401['stack'],0x1f4);});}[a28_0x3c0d('0x8')](_0x467928,_0x3a4c96,_0x10900c){this[a28_0x3c0d('0x9')][a28_0x3c0d('0xa')]({'where':{'username':_0x467928[a28_0x3c0d('0xb')][a28_0x3c0d('0xc')]}})[a28_0x3c0d('0xe')](function(_0x24637c){if(_0x24637c){return responseUtils[a28_0x3c0d('0xf')](_0x3a4c96,_0x3a4c96['__'](LocaleStrings[a28_0x3c0d('0x19')],_0x467928[a28_0x3c0d('0xb')]['username']),0x193);}else{_0x467928[a28_0x3c0d('0xb')][a28_0x3c0d('0x1a')]=_0x467928['body'][a28_0x3c0d('0xc')];const _0x39e92e={'username':_0x467928[a28_0x3c0d('0xb')][a28_0x3c0d('0xc')],'password':authUtils[a28_0x3c0d('0x1b')](_0x467928[a28_0x3c0d('0xb')][a28_0x3c0d('0x12')])};this[a28_0x3c0d('0x9')][a28_0x3c0d('0x1c')](_0x39e92e)[a28_0x3c0d('0xe')](function(_0x2905ca,_0x4c0a14){return responseUtils[a28_0x3c0d('0x1d')](_0x3a4c96,_0x2905ca,0xc8);})['catch'](_0x14f03e=>{return responseUtils[a28_0x3c0d('0xf')](_0x3a4c96,_0x14f03e['stack'],0x1f4);});}})['catch'](_0x274793=>{return responseUtils[a28_0x3c0d('0xf')](_0x3a4c96,_0x274793[a28_0x3c0d('0x1e')],0x1f4);});}}exports[a28_0x3c0d('0x1f')]=AuthConstroller;
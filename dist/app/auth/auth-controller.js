var a9_0x4ea0=['then','errorResponse','usernameNotFoundError','toJSON','sign','passwordNotMatchError','catch','stack','findOne','generateHash','create','defineProperty','__esModule','jsonwebtoken','i18n','../../config/jwt.js','../../infrastructure/auth-utils','../../resources/locale-strings','model','login','bind','createAccount','body','username','first_name','email','password'];(function(_0x16662c,_0x5529b7){var _0x10a91f=function(_0x52b289){while(--_0x52b289){_0x16662c['push'](_0x16662c['shift']());}};_0x10a91f(++_0x5529b7);}(a9_0x4ea0,0xfe));var a9_0x1711=function(_0x52fb77,_0x1919f6){_0x52fb77=_0x52fb77-0x0;var _0x139150=a9_0x4ea0[_0x52fb77];return _0x139150;};'use strict';Object[a9_0x1711('0x0')](exports,a9_0x1711('0x1'),{'value':!![]});const jwt=require(a9_0x1711('0x2'));const i18n=require(a9_0x1711('0x3'));const configJwt=require(a9_0x1711('0x4'));const authUtils=require(a9_0x1711('0x5'));const responseUtils=require('../../infrastructure/response-utils');const LocaleStrings=require(a9_0x1711('0x6'));class AuthConstroller{constructor(_0x4dddc1){this[a9_0x1711('0x7')]=_0x4dddc1;this['login']=this[a9_0x1711('0x8')][a9_0x1711('0x9')](this);this[a9_0x1711('0xa')]=this['createAccount']['bind'](this);}['login'](_0x2d872,_0x4c0447,_0x10cef0){this[a9_0x1711('0x7')]['findOne']({'where':{'username':_0x2d872[a9_0x1711('0xb')][a9_0x1711('0xc')]},'attributes':['id',a9_0x1711('0xd'),'last_name',a9_0x1711('0xe'),'username',a9_0x1711('0xf')]})[a9_0x1711('0x10')](_0x38ecc3=>{if(!_0x38ecc3){return responseUtils[a9_0x1711('0x11')](_0x4c0447,LocaleStrings[a9_0x1711('0x12')],0x193);}if(authUtils['validPassword'](_0x2d872[a9_0x1711('0xb')][a9_0x1711('0xf')],_0x38ecc3['password'])){_0x38ecc3=_0x38ecc3[a9_0x1711('0x13')]();const _0x3b8100={'id':_0x38ecc3['id']};const _0x2a9bdd=jwt[a9_0x1711('0x14')](_0x3b8100,configJwt['secret']);delete _0x38ecc3['password'];_0x38ecc3['token']=_0x2a9bdd;return responseUtils['successResponse'](_0x4c0447,_0x38ecc3,0xc8);}else{return responseUtils[a9_0x1711('0x11')](_0x4c0447,_0x4c0447['__'](LocaleStrings[a9_0x1711('0x15')]),0x193);}})[a9_0x1711('0x16')](_0x57d8be=>{return responseUtils[a9_0x1711('0x11')](_0x4c0447,_0x57d8be[a9_0x1711('0x17')],0x1f4);});}[a9_0x1711('0xa')](_0x1df452,_0x3b369f,_0x42cfc){this[a9_0x1711('0x7')][a9_0x1711('0x18')]({'where':{'username':_0x1df452['body'][a9_0x1711('0xc')]}})['then'](function(_0x186e05){if(_0x186e05){return responseUtils[a9_0x1711('0x11')](_0x3b369f,_0x3b369f['__'](LocaleStrings['usernameTakenError'],_0x1df452[a9_0x1711('0xb')][a9_0x1711('0xc')]),0x193);}else{_0x1df452['body'][a9_0x1711('0xe')]=_0x1df452[a9_0x1711('0xb')]['username'];const _0x144b12={'username':_0x1df452[a9_0x1711('0xb')][a9_0x1711('0xc')],'password':authUtils[a9_0x1711('0x19')](_0x1df452[a9_0x1711('0xb')][a9_0x1711('0xf')])};this[a9_0x1711('0x7')][a9_0x1711('0x1a')](_0x144b12)[a9_0x1711('0x10')](function(_0x2210e1,_0x4cd464){return responseUtils['successResponse'](_0x3b369f,_0x2210e1,0xc8);})['catch'](_0x2253cb=>{return responseUtils[a9_0x1711('0x11')](_0x3b369f,_0x2253cb[a9_0x1711('0x17')],0x1f4);});}})[a9_0x1711('0x16')](_0x8c1d58=>{return responseUtils[a9_0x1711('0x11')](_0x3b369f,_0x8c1d58['stack'],0x1f4);});}}exports['default']=AuthConstroller;
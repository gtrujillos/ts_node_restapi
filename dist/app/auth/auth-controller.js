var a9_0x37fb=['../../infrastructure/auth-utils','../../infrastructure/response-utils','login','bind','createAccount','model','body','first_name','last_name','username','password','errorResponse','usernameNotFoundError','validPassword','toJSON','sign','token','successResponse','catch','stack','findOne','then','usernameTakenError','generateHash','default','defineProperty','jsonwebtoken','i18n'];(function(_0x326927,_0x2c9b77){var _0x1904a8=function(_0x14a79f){while(--_0x14a79f){_0x326927['push'](_0x326927['shift']());}};_0x1904a8(++_0x2c9b77);}(a9_0x37fb,0xc1));var a9_0x4c0d=function(_0x3bae09,_0x47a0d2){_0x3bae09=_0x3bae09-0x0;var _0x39eab7=a9_0x37fb[_0x3bae09];return _0x39eab7;};'use strict';Object[a9_0x4c0d('0x0')](exports,'__esModule',{'value':!![]});const jwt=require(a9_0x4c0d('0x1'));const i18n=require(a9_0x4c0d('0x2'));const configJwt=require('../../config/jwt.js');const authUtils=require(a9_0x4c0d('0x3'));const responseUtils=require(a9_0x4c0d('0x4'));const LocaleStrings=require('../../resources/locale-strings');class AuthConstroller{constructor(_0xd279c8){this['model']=_0xd279c8;this['login']=this[a9_0x4c0d('0x5')][a9_0x4c0d('0x6')](this);this[a9_0x4c0d('0x7')]=this[a9_0x4c0d('0x7')][a9_0x4c0d('0x6')](this);}[a9_0x4c0d('0x5')](_0x5bdf2e,_0x1a646f,_0x3c7ef7){this[a9_0x4c0d('0x8')]['findOne']({'where':{'username':_0x5bdf2e[a9_0x4c0d('0x9')]['username']},'attributes':['id',a9_0x4c0d('0xa'),a9_0x4c0d('0xb'),'email',a9_0x4c0d('0xc'),a9_0x4c0d('0xd')]})['then'](_0x2cbd51=>{if(!_0x2cbd51){return responseUtils[a9_0x4c0d('0xe')](_0x1a646f,LocaleStrings[a9_0x4c0d('0xf')],0x193);}if(authUtils[a9_0x4c0d('0x10')](_0x5bdf2e['body'][a9_0x4c0d('0xd')],_0x2cbd51[a9_0x4c0d('0xd')])){_0x2cbd51=_0x2cbd51[a9_0x4c0d('0x11')]();const _0x339f8b={'id':_0x2cbd51['id']};const _0x113da3=jwt[a9_0x4c0d('0x12')](_0x339f8b,configJwt['secret']);delete _0x2cbd51[a9_0x4c0d('0xd')];_0x2cbd51[a9_0x4c0d('0x13')]=_0x113da3;return responseUtils[a9_0x4c0d('0x14')](_0x1a646f,_0x2cbd51,0xc8);}else{return responseUtils[a9_0x4c0d('0xe')](_0x1a646f,_0x1a646f['__'](LocaleStrings['passwordNotMatchError']),0x193);}})[a9_0x4c0d('0x15')](_0x3998d4=>{return responseUtils[a9_0x4c0d('0xe')](_0x1a646f,_0x3998d4[a9_0x4c0d('0x16')],0x1f4);});}[a9_0x4c0d('0x7')](_0x14cffe,_0x1e2157,_0x4014b7){this[a9_0x4c0d('0x8')][a9_0x4c0d('0x17')]({'where':{'username':_0x14cffe[a9_0x4c0d('0x9')][a9_0x4c0d('0xc')]}})[a9_0x4c0d('0x18')](function(_0x293074){if(_0x293074){return responseUtils[a9_0x4c0d('0xe')](_0x1e2157,_0x1e2157['__'](LocaleStrings[a9_0x4c0d('0x19')],_0x14cffe[a9_0x4c0d('0x9')][a9_0x4c0d('0xc')]),0x193);}else{_0x14cffe[a9_0x4c0d('0x9')]['email']=_0x14cffe[a9_0x4c0d('0x9')]['username'];const _0x5b46ac={'username':_0x14cffe[a9_0x4c0d('0x9')][a9_0x4c0d('0xc')],'password':authUtils[a9_0x4c0d('0x1a')](_0x14cffe[a9_0x4c0d('0x9')][a9_0x4c0d('0xd')])};this[a9_0x4c0d('0x8')]['create'](_0x5b46ac)[a9_0x4c0d('0x18')](function(_0x130988,_0x2aef93){return responseUtils[a9_0x4c0d('0x14')](_0x1e2157,_0x130988,0xc8);})[a9_0x4c0d('0x15')](_0x5ae7d4=>{return responseUtils[a9_0x4c0d('0xe')](_0x1e2157,_0x5ae7d4['stack'],0x1f4);});}})[a9_0x4c0d('0x15')](_0x5d48b1=>{return responseUtils['errorResponse'](_0x1e2157,_0x5d48b1[a9_0x4c0d('0x16')],0x1f4);});}}exports[a9_0x4c0d('0x1b')]=AuthConstroller;
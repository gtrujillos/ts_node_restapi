var a9_0x535f=['model','login','bind','createAccount','findOne','body','username','first_name','last_name','email','password','then','errorResponse','usernameNotFoundError','toJSON','sign','secret','token','successResponse','stack','usernameTakenError','generateHash','catch','defineProperty','jsonwebtoken','../../config/jwt.js','../../infrastructure/auth-utils','../../infrastructure/response-utils','../../resources/locale-strings'];(function(_0x50b579,_0x1a4950){var _0x2267d5=function(_0x592d60){while(--_0x592d60){_0x50b579['push'](_0x50b579['shift']());}};_0x2267d5(++_0x1a4950);}(a9_0x535f,0x6e));var a9_0x7635=function(_0x136dee,_0x2bb1c1){_0x136dee=_0x136dee-0x0;var _0x5e4493=a9_0x535f[_0x136dee];return _0x5e4493;};'use strict';Object[a9_0x7635('0x0')](exports,'__esModule',{'value':!![]});const jwt=require(a9_0x7635('0x1'));const i18n=require('i18n');const configJwt=require(a9_0x7635('0x2'));const authUtils=require(a9_0x7635('0x3'));const responseUtils=require(a9_0x7635('0x4'));const LocaleStrings=require(a9_0x7635('0x5'));class AuthConstroller{constructor(_0x589633){this[a9_0x7635('0x6')]=_0x589633;this[a9_0x7635('0x7')]=this['login'][a9_0x7635('0x8')](this);this[a9_0x7635('0x9')]=this[a9_0x7635('0x9')][a9_0x7635('0x8')](this);}[a9_0x7635('0x7')](_0x2df391,_0x587d94,_0x37ead3){this[a9_0x7635('0x6')][a9_0x7635('0xa')]({'where':{'username':_0x2df391[a9_0x7635('0xb')][a9_0x7635('0xc')]},'attributes':['id',a9_0x7635('0xd'),a9_0x7635('0xe'),a9_0x7635('0xf'),a9_0x7635('0xc'),a9_0x7635('0x10')]})[a9_0x7635('0x11')](_0xbf2ab6=>{if(!_0xbf2ab6){return responseUtils[a9_0x7635('0x12')](_0x587d94,LocaleStrings[a9_0x7635('0x13')],0x193);}if(authUtils['validPassword'](_0x2df391[a9_0x7635('0xb')][a9_0x7635('0x10')],_0xbf2ab6['password'])){_0xbf2ab6=_0xbf2ab6[a9_0x7635('0x14')]();const _0x194c4f={'id':_0xbf2ab6['id']};const _0x5a8689=jwt[a9_0x7635('0x15')](_0x194c4f,configJwt[a9_0x7635('0x16')]);delete _0xbf2ab6[a9_0x7635('0x10')];_0xbf2ab6[a9_0x7635('0x17')]=_0x5a8689;return responseUtils[a9_0x7635('0x18')](_0x587d94,_0xbf2ab6,0xc8);}else{return responseUtils[a9_0x7635('0x12')](_0x587d94,_0x587d94['__'](LocaleStrings['passwordNotMatchError']),0x193);}})['catch'](_0x41bec0=>{return responseUtils[a9_0x7635('0x12')](_0x587d94,_0x41bec0[a9_0x7635('0x19')],0x1f4);});}[a9_0x7635('0x9')](_0x4d1ab1,_0x2f48bc,_0x3197a0){this[a9_0x7635('0x6')]['findOne']({'where':{'username':_0x4d1ab1[a9_0x7635('0xb')][a9_0x7635('0xc')]}})[a9_0x7635('0x11')](function(_0xfef4b1){if(_0xfef4b1){return responseUtils[a9_0x7635('0x12')](_0x2f48bc,_0x2f48bc['__'](LocaleStrings[a9_0x7635('0x1a')],_0x4d1ab1[a9_0x7635('0xb')][a9_0x7635('0xc')]),0x193);}else{_0x4d1ab1['body'][a9_0x7635('0xf')]=_0x4d1ab1['body']['username'];const _0x94de9a={'username':_0x4d1ab1[a9_0x7635('0xb')][a9_0x7635('0xc')],'password':authUtils[a9_0x7635('0x1b')](_0x4d1ab1[a9_0x7635('0xb')][a9_0x7635('0x10')])};this[a9_0x7635('0x6')]['create'](_0x94de9a)[a9_0x7635('0x11')](function(_0x20e68e,_0x41c241){return responseUtils[a9_0x7635('0x18')](_0x2f48bc,_0x20e68e,0xc8);})[a9_0x7635('0x1c')](_0x5d73ce=>{return responseUtils['errorResponse'](_0x2f48bc,_0x5d73ce[a9_0x7635('0x19')],0x1f4);});}})['catch'](_0x126dff=>{return responseUtils[a9_0x7635('0x12')](_0x2f48bc,_0x126dff[a9_0x7635('0x19')],0x1f4);});}}exports['default']=AuthConstroller;
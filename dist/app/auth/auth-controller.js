var a9_0x2713=['model','login','bind','createAccount','findOne','body','username','last_name','email','password','then','errorResponse','usernameNotFoundError','validPassword','toJSON','sign','secret','successResponse','catch','stack','usernameTakenError','generateHash','create','defineProperty','i18n','../../resources/locale-strings'];(function(_0x592277,_0x5164ad){var _0x10ca8c=function(_0x4abba6){while(--_0x4abba6){_0x592277['push'](_0x592277['shift']());}};_0x10ca8c(++_0x5164ad);}(a9_0x2713,0x135));var a9_0x1ec3=function(_0x4b42dd,_0x582608){_0x4b42dd=_0x4b42dd-0x0;var _0x278b24=a9_0x2713[_0x4b42dd];return _0x278b24;};'use strict';Object[a9_0x1ec3('0x0')](exports,'__esModule',{'value':!![]});const jwt=require('jsonwebtoken');const i18n=require(a9_0x1ec3('0x1'));const configJwt=require('../../config/jwt.js');const authUtils=require('../../infrastructure/auth-utils');const responseUtils=require('../../infrastructure/response-utils');const LocaleStrings=require(a9_0x1ec3('0x2'));class AuthConstroller{constructor(_0x5bc947){this[a9_0x1ec3('0x3')]=_0x5bc947;this[a9_0x1ec3('0x4')]=this[a9_0x1ec3('0x4')][a9_0x1ec3('0x5')](this);this[a9_0x1ec3('0x6')]=this['createAccount'][a9_0x1ec3('0x5')](this);}['login'](_0x2d3fef,_0x47b227,_0x54f6dc){this['model'][a9_0x1ec3('0x7')]({'where':{'username':_0x2d3fef[a9_0x1ec3('0x8')][a9_0x1ec3('0x9')]},'attributes':['id','first_name',a9_0x1ec3('0xa'),a9_0x1ec3('0xb'),a9_0x1ec3('0x9'),a9_0x1ec3('0xc')]})[a9_0x1ec3('0xd')](_0x3e5140=>{if(!_0x3e5140){return responseUtils[a9_0x1ec3('0xe')](_0x47b227,LocaleStrings[a9_0x1ec3('0xf')],0x193);}if(authUtils[a9_0x1ec3('0x10')](_0x2d3fef[a9_0x1ec3('0x8')]['password'],_0x3e5140[a9_0x1ec3('0xc')])){_0x3e5140=_0x3e5140[a9_0x1ec3('0x11')]();const _0x3d91d6={'id':_0x3e5140['id']};const _0xe8dd93=jwt[a9_0x1ec3('0x12')](_0x3d91d6,configJwt[a9_0x1ec3('0x13')]);delete _0x3e5140[a9_0x1ec3('0xc')];_0x3e5140['token']=_0xe8dd93;return responseUtils[a9_0x1ec3('0x14')](_0x47b227,_0x3e5140,0xc8);}else{return responseUtils[a9_0x1ec3('0xe')](_0x47b227,_0x47b227['__'](LocaleStrings['passwordNotMatchError']),0x193);}})[a9_0x1ec3('0x15')](_0x53fc7d=>{return responseUtils['errorResponse'](_0x47b227,_0x53fc7d[a9_0x1ec3('0x16')],0x1f4);});}['createAccount'](_0x1e661c,_0x59fb9e,_0x5c17a8){this[a9_0x1ec3('0x3')][a9_0x1ec3('0x7')]({'where':{'username':_0x1e661c[a9_0x1ec3('0x8')]['username']}})[a9_0x1ec3('0xd')](function(_0x199d0e){if(_0x199d0e){return responseUtils[a9_0x1ec3('0xe')](_0x59fb9e,_0x59fb9e['__'](LocaleStrings[a9_0x1ec3('0x17')],_0x1e661c[a9_0x1ec3('0x8')][a9_0x1ec3('0x9')]),0x193);}else{_0x1e661c[a9_0x1ec3('0x8')][a9_0x1ec3('0xb')]=_0x1e661c['body'][a9_0x1ec3('0x9')];const _0x58faf2={'username':_0x1e661c[a9_0x1ec3('0x8')][a9_0x1ec3('0x9')],'password':authUtils[a9_0x1ec3('0x18')](_0x1e661c[a9_0x1ec3('0x8')][a9_0x1ec3('0xc')])};this[a9_0x1ec3('0x3')][a9_0x1ec3('0x19')](_0x58faf2)[a9_0x1ec3('0xd')](function(_0x149113,_0x3ef873){return responseUtils['successResponse'](_0x59fb9e,_0x149113,0xc8);})[a9_0x1ec3('0x15')](_0x446968=>{return responseUtils[a9_0x1ec3('0xe')](_0x59fb9e,_0x446968[a9_0x1ec3('0x16')],0x1f4);});}})[a9_0x1ec3('0x15')](_0x2e3737=>{return responseUtils['errorResponse'](_0x59fb9e,_0x2e3737[a9_0x1ec3('0x16')],0x1f4);});}}exports['default']=AuthConstroller;
var a28_0x2960=['password','errorResponse','validPassword','body','toJSON','secret','successResponse','stack','findOne','then','usernameTakenError','generateHash','create','catch','default','defineProperty','__esModule','jsonwebtoken','i18n','../../config/jwt.js','../../infrastructure/auth-utils','../../infrastructure/response-utils','../../resources/locale-strings','model','bind','createAccount','login','username','first_name','email'];(function(_0x56fdb0,_0x4cd234){var _0x4025f8=function(_0x3173b7){while(--_0x3173b7){_0x56fdb0['push'](_0x56fdb0['shift']());}};_0x4025f8(++_0x4cd234);}(a28_0x2960,0x69));var a28_0x32e2=function(_0x1ab66f,_0x275af9){_0x1ab66f=_0x1ab66f-0x0;var _0x8e292b=a28_0x2960[_0x1ab66f];return _0x8e292b;};'use strict';Object[a28_0x32e2('0x0')](exports,a28_0x32e2('0x1'),{'value':!![]});const jwt=require(a28_0x32e2('0x2'));const i18n=require(a28_0x32e2('0x3'));const configJwt=require(a28_0x32e2('0x4'));const authUtils=require(a28_0x32e2('0x5'));const responseUtils=require(a28_0x32e2('0x6'));const LocaleStrings=require(a28_0x32e2('0x7'));class AuthConstroller{constructor(_0x1e41e9){this[a28_0x32e2('0x8')]=_0x1e41e9;this['login']=this['login'][a28_0x32e2('0x9')](this);this['createAccount']=this[a28_0x32e2('0xa')][a28_0x32e2('0x9')](this);}[a28_0x32e2('0xb')](_0x455d3b,_0x5e6ab5,_0x47a621){this[a28_0x32e2('0x8')]['findOne']({'where':{'username':_0x455d3b['body'][a28_0x32e2('0xc')]},'attributes':['id',a28_0x32e2('0xd'),'last_name',a28_0x32e2('0xe'),a28_0x32e2('0xc'),a28_0x32e2('0xf')]})['then'](_0x50b446=>{if(!_0x50b446){return responseUtils[a28_0x32e2('0x10')](_0x5e6ab5,LocaleStrings['usernameNotFoundError'],0x193);}if(authUtils[a28_0x32e2('0x11')](_0x455d3b[a28_0x32e2('0x12')]['password'],_0x50b446[a28_0x32e2('0xf')])){_0x50b446=_0x50b446[a28_0x32e2('0x13')]();const _0x1ae205={'id':_0x50b446['id']};const _0x1b4e24=jwt['sign'](_0x1ae205,configJwt[a28_0x32e2('0x14')]);delete _0x50b446[a28_0x32e2('0xf')];_0x50b446['token']=_0x1b4e24;return responseUtils[a28_0x32e2('0x15')](_0x5e6ab5,_0x50b446,0xc8);}else{return responseUtils['errorResponse'](_0x5e6ab5,_0x5e6ab5['__'](LocaleStrings['passwordNotMatchError']),0x193);}})['catch'](_0x5ca1c0=>{return responseUtils[a28_0x32e2('0x10')](_0x5e6ab5,_0x5ca1c0[a28_0x32e2('0x16')],0x1f4);});}[a28_0x32e2('0xa')](_0x2db5ff,_0x16891d,_0x81bbb4){this['model'][a28_0x32e2('0x17')]({'where':{'username':_0x2db5ff[a28_0x32e2('0x12')][a28_0x32e2('0xc')]}})[a28_0x32e2('0x18')](function(_0x52779b){if(_0x52779b){return responseUtils['errorResponse'](_0x16891d,_0x16891d['__'](LocaleStrings[a28_0x32e2('0x19')],_0x2db5ff['body']['username']),0x193);}else{_0x2db5ff[a28_0x32e2('0x12')][a28_0x32e2('0xe')]=_0x2db5ff[a28_0x32e2('0x12')]['username'];const _0xadcc2c={'username':_0x2db5ff[a28_0x32e2('0x12')][a28_0x32e2('0xc')],'password':authUtils[a28_0x32e2('0x1a')](_0x2db5ff['body'][a28_0x32e2('0xf')])};this[a28_0x32e2('0x8')][a28_0x32e2('0x1b')](_0xadcc2c)[a28_0x32e2('0x18')](function(_0x125c15,_0x452fe6){return responseUtils[a28_0x32e2('0x15')](_0x16891d,_0x125c15,0xc8);})[a28_0x32e2('0x1c')](_0x21b886=>{return responseUtils[a28_0x32e2('0x10')](_0x16891d,_0x21b886['stack'],0x1f4);});}})[a28_0x32e2('0x1c')](_0x30d5ca=>{return responseUtils[a28_0x32e2('0x10')](_0x16891d,_0x30d5ca[a28_0x32e2('0x16')],0x1f4);});}}exports[a28_0x32e2('0x1d')]=AuthConstroller;
var a28_0xa6d3=['username','usernameTakenError','generateHash','create','successResponse','default','defineProperty','__esModule','i18n','../../config/jwt.js','../../infrastructure/response-utils','../../resources/locale-strings','model','login','bind','createAccount','findOne','body','first_name','last_name','email','then','usernameNotFoundError','validPassword','password','toJSON','sign','secret','errorResponse','catch','stack'];(function(_0x378431,_0x19355c){var _0x3db4f1=function(_0x519f00){while(--_0x519f00){_0x378431['push'](_0x378431['shift']());}};_0x3db4f1(++_0x19355c);}(a28_0xa6d3,0x1b8));var a28_0x2089=function(_0x448f7b,_0x1e26fd){_0x448f7b=_0x448f7b-0x0;var _0x1b686c=a28_0xa6d3[_0x448f7b];return _0x1b686c;};'use strict';Object[a28_0x2089('0x0')](exports,a28_0x2089('0x1'),{'value':!![]});const jwt=require('jsonwebtoken');const i18n=require(a28_0x2089('0x2'));const configJwt=require(a28_0x2089('0x3'));const authUtils=require('../../infrastructure/auth-utils');const responseUtils=require(a28_0x2089('0x4'));const LocaleStrings=require(a28_0x2089('0x5'));class AuthConstroller{constructor(_0x2e501a){this[a28_0x2089('0x6')]=_0x2e501a;this[a28_0x2089('0x7')]=this[a28_0x2089('0x7')][a28_0x2089('0x8')](this);this[a28_0x2089('0x9')]=this[a28_0x2089('0x9')]['bind'](this);}[a28_0x2089('0x7')](_0x5b5101,_0x5b2534,_0x4faa82){this[a28_0x2089('0x6')][a28_0x2089('0xa')]({'where':{'username':_0x5b5101[a28_0x2089('0xb')]['username']},'attributes':['id',a28_0x2089('0xc'),a28_0x2089('0xd'),a28_0x2089('0xe'),'username','password']})[a28_0x2089('0xf')](_0x593126=>{if(!_0x593126){return responseUtils['errorResponse'](_0x5b2534,LocaleStrings[a28_0x2089('0x10')],0x193);}if(authUtils[a28_0x2089('0x11')](_0x5b5101[a28_0x2089('0xb')][a28_0x2089('0x12')],_0x593126[a28_0x2089('0x12')])){_0x593126=_0x593126[a28_0x2089('0x13')]();const _0xb46cd4={'id':_0x593126['id']};const _0x424a8a=jwt[a28_0x2089('0x14')](_0xb46cd4,configJwt[a28_0x2089('0x15')]);delete _0x593126[a28_0x2089('0x12')];_0x593126['token']=_0x424a8a;return responseUtils['successResponse'](_0x5b2534,_0x593126,0xc8);}else{return responseUtils[a28_0x2089('0x16')](_0x5b2534,_0x5b2534['__'](LocaleStrings['passwordNotMatchError']),0x193);}})[a28_0x2089('0x17')](_0x6080bc=>{return responseUtils['errorResponse'](_0x5b2534,_0x6080bc[a28_0x2089('0x18')],0x1f4);});}[a28_0x2089('0x9')](_0x5de91f,_0xe236d9,_0x2dcdc4){this[a28_0x2089('0x6')]['findOne']({'where':{'username':_0x5de91f['body'][a28_0x2089('0x19')]}})['then'](function(_0xace58d){if(_0xace58d){return responseUtils[a28_0x2089('0x16')](_0xe236d9,_0xe236d9['__'](LocaleStrings[a28_0x2089('0x1a')],_0x5de91f['body'][a28_0x2089('0x19')]),0x193);}else{_0x5de91f[a28_0x2089('0xb')][a28_0x2089('0xe')]=_0x5de91f['body'][a28_0x2089('0x19')];const _0x5d0814={'username':_0x5de91f[a28_0x2089('0xb')]['username'],'password':authUtils[a28_0x2089('0x1b')](_0x5de91f['body'][a28_0x2089('0x12')])};this[a28_0x2089('0x6')][a28_0x2089('0x1c')](_0x5d0814)[a28_0x2089('0xf')](function(_0x503937,_0x4c63ac){return responseUtils[a28_0x2089('0x1d')](_0xe236d9,_0x503937,0xc8);})[a28_0x2089('0x17')](_0xfac3f5=>{return responseUtils[a28_0x2089('0x16')](_0xe236d9,_0xfac3f5[a28_0x2089('0x18')],0x1f4);});}})[a28_0x2089('0x17')](_0x2f7a30=>{return responseUtils[a28_0x2089('0x16')](_0xe236d9,_0x2f7a30[a28_0x2089('0x18')],0x1f4);});}}exports[a28_0x2089('0x1e')]=AuthConstroller;
var a9_0x3a6c=['login','createAccount','model','findOne','body','username','first_name','last_name','email','then','errorResponse','usernameNotFoundError','validPassword','password','toJSON','secret','token','successResponse','passwordNotMatchError','catch','usernameTakenError','create','stack','defineProperty','__esModule','jsonwebtoken','i18n','../../config/jwt.js','../../infrastructure/auth-utils','../../infrastructure/response-utils'];(function(_0x235213,_0x4e4b5d){var _0x2207cf=function(_0x467f71){while(--_0x467f71){_0x235213['push'](_0x235213['shift']());}};_0x2207cf(++_0x4e4b5d);}(a9_0x3a6c,0x125));var a9_0x5e0d=function(_0x13e7aa,_0x74981e){_0x13e7aa=_0x13e7aa-0x0;var _0x3a3bb9=a9_0x3a6c[_0x13e7aa];return _0x3a3bb9;};'use strict';Object[a9_0x5e0d('0x0')](exports,a9_0x5e0d('0x1'),{'value':!![]});const jwt=require(a9_0x5e0d('0x2'));const i18n=require(a9_0x5e0d('0x3'));const configJwt=require(a9_0x5e0d('0x4'));const authUtils=require(a9_0x5e0d('0x5'));const responseUtils=require(a9_0x5e0d('0x6'));const LocaleStrings=require('../../resources/locale-strings');class AuthConstroller{constructor(_0x2bec12){this['model']=_0x2bec12;this['login']=this[a9_0x5e0d('0x7')]['bind'](this);this[a9_0x5e0d('0x8')]=this[a9_0x5e0d('0x8')]['bind'](this);}[a9_0x5e0d('0x7')](_0xa18338,_0x37682a,_0x1a7dab){this[a9_0x5e0d('0x9')][a9_0x5e0d('0xa')]({'where':{'username':_0xa18338[a9_0x5e0d('0xb')][a9_0x5e0d('0xc')]},'attributes':['id',a9_0x5e0d('0xd'),a9_0x5e0d('0xe'),a9_0x5e0d('0xf'),a9_0x5e0d('0xc'),'password']})[a9_0x5e0d('0x10')](_0x160ec3=>{if(!_0x160ec3){return responseUtils[a9_0x5e0d('0x11')](_0x37682a,LocaleStrings[a9_0x5e0d('0x12')],0x193);}if(authUtils[a9_0x5e0d('0x13')](_0xa18338['body'][a9_0x5e0d('0x14')],_0x160ec3['password'])){_0x160ec3=_0x160ec3[a9_0x5e0d('0x15')]();const _0x2a3c33={'id':_0x160ec3['id']};const _0x3017bf=jwt['sign'](_0x2a3c33,configJwt[a9_0x5e0d('0x16')]);delete _0x160ec3[a9_0x5e0d('0x14')];_0x160ec3[a9_0x5e0d('0x17')]=_0x3017bf;return responseUtils[a9_0x5e0d('0x18')](_0x37682a,_0x160ec3,0xc8);}else{return responseUtils[a9_0x5e0d('0x11')](_0x37682a,_0x37682a['__'](LocaleStrings[a9_0x5e0d('0x19')]),0x193);}})[a9_0x5e0d('0x1a')](_0x420343=>{return responseUtils[a9_0x5e0d('0x11')](_0x37682a,_0x420343['stack'],0x1f4);});}[a9_0x5e0d('0x8')](_0x245ff8,_0x3f6a45,_0x3a8174){this[a9_0x5e0d('0x9')][a9_0x5e0d('0xa')]({'where':{'username':_0x245ff8[a9_0x5e0d('0xb')][a9_0x5e0d('0xc')]}})[a9_0x5e0d('0x10')](function(_0x16750e){if(_0x16750e){return responseUtils[a9_0x5e0d('0x11')](_0x3f6a45,_0x3f6a45['__'](LocaleStrings[a9_0x5e0d('0x1b')],_0x245ff8[a9_0x5e0d('0xb')][a9_0x5e0d('0xc')]),0x193);}else{_0x245ff8[a9_0x5e0d('0xb')]['email']=_0x245ff8['body']['username'];const _0x364124={'username':_0x245ff8[a9_0x5e0d('0xb')][a9_0x5e0d('0xc')],'password':authUtils['generateHash'](_0x245ff8[a9_0x5e0d('0xb')]['password'])};this['model'][a9_0x5e0d('0x1c')](_0x364124)['then'](function(_0x83cf21,_0x49378b){return responseUtils['successResponse'](_0x3f6a45,_0x83cf21,0xc8);})['catch'](_0x2a8691=>{return responseUtils[a9_0x5e0d('0x11')](_0x3f6a45,_0x2a8691[a9_0x5e0d('0x1d')],0x1f4);});}})['catch'](_0x246a71=>{return responseUtils[a9_0x5e0d('0x11')](_0x3f6a45,_0x246a71[a9_0x5e0d('0x1d')],0x1f4);});}}exports['default']=AuthConstroller;
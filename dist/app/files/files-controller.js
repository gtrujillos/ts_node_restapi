var a72_0x4a8d=['defineProperty','__esModule','../../infrastructure/base-controller','uuid','jsonwebtoken','i18n','../../infrastructure/auth-utils','../../infrastructure/response-utils','../../resources/locale-strings','string-format','fs-extra','saveFile','bind','log','user','errorResponse','authentication\x20failed','parse','upload_file','files','path','env','FILES_FOLDER','ensureDirSync','renameSync','body','size','name','type','is_private','save','successResponse','dataValues','catch','files\x20req.body\x20err1','stack','files\x20req.body\x20err2','__awaiter','next','throw','done','value','then','apply','__importDefault'];(function(_0xdddf49,_0x1ae223){var _0x2960a0=function(_0x4b28a1){while(--_0x4b28a1){_0xdddf49['push'](_0xdddf49['shift']());}};_0x2960a0(++_0x1ae223);}(a72_0x4a8d,0xac));var a72_0x21e8=function(_0x41bdc0,_0x3b9b28){_0x41bdc0=_0x41bdc0-0x0;var _0x2f8a0c=a72_0x4a8d[_0x41bdc0];return _0x2f8a0c;};'use strict';var __awaiter=this&&this[a72_0x21e8('0x0')]||function(_0x393f8d,_0x1d7c6d,_0x2b0b09,_0x549193){function _0x183da7(_0x503f1a){return _0x503f1a instanceof _0x2b0b09?_0x503f1a:new _0x2b0b09(function(_0x244a8d){_0x244a8d(_0x503f1a);});}return new(_0x2b0b09||(_0x2b0b09=Promise))(function(_0x163fdf,_0x381352){function _0xa93558(_0x2db41a){try{_0x4018d6(_0x549193[a72_0x21e8('0x1')](_0x2db41a));}catch(_0x487b69){_0x381352(_0x487b69);}}function _0x5807aa(_0x3dd3a9){try{_0x4018d6(_0x549193[a72_0x21e8('0x2')](_0x3dd3a9));}catch(_0x28dca3){_0x381352(_0x28dca3);}}function _0x4018d6(_0x3c542a){_0x3c542a[a72_0x21e8('0x3')]?_0x163fdf(_0x3c542a[a72_0x21e8('0x4')]):_0x183da7(_0x3c542a[a72_0x21e8('0x4')])[a72_0x21e8('0x5')](_0xa93558,_0x5807aa);}_0x4018d6((_0x549193=_0x549193[a72_0x21e8('0x6')](_0x393f8d,_0x1d7c6d||[]))[a72_0x21e8('0x1')]());});};var __importDefault=this&&this[a72_0x21e8('0x7')]||function(_0x1a9600){return _0x1a9600&&_0x1a9600['__esModule']?_0x1a9600:{'default':_0x1a9600};};Object[a72_0x21e8('0x8')](exports,a72_0x21e8('0x9'),{'value':!![]});const base_controller_1=__importDefault(require(a72_0x21e8('0xa')));const uuid_1=require(a72_0x21e8('0xb'));const jwt=require(a72_0x21e8('0xc'));const i18n=require(a72_0x21e8('0xd'));const authUtils=require(a72_0x21e8('0xe'));const responseUtils=require(a72_0x21e8('0xf'));const LocaleStrings=require(a72_0x21e8('0x10'));const format=require(a72_0x21e8('0x11'));const formidable=require('formidable');const fsExtra=require(a72_0x21e8('0x12'));class FilesController extends base_controller_1['default']{constructor(_0x2a2ff4){super(_0x2a2ff4,null);this[a72_0x21e8('0x13')]=this[a72_0x21e8('0x13')][a72_0x21e8('0x14')](this);}['saveFile'](_0x183dc8,_0x3dff42,_0x2f9062){return __awaiter(this,void 0x0,void 0x0,function*(){console[a72_0x21e8('0x15')](a72_0x21e8('0x13'));if(!_0x183dc8[a72_0x21e8('0x16')]){return responseUtils[a72_0x21e8('0x17')](_0x183dc8,_0x3dff42,a72_0x21e8('0x18'),0x191);}const _0x1daf72=formidable({'multiples':!![]});const _0xcf2718=uuid_1['v4']();return yield new Promise(function(_0x54f153,_0x4ec722){_0x1daf72[a72_0x21e8('0x19')](_0x183dc8,(_0x45f10e,_0x5cb1c7,_0x26d2ba)=>{const _0x168119=_0x26d2ba[a72_0x21e8('0x1a')];console[a72_0x21e8('0x15')](a72_0x21e8('0x1b'),_0x26d2ba);if(_0x168119==null){if(_0x3dff42){return responseUtils[a72_0x21e8('0x17')](_0x183dc8,_0x3dff42,null,0x190);}else{_0x4ec722(null);return;}}try{const _0x569bbc=_0x168119[a72_0x21e8('0x1c')];const _0x4363c1=process[a72_0x21e8('0x1d')][a72_0x21e8('0x1e')]+'files/';fsExtra[a72_0x21e8('0x1f')](_0x4363c1);const _0x1d2bd1=_0x4363c1+_0xcf2718;fsExtra[a72_0x21e8('0x20')](_0x569bbc,_0x1d2bd1);_0x183dc8[a72_0x21e8('0x21')]={'size':_0x168119[a72_0x21e8('0x22')],'stored_name':_0xcf2718,'name':_0x168119[a72_0x21e8('0x23')],'type':_0x168119[a72_0x21e8('0x24')],'is_private':_0x5cb1c7[a72_0x21e8('0x25')]!=null?_0x5cb1c7[a72_0x21e8('0x25')]:!![]};console[a72_0x21e8('0x15')]('files\x20req.body',_0x183dc8[a72_0x21e8('0x21')]);return this[a72_0x21e8('0x26')](_0x183dc8,null,_0x2f9062)[a72_0x21e8('0x5')](_0x2342f4=>{if(_0x3dff42){return responseUtils[a72_0x21e8('0x27')](_0x183dc8,_0x3dff42,_0x2342f4,0xc8);}else{_0x54f153({'data':_0x2342f4[a72_0x21e8('0x28')],'fields':_0x5cb1c7});}})[a72_0x21e8('0x29')](_0x45f10e=>{console['log'](a72_0x21e8('0x2a'),_0x45f10e);if(_0x3dff42){return responseUtils[a72_0x21e8('0x17')](_0x183dc8,_0x3dff42,_0x45f10e[a72_0x21e8('0x2b')],0x1f4);}else{_0x4ec722(_0x45f10e);}});}catch(_0x3f384a){console[a72_0x21e8('0x15')](a72_0x21e8('0x2c'),_0x3f384a);if(_0x3dff42){return responseUtils['errorResponse'](_0x183dc8,_0x3dff42,_0x3f384a[a72_0x21e8('0x2b')],0x1f4);}else{_0x4ec722(_0x3f384a);}}});}[a72_0x21e8('0x14')](this));});}}exports['default']=FilesController;
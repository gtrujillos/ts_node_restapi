var a72_0xbff4=['renameSync','body','size','name','type','is_private','files\x20req.body','save','successResponse','dataValues','catch','__awaiter','next','throw','done','value','then','apply','__esModule','defineProperty','uuid','i18n','../../infrastructure/auth-utils','../../resources/locale-strings','string-format','formidable','fs-extra','default','saveFile','bind','log','user','parse','upload_file','errorResponse','path','env','FILES_FOLDER','files/','ensureDirSync'];(function(_0x580652,_0x2d252a){var _0x4c7369=function(_0x5bdb93){while(--_0x5bdb93){_0x580652['push'](_0x580652['shift']());}};_0x4c7369(++_0x2d252a);}(a72_0xbff4,0x1c3));var a72_0x47f0=function(_0x4b315c,_0x2d152c){_0x4b315c=_0x4b315c-0x0;var _0x35a9d1=a72_0xbff4[_0x4b315c];return _0x35a9d1;};'use strict';var __awaiter=this&&this[a72_0x47f0('0x0')]||function(_0x5b4a18,_0x2c3376,_0x4f03ef,_0x414eb0){function _0x65167(_0x6c82c7){return _0x6c82c7 instanceof _0x4f03ef?_0x6c82c7:new _0x4f03ef(function(_0x354486){_0x354486(_0x6c82c7);});}return new(_0x4f03ef||(_0x4f03ef=Promise))(function(_0x4ba990,_0x33c013){function _0x5e04fa(_0x14e871){try{_0x23bd5b(_0x414eb0[a72_0x47f0('0x1')](_0x14e871));}catch(_0x236ce1){_0x33c013(_0x236ce1);}}function _0x76e9b6(_0x4f980b){try{_0x23bd5b(_0x414eb0[a72_0x47f0('0x2')](_0x4f980b));}catch(_0x44b6ad){_0x33c013(_0x44b6ad);}}function _0x23bd5b(_0x1a6d14){_0x1a6d14[a72_0x47f0('0x3')]?_0x4ba990(_0x1a6d14['value']):_0x65167(_0x1a6d14[a72_0x47f0('0x4')])[a72_0x47f0('0x5')](_0x5e04fa,_0x76e9b6);}_0x23bd5b((_0x414eb0=_0x414eb0[a72_0x47f0('0x6')](_0x5b4a18,_0x2c3376||[]))[a72_0x47f0('0x1')]());});};var __importDefault=this&&this['__importDefault']||function(_0x541fd2){return _0x541fd2&&_0x541fd2[a72_0x47f0('0x7')]?_0x541fd2:{'default':_0x541fd2};};Object[a72_0x47f0('0x8')](exports,a72_0x47f0('0x7'),{'value':!![]});const base_controller_1=__importDefault(require('../../infrastructure/base-controller'));const uuid_1=require(a72_0x47f0('0x9'));const jwt=require('jsonwebtoken');const i18n=require(a72_0x47f0('0xa'));const authUtils=require(a72_0x47f0('0xb'));const responseUtils=require('../../infrastructure/response-utils');const LocaleStrings=require(a72_0x47f0('0xc'));const format=require(a72_0x47f0('0xd'));const formidable=require(a72_0x47f0('0xe'));const fsExtra=require(a72_0x47f0('0xf'));class FilesController extends base_controller_1[a72_0x47f0('0x10')]{constructor(_0x339bdd){super(_0x339bdd,null);this[a72_0x47f0('0x11')]=this[a72_0x47f0('0x11')][a72_0x47f0('0x12')](this);}['saveFile'](_0x341cde,_0x14de50,_0x67503e){return __awaiter(this,void 0x0,void 0x0,function*(){console[a72_0x47f0('0x13')]('saveFile');if(!_0x341cde[a72_0x47f0('0x14')]){return responseUtils['errorResponse'](_0x341cde,_0x14de50,'authentication\x20failed',0x191);}const _0x2b7cd3=formidable({'multiples':!![]});const _0x15a4e5=uuid_1['v4']();return yield new Promise(function(_0x47316e,_0x25e488){_0x2b7cd3[a72_0x47f0('0x15')](_0x341cde,(_0x1b18c9,_0x1d15e1,_0x1060cb)=>{const _0x19bab9=_0x1060cb[a72_0x47f0('0x16')];console[a72_0x47f0('0x13')]('files',_0x1060cb);if(_0x19bab9==null){if(_0x14de50){return responseUtils[a72_0x47f0('0x17')](_0x341cde,_0x14de50,null,0x190);}else{_0x25e488(null);return;}}const _0x5cc7e2=_0x19bab9[a72_0x47f0('0x18')];const _0x19ce42=process[a72_0x47f0('0x19')][a72_0x47f0('0x1a')]+a72_0x47f0('0x1b');fsExtra[a72_0x47f0('0x1c')](_0x19ce42);const _0x2ff17b=_0x19ce42+_0x15a4e5;fsExtra[a72_0x47f0('0x1d')](_0x5cc7e2,_0x2ff17b);_0x341cde[a72_0x47f0('0x1e')]={'size':_0x19bab9[a72_0x47f0('0x1f')],'stored_name':_0x15a4e5,'name':_0x19bab9[a72_0x47f0('0x20')],'type':_0x19bab9[a72_0x47f0('0x21')],'is_private':_0x1d15e1[a72_0x47f0('0x22')]!=null?_0x1d15e1[a72_0x47f0('0x22')]:!![]};console[a72_0x47f0('0x13')](a72_0x47f0('0x23'),_0x341cde[a72_0x47f0('0x1e')]);return this[a72_0x47f0('0x24')](_0x341cde,null,_0x67503e)[a72_0x47f0('0x5')](_0x4a248e=>{if(_0x14de50){return responseUtils[a72_0x47f0('0x25')](_0x341cde,_0x14de50,_0x4a248e,0xc8);}else{_0x47316e({'data':_0x4a248e[a72_0x47f0('0x26')],'fields':_0x1d15e1});}})[a72_0x47f0('0x27')](_0x1b18c9=>{if(_0x14de50){return responseUtils['errorResponse'](_0x341cde,_0x14de50,_0x1b18c9['stack'],0x1f4);}else{_0x25e488(_0x1b18c9);}});});}[a72_0x47f0('0x12')](this));});}}exports[a72_0x47f0('0x10')]=FilesController;
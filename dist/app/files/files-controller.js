var a72_0x2bba=['formidable','fs-extra','default','saveFile','bind','user','upload_file','log','files','errorResponse','path','env','FILES_FOLDER','files/','ensureDirSync','renameSync','body','name','is_private','files\x20req.body','save','then','successResponse','dataValues','stack','__awaiter','next','throw','value','apply','__importDefault','__esModule','defineProperty','uuid','jsonwebtoken','../../infrastructure/response-utils','../../resources/locale-strings','string-format'];(function(_0x12ca53,_0x183f62){var _0x4e0ba0=function(_0x1baa31){while(--_0x1baa31){_0x12ca53['push'](_0x12ca53['shift']());}};_0x4e0ba0(++_0x183f62);}(a72_0x2bba,0x123));var a72_0x344b=function(_0x32d5d9,_0x383ccc){_0x32d5d9=_0x32d5d9-0x0;var _0x51ecf5=a72_0x2bba[_0x32d5d9];return _0x51ecf5;};'use strict';var __awaiter=this&&this[a72_0x344b('0x0')]||function(_0x2c05c2,_0x5ea1a0,_0x2ffb3a,_0x19a5b6){function _0x53047f(_0x5dde09){return _0x5dde09 instanceof _0x2ffb3a?_0x5dde09:new _0x2ffb3a(function(_0x560c3d){_0x560c3d(_0x5dde09);});}return new(_0x2ffb3a||(_0x2ffb3a=Promise))(function(_0x488373,_0x5a540d){function _0x4d28f5(_0x5782d8){try{_0x3ec401(_0x19a5b6[a72_0x344b('0x1')](_0x5782d8));}catch(_0x5f0e24){_0x5a540d(_0x5f0e24);}}function _0x159821(_0x4fdfbf){try{_0x3ec401(_0x19a5b6[a72_0x344b('0x2')](_0x4fdfbf));}catch(_0x1c70a9){_0x5a540d(_0x1c70a9);}}function _0x3ec401(_0x3717e2){_0x3717e2['done']?_0x488373(_0x3717e2[a72_0x344b('0x3')]):_0x53047f(_0x3717e2[a72_0x344b('0x3')])['then'](_0x4d28f5,_0x159821);}_0x3ec401((_0x19a5b6=_0x19a5b6[a72_0x344b('0x4')](_0x2c05c2,_0x5ea1a0||[]))[a72_0x344b('0x1')]());});};var __importDefault=this&&this[a72_0x344b('0x5')]||function(_0x5c400f){return _0x5c400f&&_0x5c400f[a72_0x344b('0x6')]?_0x5c400f:{'default':_0x5c400f};};Object[a72_0x344b('0x7')](exports,a72_0x344b('0x6'),{'value':!![]});const base_controller_1=__importDefault(require('../../infrastructure/base-controller'));const uuid_1=require(a72_0x344b('0x8'));const jwt=require(a72_0x344b('0x9'));const i18n=require('i18n');const authUtils=require('../../infrastructure/auth-utils');const responseUtils=require(a72_0x344b('0xa'));const LocaleStrings=require(a72_0x344b('0xb'));const format=require(a72_0x344b('0xc'));const formidable=require(a72_0x344b('0xd'));const fsExtra=require(a72_0x344b('0xe'));class FilesController extends base_controller_1[a72_0x344b('0xf')]{constructor(_0x28790b){super(_0x28790b,null);this[a72_0x344b('0x10')]=this[a72_0x344b('0x10')][a72_0x344b('0x11')](this);}['saveFile'](_0x15d4be,_0x40d1f8,_0x51f711){return __awaiter(this,void 0x0,void 0x0,function*(){console['log'](a72_0x344b('0x10'));if(!_0x15d4be[a72_0x344b('0x12')]){return responseUtils['errorResponse'](_0x15d4be,_0x40d1f8,'authentication\x20failed',0x191);}const _0x5c5a7e=formidable({'multiples':!![]});const _0x4fa914=uuid_1['v4']();return yield new Promise(function(_0x25f83e,_0x1d3d3a){_0x5c5a7e['parse'](_0x15d4be,(_0xec729f,_0x53b866,_0x12d611)=>{const _0x2dbf94=_0x12d611[a72_0x344b('0x13')];console[a72_0x344b('0x14')](a72_0x344b('0x15'),_0x12d611);if(_0x2dbf94==null){if(_0x40d1f8){return responseUtils[a72_0x344b('0x16')](_0x15d4be,_0x40d1f8,null,0x190);}else{_0x1d3d3a(null);return;}}try{const _0x179660=_0x2dbf94[a72_0x344b('0x17')];const _0x333706=process[a72_0x344b('0x18')][a72_0x344b('0x19')]+a72_0x344b('0x1a');fsExtra[a72_0x344b('0x1b')](_0x333706);const _0x5045cb=_0x333706+_0x4fa914;fsExtra[a72_0x344b('0x1c')](_0x179660,_0x5045cb);_0x15d4be[a72_0x344b('0x1d')]={'size':_0x2dbf94['size'],'stored_name':_0x4fa914,'name':_0x2dbf94[a72_0x344b('0x1e')],'type':_0x2dbf94['type'],'is_private':_0x53b866[a72_0x344b('0x1f')]!=null?_0x53b866[a72_0x344b('0x1f')]:!![]};console[a72_0x344b('0x14')](a72_0x344b('0x20'),_0x15d4be[a72_0x344b('0x1d')]);return this[a72_0x344b('0x21')](_0x15d4be,null,_0x51f711)[a72_0x344b('0x22')](_0x5642b5=>{if(_0x40d1f8){return responseUtils[a72_0x344b('0x23')](_0x15d4be,_0x40d1f8,_0x5642b5,0xc8);}else{_0x25f83e({'data':_0x5642b5[a72_0x344b('0x24')],'fields':_0x53b866});}})['catch'](_0xec729f=>{if(_0x40d1f8){return responseUtils[a72_0x344b('0x16')](_0x15d4be,_0x40d1f8,_0xec729f[a72_0x344b('0x25')],0x1f4);}else{_0x1d3d3a(_0xec729f);}});}catch(_0x31dc9a){if(_0x40d1f8){return responseUtils['errorResponse'](_0x15d4be,_0x40d1f8,_0x31dc9a[a72_0x344b('0x25')],0x1f4);}else{_0x1d3d3a(_0x31dc9a);}}});}[a72_0x344b('0x11')](this));});}}exports[a72_0x344b('0xf')]=FilesController;
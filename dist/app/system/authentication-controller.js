var a208_0x47ce=['toJSON','generateJWT','successResponse','catch','usernameTakenError','last_name','hashPassword','create','stack','__importDefault','__esModule','defineProperty','jsonwebtoken','i18n','../../infrastructure/auth-utils','../../infrastructure/response-utils','string-format','login','bind','createAccount','model','findOne','body','username','first_name','email','password','then','errorResponse','usernameNotFoundError','default','validPassword'];(function(_0x381055,_0x4ee6dc){var _0x2e729a=function(_0x30c611){while(--_0x30c611){_0x381055['push'](_0x381055['shift']());}};_0x2e729a(++_0x4ee6dc);}(a208_0x47ce,0xe9));var a208_0x5038=function(_0x116b19,_0x48363f){_0x116b19=_0x116b19-0x0;var _0x25a50a=a208_0x47ce[_0x116b19];return _0x25a50a;};'use strict';var __importDefault=this&&this[a208_0x5038('0x0')]||function(_0xb2b346){return _0xb2b346&&_0xb2b346[a208_0x5038('0x1')]?_0xb2b346:{'default':_0xb2b346};};Object[a208_0x5038('0x2')](exports,a208_0x5038('0x1'),{'value':!![]});const crypt_utils_1=__importDefault(require('../../infrastructure/crypt-utils'));const jwt=require(a208_0x5038('0x3'));const i18n=require(a208_0x5038('0x4'));const authUtils=require(a208_0x5038('0x5'));const responseUtils=require(a208_0x5038('0x6'));const LocaleStrings=require('../../resources/locale-strings');const format=require(a208_0x5038('0x7'));class AuthenticationController{constructor(_0x1d5b28){this['model']=_0x1d5b28;this[a208_0x5038('0x8')]=this['login'][a208_0x5038('0x9')](this);this['createAccount']=this[a208_0x5038('0xa')]['bind'](this);}['login'](_0xc13e4c,_0x188a78,_0x55b65){this[a208_0x5038('0xb')][a208_0x5038('0xc')]({'where':{'username':_0xc13e4c[a208_0x5038('0xd')][a208_0x5038('0xe')]},'attributes':['id',a208_0x5038('0xf'),'last_name',a208_0x5038('0x10'),a208_0x5038('0xe'),a208_0x5038('0x11')]})[a208_0x5038('0x12')](_0x577ad3=>{if(!_0x577ad3){return responseUtils[a208_0x5038('0x13')](_0xc13e4c,_0x188a78,format(LocaleStrings[a208_0x5038('0x14')],_0xc13e4c[a208_0x5038('0xd')][a208_0x5038('0xe')]),0x193);}if(crypt_utils_1[a208_0x5038('0x15')][a208_0x5038('0x16')](_0xc13e4c['body'][a208_0x5038('0x11')],_0x577ad3['password']==null?'':_0x577ad3[a208_0x5038('0x11')])){_0x577ad3=_0x577ad3[a208_0x5038('0x17')]();const _0x35f942=authUtils[a208_0x5038('0x18')](_0x577ad3);const _0x5bb43b={'token':_0x35f942};return responseUtils[a208_0x5038('0x19')](_0xc13e4c,_0x188a78,_0x5bb43b,0xc8);}else{return responseUtils[a208_0x5038('0x13')](_0xc13e4c,_0x188a78,format(LocaleStrings['passwordNotMatchError']),0x193);}})[a208_0x5038('0x1a')](_0x4de962=>{return responseUtils['errorResponse'](_0xc13e4c,_0x188a78,_0x4de962,0x1f4);});}[a208_0x5038('0xa')](_0x323d90,_0x280f66,_0x75f103){this[a208_0x5038('0xb')][a208_0x5038('0xc')]({'where':{'username':_0x323d90[a208_0x5038('0xd')][a208_0x5038('0xe')]}})[a208_0x5038('0x12')](_0x1592ed=>{if(_0x1592ed){return responseUtils['errorResponse'](_0x323d90,_0x280f66,format(LocaleStrings[a208_0x5038('0x1b')],_0x323d90['body'][a208_0x5038('0xe')]),0x193);}else{const _0x23333a={'first_name':_0x323d90[a208_0x5038('0xd')][a208_0x5038('0xf')],'last_name':_0x323d90[a208_0x5038('0xd')][a208_0x5038('0x1c')],'email':_0x323d90[a208_0x5038('0xd')][a208_0x5038('0x10')],'username':_0x323d90['body'][a208_0x5038('0xe')],'password':crypt_utils_1[a208_0x5038('0x15')][a208_0x5038('0x1d')](_0x323d90['body'][a208_0x5038('0x11')])};this[a208_0x5038('0xb')][a208_0x5038('0x1e')](_0x23333a)['then'](function(_0x423954,_0x2f64ad){const _0x492dc5=authUtils[a208_0x5038('0x18')](_0x1592ed);const _0x1d5be7={'token':_0x492dc5};return responseUtils[a208_0x5038('0x19')](_0x323d90,_0x280f66,_0x1d5be7,0xc8);})[a208_0x5038('0x1a')](_0x250b14=>{return responseUtils[a208_0x5038('0x13')](_0x323d90,_0x280f66,_0x250b14[a208_0x5038('0x1f')],0x1f4);});}})[a208_0x5038('0x1a')](_0x24ef9f=>{return responseUtils[a208_0x5038('0x13')](_0x323d90,_0x280f66,_0x24ef9f[a208_0x5038('0x1f')],0x1f4);});}}exports['default']=AuthenticationController;
var a208_0x2803=['bind','createAccount','findOne','body','username','first_name','password','then','errorResponse','usernameNotFoundError','validPassword','toJSON','generateJWT','successResponse','passwordNotMatchError','last_name','email','default','hashPassword','create','catch','stack','__importDefault','__esModule','defineProperty','jsonwebtoken','../../infrastructure/auth-utils','../../infrastructure/response-utils','../../resources/locale-strings','string-format','model','login'];(function(_0x3bf3e6,_0x1a8cbf){var _0x31cf4c=function(_0x5a204c){while(--_0x5a204c){_0x3bf3e6['push'](_0x3bf3e6['shift']());}};_0x31cf4c(++_0x1a8cbf);}(a208_0x2803,0x156));var a208_0x30c5=function(_0x2ca66e,_0x58d833){_0x2ca66e=_0x2ca66e-0x0;var _0x395ebf=a208_0x2803[_0x2ca66e];return _0x395ebf;};'use strict';var __importDefault=this&&this[a208_0x30c5('0x0')]||function(_0x2f50c1){return _0x2f50c1&&_0x2f50c1[a208_0x30c5('0x1')]?_0x2f50c1:{'default':_0x2f50c1};};Object[a208_0x30c5('0x2')](exports,a208_0x30c5('0x1'),{'value':!![]});const crypt_utils_1=__importDefault(require('../../infrastructure/crypt-utils'));const jwt=require(a208_0x30c5('0x3'));const i18n=require('i18n');const authUtils=require(a208_0x30c5('0x4'));const responseUtils=require(a208_0x30c5('0x5'));const LocaleStrings=require(a208_0x30c5('0x6'));const format=require(a208_0x30c5('0x7'));class AuthenticationController{constructor(_0x1f9389){this[a208_0x30c5('0x8')]=_0x1f9389;this[a208_0x30c5('0x9')]=this[a208_0x30c5('0x9')][a208_0x30c5('0xa')](this);this[a208_0x30c5('0xb')]=this['createAccount'][a208_0x30c5('0xa')](this);}[a208_0x30c5('0x9')](_0x3ed74d,_0x3aaee1,_0x5985d3){this[a208_0x30c5('0x8')][a208_0x30c5('0xc')]({'where':{'username':_0x3ed74d[a208_0x30c5('0xd')][a208_0x30c5('0xe')]},'attributes':['id',a208_0x30c5('0xf'),'last_name','email',a208_0x30c5('0xe'),a208_0x30c5('0x10')]})[a208_0x30c5('0x11')](_0x11a181=>{if(!_0x11a181){return responseUtils[a208_0x30c5('0x12')](_0x3ed74d,_0x3aaee1,format(LocaleStrings[a208_0x30c5('0x13')],_0x3ed74d[a208_0x30c5('0xd')][a208_0x30c5('0xe')]),0x193);}if(crypt_utils_1['default'][a208_0x30c5('0x14')](_0x3ed74d[a208_0x30c5('0xd')][a208_0x30c5('0x10')],_0x11a181['password']==null?'':_0x11a181[a208_0x30c5('0x10')])){_0x11a181=_0x11a181[a208_0x30c5('0x15')]();const _0x594444=authUtils[a208_0x30c5('0x16')](_0x11a181);const _0x3413a6={'token':_0x594444};return responseUtils[a208_0x30c5('0x17')](_0x3ed74d,_0x3aaee1,_0x3413a6,0xc8);}else{return responseUtils[a208_0x30c5('0x12')](_0x3ed74d,_0x3aaee1,format(LocaleStrings[a208_0x30c5('0x18')]),0x193);}})['catch'](_0x238ab5=>{return responseUtils[a208_0x30c5('0x12')](_0x3ed74d,_0x3aaee1,_0x238ab5,0x1f4);});}['createAccount'](_0x56765f,_0x5db639,_0x53be18){this[a208_0x30c5('0x8')][a208_0x30c5('0xc')]({'where':{'username':_0x56765f[a208_0x30c5('0xd')][a208_0x30c5('0xe')]}})[a208_0x30c5('0x11')](_0x361073=>{if(_0x361073){return responseUtils[a208_0x30c5('0x12')](_0x56765f,_0x5db639,format(LocaleStrings['usernameTakenError'],_0x56765f['body']['username']),0x193);}else{const _0x34db9b={'first_name':_0x56765f[a208_0x30c5('0xd')]['first_name'],'last_name':_0x56765f[a208_0x30c5('0xd')][a208_0x30c5('0x19')],'email':_0x56765f[a208_0x30c5('0xd')][a208_0x30c5('0x1a')],'username':_0x56765f[a208_0x30c5('0xd')][a208_0x30c5('0xe')],'password':crypt_utils_1[a208_0x30c5('0x1b')][a208_0x30c5('0x1c')](_0x56765f[a208_0x30c5('0xd')]['password'])};this[a208_0x30c5('0x8')][a208_0x30c5('0x1d')](_0x34db9b)[a208_0x30c5('0x11')](function(_0x31463c,_0x13e21b){const _0x3081d3=authUtils[a208_0x30c5('0x16')](_0x361073);const _0x555c01={'token':_0x3081d3};return responseUtils['successResponse'](_0x56765f,_0x5db639,_0x555c01,0xc8);})[a208_0x30c5('0x1e')](_0x1b20e0=>{return responseUtils[a208_0x30c5('0x12')](_0x56765f,_0x5db639,_0x1b20e0[a208_0x30c5('0x1f')],0x1f4);});}})[a208_0x30c5('0x1e')](_0x201b41=>{return responseUtils[a208_0x30c5('0x12')](_0x56765f,_0x5db639,_0x201b41[a208_0x30c5('0x1f')],0x1f4);});}}exports[a208_0x30c5('0x1b')]=AuthenticationController;
var a118_0x5431=['__importDefault','__esModule','defineProperty','../../infrastructure/controller-utils','../../infrastructure/response-utils','default','devicesController','playersController','register','bind','reportStatus','getStatus','updateOrCreate','body','device_uuid','then','player_id','playlist','json','playing_item','status','find','params','models','playerDevicesModel','log'];(function(_0x1fe9a8,_0x68d6c5){var _0x967dca=function(_0x12d170){while(--_0x12d170){_0x1fe9a8['push'](_0x1fe9a8['shift']());}};_0x967dca(++_0x68d6c5);}(a118_0x5431,0x138));var a118_0x11b0=function(_0x478c3e,_0x28916b){_0x478c3e=_0x478c3e-0x0;var _0x3a156b=a118_0x5431[_0x478c3e];return _0x3a156b;};'use strict';var __importDefault=this&&this[a118_0x11b0('0x0')]||function(_0x342d3c){return _0x342d3c&&_0x342d3c[a118_0x11b0('0x1')]?_0x342d3c:{'default':_0x342d3c};};Object[a118_0x11b0('0x2')](exports,a118_0x11b0('0x1'),{'value':!![]});const controller_utils_1=__importDefault(require(a118_0x11b0('0x3')));const sequelize_utils_1=__importDefault(require('../../infrastructure/sequelize-utils'));const responseUtils=require(a118_0x11b0('0x4'));class PlayerDevicesController extends controller_utils_1[a118_0x11b0('0x5')]{constructor(_0x705fe2,_0x700b2c,_0x22e049){super(_0x705fe2,null);this[a118_0x11b0('0x6')]=_0x700b2c;this[a118_0x11b0('0x7')]=_0x22e049;this['register']=this[a118_0x11b0('0x8')][a118_0x11b0('0x9')](this);this[a118_0x11b0('0xa')]=this[a118_0x11b0('0xa')]['bind'](this);this[a118_0x11b0('0xb')]=this[a118_0x11b0('0xb')][a118_0x11b0('0x9')](this);}[a118_0x11b0('0x8')](_0x1ff108,_0x2409e5,_0x33604a){return this['devicesController'][a118_0x11b0('0xc')]({'params':{'uuid':_0x1ff108[a118_0x11b0('0xd')][a118_0x11b0('0xe')]},'body':{'uuid':_0x1ff108[a118_0x11b0('0xd')]['device_uuid'],'network_info':_0x1ff108[a118_0x11b0('0xd')]['network_info'],'firmware_info':_0x1ff108[a118_0x11b0('0xd')]['firmware_info']}},null,_0x33604a,!![])[a118_0x11b0('0xf')](_0x21c42f=>{return this['updateOrCreate']({'params':{'device_id':_0x21c42f['id'],'player_id':_0x1ff108['body'][a118_0x11b0('0x10')]},'body':{'device_id':_0x21c42f['id'],'player_id':_0x1ff108[a118_0x11b0('0xd')]['player_id'],'status':_0x1ff108[a118_0x11b0('0xd')]['status'],'playlist':_0x1ff108[a118_0x11b0('0xd')][a118_0x11b0('0x11')],'reported_at':new Date()}},null,_0x33604a)[a118_0x11b0('0xf')](_0x5aaf2b=>{delete _0x21c42f['id'];return _0x2409e5[a118_0x11b0('0x12')]({'success':!![],'data':_0x21c42f});});});}['reportStatus'](_0xdd42cd,_0x35b642,_0x2214b6){return this[a118_0x11b0('0x6')][a118_0x11b0('0xc')]({'params':{'uuid':_0xdd42cd[a118_0x11b0('0xd')][a118_0x11b0('0xe')]},'body':{'uuid':_0xdd42cd['body']['device_uuid']}},null,_0x2214b6,!![])[a118_0x11b0('0xf')](_0x56d008=>{return this[a118_0x11b0('0xc')]({'params':{'device_id':_0x56d008['id'],'player_id':_0xdd42cd[a118_0x11b0('0xd')][a118_0x11b0('0x10')]},'body':{'device_id':_0x56d008['id'],'player_id':_0xdd42cd[a118_0x11b0('0xd')][a118_0x11b0('0x10')],'playing_item':_0xdd42cd['body'][a118_0x11b0('0x13')],'status':_0xdd42cd[a118_0x11b0('0xd')][a118_0x11b0('0x14')],'reported_at':new Date()}},null,_0x2214b6)[a118_0x11b0('0xf')](_0x5c4417=>{delete _0x56d008['id'];return _0x35b642[a118_0x11b0('0x12')]({'success':!![],'data':_0x5c4417});});});}[a118_0x11b0('0xb')](_0x399f99,_0x36cf4e,_0x21e12c){return this['playersController'][a118_0x11b0('0x15')]({'params':{'$user.uuid$':_0x399f99[a118_0x11b0('0x16')]['user_uuid']}},null,_0x21e12c,!![],[sequelize_utils_1['default'][a118_0x11b0('0x17')]['usersModel'],sequelize_utils_1[a118_0x11b0('0x5')][a118_0x11b0('0x17')][a118_0x11b0('0x18')]])[a118_0x11b0('0xf')](_0x438d6c=>{console[a118_0x11b0('0x19')](_0x438d6c);return _0x36cf4e['json']({'success':!![],'data':_0x438d6c});});}}exports[a118_0x11b0('0x5')]=PlayerDevicesController;
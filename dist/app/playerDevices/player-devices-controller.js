var a57_0xfd96=['register','bind','reportStatus','getStatus','body','device_uuid','network_info','then','updateOrCreate','player_id','playlist','json','playing_item','find','params','models','playerDevicesModel','log','__esModule','defineProperty','../../infrastructure/sequelize-utils','default','devicesController','playersController'];(function(_0x1cab71,_0x3be68e){var _0x1a67c8=function(_0x433b05){while(--_0x433b05){_0x1cab71['push'](_0x1cab71['shift']());}};_0x1a67c8(++_0x3be68e);}(a57_0xfd96,0x17a));var a57_0x4593=function(_0xb67384,_0x27295a){_0xb67384=_0xb67384-0x0;var _0x156d7c=a57_0xfd96[_0xb67384];return _0x156d7c;};'use strict';var __importDefault=this&&this['__importDefault']||function(_0x3506c0){return _0x3506c0&&_0x3506c0[a57_0x4593('0x0')]?_0x3506c0:{'default':_0x3506c0};};Object[a57_0x4593('0x1')](exports,a57_0x4593('0x0'),{'value':!![]});const controller_utils_1=__importDefault(require('../../infrastructure/controller-utils'));const sequelize_utils_1=__importDefault(require(a57_0x4593('0x2')));const responseUtils=require('../../infrastructure/response-utils');class PlayerDevicesController extends controller_utils_1[a57_0x4593('0x3')]{constructor(_0x3b77e6,_0x3bbe0e,_0x2c77f3){super(_0x3b77e6,null);this[a57_0x4593('0x4')]=_0x3bbe0e;this[a57_0x4593('0x5')]=_0x2c77f3;this[a57_0x4593('0x6')]=this[a57_0x4593('0x6')][a57_0x4593('0x7')](this);this[a57_0x4593('0x8')]=this[a57_0x4593('0x8')][a57_0x4593('0x7')](this);this[a57_0x4593('0x9')]=this['getStatus']['bind'](this);}[a57_0x4593('0x6')](_0xa76859,_0x294745,_0x87f3e3){return this[a57_0x4593('0x4')]['updateOrCreate']({'params':{'uuid':_0xa76859[a57_0x4593('0xa')][a57_0x4593('0xb')]},'body':{'uuid':_0xa76859[a57_0x4593('0xa')][a57_0x4593('0xb')],'network_info':_0xa76859['body'][a57_0x4593('0xc')],'firmware_info':_0xa76859[a57_0x4593('0xa')]['firmware_info']}},null,_0x87f3e3,!![])[a57_0x4593('0xd')](_0x5dedfc=>{return this[a57_0x4593('0xe')]({'params':{'device_id':_0x5dedfc['id'],'player_id':_0xa76859[a57_0x4593('0xa')][a57_0x4593('0xf')]},'body':{'device_id':_0x5dedfc['id'],'player_id':_0xa76859['body'][a57_0x4593('0xf')],'status':_0xa76859['body']['status'],'playlist':_0xa76859[a57_0x4593('0xa')][a57_0x4593('0x10')],'reported_at':new Date()}},null,_0x87f3e3)[a57_0x4593('0xd')](_0x406e7f=>{delete _0x5dedfc['id'];return _0x294745[a57_0x4593('0x11')]({'success':!![],'data':_0x5dedfc});});});}[a57_0x4593('0x8')](_0x5c32d0,_0x3c23b3,_0x1fd636){return this['devicesController'][a57_0x4593('0xe')]({'params':{'uuid':_0x5c32d0[a57_0x4593('0xa')][a57_0x4593('0xb')]},'body':{'uuid':_0x5c32d0[a57_0x4593('0xa')][a57_0x4593('0xb')]}},null,_0x1fd636,!![])['then'](_0xe3c42f=>{return this[a57_0x4593('0xe')]({'params':{'device_id':_0xe3c42f['id'],'player_id':_0x5c32d0['body'][a57_0x4593('0xf')]},'body':{'device_id':_0xe3c42f['id'],'player_id':_0x5c32d0['body'][a57_0x4593('0xf')],'playing_item':_0x5c32d0[a57_0x4593('0xa')][a57_0x4593('0x12')],'status':_0x5c32d0[a57_0x4593('0xa')]['status'],'reported_at':new Date()}},null,_0x1fd636)[a57_0x4593('0xd')](_0x1e16dd=>{delete _0xe3c42f['id'];return _0x3c23b3[a57_0x4593('0x11')]({'success':!![],'data':_0x1e16dd});});});}[a57_0x4593('0x9')](_0x5333b7,_0x95bf1b,_0x4f7d9e){return this[a57_0x4593('0x5')][a57_0x4593('0x13')]({'params':{'$user.uuid$':_0x5333b7[a57_0x4593('0x14')]['user_uuid']}},null,_0x4f7d9e,!![],[sequelize_utils_1[a57_0x4593('0x3')][a57_0x4593('0x15')]['usersModel'],sequelize_utils_1[a57_0x4593('0x3')][a57_0x4593('0x15')][a57_0x4593('0x16')]])['then'](_0x2e5d78=>{console[a57_0x4593('0x17')](_0x2e5d78);return _0x95bf1b[a57_0x4593('0x11')]({'success':!![],'data':_0x2e5d78});});}}exports[a57_0x4593('0x3')]=PlayerDevicesController;
var a110_0x3748=['port','log','start','net','createServer','TCP\x20Server\x20is\x20running\x20on\x20port\x20','vehiclesCount/','ensureDir','connection','remoteAddress','remotePort','******result:\x20','ST910','alarm','alarmsController','reportAlarm','then','alarm:\x20','close','findIndex','splice','LPR','substr','indexOf','parse','controllers','vehiclesCountController','dataValues','infoplate','img','writeFile','uuid','fullData:\x20','__importDefault','__esModule','defineProperty','./app','./infrastructure/sequelize-utils','./tasks/fileOptimizationTask','default','use','env','EXPRESS_SERVICE_ENABLED','true','FILE_OPTIMIZATION_SERVICE_ENABLED','SOCKET_SERVICE_ENABLED','listen','get'];(function(_0x2ac73b,_0x295830){var _0x334432=function(_0x3f24a1){while(--_0x3f24a1){_0x2ac73b['push'](_0x2ac73b['shift']());}};_0x334432(++_0x295830);}(a110_0x3748,0x141));var a110_0x45a9=function(_0x249a53,_0xfc206f){_0x249a53=_0x249a53-0x0;var _0x51ee35=a110_0x3748[_0x249a53];return _0x51ee35;};'use strict';var __importDefault=this&&this[a110_0x45a9('0x0')]||function(_0x27c0e3){return _0x27c0e3&&_0x27c0e3[a110_0x45a9('0x1')]?_0x27c0e3:{'default':_0x27c0e3};};Object[a110_0x45a9('0x2')](exports,a110_0x45a9('0x1'),{'value':!![]});const errorhandler_1=__importDefault(require('errorhandler'));const app_1=__importDefault(require(a110_0x45a9('0x3')));const sequelize_utils_1=__importDefault(require(a110_0x45a9('0x4')));const fileOptimizationTask_1=__importDefault(require(a110_0x45a9('0x5')));const fsExtra=require('fs-extra');app_1[a110_0x45a9('0x6')][a110_0x45a9('0x7')](errorhandler_1[a110_0x45a9('0x6')]());const expressServiceEnabled=process[a110_0x45a9('0x8')][a110_0x45a9('0x9')]==a110_0x45a9('0xa');const fileOptimizationEnabled=process[a110_0x45a9('0x8')][a110_0x45a9('0xb')]==a110_0x45a9('0xa');const socketServiceEnabled=process[a110_0x45a9('0x8')][a110_0x45a9('0xc')]=='true';if(expressServiceEnabled){const server=app_1[a110_0x45a9('0x6')][a110_0x45a9('0xd')](app_1[a110_0x45a9('0x6')][a110_0x45a9('0xe')](a110_0x45a9('0xf')),()=>{console['log']('\x20\x20App\x20is\x20running\x20at\x20http://localhost:%d\x20in\x20%s\x20mode',app_1['default'][a110_0x45a9('0xe')](a110_0x45a9('0xf')),app_1[a110_0x45a9('0x6')][a110_0x45a9('0xe')](a110_0x45a9('0x8')));console[a110_0x45a9('0x10')]('\x20\x20Press\x20CTRL-C\x20to\x20stop\x0a');});}if(fileOptimizationEnabled){const fileOptimizationTask=new fileOptimizationTask_1[(a110_0x45a9('0x6'))]();fileOptimizationTask[a110_0x45a9('0x11')]();}if(socketServiceEnabled){const net=require(a110_0x45a9('0x12'));const port=0x46;const host='0.0.0.0';const fs=require('fs');const socketServer=net[a110_0x45a9('0x13')]();socketServer[a110_0x45a9('0xd')](port,host,()=>{console['log'](a110_0x45a9('0x14')+port+'.');});const imageFolder=process[a110_0x45a9('0x8')]['IMAGE_FILES_FOLDER']+a110_0x45a9('0x15');fsExtra[a110_0x45a9('0x16')](imageFolder,_0x17dc92=>{console[a110_0x45a9('0x10')](_0x17dc92);});const sockets=[];socketServer['on'](a110_0x45a9('0x17'),function(_0x48e879){console[a110_0x45a9('0x10')]('CONNECTED:\x20'+_0x48e879[a110_0x45a9('0x18')]+':'+_0x48e879[a110_0x45a9('0x19')]);let _0x38ccf0='';_0x48e879['on']('data',function(_0x4189e3){const _0x19ce19=String(_0x4189e3);console['log'](a110_0x45a9('0x1a'));console['log'](_0x19ce19);_0x38ccf0+=_0x19ce19;if(_0x19ce19['startsWith'](a110_0x45a9('0x1b'))){console['log'](a110_0x45a9('0x1c'));const _0x1e5176={};sequelize_utils_1[a110_0x45a9('0x6')]['controllers'][a110_0x45a9('0x1d')][a110_0x45a9('0x1e')]({'body':{'data':''}},null,null)[a110_0x45a9('0x1f')](_0x5829d0=>{console[a110_0x45a9('0x10')](a110_0x45a9('0x20'));console[a110_0x45a9('0x10')](_0x5829d0);});}});_0x48e879['on'](a110_0x45a9('0x21'),function(_0x15e486){const _0x3dec05=sockets[a110_0x45a9('0x22')](function(_0x2205fa){return _0x2205fa[a110_0x45a9('0x18')]===_0x48e879['remoteAddress']&&_0x2205fa[a110_0x45a9('0x19')]===_0x48e879[a110_0x45a9('0x19')];});if(_0x3dec05!==-0x1)sockets[a110_0x45a9('0x23')](_0x3dec05,0x1);if(_0x38ccf0['startsWith']('ST910')){}else{console['log'](a110_0x45a9('0x24'));_0x38ccf0=_0x38ccf0[a110_0x45a9('0x25')](_0x38ccf0[a110_0x45a9('0x26')]('{'));let _0xfbaf3f={};try{_0xfbaf3f=JSON[a110_0x45a9('0x27')](_0x38ccf0);}catch(_0x5e5953){console[a110_0x45a9('0x10')](_0x5e5953);}if(_0xfbaf3f['infoplate']!=null&&_0xfbaf3f['infoplate']!=''){sequelize_utils_1[a110_0x45a9('0x6')][a110_0x45a9('0x28')][a110_0x45a9('0x29')]['report']({'body':_0xfbaf3f},null,null)[a110_0x45a9('0x1f')](_0x4db91b=>{console[a110_0x45a9('0x10')](_0x4db91b[a110_0x45a9('0x2a')]);if(_0xfbaf3f[a110_0x45a9('0x2b')][a110_0x45a9('0x2c')]!=null&&_0xfbaf3f[a110_0x45a9('0x2b')][a110_0x45a9('0x2c')]!='')fsExtra[a110_0x45a9('0x2d')](imageFolder+_0x4db91b[a110_0x45a9('0x2a')][a110_0x45a9('0x2e')]+'.png',_0xfbaf3f['infoplate'][a110_0x45a9('0x2c')],'base64',function(_0x43b753){console[a110_0x45a9('0x10')](_0x43b753);});});}}console[a110_0x45a9('0x10')](a110_0x45a9('0x2f')+_0x38ccf0);console[a110_0x45a9('0x10')]('CLOSED:\x20'+_0x48e879[a110_0x45a9('0x18')]+'\x20'+_0x48e879[a110_0x45a9('0x19')]);});});}exports['default']=null;
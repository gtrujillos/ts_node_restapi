var a110_0x44e3=['TCP\x20Server\x20is\x20running\x20on\x20port\x20','IMAGE_FILES_FOLDER','vehiclesCount/','connection','CONNECTED:\x20','remoteAddress','remotePort','data','******result:\x20','close','splice','startsWith','ST910','alarm','controllers','alarmsController','then','alarm:\x20','LPR','indexOf','infoplate','vehiclesCountController','dataValues','img','writeFile','uuid','base64','fullData:\x20','CLOSED:\x20','__importDefault','__esModule','defineProperty','errorhandler','./app','./infrastructure/sequelize-utils','default','use','env','EXPRESS_SERVICE_ENABLED','true','FILE_OPTIMIZATION_SERVICE_ENABLED','listen','get','port','\x20\x20App\x20is\x20running\x20at\x20http://localhost:%d\x20in\x20%s\x20mode','log','net','0.0.0.0'];(function(_0x1487b4,_0x586865){var _0x1c9cb7=function(_0x491765){while(--_0x491765){_0x1487b4['push'](_0x1487b4['shift']());}};_0x1c9cb7(++_0x586865);}(a110_0x44e3,0xdd));var a110_0x3a23=function(_0x28948e,_0x10f819){_0x28948e=_0x28948e-0x0;var _0x5c0a5a=a110_0x44e3[_0x28948e];return _0x5c0a5a;};'use strict';var __importDefault=this&&this[a110_0x3a23('0x0')]||function(_0x205e10){return _0x205e10&&_0x205e10[a110_0x3a23('0x1')]?_0x205e10:{'default':_0x205e10};};Object[a110_0x3a23('0x2')](exports,a110_0x3a23('0x1'),{'value':!![]});const errorhandler_1=__importDefault(require(a110_0x3a23('0x3')));const app_1=__importDefault(require(a110_0x3a23('0x4')));const sequelize_utils_1=__importDefault(require(a110_0x3a23('0x5')));const fileOptimizationDemon_1=__importDefault(require('./tasks/fileOptimizationDemon'));const fsExtra=require('fs-extra');app_1[a110_0x3a23('0x6')][a110_0x3a23('0x7')](errorhandler_1[a110_0x3a23('0x6')]());const expressServiceEnabled=process[a110_0x3a23('0x8')][a110_0x3a23('0x9')]==a110_0x3a23('0xa');const fileOptimizationEnabled=process[a110_0x3a23('0x8')][a110_0x3a23('0xb')]==a110_0x3a23('0xa');const socketServiceEnabled=process['env']['SOCKET_SERVICE_ENABLED']=='true';if(expressServiceEnabled){const server=app_1[a110_0x3a23('0x6')][a110_0x3a23('0xc')](app_1['default'][a110_0x3a23('0xd')](a110_0x3a23('0xe')),()=>{console['log'](a110_0x3a23('0xf'),app_1['default'][a110_0x3a23('0xd')](a110_0x3a23('0xe')),app_1['default']['get'](a110_0x3a23('0x8')));console[a110_0x3a23('0x10')]('\x20\x20Press\x20CTRL-C\x20to\x20stop\x0a');});}if(fileOptimizationEnabled){const fileOptimizationTask=new fileOptimizationDemon_1[(a110_0x3a23('0x6'))]();fileOptimizationTask['start']();}if(socketServiceEnabled){const net=require(a110_0x3a23('0x11'));const port=0x46;const host=a110_0x3a23('0x12');const fs=require('fs');const socketServer=net['createServer']();socketServer[a110_0x3a23('0xc')](port,host,()=>{console[a110_0x3a23('0x10')](a110_0x3a23('0x13')+port+'.');});const imageFolder=process['env'][a110_0x3a23('0x14')]+a110_0x3a23('0x15');fsExtra['ensureDir'](imageFolder,_0x40d0ff=>{console[a110_0x3a23('0x10')](_0x40d0ff);});const sockets=[];socketServer['on'](a110_0x3a23('0x16'),function(_0x53b3d2){console['log'](a110_0x3a23('0x17')+_0x53b3d2[a110_0x3a23('0x18')]+':'+_0x53b3d2[a110_0x3a23('0x19')]);let _0x375d01='';_0x53b3d2['on'](a110_0x3a23('0x1a'),function(_0x5d50ff){const _0x1be346=String(_0x5d50ff);console['log'](a110_0x3a23('0x1b'));console['log'](_0x1be346);_0x375d01+=_0x1be346;});_0x53b3d2['on'](a110_0x3a23('0x1c'),function(_0x1b0ed0){const _0x5ab936=sockets['findIndex'](function(_0x4ce205){return _0x4ce205[a110_0x3a23('0x18')]===_0x53b3d2['remoteAddress']&&_0x4ce205[a110_0x3a23('0x19')]===_0x53b3d2['remotePort'];});if(_0x5ab936!==-0x1)sockets[a110_0x3a23('0x1d')](_0x5ab936,0x1);if(_0x375d01[a110_0x3a23('0x1e')](a110_0x3a23('0x1f'))){console[a110_0x3a23('0x10')](a110_0x3a23('0x20'));const _0x1e9b24={};sequelize_utils_1['default'][a110_0x3a23('0x21')][a110_0x3a23('0x22')]['reportAlarm']({'body':{'data':''}},null,null)[a110_0x3a23('0x23')](_0x19ec51=>{console[a110_0x3a23('0x10')](a110_0x3a23('0x24'));console[a110_0x3a23('0x10')](_0x19ec51);});}else{console['log'](a110_0x3a23('0x25'));_0x375d01=_0x375d01['substr'](_0x375d01[a110_0x3a23('0x26')]('{'));let _0x44c59d={};try{_0x44c59d=JSON['parse'](_0x375d01);}catch(_0x45dbf5){console[a110_0x3a23('0x10')](_0x45dbf5);}if(_0x44c59d[a110_0x3a23('0x27')]!=null&&_0x44c59d['infoplate']!=''){sequelize_utils_1['default'][a110_0x3a23('0x21')][a110_0x3a23('0x28')]['report']({'body':_0x44c59d},null,null)[a110_0x3a23('0x23')](_0x42e716=>{console[a110_0x3a23('0x10')](_0x42e716[a110_0x3a23('0x29')]);if(_0x44c59d[a110_0x3a23('0x27')][a110_0x3a23('0x2a')]!=null&&_0x44c59d['infoplate'][a110_0x3a23('0x2a')]!='')fsExtra[a110_0x3a23('0x2b')](imageFolder+_0x42e716[a110_0x3a23('0x29')][a110_0x3a23('0x2c')]+'.png',_0x44c59d[a110_0x3a23('0x27')][a110_0x3a23('0x2a')],a110_0x3a23('0x2d'),function(_0x35d35e){console[a110_0x3a23('0x10')](_0x35d35e);});});}}console[a110_0x3a23('0x10')](a110_0x3a23('0x2e')+_0x375d01);console[a110_0x3a23('0x10')](a110_0x3a23('0x2f')+_0x53b3d2['remoteAddress']+'\x20'+_0x53b3d2['remotePort']);});});}exports[a110_0x3a23('0x6')]=null;
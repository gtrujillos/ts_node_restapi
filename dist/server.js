var a221_0x24f3=['alarm','eventsController','reportEvent','then','alarm:\x20','close','findIndex','remoteAddress','splice','ST910','LPR','indexOf','infoplate','controllers','vehiclesCountController','dataValues','img','writeFile','uuid','.png','base64','fullData:\x20','__importDefault','__esModule','defineProperty','./app','fs-extra','default','env','true','FILE_OPTIMIZATION_SERVICE_ENABLED','SOCKET_SERVICE_ENABLED','listen','get','port','log','\x20\x20App\x20is\x20running\x20at\x20http://localhost:%d\x20in\x20%s\x20mode','start','net','0.0.0.0','createServer','TCP\x20Server\x20is\x20running\x20on\x20port\x20','vehiclesCount/','ensureDir','connection','CONNECTED:\x20','remotePort','data','******result:\x20','startsWith'];(function(_0x560b68,_0x551ce1){var _0x2a70c5=function(_0x15477c){while(--_0x15477c){_0x560b68['push'](_0x560b68['shift']());}};_0x2a70c5(++_0x551ce1);}(a221_0x24f3,0x1a6));var a221_0x3ecb=function(_0x28da2f,_0x5db785){_0x28da2f=_0x28da2f-0x0;var _0x5bf7b4=a221_0x24f3[_0x28da2f];return _0x5bf7b4;};'use strict';var __importDefault=this&&this[a221_0x3ecb('0x0')]||function(_0x388e09){return _0x388e09&&_0x388e09[a221_0x3ecb('0x1')]?_0x388e09:{'default':_0x388e09};};Object[a221_0x3ecb('0x2')](exports,a221_0x3ecb('0x1'),{'value':!![]});const errorhandler_1=__importDefault(require('errorhandler'));const app_1=__importDefault(require(a221_0x3ecb('0x3')));const sequelize_utils_1=__importDefault(require('./infrastructure/sequelize-utils'));const fileOptimizationTask_1=__importDefault(require('./tasks/fileOptimizationTask'));const fsExtra=require(a221_0x3ecb('0x4'));app_1[a221_0x3ecb('0x5')]['use'](errorhandler_1[a221_0x3ecb('0x5')]());const expressServiceEnabled=process[a221_0x3ecb('0x6')]['EXPRESS_SERVICE_ENABLED']==a221_0x3ecb('0x7');const fileOptimizationEnabled=process[a221_0x3ecb('0x6')][a221_0x3ecb('0x8')]=='true';const socketServiceEnabled=process[a221_0x3ecb('0x6')][a221_0x3ecb('0x9')]=='true';if(expressServiceEnabled){const server=app_1[a221_0x3ecb('0x5')][a221_0x3ecb('0xa')](app_1[a221_0x3ecb('0x5')][a221_0x3ecb('0xb')](a221_0x3ecb('0xc')),()=>{console[a221_0x3ecb('0xd')](a221_0x3ecb('0xe'),app_1[a221_0x3ecb('0x5')][a221_0x3ecb('0xb')](a221_0x3ecb('0xc')),app_1[a221_0x3ecb('0x5')]['get'](a221_0x3ecb('0x6')));console[a221_0x3ecb('0xd')]('\x20\x20Press\x20CTRL-C\x20to\x20stop\x0a');});}if(fileOptimizationEnabled){const fileOptimizationTask=new fileOptimizationTask_1[(a221_0x3ecb('0x5'))]();fileOptimizationTask[a221_0x3ecb('0xf')]();}if(socketServiceEnabled){const net=require(a221_0x3ecb('0x10'));const port=0x46;const host=a221_0x3ecb('0x11');const fs=require('fs');const socketServer=net[a221_0x3ecb('0x12')]();socketServer[a221_0x3ecb('0xa')](port,host,()=>{console['log'](a221_0x3ecb('0x13')+port+'.');});const imageFolder=process['env']['IMAGE_FILES_FOLDER']+a221_0x3ecb('0x14');fsExtra[a221_0x3ecb('0x15')](imageFolder,_0x53b309=>{console['log'](_0x53b309);});const sockets=[];socketServer['on'](a221_0x3ecb('0x16'),function(_0x4688ae){console[a221_0x3ecb('0xd')](a221_0x3ecb('0x17')+_0x4688ae['remoteAddress']+':'+_0x4688ae[a221_0x3ecb('0x18')]);let _0x44a620='';_0x4688ae['on'](a221_0x3ecb('0x19'),function(_0x3d72ce){const _0x36a317=String(_0x3d72ce);console['log'](a221_0x3ecb('0x1a'));console[a221_0x3ecb('0xd')](_0x36a317);_0x44a620+=_0x36a317;if(_0x36a317[a221_0x3ecb('0x1b')]('ST910')){console['log'](a221_0x3ecb('0x1c'));const _0x1bd574={};sequelize_utils_1['default']['controllers'][a221_0x3ecb('0x1d')][a221_0x3ecb('0x1e')]({'body':{'data':''}},null,null)[a221_0x3ecb('0x1f')](_0x2273c5=>{console[a221_0x3ecb('0xd')](a221_0x3ecb('0x20'));console[a221_0x3ecb('0xd')](_0x2273c5);});}});_0x4688ae['on'](a221_0x3ecb('0x21'),function(_0xb4940){const _0x3c7e91=sockets[a221_0x3ecb('0x22')](function(_0x5ba94d){return _0x5ba94d[a221_0x3ecb('0x23')]===_0x4688ae[a221_0x3ecb('0x23')]&&_0x5ba94d[a221_0x3ecb('0x18')]===_0x4688ae[a221_0x3ecb('0x18')];});if(_0x3c7e91!==-0x1)sockets[a221_0x3ecb('0x24')](_0x3c7e91,0x1);if(_0x44a620[a221_0x3ecb('0x1b')](a221_0x3ecb('0x25'))){}else{console[a221_0x3ecb('0xd')](a221_0x3ecb('0x26'));_0x44a620=_0x44a620['substr'](_0x44a620[a221_0x3ecb('0x27')]('{'));let _0x5424e5={};try{_0x5424e5=JSON['parse'](_0x44a620);}catch(_0x371054){console[a221_0x3ecb('0xd')](_0x371054);}if(_0x5424e5[a221_0x3ecb('0x28')]!=null&&_0x5424e5[a221_0x3ecb('0x28')]!=''){sequelize_utils_1[a221_0x3ecb('0x5')][a221_0x3ecb('0x29')][a221_0x3ecb('0x2a')]['report']({'body':_0x5424e5},null,null)[a221_0x3ecb('0x1f')](_0x3c301a=>{console[a221_0x3ecb('0xd')](_0x3c301a[a221_0x3ecb('0x2b')]);if(_0x5424e5[a221_0x3ecb('0x28')][a221_0x3ecb('0x2c')]!=null&&_0x5424e5['infoplate'][a221_0x3ecb('0x2c')]!='')fsExtra[a221_0x3ecb('0x2d')](imageFolder+_0x3c301a[a221_0x3ecb('0x2b')][a221_0x3ecb('0x2e')]+a221_0x3ecb('0x2f'),_0x5424e5[a221_0x3ecb('0x28')][a221_0x3ecb('0x2c')],a221_0x3ecb('0x30'),function(_0x18f060){console[a221_0x3ecb('0xd')](_0x18f060);});});}}console[a221_0x3ecb('0xd')](a221_0x3ecb('0x31')+_0x44a620);console[a221_0x3ecb('0xd')]('CLOSED:\x20'+_0x4688ae[a221_0x3ecb('0x23')]+'\x20'+_0x4688ae[a221_0x3ecb('0x18')]);});});}exports[a221_0x3ecb('0x5')]=null;
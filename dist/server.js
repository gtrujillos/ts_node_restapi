var a110_0x5e70=['connection','CONNECTED:\x20','remoteAddress','close','remotePort','splice','startsWith','ST910','alarm','LPR','substr','parse','infoplate','vehiclesCountController','report','then','dataValues','img','writeFile','uuid','.png','base64','fullData:\x20','__esModule','defineProperty','./app','./infrastructure/sequelize-utils','fs-extra','true','env','FILE_OPTIMIZATION_SERVICE_ENABLED','SOCKET_SERVICE_ENABLED','listen','default','get','port','log','\x20\x20Press\x20CTRL-C\x20to\x20stop\x0a','start','net','0.0.0.0','createServer','media/vehiclesCount/','readFileSync','dataTest/plate.txt','ensureDir'];(function(_0x450fca,_0x463ab3){var _0x503cad=function(_0x41a8d0){while(--_0x41a8d0){_0x450fca['push'](_0x450fca['shift']());}};_0x503cad(++_0x463ab3);}(a110_0x5e70,0xfd));var a110_0x2a45=function(_0x4d4962,_0x4ed3a6){_0x4d4962=_0x4d4962-0x0;var _0x28fd4d=a110_0x5e70[_0x4d4962];return _0x28fd4d;};'use strict';var __importDefault=this&&this['__importDefault']||function(_0x5ede86){return _0x5ede86&&_0x5ede86[a110_0x2a45('0x0')]?_0x5ede86:{'default':_0x5ede86};};Object[a110_0x2a45('0x1')](exports,a110_0x2a45('0x0'),{'value':!![]});const errorhandler_1=__importDefault(require('errorhandler'));const app_1=__importDefault(require(a110_0x2a45('0x2')));const sequelize_utils_1=__importDefault(require(a110_0x2a45('0x3')));const fileOptimizationDemon_1=__importDefault(require('./tasks/fileOptimizationDemon'));const fsExtra=require(a110_0x2a45('0x4'));app_1['default']['use'](errorhandler_1['default']());const expressServiceEnabled=process['env']['EXPRESS_SERVICE_ENABLED']==a110_0x2a45('0x5');const fileOptimizationEnabled=process[a110_0x2a45('0x6')][a110_0x2a45('0x7')]==a110_0x2a45('0x5');const socketServiceEnabled=process[a110_0x2a45('0x6')][a110_0x2a45('0x8')]==a110_0x2a45('0x5');if(expressServiceEnabled){const server=app_1['default'][a110_0x2a45('0x9')](app_1[a110_0x2a45('0xa')][a110_0x2a45('0xb')](a110_0x2a45('0xc')),()=>{console[a110_0x2a45('0xd')]('\x20\x20App\x20is\x20running\x20at\x20http://localhost:%d\x20in\x20%s\x20mode',app_1['default'][a110_0x2a45('0xb')](a110_0x2a45('0xc')),app_1[a110_0x2a45('0xa')][a110_0x2a45('0xb')](a110_0x2a45('0x6')));console[a110_0x2a45('0xd')](a110_0x2a45('0xe'));});}if(fileOptimizationEnabled){const fileOptimizationTask=new fileOptimizationDemon_1['default']();fileOptimizationTask[a110_0x2a45('0xf')]();}if(socketServiceEnabled){const net=require(a110_0x2a45('0x10'));const port=0x46;const host=a110_0x2a45('0x11');const fs=require('fs');const socketServer=net[a110_0x2a45('0x12')]();socketServer[a110_0x2a45('0x9')](port,host,()=>{console['log']('TCP\x20Server\x20is\x20running\x20on\x20port\x20'+port+'.');});const imageFolder=a110_0x2a45('0x13');const dataTest=fsExtra[a110_0x2a45('0x14')](a110_0x2a45('0x15'));fsExtra[a110_0x2a45('0x16')](imageFolder,_0x57d692=>{console['log'](_0x57d692);});const sockets=[];socketServer['on'](a110_0x2a45('0x17'),function(_0x19824a){console[a110_0x2a45('0xd')](a110_0x2a45('0x18')+_0x19824a[a110_0x2a45('0x19')]+':'+_0x19824a['remotePort']);let _0x36c45b='';_0x19824a['on']('data',function(_0x238036){const _0x42c777=String(_0x238036);_0x36c45b+=_0x42c777;});_0x19824a['on'](a110_0x2a45('0x1a'),function(_0x28f457){const _0x211e46=sockets['findIndex'](function(_0x402dad){return _0x402dad[a110_0x2a45('0x19')]===_0x19824a[a110_0x2a45('0x19')]&&_0x402dad[a110_0x2a45('0x1b')]===_0x19824a[a110_0x2a45('0x1b')];});if(_0x211e46!==-0x1)sockets[a110_0x2a45('0x1c')](_0x211e46,0x1);_0x36c45b=dataTest+'';if(_0x36c45b[a110_0x2a45('0x1d')](a110_0x2a45('0x1e'))){console[a110_0x2a45('0xd')](a110_0x2a45('0x1f'));}else{console[a110_0x2a45('0xd')](a110_0x2a45('0x20'));_0x36c45b=_0x36c45b[a110_0x2a45('0x21')](_0x36c45b['indexOf']('{'));let _0x540444={};try{_0x540444=JSON[a110_0x2a45('0x22')](_0x36c45b);}catch(_0x570813){console[a110_0x2a45('0xd')](_0x570813);}if(_0x540444[a110_0x2a45('0x23')]!=null&&_0x540444[a110_0x2a45('0x23')]!=''){sequelize_utils_1['default']['controllers'][a110_0x2a45('0x24')][a110_0x2a45('0x25')]({'body':_0x540444},null,null)[a110_0x2a45('0x26')](_0x366380=>{console['log'](_0x366380[a110_0x2a45('0x27')]);if(_0x540444[a110_0x2a45('0x23')]['img']!=null&&_0x540444[a110_0x2a45('0x23')][a110_0x2a45('0x28')]!='')fsExtra[a110_0x2a45('0x29')](imageFolder+_0x366380[a110_0x2a45('0x27')][a110_0x2a45('0x2a')]+a110_0x2a45('0x2b'),_0x540444['infoplate']['img'],a110_0x2a45('0x2c'),function(_0x10be67){console[a110_0x2a45('0xd')](_0x10be67);});});}}console[a110_0x2a45('0xd')](a110_0x2a45('0x2d')+_0x36c45b);console[a110_0x2a45('0xd')]('CLOSED:\x20'+_0x19824a[a110_0x2a45('0x19')]+'\x20'+_0x19824a[a110_0x2a45('0x1b')]);});});}exports[a110_0x2a45('0xa')]=null;
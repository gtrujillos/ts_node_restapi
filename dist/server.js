var a221_0x5db5=['findIndex','remoteAddress','splice','ST910','substr','indexOf','infoplate','vehiclesCountController','img','writeFile','dataValues','uuid','base64','fullData:\x20','CLOSED:\x20','__importDefault','defineProperty','__esModule','./infrastructure/sequelize-utils','./tasks/fileOptimizationTask','fs-extra','default','use','env','EXPRESS_SERVICE_ENABLED','true','FILE_OPTIMIZATION_SERVICE_ENABLED','SOCKET_SERVICE_ENABLED','log','\x20\x20App\x20is\x20running\x20at\x20http://localhost:%d\x20in\x20%s\x20mode','get','port','start','net','0.0.0.0','createServer','listen','TCP\x20Server\x20is\x20running\x20on\x20port\x20','ensureDir','connection','CONNECTED:\x20','remotePort','******result:\x20','startsWith','alarm','controllers','eventsController','reportEvent','then','close'];(function(_0x17ba93,_0x76e570){var _0x1986d3=function(_0x318d2f){while(--_0x318d2f){_0x17ba93['push'](_0x17ba93['shift']());}};_0x1986d3(++_0x76e570);}(a221_0x5db5,0x1d1));var a221_0x3f0e=function(_0x4d0aa2,_0x4225a3){_0x4d0aa2=_0x4d0aa2-0x0;var _0x45638f=a221_0x5db5[_0x4d0aa2];return _0x45638f;};'use strict';var __importDefault=this&&this[a221_0x3f0e('0x0')]||function(_0x217829){return _0x217829&&_0x217829['__esModule']?_0x217829:{'default':_0x217829};};Object[a221_0x3f0e('0x1')](exports,a221_0x3f0e('0x2'),{'value':!![]});const errorhandler_1=__importDefault(require('errorhandler'));const app_1=__importDefault(require('./app'));const sequelize_utils_1=__importDefault(require(a221_0x3f0e('0x3')));const fileOptimizationTask_1=__importDefault(require(a221_0x3f0e('0x4')));const fsExtra=require(a221_0x3f0e('0x5'));app_1[a221_0x3f0e('0x6')][a221_0x3f0e('0x7')](errorhandler_1['default']());const expressServiceEnabled=process[a221_0x3f0e('0x8')][a221_0x3f0e('0x9')]==a221_0x3f0e('0xa');const fileOptimizationEnabled=process[a221_0x3f0e('0x8')][a221_0x3f0e('0xb')]==a221_0x3f0e('0xa');const socketServiceEnabled=process[a221_0x3f0e('0x8')][a221_0x3f0e('0xc')]==a221_0x3f0e('0xa');if(expressServiceEnabled){const server=app_1[a221_0x3f0e('0x6')]['listen'](app_1[a221_0x3f0e('0x6')]['get']('port'),()=>{console[a221_0x3f0e('0xd')](a221_0x3f0e('0xe'),app_1[a221_0x3f0e('0x6')][a221_0x3f0e('0xf')](a221_0x3f0e('0x10')),app_1['default'][a221_0x3f0e('0xf')]('env'));console[a221_0x3f0e('0xd')]('\x20\x20Press\x20CTRL-C\x20to\x20stop\x0a');});}if(fileOptimizationEnabled){const fileOptimizationTask=new fileOptimizationTask_1[(a221_0x3f0e('0x6'))]();fileOptimizationTask[a221_0x3f0e('0x11')]();}if(socketServiceEnabled){const net=require(a221_0x3f0e('0x12'));const port=0x46;const host=a221_0x3f0e('0x13');const fs=require('fs');const socketServer=net[a221_0x3f0e('0x14')]();socketServer[a221_0x3f0e('0x15')](port,host,()=>{console[a221_0x3f0e('0xd')](a221_0x3f0e('0x16')+port+'.');});const imageFolder=process[a221_0x3f0e('0x8')]['IMAGE_FILES_FOLDER']+'vehiclesCount/';fsExtra[a221_0x3f0e('0x17')](imageFolder,_0x150276=>{console[a221_0x3f0e('0xd')](_0x150276);});const sockets=[];socketServer['on'](a221_0x3f0e('0x18'),function(_0x3d23c2){console[a221_0x3f0e('0xd')](a221_0x3f0e('0x19')+_0x3d23c2['remoteAddress']+':'+_0x3d23c2[a221_0x3f0e('0x1a')]);let _0x7a7ee='';_0x3d23c2['on']('data',function(_0x2266d5){const _0x518150=String(_0x2266d5);console[a221_0x3f0e('0xd')](a221_0x3f0e('0x1b'));console[a221_0x3f0e('0xd')](_0x518150);_0x7a7ee+=_0x518150;if(_0x518150[a221_0x3f0e('0x1c')]('ST910')){console['log'](a221_0x3f0e('0x1d'));const _0x50a559={};sequelize_utils_1['default'][a221_0x3f0e('0x1e')][a221_0x3f0e('0x1f')][a221_0x3f0e('0x20')]({'body':{'data':''}},null,null)[a221_0x3f0e('0x21')](_0x7000e7=>{console[a221_0x3f0e('0xd')]('alarm:\x20');console[a221_0x3f0e('0xd')](_0x7000e7);});}});_0x3d23c2['on'](a221_0x3f0e('0x22'),function(_0x45f9df){const _0x615e02=sockets[a221_0x3f0e('0x23')](function(_0x56da97){return _0x56da97[a221_0x3f0e('0x24')]===_0x3d23c2[a221_0x3f0e('0x24')]&&_0x56da97['remotePort']===_0x3d23c2[a221_0x3f0e('0x1a')];});if(_0x615e02!==-0x1)sockets[a221_0x3f0e('0x25')](_0x615e02,0x1);if(_0x7a7ee[a221_0x3f0e('0x1c')](a221_0x3f0e('0x26'))){}else{console[a221_0x3f0e('0xd')]('LPR');_0x7a7ee=_0x7a7ee[a221_0x3f0e('0x27')](_0x7a7ee[a221_0x3f0e('0x28')]('{'));let _0x56c889={};try{_0x56c889=JSON['parse'](_0x7a7ee);}catch(_0x12b0c3){console[a221_0x3f0e('0xd')](_0x12b0c3);}if(_0x56c889['infoplate']!=null&&_0x56c889[a221_0x3f0e('0x29')]!=''){sequelize_utils_1[a221_0x3f0e('0x6')][a221_0x3f0e('0x1e')][a221_0x3f0e('0x2a')]['report']({'body':_0x56c889},null,null)[a221_0x3f0e('0x21')](_0x3ca064=>{console[a221_0x3f0e('0xd')](_0x3ca064['dataValues']);if(_0x56c889[a221_0x3f0e('0x29')]['img']!=null&&_0x56c889[a221_0x3f0e('0x29')][a221_0x3f0e('0x2b')]!='')fsExtra[a221_0x3f0e('0x2c')](imageFolder+_0x3ca064[a221_0x3f0e('0x2d')][a221_0x3f0e('0x2e')]+'.png',_0x56c889[a221_0x3f0e('0x29')][a221_0x3f0e('0x2b')],a221_0x3f0e('0x2f'),function(_0x4895a0){console['log'](_0x4895a0);});});}}console[a221_0x3f0e('0xd')](a221_0x3f0e('0x30')+_0x7a7ee);console[a221_0x3f0e('0xd')](a221_0x3f0e('0x31')+_0x3d23c2['remoteAddress']+'\x20'+_0x3d23c2['remotePort']);});});}exports['default']=null;
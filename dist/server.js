var a116_0x336f=['env','true','FILE_OPTIMIZATION_SERVICE_ENABLED','SOCKET_SERVICE_ENABLED','listen','get','\x20\x20App\x20is\x20running\x20at\x20http://localhost:%d\x20in\x20%s\x20mode','port','log','\x20\x20Press\x20CTRL-C\x20to\x20stop\x0a','net','TCP\x20Server\x20is\x20running\x20on\x20port\x20','vehiclesCount/','ensureDir','connection','CONNECTED:\x20','remotePort','data','startsWith','ST910','alarm','alarmsController','reportAlarm','then','alarm:\x20','remoteAddress','splice','LPR','substr','infoplate','controllers','report','dataValues','img','writeFile','uuid','.png','base64','fullData:\x20','CLOSED:\x20','__importDefault','__esModule','defineProperty','errorhandler','./app','./infrastructure/sequelize-utils','fs-extra','use','default'];(function(_0x55be0f,_0x376cce){var _0x9fd4e1=function(_0x5cee79){while(--_0x5cee79){_0x55be0f['push'](_0x55be0f['shift']());}};_0x9fd4e1(++_0x376cce);}(a116_0x336f,0xbb));var a116_0x5845=function(_0x13501a,_0x42bab4){_0x13501a=_0x13501a-0x0;var _0x4470f3=a116_0x336f[_0x13501a];return _0x4470f3;};'use strict';var __importDefault=this&&this[a116_0x5845('0x0')]||function(_0x5aa3d0){return _0x5aa3d0&&_0x5aa3d0[a116_0x5845('0x1')]?_0x5aa3d0:{'default':_0x5aa3d0};};Object[a116_0x5845('0x2')](exports,'__esModule',{'value':!![]});const errorhandler_1=__importDefault(require(a116_0x5845('0x3')));const app_1=__importDefault(require(a116_0x5845('0x4')));const sequelize_utils_1=__importDefault(require(a116_0x5845('0x5')));const fileOptimizationTask_1=__importDefault(require('./tasks/fileOptimizationTask'));const fsExtra=require(a116_0x5845('0x6'));app_1['default'][a116_0x5845('0x7')](errorhandler_1[a116_0x5845('0x8')]());const expressServiceEnabled=process[a116_0x5845('0x9')]['EXPRESS_SERVICE_ENABLED']==a116_0x5845('0xa');const fileOptimizationEnabled=process[a116_0x5845('0x9')][a116_0x5845('0xb')]==a116_0x5845('0xa');const socketServiceEnabled=process['env'][a116_0x5845('0xc')]==a116_0x5845('0xa');if(expressServiceEnabled){const server=app_1[a116_0x5845('0x8')][a116_0x5845('0xd')](app_1['default'][a116_0x5845('0xe')]('port'),()=>{console['log'](a116_0x5845('0xf'),app_1[a116_0x5845('0x8')][a116_0x5845('0xe')](a116_0x5845('0x10')),app_1[a116_0x5845('0x8')][a116_0x5845('0xe')](a116_0x5845('0x9')));console[a116_0x5845('0x11')](a116_0x5845('0x12'));});}if(fileOptimizationEnabled){const fileOptimizationTask=new fileOptimizationTask_1[(a116_0x5845('0x8'))]();fileOptimizationTask['start']();}if(socketServiceEnabled){const net=require(a116_0x5845('0x13'));const port=0x46;const host='0.0.0.0';const fs=require('fs');const socketServer=net['createServer']();socketServer[a116_0x5845('0xd')](port,host,()=>{console['log'](a116_0x5845('0x14')+port+'.');});const imageFolder=process['env']['IMAGE_FILES_FOLDER']+a116_0x5845('0x15');fsExtra[a116_0x5845('0x16')](imageFolder,_0x9332db=>{console[a116_0x5845('0x11')](_0x9332db);});const sockets=[];socketServer['on'](a116_0x5845('0x17'),function(_0x60e8b9){console[a116_0x5845('0x11')](a116_0x5845('0x18')+_0x60e8b9['remoteAddress']+':'+_0x60e8b9[a116_0x5845('0x19')]);let _0xbd681b='';_0x60e8b9['on'](a116_0x5845('0x1a'),function(_0x104a22){const _0x4eb2aa=String(_0x104a22);console[a116_0x5845('0x11')]('******result:\x20');console['log'](_0x4eb2aa);_0xbd681b+=_0x4eb2aa;if(_0x4eb2aa[a116_0x5845('0x1b')](a116_0x5845('0x1c'))){console['log'](a116_0x5845('0x1d'));const _0x91cf85={};sequelize_utils_1[a116_0x5845('0x8')]['controllers'][a116_0x5845('0x1e')][a116_0x5845('0x1f')]({'body':{'data':''}},null,null)[a116_0x5845('0x20')](_0xcf7143=>{console[a116_0x5845('0x11')](a116_0x5845('0x21'));console[a116_0x5845('0x11')](_0xcf7143);});}});_0x60e8b9['on']('close',function(_0x57c793){const _0x162539=sockets['findIndex'](function(_0x2476df){return _0x2476df[a116_0x5845('0x22')]===_0x60e8b9[a116_0x5845('0x22')]&&_0x2476df['remotePort']===_0x60e8b9[a116_0x5845('0x19')];});if(_0x162539!==-0x1)sockets[a116_0x5845('0x23')](_0x162539,0x1);if(_0xbd681b[a116_0x5845('0x1b')](a116_0x5845('0x1c'))){}else{console[a116_0x5845('0x11')](a116_0x5845('0x24'));_0xbd681b=_0xbd681b[a116_0x5845('0x25')](_0xbd681b['indexOf']('{'));let _0x9db81d={};try{_0x9db81d=JSON['parse'](_0xbd681b);}catch(_0x49d451){console[a116_0x5845('0x11')](_0x49d451);}if(_0x9db81d[a116_0x5845('0x26')]!=null&&_0x9db81d[a116_0x5845('0x26')]!=''){sequelize_utils_1[a116_0x5845('0x8')][a116_0x5845('0x27')]['vehiclesCountController'][a116_0x5845('0x28')]({'body':_0x9db81d},null,null)[a116_0x5845('0x20')](_0x4d42f7=>{console[a116_0x5845('0x11')](_0x4d42f7[a116_0x5845('0x29')]);if(_0x9db81d['infoplate'][a116_0x5845('0x2a')]!=null&&_0x9db81d[a116_0x5845('0x26')][a116_0x5845('0x2a')]!='')fsExtra[a116_0x5845('0x2b')](imageFolder+_0x4d42f7[a116_0x5845('0x29')][a116_0x5845('0x2c')]+a116_0x5845('0x2d'),_0x9db81d[a116_0x5845('0x26')][a116_0x5845('0x2a')],a116_0x5845('0x2e'),function(_0x59dc7c){console[a116_0x5845('0x11')](_0x59dc7c);});});}}console['log'](a116_0x5845('0x2f')+_0xbd681b);console[a116_0x5845('0x11')](a116_0x5845('0x30')+_0x60e8b9[a116_0x5845('0x22')]+'\x20'+_0x60e8b9[a116_0x5845('0x19')]);});});}exports[a116_0x5845('0x8')]=null;
var a221_0x3c85=['get','port','log','\x20\x20App\x20is\x20running\x20at\x20http://localhost:%d\x20in\x20%s\x20mode','0.0.0.0','IMAGE_FILES_FOLDER','vehiclesCount/','ensureDir','remoteAddress','remotePort','data','startsWith','ST910','alarm','controllers','alarm:\x20','close','splice','LPR','substr','indexOf','parse','infoplate','vehiclesCountController','report','then','dataValues','img','uuid','.png','base64','fullData:\x20','__importDefault','__esModule','defineProperty','errorhandler','./app','./infrastructure/sequelize-utils','./tasks/fileOptimizationTask','fs-extra','default','use','env','FILE_OPTIMIZATION_SERVICE_ENABLED','true','SOCKET_SERVICE_ENABLED','listen'];(function(_0x2ecd67,_0x28ca7f){var _0x2d9edb=function(_0x328891){while(--_0x328891){_0x2ecd67['push'](_0x2ecd67['shift']());}};_0x2d9edb(++_0x28ca7f);}(a221_0x3c85,0x7e));var a221_0x1547=function(_0x2e4e91,_0xa9e967){_0x2e4e91=_0x2e4e91-0x0;var _0x36293c=a221_0x3c85[_0x2e4e91];return _0x36293c;};'use strict';var __importDefault=this&&this[a221_0x1547('0x0')]||function(_0x4a536e){return _0x4a536e&&_0x4a536e[a221_0x1547('0x1')]?_0x4a536e:{'default':_0x4a536e};};Object[a221_0x1547('0x2')](exports,a221_0x1547('0x1'),{'value':!![]});const errorhandler_1=__importDefault(require(a221_0x1547('0x3')));const app_1=__importDefault(require(a221_0x1547('0x4')));const sequelize_utils_1=__importDefault(require(a221_0x1547('0x5')));const fileOptimizationTask_1=__importDefault(require(a221_0x1547('0x6')));const fsExtra=require(a221_0x1547('0x7'));app_1[a221_0x1547('0x8')][a221_0x1547('0x9')](errorhandler_1['default']());const expressServiceEnabled=process[a221_0x1547('0xa')]['EXPRESS_SERVICE_ENABLED']=='true';const fileOptimizationEnabled=process[a221_0x1547('0xa')][a221_0x1547('0xb')]==a221_0x1547('0xc');const socketServiceEnabled=process[a221_0x1547('0xa')][a221_0x1547('0xd')]==a221_0x1547('0xc');if(expressServiceEnabled){const server=app_1[a221_0x1547('0x8')][a221_0x1547('0xe')](app_1[a221_0x1547('0x8')][a221_0x1547('0xf')](a221_0x1547('0x10')),()=>{console[a221_0x1547('0x11')](a221_0x1547('0x12'),app_1['default'][a221_0x1547('0xf')]('port'),app_1[a221_0x1547('0x8')][a221_0x1547('0xf')](a221_0x1547('0xa')));console[a221_0x1547('0x11')]('\x20\x20Press\x20CTRL-C\x20to\x20stop\x0a');});}if(fileOptimizationEnabled){const fileOptimizationTask=new fileOptimizationTask_1[(a221_0x1547('0x8'))]();fileOptimizationTask['start']();}if(socketServiceEnabled){const net=require('net');const port=0x46;const host=a221_0x1547('0x13');const fs=require('fs');const socketServer=net['createServer']();socketServer['listen'](port,host,()=>{console[a221_0x1547('0x11')]('TCP\x20Server\x20is\x20running\x20on\x20port\x20'+port+'.');});const imageFolder=process[a221_0x1547('0xa')][a221_0x1547('0x14')]+a221_0x1547('0x15');fsExtra[a221_0x1547('0x16')](imageFolder,_0x14493a=>{console['log'](_0x14493a);});const sockets=[];socketServer['on']('connection',function(_0x2b4e1c){console[a221_0x1547('0x11')]('CONNECTED:\x20'+_0x2b4e1c[a221_0x1547('0x17')]+':'+_0x2b4e1c[a221_0x1547('0x18')]);let _0x23f763='';_0x2b4e1c['on'](a221_0x1547('0x19'),function(_0x181816){const _0x472eb9=String(_0x181816);console[a221_0x1547('0x11')]('******result:\x20');console['log'](_0x472eb9);_0x23f763+=_0x472eb9;if(_0x472eb9[a221_0x1547('0x1a')](a221_0x1547('0x1b'))){console[a221_0x1547('0x11')](a221_0x1547('0x1c'));const _0x20c2b0={};sequelize_utils_1['default'][a221_0x1547('0x1d')]['eventsController']['reportEvent']({'body':{'data':''}},null,null)['then'](_0x23d1e7=>{console[a221_0x1547('0x11')](a221_0x1547('0x1e'));console[a221_0x1547('0x11')](_0x23d1e7);});}});_0x2b4e1c['on'](a221_0x1547('0x1f'),function(_0x5b2518){const _0x2764ea=sockets['findIndex'](function(_0xb68f92){return _0xb68f92[a221_0x1547('0x17')]===_0x2b4e1c[a221_0x1547('0x17')]&&_0xb68f92[a221_0x1547('0x18')]===_0x2b4e1c[a221_0x1547('0x18')];});if(_0x2764ea!==-0x1)sockets[a221_0x1547('0x20')](_0x2764ea,0x1);if(_0x23f763['startsWith'](a221_0x1547('0x1b'))){}else{console[a221_0x1547('0x11')](a221_0x1547('0x21'));_0x23f763=_0x23f763[a221_0x1547('0x22')](_0x23f763[a221_0x1547('0x23')]('{'));let _0x226b93={};try{_0x226b93=JSON[a221_0x1547('0x24')](_0x23f763);}catch(_0x20ab1b){console[a221_0x1547('0x11')](_0x20ab1b);}if(_0x226b93[a221_0x1547('0x25')]!=null&&_0x226b93[a221_0x1547('0x25')]!=''){sequelize_utils_1[a221_0x1547('0x8')][a221_0x1547('0x1d')][a221_0x1547('0x26')][a221_0x1547('0x27')]({'body':_0x226b93},null,null)[a221_0x1547('0x28')](_0x466985=>{console[a221_0x1547('0x11')](_0x466985[a221_0x1547('0x29')]);if(_0x226b93[a221_0x1547('0x25')][a221_0x1547('0x2a')]!=null&&_0x226b93[a221_0x1547('0x25')][a221_0x1547('0x2a')]!='')fsExtra['writeFile'](imageFolder+_0x466985[a221_0x1547('0x29')][a221_0x1547('0x2b')]+a221_0x1547('0x2c'),_0x226b93[a221_0x1547('0x25')][a221_0x1547('0x2a')],a221_0x1547('0x2d'),function(_0x2a65c5){console[a221_0x1547('0x11')](_0x2a65c5);});});}}console[a221_0x1547('0x11')](a221_0x1547('0x2e')+_0x23f763);console[a221_0x1547('0x11')]('CLOSED:\x20'+_0x2b4e1c['remoteAddress']+'\x20'+_0x2b4e1c[a221_0x1547('0x18')]);});});}exports[a221_0x1547('0x8')]=null;
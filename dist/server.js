var a221_0x15f2=['default','env','EXPRESS_SERVICE_ENABLED','true','SOCKET_SERVICE_ENABLED','get','port','\x20\x20App\x20is\x20running\x20at\x20http://localhost:%d\x20in\x20%s\x20mode','log','\x20\x20Press\x20CTRL-C\x20to\x20stop\x0a','0.0.0.0','createServer','listen','TCP\x20Server\x20is\x20running\x20on\x20port\x20','vehiclesCount/','ensureDir','connection','CONNECTED:\x20','remoteAddress','data','******result:\x20','startsWith','ST910','eventsController','reportEvent','then','findIndex','remotePort','splice','LPR','indexOf','infoplate','controllers','vehiclesCountController','report','dataValues','img','base64','fullData:\x20','CLOSED:\x20','__importDefault','__esModule','defineProperty','errorhandler','./tasks/fileOptimizationTask','fs-extra'];(function(_0xc841da,_0x15ff67){var _0x2bbd9e=function(_0x28af56){while(--_0x28af56){_0xc841da['push'](_0xc841da['shift']());}};_0x2bbd9e(++_0x15ff67);}(a221_0x15f2,0x16a));var a221_0x4372=function(_0x27ec57,_0x2403f2){_0x27ec57=_0x27ec57-0x0;var _0x18fb6e=a221_0x15f2[_0x27ec57];return _0x18fb6e;};'use strict';var __importDefault=this&&this[a221_0x4372('0x0')]||function(_0x3fb5bc){return _0x3fb5bc&&_0x3fb5bc[a221_0x4372('0x1')]?_0x3fb5bc:{'default':_0x3fb5bc};};Object[a221_0x4372('0x2')](exports,a221_0x4372('0x1'),{'value':!![]});const errorhandler_1=__importDefault(require(a221_0x4372('0x3')));const app_1=__importDefault(require('./app'));const sequelize_utils_1=__importDefault(require('./infrastructure/sequelize-utils'));const fileOptimizationTask_1=__importDefault(require(a221_0x4372('0x4')));const fsExtra=require(a221_0x4372('0x5'));app_1[a221_0x4372('0x6')]['use'](errorhandler_1[a221_0x4372('0x6')]());const expressServiceEnabled=process[a221_0x4372('0x7')][a221_0x4372('0x8')]==a221_0x4372('0x9');const fileOptimizationEnabled=process[a221_0x4372('0x7')]['FILE_OPTIMIZATION_SERVICE_ENABLED']==a221_0x4372('0x9');const socketServiceEnabled=process['env'][a221_0x4372('0xa')]==a221_0x4372('0x9');if(expressServiceEnabled){const server=app_1[a221_0x4372('0x6')]['listen'](app_1['default'][a221_0x4372('0xb')](a221_0x4372('0xc')),()=>{console['log'](a221_0x4372('0xd'),app_1[a221_0x4372('0x6')][a221_0x4372('0xb')]('port'),app_1[a221_0x4372('0x6')][a221_0x4372('0xb')](a221_0x4372('0x7')));console[a221_0x4372('0xe')](a221_0x4372('0xf'));});}if(fileOptimizationEnabled){const fileOptimizationTask=new fileOptimizationTask_1[(a221_0x4372('0x6'))]();fileOptimizationTask['start']();}if(socketServiceEnabled){const net=require('net');const port=0x46;const host=a221_0x4372('0x10');const fs=require('fs');const socketServer=net[a221_0x4372('0x11')]();socketServer[a221_0x4372('0x12')](port,host,()=>{console[a221_0x4372('0xe')](a221_0x4372('0x13')+port+'.');});const imageFolder=process['env']['IMAGE_FILES_FOLDER']+a221_0x4372('0x14');fsExtra[a221_0x4372('0x15')](imageFolder,_0x57a149=>{console[a221_0x4372('0xe')](_0x57a149);});const sockets=[];socketServer['on'](a221_0x4372('0x16'),function(_0x195d25){console[a221_0x4372('0xe')](a221_0x4372('0x17')+_0x195d25[a221_0x4372('0x18')]+':'+_0x195d25['remotePort']);let _0x5db86d='';_0x195d25['on'](a221_0x4372('0x19'),function(_0x25da29){const _0x47a81a=String(_0x25da29);console[a221_0x4372('0xe')](a221_0x4372('0x1a'));console[a221_0x4372('0xe')](_0x47a81a);_0x5db86d+=_0x47a81a;if(_0x47a81a[a221_0x4372('0x1b')](a221_0x4372('0x1c'))){console['log']('alarm');const _0x26a212={};sequelize_utils_1['default']['controllers'][a221_0x4372('0x1d')][a221_0x4372('0x1e')]({'body':{'data':''}},null,null)[a221_0x4372('0x1f')](_0xfca192=>{console[a221_0x4372('0xe')]('alarm:\x20');console[a221_0x4372('0xe')](_0xfca192);});}});_0x195d25['on']('close',function(_0x125096){const _0x72322b=sockets[a221_0x4372('0x20')](function(_0x29c6b3){return _0x29c6b3[a221_0x4372('0x18')]===_0x195d25[a221_0x4372('0x18')]&&_0x29c6b3[a221_0x4372('0x21')]===_0x195d25[a221_0x4372('0x21')];});if(_0x72322b!==-0x1)sockets[a221_0x4372('0x22')](_0x72322b,0x1);if(_0x5db86d[a221_0x4372('0x1b')](a221_0x4372('0x1c'))){}else{console[a221_0x4372('0xe')](a221_0x4372('0x23'));_0x5db86d=_0x5db86d['substr'](_0x5db86d[a221_0x4372('0x24')]('{'));let _0x1bc8db={};try{_0x1bc8db=JSON['parse'](_0x5db86d);}catch(_0x126967){console[a221_0x4372('0xe')](_0x126967);}if(_0x1bc8db[a221_0x4372('0x25')]!=null&&_0x1bc8db['infoplate']!=''){sequelize_utils_1[a221_0x4372('0x6')][a221_0x4372('0x26')][a221_0x4372('0x27')][a221_0x4372('0x28')]({'body':_0x1bc8db},null,null)[a221_0x4372('0x1f')](_0x3edf02=>{console[a221_0x4372('0xe')](_0x3edf02[a221_0x4372('0x29')]);if(_0x1bc8db['infoplate'][a221_0x4372('0x2a')]!=null&&_0x1bc8db[a221_0x4372('0x25')][a221_0x4372('0x2a')]!='')fsExtra['writeFile'](imageFolder+_0x3edf02[a221_0x4372('0x29')]['uuid']+'.png',_0x1bc8db['infoplate'][a221_0x4372('0x2a')],a221_0x4372('0x2b'),function(_0x4f3069){console[a221_0x4372('0xe')](_0x4f3069);});});}}console[a221_0x4372('0xe')](a221_0x4372('0x2c')+_0x5db86d);console[a221_0x4372('0xe')](a221_0x4372('0x2d')+_0x195d25[a221_0x4372('0x18')]+'\x20'+_0x195d25[a221_0x4372('0x21')]);});});}exports['default']=null;
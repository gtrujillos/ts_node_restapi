var a207_0xcd86=['CONNECTED:\x20','******result:\x20','startsWith','reportEvent','then','alarm:\x20','close','findIndex','remotePort','splice','ST910','substr','indexOf','parse','infoplate','getInstance','vehiclesCountController','report','img','writeFile','.png','base64','fullData:\x20','CLOSED:\x20','remoteAddress','__importDefault','__esModule','defineProperty','errorhandler','./tasks/fileOptimizationTask','./app/controllers','fs-extra','default','env','EXPRESS_SERVICE_ENABLED','true','SOCKET_SERVICE_ENABLED','listen','get','port','log','\x20\x20Press\x20CTRL-C\x20to\x20stop\x0a','start','net','0.0.0.0','createServer','TCP\x20Server\x20is\x20running\x20on\x20port\x20','FILES_FOLDER','vehiclesCount/','connection'];(function(_0xb58713,_0x1b4680){var _0x6b306e=function(_0x26ad4a){while(--_0x26ad4a){_0xb58713['push'](_0xb58713['shift']());}};_0x6b306e(++_0x1b4680);}(a207_0xcd86,0x113));var a207_0xa8ef=function(_0x570e10,_0x4e09f2){_0x570e10=_0x570e10-0x0;var _0x195c61=a207_0xcd86[_0x570e10];return _0x195c61;};'use strict';var __importDefault=this&&this[a207_0xa8ef('0x0')]||function(_0x266e36){return _0x266e36&&_0x266e36[a207_0xa8ef('0x1')]?_0x266e36:{'default':_0x266e36};};Object[a207_0xa8ef('0x2')](exports,'__esModule',{'value':!![]});const errorhandler_1=__importDefault(require(a207_0xa8ef('0x3')));const app_1=__importDefault(require('./app'));const fileOptimizationTask_1=__importDefault(require(a207_0xa8ef('0x4')));const controllers_1=__importDefault(require(a207_0xa8ef('0x5')));const fsExtra=require(a207_0xa8ef('0x6'));app_1['default']['use'](errorhandler_1[a207_0xa8ef('0x7')]());const expressServiceEnabled=process[a207_0xa8ef('0x8')][a207_0xa8ef('0x9')]==a207_0xa8ef('0xa');const fileOptimizationEnabled=process[a207_0xa8ef('0x8')]['FILE_OPTIMIZATION_SERVICE_ENABLED']=='true';const socketServiceEnabled=process[a207_0xa8ef('0x8')][a207_0xa8ef('0xb')]==a207_0xa8ef('0xa');if(expressServiceEnabled){const server=app_1[a207_0xa8ef('0x7')][a207_0xa8ef('0xc')](app_1[a207_0xa8ef('0x7')][a207_0xa8ef('0xd')](a207_0xa8ef('0xe')),()=>{console[a207_0xa8ef('0xf')]('\x20\x20App\x20is\x20running\x20at\x20http://localhost:%d\x20in\x20%s\x20mode',app_1[a207_0xa8ef('0x7')]['get'](a207_0xa8ef('0xe')),app_1[a207_0xa8ef('0x7')][a207_0xa8ef('0xd')](a207_0xa8ef('0x8')));console[a207_0xa8ef('0xf')](a207_0xa8ef('0x10'));});}if(fileOptimizationEnabled){const fileOptimizationTask=new fileOptimizationTask_1[(a207_0xa8ef('0x7'))]();fileOptimizationTask[a207_0xa8ef('0x11')]();}if(socketServiceEnabled){const net=require(a207_0xa8ef('0x12'));const port=0x46;const host=a207_0xa8ef('0x13');const fs=require('fs');const socketServer=net[a207_0xa8ef('0x14')]();socketServer[a207_0xa8ef('0xc')](port,host,()=>{console[a207_0xa8ef('0xf')](a207_0xa8ef('0x15')+port+'.');});const imageFolder=process[a207_0xa8ef('0x8')][a207_0xa8ef('0x16')]+a207_0xa8ef('0x17');fsExtra['ensureDir'](imageFolder,_0x5daa75=>{console[a207_0xa8ef('0xf')](_0x5daa75);});const sockets=[];socketServer['on'](a207_0xa8ef('0x18'),function(_0x1caa46){console[a207_0xa8ef('0xf')](a207_0xa8ef('0x19')+_0x1caa46['remoteAddress']+':'+_0x1caa46['remotePort']);let _0x266583='';_0x1caa46['on']('data',function(_0x33ea8e){const _0x1c36a0=String(_0x33ea8e);console[a207_0xa8ef('0xf')](a207_0xa8ef('0x1a'));console[a207_0xa8ef('0xf')](_0x1c36a0);_0x266583+=_0x1c36a0;if(_0x1c36a0[a207_0xa8ef('0x1b')]('ST910')){console['log']('alarm');const _0x1fe80c={};controllers_1['default']['getInstance']()['eventsController'][a207_0xa8ef('0x1c')]({'body':{'data':''}},null,null)[a207_0xa8ef('0x1d')](_0x4f09e5=>{console[a207_0xa8ef('0xf')](a207_0xa8ef('0x1e'));console['log'](_0x4f09e5);});}});_0x1caa46['on'](a207_0xa8ef('0x1f'),function(_0x262207){const _0x4eda06=sockets[a207_0xa8ef('0x20')](function(_0x53c140){return _0x53c140['remoteAddress']===_0x1caa46['remoteAddress']&&_0x53c140[a207_0xa8ef('0x21')]===_0x1caa46[a207_0xa8ef('0x21')];});if(_0x4eda06!==-0x1)sockets[a207_0xa8ef('0x22')](_0x4eda06,0x1);if(_0x266583[a207_0xa8ef('0x1b')](a207_0xa8ef('0x23'))){}else{console[a207_0xa8ef('0xf')]('LPR');_0x266583=_0x266583[a207_0xa8ef('0x24')](_0x266583[a207_0xa8ef('0x25')]('{'));let _0x5861f3={};try{_0x5861f3=JSON[a207_0xa8ef('0x26')](_0x266583);}catch(_0x31459a){console[a207_0xa8ef('0xf')](_0x31459a);}if(_0x5861f3[a207_0xa8ef('0x27')]!=null&&_0x5861f3['infoplate']!=''){controllers_1['default'][a207_0xa8ef('0x28')]()[a207_0xa8ef('0x29')][a207_0xa8ef('0x2a')]({'body':_0x5861f3},null,null)[a207_0xa8ef('0x1d')](_0x296d88=>{console[a207_0xa8ef('0xf')](_0x296d88['dataValues']);if(_0x5861f3[a207_0xa8ef('0x27')][a207_0xa8ef('0x2b')]!=null&&_0x5861f3['infoplate'][a207_0xa8ef('0x2b')]!='')fsExtra[a207_0xa8ef('0x2c')](imageFolder+_0x296d88['dataValues']['uuid']+a207_0xa8ef('0x2d'),_0x5861f3['infoplate']['img'],a207_0xa8ef('0x2e'),function(_0x8af236){console[a207_0xa8ef('0xf')](_0x8af236);});});}}console[a207_0xa8ef('0xf')](a207_0xa8ef('0x2f')+_0x266583);console[a207_0xa8ef('0xf')](a207_0xa8ef('0x30')+_0x1caa46[a207_0xa8ef('0x31')]+'\x20'+_0x1caa46[a207_0xa8ef('0x21')]);});});}exports[a207_0xa8ef('0x7')]=null;
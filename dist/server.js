var a221_0x3925=['indexOf','parse','infoplate','controllers','report','dataValues','img','writeFile','uuid','.png','base64','fullData:\x20','CLOSED:\x20','__importDefault','__esModule','./app','./tasks/fileOptimizationTask','fs-extra','default','use','env','EXPRESS_SERVICE_ENABLED','true','FILE_OPTIMIZATION_SERVICE_ENABLED','get','port','log','\x20\x20Press\x20CTRL-C\x20to\x20stop\x0a','start','listen','TCP\x20Server\x20is\x20running\x20on\x20port\x20','vehiclesCount/','ensureDir','connection','CONNECTED:\x20','remoteAddress','remotePort','******result:\x20','ST910','alarm','eventsController','reportEvent','then','alarm:\x20','close','findIndex','splice','startsWith','LPR','substr'];(function(_0x2d8f05,_0x4b81bb){var _0x4d74cb=function(_0x32719f){while(--_0x32719f){_0x2d8f05['push'](_0x2d8f05['shift']());}};_0x4d74cb(++_0x4b81bb);}(a221_0x3925,0x107));var a221_0x31b0=function(_0x2d8f05,_0x4b81bb){_0x2d8f05=_0x2d8f05-0x0;var _0x4d74cb=a221_0x3925[_0x2d8f05];return _0x4d74cb;};'use strict';var __importDefault=this&&this[a221_0x31b0('0x0')]||function(_0x54c394){return _0x54c394&&_0x54c394[a221_0x31b0('0x1')]?_0x54c394:{'default':_0x54c394};};Object['defineProperty'](exports,'__esModule',{'value':!![]});const errorhandler_1=__importDefault(require('errorhandler'));const app_1=__importDefault(require(a221_0x31b0('0x2')));const sequelize_utils_1=__importDefault(require('./infrastructure/sequelize-utils'));const fileOptimizationTask_1=__importDefault(require(a221_0x31b0('0x3')));const fsExtra=require(a221_0x31b0('0x4'));app_1[a221_0x31b0('0x5')][a221_0x31b0('0x6')](errorhandler_1['default']());const expressServiceEnabled=process[a221_0x31b0('0x7')][a221_0x31b0('0x8')]==a221_0x31b0('0x9');const fileOptimizationEnabled=process[a221_0x31b0('0x7')][a221_0x31b0('0xa')]==a221_0x31b0('0x9');const socketServiceEnabled=process[a221_0x31b0('0x7')]['SOCKET_SERVICE_ENABLED']==a221_0x31b0('0x9');if(expressServiceEnabled){const server=app_1['default']['listen'](app_1['default'][a221_0x31b0('0xb')](a221_0x31b0('0xc')),()=>{console[a221_0x31b0('0xd')]('\x20\x20App\x20is\x20running\x20at\x20http://localhost:%d\x20in\x20%s\x20mode',app_1[a221_0x31b0('0x5')][a221_0x31b0('0xb')](a221_0x31b0('0xc')),app_1['default'][a221_0x31b0('0xb')](a221_0x31b0('0x7')));console[a221_0x31b0('0xd')](a221_0x31b0('0xe'));});}if(fileOptimizationEnabled){const fileOptimizationTask=new fileOptimizationTask_1[(a221_0x31b0('0x5'))]();fileOptimizationTask[a221_0x31b0('0xf')]();}if(socketServiceEnabled){const net=require('net');const port=0x46;const host='0.0.0.0';const fs=require('fs');const socketServer=net['createServer']();socketServer[a221_0x31b0('0x10')](port,host,()=>{console['log'](a221_0x31b0('0x11')+port+'.');});const imageFolder=process[a221_0x31b0('0x7')]['IMAGE_FILES_FOLDER']+a221_0x31b0('0x12');fsExtra[a221_0x31b0('0x13')](imageFolder,_0x3062f5=>{console[a221_0x31b0('0xd')](_0x3062f5);});const sockets=[];socketServer['on'](a221_0x31b0('0x14'),function(_0x51e967){console[a221_0x31b0('0xd')](a221_0x31b0('0x15')+_0x51e967[a221_0x31b0('0x16')]+':'+_0x51e967[a221_0x31b0('0x17')]);let _0x4ef6c4='';_0x51e967['on']('data',function(_0x554e5c){const _0x1cebfa=String(_0x554e5c);console[a221_0x31b0('0xd')](a221_0x31b0('0x18'));console[a221_0x31b0('0xd')](_0x1cebfa);_0x4ef6c4+=_0x1cebfa;if(_0x1cebfa['startsWith'](a221_0x31b0('0x19'))){console[a221_0x31b0('0xd')](a221_0x31b0('0x1a'));const _0x5f288e={};sequelize_utils_1[a221_0x31b0('0x5')]['controllers'][a221_0x31b0('0x1b')][a221_0x31b0('0x1c')]({'body':{'data':''}},null,null)[a221_0x31b0('0x1d')](_0x461f6a=>{console[a221_0x31b0('0xd')](a221_0x31b0('0x1e'));console[a221_0x31b0('0xd')](_0x461f6a);});}});_0x51e967['on'](a221_0x31b0('0x1f'),function(_0x212005){const _0x2bd2eb=sockets[a221_0x31b0('0x20')](function(_0xe227a){return _0xe227a[a221_0x31b0('0x16')]===_0x51e967['remoteAddress']&&_0xe227a[a221_0x31b0('0x17')]===_0x51e967['remotePort'];});if(_0x2bd2eb!==-0x1)sockets[a221_0x31b0('0x21')](_0x2bd2eb,0x1);if(_0x4ef6c4[a221_0x31b0('0x22')](a221_0x31b0('0x19'))){}else{console[a221_0x31b0('0xd')](a221_0x31b0('0x23'));_0x4ef6c4=_0x4ef6c4[a221_0x31b0('0x24')](_0x4ef6c4[a221_0x31b0('0x25')]('{'));let _0x1493fb={};try{_0x1493fb=JSON[a221_0x31b0('0x26')](_0x4ef6c4);}catch(_0x2385f7){console[a221_0x31b0('0xd')](_0x2385f7);}if(_0x1493fb[a221_0x31b0('0x27')]!=null&&_0x1493fb[a221_0x31b0('0x27')]!=''){sequelize_utils_1[a221_0x31b0('0x5')][a221_0x31b0('0x28')]['vehiclesCountController'][a221_0x31b0('0x29')]({'body':_0x1493fb},null,null)['then'](_0x4cb3af=>{console[a221_0x31b0('0xd')](_0x4cb3af[a221_0x31b0('0x2a')]);if(_0x1493fb[a221_0x31b0('0x27')][a221_0x31b0('0x2b')]!=null&&_0x1493fb[a221_0x31b0('0x27')]['img']!='')fsExtra[a221_0x31b0('0x2c')](imageFolder+_0x4cb3af[a221_0x31b0('0x2a')][a221_0x31b0('0x2d')]+a221_0x31b0('0x2e'),_0x1493fb[a221_0x31b0('0x27')][a221_0x31b0('0x2b')],a221_0x31b0('0x2f'),function(_0x27bc72){console[a221_0x31b0('0xd')](_0x27bc72);});});}}console[a221_0x31b0('0xd')](a221_0x31b0('0x30')+_0x4ef6c4);console[a221_0x31b0('0xd')](a221_0x31b0('0x31')+_0x51e967['remoteAddress']+'\x20'+_0x51e967[a221_0x31b0('0x17')]);});});}exports[a221_0x31b0('0x5')]=null;
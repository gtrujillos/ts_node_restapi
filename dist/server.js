var a312_0x3b48=['EXPRESS_SERVICE_ENABLED','env','FILE_OPTIMIZATION_SERVICE_ENABLED','listen','get','port','log','\x20\x20App\x20is\x20running\x20at\x20http://localhost:%d\x20in\x20%s\x20mode','\x20\x20Press\x20CTRL-C\x20to\x20stop\x0a','net','0.0.0.0','createServer','TCP\x20Server\x20is\x20running\x20on\x20port\x20','vehiclesCount/','ensureDir','remoteAddress','remotePort','data','******result:\x20','startsWith','ST910','alarm','getInstance','eventsController','then','alarm:\x20','close','splice','substr','parse','infoplate','report','dataValues','img','writeFile','uuid','CLOSED:\x20','__importDefault','defineProperty','__esModule','errorhandler','./app','./tasks/fileOptimizationTask','./app/controllers','fs-extra','default'];(function(_0x4243c2,_0x314931){var _0x2e64a1=function(_0x211232){while(--_0x211232){_0x4243c2['push'](_0x4243c2['shift']());}};_0x2e64a1(++_0x314931);}(a312_0x3b48,0x81));var a312_0x4165=function(_0x57474d,_0x25855c){_0x57474d=_0x57474d-0x0;var _0xd08fe3=a312_0x3b48[_0x57474d];return _0xd08fe3;};'use strict';var __importDefault=this&&this[a312_0x4165('0x0')]||function(_0xbb7f2d){return _0xbb7f2d&&_0xbb7f2d['__esModule']?_0xbb7f2d:{'default':_0xbb7f2d};};Object[a312_0x4165('0x1')](exports,a312_0x4165('0x2'),{'value':!![]});const errorhandler_1=__importDefault(require(a312_0x4165('0x3')));const app_1=__importDefault(require(a312_0x4165('0x4')));const fileOptimizationTask_1=__importDefault(require(a312_0x4165('0x5')));const controllers_1=__importDefault(require(a312_0x4165('0x6')));const fsExtra=require(a312_0x4165('0x7'));app_1[a312_0x4165('0x8')]['use'](errorhandler_1[a312_0x4165('0x8')]());const expressServiceEnabled=process['env'][a312_0x4165('0x9')]=='true';const fileOptimizationEnabled=process[a312_0x4165('0xa')][a312_0x4165('0xb')]=='true';const socketServiceEnabled=process[a312_0x4165('0xa')]['SOCKET_SERVICE_ENABLED']=='true';if(expressServiceEnabled){const server=app_1[a312_0x4165('0x8')][a312_0x4165('0xc')](app_1[a312_0x4165('0x8')][a312_0x4165('0xd')](a312_0x4165('0xe')),()=>{console[a312_0x4165('0xf')](a312_0x4165('0x10'),app_1['default'][a312_0x4165('0xd')](a312_0x4165('0xe')),app_1[a312_0x4165('0x8')][a312_0x4165('0xd')](a312_0x4165('0xa')));console['log'](a312_0x4165('0x11'));});}if(fileOptimizationEnabled){const fileOptimizationTask=new fileOptimizationTask_1[(a312_0x4165('0x8'))]();fileOptimizationTask['start']();}if(socketServiceEnabled){const net=require(a312_0x4165('0x12'));const port=0x46;const host=a312_0x4165('0x13');const fs=require('fs');const socketServer=net[a312_0x4165('0x14')]();socketServer[a312_0x4165('0xc')](port,host,()=>{console['log'](a312_0x4165('0x15')+port+'.');});const imageFolder=process['env']['IMAGE_FILES_FOLDER']+a312_0x4165('0x16');fsExtra[a312_0x4165('0x17')](imageFolder,_0x54ff6f=>{console['log'](_0x54ff6f);});const sockets=[];socketServer['on']('connection',function(_0x86390){console['log']('CONNECTED:\x20'+_0x86390[a312_0x4165('0x18')]+':'+_0x86390[a312_0x4165('0x19')]);let _0x3779c5='';_0x86390['on'](a312_0x4165('0x1a'),function(_0x16b147){const _0x10138e=String(_0x16b147);console['log'](a312_0x4165('0x1b'));console[a312_0x4165('0xf')](_0x10138e);_0x3779c5+=_0x10138e;if(_0x10138e[a312_0x4165('0x1c')](a312_0x4165('0x1d'))){console[a312_0x4165('0xf')](a312_0x4165('0x1e'));const _0x1ab838={};controllers_1['default'][a312_0x4165('0x1f')]()[a312_0x4165('0x20')]['reportEvent']({'body':{'data':''}},null,null)[a312_0x4165('0x21')](_0x38d932=>{console[a312_0x4165('0xf')](a312_0x4165('0x22'));console[a312_0x4165('0xf')](_0x38d932);});}});_0x86390['on'](a312_0x4165('0x23'),function(_0x3ff3f4){const _0xaac5f7=sockets['findIndex'](function(_0x2cd024){return _0x2cd024['remoteAddress']===_0x86390['remoteAddress']&&_0x2cd024['remotePort']===_0x86390[a312_0x4165('0x19')];});if(_0xaac5f7!==-0x1)sockets[a312_0x4165('0x24')](_0xaac5f7,0x1);if(_0x3779c5[a312_0x4165('0x1c')](a312_0x4165('0x1d'))){}else{console[a312_0x4165('0xf')]('LPR');_0x3779c5=_0x3779c5[a312_0x4165('0x25')](_0x3779c5['indexOf']('{'));let _0x3a7ef9={};try{_0x3a7ef9=JSON[a312_0x4165('0x26')](_0x3779c5);}catch(_0xb5af0){console[a312_0x4165('0xf')](_0xb5af0);}if(_0x3a7ef9[a312_0x4165('0x27')]!=null&&_0x3a7ef9[a312_0x4165('0x27')]!=''){controllers_1[a312_0x4165('0x8')][a312_0x4165('0x1f')]()['vehiclesCountController'][a312_0x4165('0x28')]({'body':_0x3a7ef9},null,null)[a312_0x4165('0x21')](_0x4099af=>{console['log'](_0x4099af[a312_0x4165('0x29')]);if(_0x3a7ef9[a312_0x4165('0x27')][a312_0x4165('0x2a')]!=null&&_0x3a7ef9[a312_0x4165('0x27')][a312_0x4165('0x2a')]!='')fsExtra[a312_0x4165('0x2b')](imageFolder+_0x4099af[a312_0x4165('0x29')][a312_0x4165('0x2c')]+'.png',_0x3a7ef9[a312_0x4165('0x27')][a312_0x4165('0x2a')],'base64',function(_0x543b5){console[a312_0x4165('0xf')](_0x543b5);});});}}console[a312_0x4165('0xf')]('fullData:\x20'+_0x3779c5);console[a312_0x4165('0xf')](a312_0x4165('0x2d')+_0x86390['remoteAddress']+'\x20'+_0x86390[a312_0x4165('0x19')]);});});}exports[a312_0x4165('0x8')]=null;
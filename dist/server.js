var a110_0x2ba5=['remoteAddress','remotePort','data','findIndex','startsWith','ST910','alarm','indexOf','parse','infoplate','controllers','vehiclesCountController','report','then','dataValues','img','writeFile','uuid','.png','base64','CLOSED:\x20','__importDefault','__esModule','errorhandler','fs-extra','use','default','env','EXPRESS_SERVICE_ENABLED','true','FILE_OPTIMIZATION_SERVICE_ENABLED','listen','get','port','log','\x20\x20App\x20is\x20running\x20at\x20http://localhost:%d\x20in\x20%s\x20mode','\x20\x20Press\x20CTRL-C\x20to\x20stop\x0a','start','net','0.0.0.0','createServer','TCP\x20Server\x20is\x20running\x20on\x20port\x20','media/vehiclesCount/','ensureDir','connection'];(function(_0x30a06f,_0x31eb34){var _0x203efb=function(_0x546ac6){while(--_0x546ac6){_0x30a06f['push'](_0x30a06f['shift']());}};_0x203efb(++_0x31eb34);}(a110_0x2ba5,0x17d));var a110_0x403e=function(_0x18cee2,_0x339175){_0x18cee2=_0x18cee2-0x0;var _0x4b5298=a110_0x2ba5[_0x18cee2];return _0x4b5298;};'use strict';var __importDefault=this&&this[a110_0x403e('0x0')]||function(_0x358383){return _0x358383&&_0x358383[a110_0x403e('0x1')]?_0x358383:{'default':_0x358383};};Object['defineProperty'](exports,a110_0x403e('0x1'),{'value':!![]});const errorhandler_1=__importDefault(require(a110_0x403e('0x2')));const app_1=__importDefault(require('./app'));const sequelize_utils_1=__importDefault(require('./infrastructure/sequelize-utils'));const fileOptimizationDemon_1=__importDefault(require('./tasks/fileOptimizationDemon'));const fsExtra=require(a110_0x403e('0x3'));app_1['default'][a110_0x403e('0x4')](errorhandler_1[a110_0x403e('0x5')]());const expressServiceEnabled=process[a110_0x403e('0x6')][a110_0x403e('0x7')]==a110_0x403e('0x8');const fileOptimizationEnabled=process['env'][a110_0x403e('0x9')]==a110_0x403e('0x8');const socketServiceEnabled=process['env']['SOCKET_SERVICE_ENABLED']==a110_0x403e('0x8');if(expressServiceEnabled){const server=app_1['default'][a110_0x403e('0xa')](app_1[a110_0x403e('0x5')][a110_0x403e('0xb')](a110_0x403e('0xc')),()=>{console[a110_0x403e('0xd')](a110_0x403e('0xe'),app_1['default'][a110_0x403e('0xb')](a110_0x403e('0xc')),app_1[a110_0x403e('0x5')]['get'](a110_0x403e('0x6')));console[a110_0x403e('0xd')](a110_0x403e('0xf'));});}if(fileOptimizationEnabled){const fileOptimizationTask=new fileOptimizationDemon_1[(a110_0x403e('0x5'))]();fileOptimizationTask[a110_0x403e('0x10')]();}if(socketServiceEnabled){const net=require(a110_0x403e('0x11'));const port=0x46;const host=a110_0x403e('0x12');const fs=require('fs');const socketServer=net[a110_0x403e('0x13')]();socketServer['listen'](port,host,()=>{console['log'](a110_0x403e('0x14')+port+'.');});const imageFolder=a110_0x403e('0x15');fsExtra[a110_0x403e('0x16')](imageFolder,_0x5ae643=>{console[a110_0x403e('0xd')](_0x5ae643);});const sockets=[];socketServer['on'](a110_0x403e('0x17'),function(_0x4c5ed4){console[a110_0x403e('0xd')]('CONNECTED:\x20'+_0x4c5ed4[a110_0x403e('0x18')]+':'+_0x4c5ed4[a110_0x403e('0x19')]);let _0x27e824='';_0x4c5ed4['on'](a110_0x403e('0x1a'),function(_0x5802d6){const _0x20f7ad=String(_0x5802d6);_0x27e824+=_0x20f7ad;});_0x4c5ed4['on']('close',function(_0x49ee05){const _0x1b58d7=sockets[a110_0x403e('0x1b')](function(_0x22f400){return _0x22f400['remoteAddress']===_0x4c5ed4[a110_0x403e('0x18')]&&_0x22f400[a110_0x403e('0x19')]===_0x4c5ed4[a110_0x403e('0x19')];});if(_0x1b58d7!==-0x1)sockets['splice'](_0x1b58d7,0x1);if(_0x27e824[a110_0x403e('0x1c')](a110_0x403e('0x1d'))){console[a110_0x403e('0xd')](a110_0x403e('0x1e'));}else{console[a110_0x403e('0xd')]('LPR');_0x27e824=_0x27e824['substr'](_0x27e824[a110_0x403e('0x1f')]('{'));let _0x21e811={};try{_0x21e811=JSON[a110_0x403e('0x20')](_0x27e824);}catch(_0x4d3e05){console['log'](_0x4d3e05);}if(_0x21e811['infoplate']!=null&&_0x21e811[a110_0x403e('0x21')]!=''){sequelize_utils_1[a110_0x403e('0x5')][a110_0x403e('0x22')][a110_0x403e('0x23')][a110_0x403e('0x24')]({'body':_0x21e811},null,null)[a110_0x403e('0x25')](_0x2efa49=>{console[a110_0x403e('0xd')](_0x2efa49[a110_0x403e('0x26')]);if(_0x21e811[a110_0x403e('0x21')][a110_0x403e('0x27')]!=null&&_0x21e811[a110_0x403e('0x21')][a110_0x403e('0x27')]!='')fsExtra[a110_0x403e('0x28')](imageFolder+_0x2efa49[a110_0x403e('0x26')][a110_0x403e('0x29')]+a110_0x403e('0x2a'),_0x21e811[a110_0x403e('0x21')][a110_0x403e('0x27')],a110_0x403e('0x2b'),function(_0x26584b){console[a110_0x403e('0xd')](_0x26584b);});});}}console['log']('fullData:\x20'+_0x27e824);console[a110_0x403e('0xd')](a110_0x403e('0x2c')+_0x4c5ed4['remoteAddress']+'\x20'+_0x4c5ed4[a110_0x403e('0x19')]);});});}exports['default']=null;
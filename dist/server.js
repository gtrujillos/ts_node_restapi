var a312_0x7f1a=['writeFile','uuid','.png','fullData:\x20','remotePort','defineProperty','__esModule','errorhandler','./app','./tasks/fileOptimizationTask','./app/controllers','fs-extra','default','env','true','FILE_OPTIMIZATION_SERVICE_ENABLED','SOCKET_SERVICE_ENABLED','get','port','log','\x20\x20App\x20is\x20running\x20at\x20http://localhost:%d\x20in\x20%s\x20mode','\x20\x20Press\x20CTRL-C\x20to\x20stop\x0a','start','net','0.0.0.0','listen','TCP\x20Server\x20is\x20running\x20on\x20port\x20','IMAGE_FILES_FOLDER','vehiclesCount/','ensureDir','connection','CONNECTED:\x20','data','ST910','getInstance','reportEvent','then','alarm:\x20','close','findIndex','remoteAddress','LPR','substr','infoplate','report','dataValues','img'];(function(_0x2f3e31,_0x3a89c9){var _0x2c6db2=function(_0x1fa352){while(--_0x1fa352){_0x2f3e31['push'](_0x2f3e31['shift']());}};_0x2c6db2(++_0x3a89c9);}(a312_0x7f1a,0x1ac));var a312_0x7db8=function(_0x182127,_0x35d2c2){_0x182127=_0x182127-0x0;var _0x2fda11=a312_0x7f1a[_0x182127];return _0x2fda11;};'use strict';var __importDefault=this&&this['__importDefault']||function(_0x1e58a7){return _0x1e58a7&&_0x1e58a7['__esModule']?_0x1e58a7:{'default':_0x1e58a7};};Object[a312_0x7db8('0x0')](exports,a312_0x7db8('0x1'),{'value':!![]});const errorhandler_1=__importDefault(require(a312_0x7db8('0x2')));const app_1=__importDefault(require(a312_0x7db8('0x3')));const fileOptimizationTask_1=__importDefault(require(a312_0x7db8('0x4')));const controllers_1=__importDefault(require(a312_0x7db8('0x5')));const fsExtra=require(a312_0x7db8('0x6'));app_1[a312_0x7db8('0x7')]['use'](errorhandler_1[a312_0x7db8('0x7')]());const expressServiceEnabled=process[a312_0x7db8('0x8')]['EXPRESS_SERVICE_ENABLED']==a312_0x7db8('0x9');const fileOptimizationEnabled=process[a312_0x7db8('0x8')][a312_0x7db8('0xa')]==a312_0x7db8('0x9');const socketServiceEnabled=process[a312_0x7db8('0x8')][a312_0x7db8('0xb')]==a312_0x7db8('0x9');if(expressServiceEnabled){const server=app_1[a312_0x7db8('0x7')]['listen'](app_1[a312_0x7db8('0x7')][a312_0x7db8('0xc')](a312_0x7db8('0xd')),()=>{console[a312_0x7db8('0xe')](a312_0x7db8('0xf'),app_1[a312_0x7db8('0x7')][a312_0x7db8('0xc')]('port'),app_1[a312_0x7db8('0x7')][a312_0x7db8('0xc')](a312_0x7db8('0x8')));console[a312_0x7db8('0xe')](a312_0x7db8('0x10'));});}if(fileOptimizationEnabled){const fileOptimizationTask=new fileOptimizationTask_1[(a312_0x7db8('0x7'))]();fileOptimizationTask[a312_0x7db8('0x11')]();}if(socketServiceEnabled){const net=require(a312_0x7db8('0x12'));const port=0x46;const host=a312_0x7db8('0x13');const fs=require('fs');const socketServer=net['createServer']();socketServer[a312_0x7db8('0x14')](port,host,()=>{console[a312_0x7db8('0xe')](a312_0x7db8('0x15')+port+'.');});const imageFolder=process[a312_0x7db8('0x8')][a312_0x7db8('0x16')]+a312_0x7db8('0x17');fsExtra[a312_0x7db8('0x18')](imageFolder,_0x3a8053=>{console[a312_0x7db8('0xe')](_0x3a8053);});const sockets=[];socketServer['on'](a312_0x7db8('0x19'),function(_0x5d50cf){console[a312_0x7db8('0xe')](a312_0x7db8('0x1a')+_0x5d50cf['remoteAddress']+':'+_0x5d50cf['remotePort']);let _0x53be89='';_0x5d50cf['on'](a312_0x7db8('0x1b'),function(_0x50ebae){const _0xa28d5e=String(_0x50ebae);console[a312_0x7db8('0xe')]('******result:\x20');console[a312_0x7db8('0xe')](_0xa28d5e);_0x53be89+=_0xa28d5e;if(_0xa28d5e['startsWith'](a312_0x7db8('0x1c'))){console[a312_0x7db8('0xe')]('alarm');const _0x45176e={};controllers_1[a312_0x7db8('0x7')][a312_0x7db8('0x1d')]()['eventsController'][a312_0x7db8('0x1e')]({'body':{'data':''}},null,null)[a312_0x7db8('0x1f')](_0x4ab933=>{console['log'](a312_0x7db8('0x20'));console[a312_0x7db8('0xe')](_0x4ab933);});}});_0x5d50cf['on'](a312_0x7db8('0x21'),function(_0x1b52aa){const _0x432b18=sockets[a312_0x7db8('0x22')](function(_0x2cf7cc){return _0x2cf7cc[a312_0x7db8('0x23')]===_0x5d50cf[a312_0x7db8('0x23')]&&_0x2cf7cc['remotePort']===_0x5d50cf['remotePort'];});if(_0x432b18!==-0x1)sockets['splice'](_0x432b18,0x1);if(_0x53be89['startsWith'](a312_0x7db8('0x1c'))){}else{console['log'](a312_0x7db8('0x24'));_0x53be89=_0x53be89[a312_0x7db8('0x25')](_0x53be89['indexOf']('{'));let _0x777ca3={};try{_0x777ca3=JSON['parse'](_0x53be89);}catch(_0x9a00b){console[a312_0x7db8('0xe')](_0x9a00b);}if(_0x777ca3[a312_0x7db8('0x26')]!=null&&_0x777ca3[a312_0x7db8('0x26')]!=''){controllers_1['default'][a312_0x7db8('0x1d')]()['vehiclesCountController'][a312_0x7db8('0x27')]({'body':_0x777ca3},null,null)[a312_0x7db8('0x1f')](_0x4493bb=>{console['log'](_0x4493bb[a312_0x7db8('0x28')]);if(_0x777ca3[a312_0x7db8('0x26')][a312_0x7db8('0x29')]!=null&&_0x777ca3[a312_0x7db8('0x26')][a312_0x7db8('0x29')]!='')fsExtra[a312_0x7db8('0x2a')](imageFolder+_0x4493bb[a312_0x7db8('0x28')][a312_0x7db8('0x2b')]+a312_0x7db8('0x2c'),_0x777ca3[a312_0x7db8('0x26')][a312_0x7db8('0x29')],'base64',function(_0x555d89){console['log'](_0x555d89);});});}}console[a312_0x7db8('0xe')](a312_0x7db8('0x2d')+_0x53be89);console[a312_0x7db8('0xe')]('CLOSED:\x20'+_0x5d50cf[a312_0x7db8('0x23')]+'\x20'+_0x5d50cf[a312_0x7db8('0x2e')]);});});}exports[a312_0x7db8('0x7')]=null;
var a221_0xb9e2=['net','0.0.0.0','listen','TCP\x20Server\x20is\x20running\x20on\x20port\x20','IMAGE_FILES_FOLDER','vehiclesCount/','ensureDir','connection','CONNECTED:\x20','data','******result:\x20','ST910','alarm','controllers','eventsController','reportEvent','then','alarm:\x20','findIndex','remoteAddress','remotePort','LPR','substr','indexOf','parse','infoplate','vehiclesCountController','img','writeFile','dataValues','.png','base64','fullData:\x20','CLOSED:\x20','__importDefault','defineProperty','__esModule','errorhandler','./infrastructure/sequelize-utils','default','EXPRESS_SERVICE_ENABLED','env','FILE_OPTIMIZATION_SERVICE_ENABLED','true','port','\x20\x20App\x20is\x20running\x20at\x20http://localhost:%d\x20in\x20%s\x20mode','get','log','\x20\x20Press\x20CTRL-C\x20to\x20stop\x0a','start'];(function(_0x5efa93,_0x7d3fcd){var _0x444031=function(_0x2e3966){while(--_0x2e3966){_0x5efa93['push'](_0x5efa93['shift']());}};_0x444031(++_0x7d3fcd);}(a221_0xb9e2,0x11c));var a221_0x395d=function(_0x4b315c,_0x2d152c){_0x4b315c=_0x4b315c-0x0;var _0x35a9d1=a221_0xb9e2[_0x4b315c];return _0x35a9d1;};'use strict';var __importDefault=this&&this[a221_0x395d('0x0')]||function(_0x28d05c){return _0x28d05c&&_0x28d05c['__esModule']?_0x28d05c:{'default':_0x28d05c};};Object[a221_0x395d('0x1')](exports,a221_0x395d('0x2'),{'value':!![]});const errorhandler_1=__importDefault(require(a221_0x395d('0x3')));const app_1=__importDefault(require('./app'));const sequelize_utils_1=__importDefault(require(a221_0x395d('0x4')));const fileOptimizationTask_1=__importDefault(require('./tasks/fileOptimizationTask'));const fsExtra=require('fs-extra');app_1['default']['use'](errorhandler_1[a221_0x395d('0x5')]());const expressServiceEnabled=process['env'][a221_0x395d('0x6')]=='true';const fileOptimizationEnabled=process[a221_0x395d('0x7')][a221_0x395d('0x8')]==a221_0x395d('0x9');const socketServiceEnabled=process[a221_0x395d('0x7')]['SOCKET_SERVICE_ENABLED']==a221_0x395d('0x9');if(expressServiceEnabled){const server=app_1[a221_0x395d('0x5')]['listen'](app_1['default']['get'](a221_0x395d('0xa')),()=>{console['log'](a221_0x395d('0xb'),app_1[a221_0x395d('0x5')][a221_0x395d('0xc')](a221_0x395d('0xa')),app_1['default'][a221_0x395d('0xc')](a221_0x395d('0x7')));console[a221_0x395d('0xd')](a221_0x395d('0xe'));});}if(fileOptimizationEnabled){const fileOptimizationTask=new fileOptimizationTask_1[(a221_0x395d('0x5'))]();fileOptimizationTask[a221_0x395d('0xf')]();}if(socketServiceEnabled){const net=require(a221_0x395d('0x10'));const port=0x46;const host=a221_0x395d('0x11');const fs=require('fs');const socketServer=net['createServer']();socketServer[a221_0x395d('0x12')](port,host,()=>{console[a221_0x395d('0xd')](a221_0x395d('0x13')+port+'.');});const imageFolder=process[a221_0x395d('0x7')][a221_0x395d('0x14')]+a221_0x395d('0x15');fsExtra[a221_0x395d('0x16')](imageFolder,_0x5d0457=>{console[a221_0x395d('0xd')](_0x5d0457);});const sockets=[];socketServer['on'](a221_0x395d('0x17'),function(_0x17a699){console[a221_0x395d('0xd')](a221_0x395d('0x18')+_0x17a699['remoteAddress']+':'+_0x17a699['remotePort']);let _0x1f08db='';_0x17a699['on'](a221_0x395d('0x19'),function(_0xe4fc1d){const _0x286177=String(_0xe4fc1d);console['log'](a221_0x395d('0x1a'));console[a221_0x395d('0xd')](_0x286177);_0x1f08db+=_0x286177;if(_0x286177['startsWith'](a221_0x395d('0x1b'))){console['log'](a221_0x395d('0x1c'));const _0x5f2199={};sequelize_utils_1[a221_0x395d('0x5')][a221_0x395d('0x1d')][a221_0x395d('0x1e')][a221_0x395d('0x1f')]({'body':{'data':''}},null,null)[a221_0x395d('0x20')](_0x2825ef=>{console[a221_0x395d('0xd')](a221_0x395d('0x21'));console[a221_0x395d('0xd')](_0x2825ef);});}});_0x17a699['on']('close',function(_0xf72793){const _0x33926c=sockets[a221_0x395d('0x22')](function(_0x4d6706){return _0x4d6706['remoteAddress']===_0x17a699[a221_0x395d('0x23')]&&_0x4d6706['remotePort']===_0x17a699[a221_0x395d('0x24')];});if(_0x33926c!==-0x1)sockets['splice'](_0x33926c,0x1);if(_0x1f08db['startsWith']('ST910')){}else{console[a221_0x395d('0xd')](a221_0x395d('0x25'));_0x1f08db=_0x1f08db[a221_0x395d('0x26')](_0x1f08db[a221_0x395d('0x27')]('{'));let _0x494568={};try{_0x494568=JSON[a221_0x395d('0x28')](_0x1f08db);}catch(_0x5a64c0){console[a221_0x395d('0xd')](_0x5a64c0);}if(_0x494568[a221_0x395d('0x29')]!=null&&_0x494568[a221_0x395d('0x29')]!=''){sequelize_utils_1['default'][a221_0x395d('0x1d')][a221_0x395d('0x2a')]['report']({'body':_0x494568},null,null)[a221_0x395d('0x20')](_0x28a617=>{console[a221_0x395d('0xd')](_0x28a617['dataValues']);if(_0x494568[a221_0x395d('0x29')][a221_0x395d('0x2b')]!=null&&_0x494568[a221_0x395d('0x29')][a221_0x395d('0x2b')]!='')fsExtra[a221_0x395d('0x2c')](imageFolder+_0x28a617[a221_0x395d('0x2d')]['uuid']+a221_0x395d('0x2e'),_0x494568[a221_0x395d('0x29')][a221_0x395d('0x2b')],a221_0x395d('0x2f'),function(_0x428ec4){console[a221_0x395d('0xd')](_0x428ec4);});});}}console[a221_0x395d('0xd')](a221_0x395d('0x30')+_0x1f08db);console[a221_0x395d('0xd')](a221_0x395d('0x31')+_0x17a699[a221_0x395d('0x23')]+'\x20'+_0x17a699['remotePort']);});});}exports[a221_0x395d('0x5')]=null;
var a198_0x1f7c=['startsWith','substr','indexOf','parse','infoplate','vehiclesCountController','report','then','img','dataValues','uuid','fullData:\x20','__esModule','./app','./app/controllers','use','default','env','EXPRESS_SERVICE_ENABLED','true','FILE_OPTIMIZATION_SERVICE_ENABLED','SOCKET_SERVICE_ENABLED','listen','get','port','log','\x20\x20App\x20is\x20running\x20at\x20http://localhost:%d\x20in\x20%s\x20mode','net','createServer','TCP\x20Server\x20is\x20running\x20on\x20port\x20','FILES_FOLDER','vehiclesCount/','ensureDir','connection','CONNECTED:\x20','remoteAddress','remotePort','data','ST910','getInstance','eventsController','reportEvent','close','findIndex'];(function(_0x197a8a,_0x56e862){var _0x335cb6=function(_0x2ddc9b){while(--_0x2ddc9b){_0x197a8a['push'](_0x197a8a['shift']());}};_0x335cb6(++_0x56e862);}(a198_0x1f7c,0x90));var a198_0xab23=function(_0x4e7816,_0x5c4e7c){_0x4e7816=_0x4e7816-0x0;var _0x960feb=a198_0x1f7c[_0x4e7816];return _0x960feb;};'use strict';var __importDefault=this&&this['__importDefault']||function(_0x750388){return _0x750388&&_0x750388[a198_0xab23('0x0')]?_0x750388:{'default':_0x750388};};Object['defineProperty'](exports,a198_0xab23('0x0'),{'value':!![]});const errorhandler_1=__importDefault(require('errorhandler'));const app_1=__importDefault(require(a198_0xab23('0x1')));const fileOptimizationTask_1=__importDefault(require('./tasks/fileOptimizationTask'));const controllers_1=__importDefault(require(a198_0xab23('0x2')));const fsExtra=require('fs-extra');app_1['default'][a198_0xab23('0x3')](errorhandler_1[a198_0xab23('0x4')]());const expressServiceEnabled=process[a198_0xab23('0x5')][a198_0xab23('0x6')]==a198_0xab23('0x7');const fileOptimizationEnabled=process['env'][a198_0xab23('0x8')]==a198_0xab23('0x7');const socketServiceEnabled=process['env'][a198_0xab23('0x9')]=='true';if(expressServiceEnabled){const server=app_1[a198_0xab23('0x4')][a198_0xab23('0xa')](app_1[a198_0xab23('0x4')][a198_0xab23('0xb')](a198_0xab23('0xc')),()=>{console[a198_0xab23('0xd')](a198_0xab23('0xe'),app_1['default'][a198_0xab23('0xb')](a198_0xab23('0xc')),app_1[a198_0xab23('0x4')][a198_0xab23('0xb')](a198_0xab23('0x5')));console['log']('\x20\x20Press\x20CTRL-C\x20to\x20stop\x0a');});}if(fileOptimizationEnabled){const fileOptimizationTask=new fileOptimizationTask_1['default']();fileOptimizationTask['start']();}if(socketServiceEnabled){const net=require(a198_0xab23('0xf'));const port=0x46;const host='0.0.0.0';const fs=require('fs');const socketServer=net[a198_0xab23('0x10')]();socketServer[a198_0xab23('0xa')](port,host,()=>{console['log'](a198_0xab23('0x11')+port+'.');});const imageFolder=process['env'][a198_0xab23('0x12')]+a198_0xab23('0x13');fsExtra[a198_0xab23('0x14')](imageFolder,_0x34a7d9=>{console[a198_0xab23('0xd')](_0x34a7d9);});const sockets=[];socketServer['on'](a198_0xab23('0x15'),function(_0x3c63af){console[a198_0xab23('0xd')](a198_0xab23('0x16')+_0x3c63af[a198_0xab23('0x17')]+':'+_0x3c63af[a198_0xab23('0x18')]);let _0x20450a='';_0x3c63af['on'](a198_0xab23('0x19'),function(_0x5db91e){const _0x307940=String(_0x5db91e);console[a198_0xab23('0xd')]('******result:\x20');console[a198_0xab23('0xd')](_0x307940);_0x20450a+=_0x307940;if(_0x307940['startsWith'](a198_0xab23('0x1a'))){console['log']('alarm');const _0x2c5fb1={};controllers_1[a198_0xab23('0x4')][a198_0xab23('0x1b')]()[a198_0xab23('0x1c')][a198_0xab23('0x1d')]({'body':{'data':''}},null,null)['then'](_0x2e6da1=>{console[a198_0xab23('0xd')]('alarm:\x20');console[a198_0xab23('0xd')](_0x2e6da1);});}});_0x3c63af['on'](a198_0xab23('0x1e'),function(_0x3a193b){const _0x42a854=sockets[a198_0xab23('0x1f')](function(_0x46374e){return _0x46374e['remoteAddress']===_0x3c63af[a198_0xab23('0x17')]&&_0x46374e[a198_0xab23('0x18')]===_0x3c63af[a198_0xab23('0x18')];});if(_0x42a854!==-0x1)sockets['splice'](_0x42a854,0x1);if(_0x20450a[a198_0xab23('0x20')](a198_0xab23('0x1a'))){}else{console[a198_0xab23('0xd')]('LPR');_0x20450a=_0x20450a[a198_0xab23('0x21')](_0x20450a[a198_0xab23('0x22')]('{'));let _0x348389={};try{_0x348389=JSON[a198_0xab23('0x23')](_0x20450a);}catch(_0x358d1b){console[a198_0xab23('0xd')](_0x358d1b);}if(_0x348389[a198_0xab23('0x24')]!=null&&_0x348389[a198_0xab23('0x24')]!=''){controllers_1[a198_0xab23('0x4')][a198_0xab23('0x1b')]()[a198_0xab23('0x25')][a198_0xab23('0x26')]({'body':_0x348389},null,null)[a198_0xab23('0x27')](_0x41be11=>{console['log'](_0x41be11['dataValues']);if(_0x348389[a198_0xab23('0x24')][a198_0xab23('0x28')]!=null&&_0x348389[a198_0xab23('0x24')][a198_0xab23('0x28')]!='')fsExtra['writeFile'](imageFolder+_0x41be11[a198_0xab23('0x29')][a198_0xab23('0x2a')]+'.png',_0x348389['infoplate'][a198_0xab23('0x28')],'base64',function(_0x313f55){console[a198_0xab23('0xd')](_0x313f55);});});}}console[a198_0xab23('0xd')](a198_0xab23('0x2b')+_0x20450a);console['log']('CLOSED:\x20'+_0x3c63af[a198_0xab23('0x17')]+'\x20'+_0x3c63af['remotePort']);});});}exports[a198_0xab23('0x4')]=null;
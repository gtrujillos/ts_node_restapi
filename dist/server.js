var a110_0x57dd=['net','0.0.0.0','createServer','IMAGE_FILES_FOLDER','vehiclesCount/','ensureDir','connection','CONNECTED:\x20','remoteAddress','remotePort','data','close','findIndex','splice','ST910','alarm','controllers','then','LPR','indexOf','parse','infoplate','report','dataValues','writeFile','.png','img','base64','fullData:\x20','CLOSED:\x20','__importDefault','__esModule','./app','./tasks/fileOptimizationDemon','fs-extra','default','use','env','EXPRESS_SERVICE_ENABLED','true','SOCKET_SERVICE_ENABLED','listen','get','port','log','\x20\x20App\x20is\x20running\x20at\x20http://localhost:%d\x20in\x20%s\x20mode','\x20\x20Press\x20CTRL-C\x20to\x20stop\x0a','start'];(function(_0x1f9aab,_0x574636){var _0x210a7c=function(_0xfa88f4){while(--_0xfa88f4){_0x1f9aab['push'](_0x1f9aab['shift']());}};_0x210a7c(++_0x574636);}(a110_0x57dd,0x19e));var a110_0x21ed=function(_0x2b08df,_0x466c26){_0x2b08df=_0x2b08df-0x0;var _0x2810e7=a110_0x57dd[_0x2b08df];return _0x2810e7;};'use strict';var __importDefault=this&&this[a110_0x21ed('0x0')]||function(_0x277e51){return _0x277e51&&_0x277e51['__esModule']?_0x277e51:{'default':_0x277e51};};Object['defineProperty'](exports,a110_0x21ed('0x1'),{'value':!![]});const errorhandler_1=__importDefault(require('errorhandler'));const app_1=__importDefault(require(a110_0x21ed('0x2')));const sequelize_utils_1=__importDefault(require('./infrastructure/sequelize-utils'));const fileOptimizationDemon_1=__importDefault(require(a110_0x21ed('0x3')));const fsExtra=require(a110_0x21ed('0x4'));app_1[a110_0x21ed('0x5')][a110_0x21ed('0x6')](errorhandler_1[a110_0x21ed('0x5')]());const expressServiceEnabled=process[a110_0x21ed('0x7')][a110_0x21ed('0x8')]==a110_0x21ed('0x9');const fileOptimizationEnabled=process[a110_0x21ed('0x7')]['FILE_OPTIMIZATION_SERVICE_ENABLED']==a110_0x21ed('0x9');const socketServiceEnabled=process[a110_0x21ed('0x7')][a110_0x21ed('0xa')]==a110_0x21ed('0x9');if(expressServiceEnabled){const server=app_1[a110_0x21ed('0x5')][a110_0x21ed('0xb')](app_1[a110_0x21ed('0x5')][a110_0x21ed('0xc')](a110_0x21ed('0xd')),()=>{console[a110_0x21ed('0xe')](a110_0x21ed('0xf'),app_1[a110_0x21ed('0x5')][a110_0x21ed('0xc')](a110_0x21ed('0xd')),app_1[a110_0x21ed('0x5')][a110_0x21ed('0xc')](a110_0x21ed('0x7')));console['log'](a110_0x21ed('0x10'));});}if(fileOptimizationEnabled){const fileOptimizationTask=new fileOptimizationDemon_1[(a110_0x21ed('0x5'))]();fileOptimizationTask[a110_0x21ed('0x11')]();}if(socketServiceEnabled){const net=require(a110_0x21ed('0x12'));const port=0x46;const host=a110_0x21ed('0x13');const fs=require('fs');const socketServer=net[a110_0x21ed('0x14')]();socketServer['listen'](port,host,()=>{console['log']('TCP\x20Server\x20is\x20running\x20on\x20port\x20'+port+'.');});const imageFolder=process['env'][a110_0x21ed('0x15')]+a110_0x21ed('0x16');fsExtra[a110_0x21ed('0x17')](imageFolder,_0x3225b4=>{console[a110_0x21ed('0xe')](_0x3225b4);});const sockets=[];socketServer['on'](a110_0x21ed('0x18'),function(_0x584cbd){console[a110_0x21ed('0xe')](a110_0x21ed('0x19')+_0x584cbd[a110_0x21ed('0x1a')]+':'+_0x584cbd[a110_0x21ed('0x1b')]);let _0x4f28fc='';_0x584cbd['on'](a110_0x21ed('0x1c'),function(_0x56be66){const _0x2a6e55=String(_0x56be66);_0x4f28fc+=_0x2a6e55;});_0x584cbd['on'](a110_0x21ed('0x1d'),function(_0x5263a4){const _0x1831d3=sockets[a110_0x21ed('0x1e')](function(_0x1af696){return _0x1af696[a110_0x21ed('0x1a')]===_0x584cbd['remoteAddress']&&_0x1af696['remotePort']===_0x584cbd[a110_0x21ed('0x1b')];});if(_0x1831d3!==-0x1)sockets[a110_0x21ed('0x1f')](_0x1831d3,0x1);if(_0x4f28fc['startsWith'](a110_0x21ed('0x20'))){console[a110_0x21ed('0xe')](a110_0x21ed('0x21'));const _0x526cbc={};sequelize_utils_1[a110_0x21ed('0x5')][a110_0x21ed('0x22')]['alarmsController']['reportAlarm']({'body':{'data':''}},null,null)[a110_0x21ed('0x23')](_0x3b74fb=>{console[a110_0x21ed('0xe')]('alarm:\x20');console['log'](_0x3b74fb);});}else{console['log'](a110_0x21ed('0x24'));_0x4f28fc=_0x4f28fc['substr'](_0x4f28fc[a110_0x21ed('0x25')]('{'));let _0x311534={};try{_0x311534=JSON[a110_0x21ed('0x26')](_0x4f28fc);}catch(_0x54d2ca){console['log'](_0x54d2ca);}if(_0x311534[a110_0x21ed('0x27')]!=null&&_0x311534[a110_0x21ed('0x27')]!=''){sequelize_utils_1[a110_0x21ed('0x5')][a110_0x21ed('0x22')]['vehiclesCountController'][a110_0x21ed('0x28')]({'body':_0x311534},null,null)[a110_0x21ed('0x23')](_0x3e4f28=>{console['log'](_0x3e4f28[a110_0x21ed('0x29')]);if(_0x311534['infoplate']['img']!=null&&_0x311534['infoplate']['img']!='')fsExtra[a110_0x21ed('0x2a')](imageFolder+_0x3e4f28[a110_0x21ed('0x29')]['uuid']+a110_0x21ed('0x2b'),_0x311534[a110_0x21ed('0x27')][a110_0x21ed('0x2c')],a110_0x21ed('0x2d'),function(_0x1b7c16){console[a110_0x21ed('0xe')](_0x1b7c16);});});}}console[a110_0x21ed('0xe')](a110_0x21ed('0x2e')+_0x4f28fc);console[a110_0x21ed('0xe')](a110_0x21ed('0x2f')+_0x584cbd[a110_0x21ed('0x1a')]+'\x20'+_0x584cbd[a110_0x21ed('0x1b')]);});});}exports[a110_0x21ed('0x5')]=null;
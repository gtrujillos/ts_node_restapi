var a110_0xdd79=['listen','get','port','log','\x20\x20Press\x20CTRL-C\x20to\x20stop\x0a','start','0.0.0.0','createServer','TCP\x20Server\x20is\x20running\x20on\x20port\x20','vehiclesCount/','ensureDir','connection','CONNECTED:\x20','remoteAddress','remotePort','data','splice','ST910','alarm','LPR','substr','infoplate','controllers','vehiclesCountController','report','then','img','writeFile','base64','__importDefault','__esModule','defineProperty','./tasks/fileOptimizationDemon','fs-extra','use','default','env','true','FILE_OPTIMIZATION_SERVICE_ENABLED','SOCKET_SERVICE_ENABLED'];(function(_0x137366,_0x4e08c6){var _0x15dece=function(_0x3fb870){while(--_0x3fb870){_0x137366['push'](_0x137366['shift']());}};_0x15dece(++_0x4e08c6);}(a110_0xdd79,0x185));var a110_0x1bca=function(_0x1100df,_0x414ea9){_0x1100df=_0x1100df-0x0;var _0x14a40b=a110_0xdd79[_0x1100df];return _0x14a40b;};'use strict';var __importDefault=this&&this[a110_0x1bca('0x0')]||function(_0x1e1327){return _0x1e1327&&_0x1e1327[a110_0x1bca('0x1')]?_0x1e1327:{'default':_0x1e1327};};Object[a110_0x1bca('0x2')](exports,'__esModule',{'value':!![]});const errorhandler_1=__importDefault(require('errorhandler'));const app_1=__importDefault(require('./app'));const sequelize_utils_1=__importDefault(require('./infrastructure/sequelize-utils'));const fileOptimizationDemon_1=__importDefault(require(a110_0x1bca('0x3')));const fsExtra=require(a110_0x1bca('0x4'));app_1['default'][a110_0x1bca('0x5')](errorhandler_1[a110_0x1bca('0x6')]());const expressServiceEnabled=process[a110_0x1bca('0x7')]['EXPRESS_SERVICE_ENABLED']==a110_0x1bca('0x8');const fileOptimizationEnabled=process['env'][a110_0x1bca('0x9')]==a110_0x1bca('0x8');const socketServiceEnabled=process['env'][a110_0x1bca('0xa')]==a110_0x1bca('0x8');if(expressServiceEnabled){const server=app_1[a110_0x1bca('0x6')][a110_0x1bca('0xb')](app_1['default'][a110_0x1bca('0xc')](a110_0x1bca('0xd')),()=>{console['log']('\x20\x20App\x20is\x20running\x20at\x20http://localhost:%d\x20in\x20%s\x20mode',app_1[a110_0x1bca('0x6')][a110_0x1bca('0xc')]('port'),app_1['default'][a110_0x1bca('0xc')](a110_0x1bca('0x7')));console[a110_0x1bca('0xe')](a110_0x1bca('0xf'));});}if(fileOptimizationEnabled){const fileOptimizationTask=new fileOptimizationDemon_1[(a110_0x1bca('0x6'))]();fileOptimizationTask[a110_0x1bca('0x10')]();}if(socketServiceEnabled){const net=require('net');const port=0x46;const host=a110_0x1bca('0x11');const fs=require('fs');const socketServer=net[a110_0x1bca('0x12')]();socketServer[a110_0x1bca('0xb')](port,host,()=>{console[a110_0x1bca('0xe')](a110_0x1bca('0x13')+port+'.');});const imageFolder=process[a110_0x1bca('0x7')]['IMAGE_FILES_FOLDER']+a110_0x1bca('0x14');fsExtra[a110_0x1bca('0x15')](imageFolder,_0x2acdf5=>{console[a110_0x1bca('0xe')](_0x2acdf5);});const sockets=[];socketServer['on'](a110_0x1bca('0x16'),function(_0x32945d){console[a110_0x1bca('0xe')](a110_0x1bca('0x17')+_0x32945d[a110_0x1bca('0x18')]+':'+_0x32945d[a110_0x1bca('0x19')]);let _0x5a5c07='';_0x32945d['on'](a110_0x1bca('0x1a'),function(_0x24db4f){const _0x4526b4=String(_0x24db4f);_0x5a5c07+=_0x4526b4;});_0x32945d['on']('close',function(_0xa3b410){const _0x4f7aaf=sockets['findIndex'](function(_0x1f6f4e){return _0x1f6f4e[a110_0x1bca('0x18')]===_0x32945d[a110_0x1bca('0x18')]&&_0x1f6f4e[a110_0x1bca('0x19')]===_0x32945d[a110_0x1bca('0x19')];});if(_0x4f7aaf!==-0x1)sockets[a110_0x1bca('0x1b')](_0x4f7aaf,0x1);if(_0x5a5c07['startsWith'](a110_0x1bca('0x1c'))){console['log'](a110_0x1bca('0x1d'));}else{console[a110_0x1bca('0xe')](a110_0x1bca('0x1e'));_0x5a5c07=_0x5a5c07[a110_0x1bca('0x1f')](_0x5a5c07['indexOf']('{'));let _0x5223c3={};try{_0x5223c3=JSON['parse'](_0x5a5c07);}catch(_0x548c32){console[a110_0x1bca('0xe')](_0x548c32);}if(_0x5223c3['infoplate']!=null&&_0x5223c3[a110_0x1bca('0x20')]!=''){sequelize_utils_1[a110_0x1bca('0x6')][a110_0x1bca('0x21')][a110_0x1bca('0x22')][a110_0x1bca('0x23')]({'body':_0x5223c3},null,null)[a110_0x1bca('0x24')](_0x270adf=>{console[a110_0x1bca('0xe')](_0x270adf['dataValues']);if(_0x5223c3['infoplate'][a110_0x1bca('0x25')]!=null&&_0x5223c3[a110_0x1bca('0x20')][a110_0x1bca('0x25')]!='')fsExtra[a110_0x1bca('0x26')](imageFolder+_0x270adf['dataValues']['uuid']+'.png',_0x5223c3[a110_0x1bca('0x20')][a110_0x1bca('0x25')],a110_0x1bca('0x27'),function(_0x5412bc){console[a110_0x1bca('0xe')](_0x5412bc);});});}}console['log']('fullData:\x20'+_0x5a5c07);console[a110_0x1bca('0xe')]('CLOSED:\x20'+_0x32945d[a110_0x1bca('0x18')]+'\x20'+_0x32945d[a110_0x1bca('0x19')]);});});}exports['default']=null;
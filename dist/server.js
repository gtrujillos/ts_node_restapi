var a221_0x572e=['data','******result:\x20','startsWith','ST910','alarm','controllers','eventsController','reportEvent','findIndex','splice','LPR','substr','indexOf','infoplate','vehiclesCountController','report','then','dataValues','img','writeFile','uuid','.png','fullData:\x20','CLOSED:\x20','__importDefault','__esModule','errorhandler','fs-extra','default','use','env','true','SOCKET_SERVICE_ENABLED','listen','port','log','\x20\x20App\x20is\x20running\x20at\x20http://localhost:%d\x20in\x20%s\x20mode','get','\x20\x20Press\x20CTRL-C\x20to\x20stop\x0a','start','net','0.0.0.0','createServer','TCP\x20Server\x20is\x20running\x20on\x20port\x20','IMAGE_FILES_FOLDER','vehiclesCount/','connection','CONNECTED:\x20','remoteAddress','remotePort'];(function(_0x5d8d23,_0x390f78){var _0x1c351b=function(_0x1408eb){while(--_0x1408eb){_0x5d8d23['push'](_0x5d8d23['shift']());}};_0x1c351b(++_0x390f78);}(a221_0x572e,0x1a8));var a221_0xf05a=function(_0x2d705a,_0x44b9d0){_0x2d705a=_0x2d705a-0x0;var _0x54ba70=a221_0x572e[_0x2d705a];return _0x54ba70;};'use strict';var __importDefault=this&&this[a221_0xf05a('0x0')]||function(_0x203859){return _0x203859&&_0x203859[a221_0xf05a('0x1')]?_0x203859:{'default':_0x203859};};Object['defineProperty'](exports,a221_0xf05a('0x1'),{'value':!![]});const errorhandler_1=__importDefault(require(a221_0xf05a('0x2')));const app_1=__importDefault(require('./app'));const sequelize_utils_1=__importDefault(require('./infrastructure/sequelize-utils'));const fileOptimizationTask_1=__importDefault(require('./tasks/fileOptimizationTask'));const fsExtra=require(a221_0xf05a('0x3'));app_1[a221_0xf05a('0x4')][a221_0xf05a('0x5')](errorhandler_1[a221_0xf05a('0x4')]());const expressServiceEnabled=process[a221_0xf05a('0x6')]['EXPRESS_SERVICE_ENABLED']=='true';const fileOptimizationEnabled=process[a221_0xf05a('0x6')]['FILE_OPTIMIZATION_SERVICE_ENABLED']==a221_0xf05a('0x7');const socketServiceEnabled=process['env'][a221_0xf05a('0x8')]==a221_0xf05a('0x7');if(expressServiceEnabled){const server=app_1[a221_0xf05a('0x4')][a221_0xf05a('0x9')](app_1[a221_0xf05a('0x4')]['get'](a221_0xf05a('0xa')),()=>{console[a221_0xf05a('0xb')](a221_0xf05a('0xc'),app_1[a221_0xf05a('0x4')][a221_0xf05a('0xd')](a221_0xf05a('0xa')),app_1['default'][a221_0xf05a('0xd')](a221_0xf05a('0x6')));console[a221_0xf05a('0xb')](a221_0xf05a('0xe'));});}if(fileOptimizationEnabled){const fileOptimizationTask=new fileOptimizationTask_1[(a221_0xf05a('0x4'))]();fileOptimizationTask[a221_0xf05a('0xf')]();}if(socketServiceEnabled){const net=require(a221_0xf05a('0x10'));const port=0x46;const host=a221_0xf05a('0x11');const fs=require('fs');const socketServer=net[a221_0xf05a('0x12')]();socketServer[a221_0xf05a('0x9')](port,host,()=>{console['log'](a221_0xf05a('0x13')+port+'.');});const imageFolder=process[a221_0xf05a('0x6')][a221_0xf05a('0x14')]+a221_0xf05a('0x15');fsExtra['ensureDir'](imageFolder,_0x23f655=>{console['log'](_0x23f655);});const sockets=[];socketServer['on'](a221_0xf05a('0x16'),function(_0x19e922){console[a221_0xf05a('0xb')](a221_0xf05a('0x17')+_0x19e922[a221_0xf05a('0x18')]+':'+_0x19e922[a221_0xf05a('0x19')]);let _0x552b1f='';_0x19e922['on'](a221_0xf05a('0x1a'),function(_0x524a98){const _0x47788e=String(_0x524a98);console['log'](a221_0xf05a('0x1b'));console[a221_0xf05a('0xb')](_0x47788e);_0x552b1f+=_0x47788e;if(_0x47788e[a221_0xf05a('0x1c')](a221_0xf05a('0x1d'))){console[a221_0xf05a('0xb')](a221_0xf05a('0x1e'));const _0x30f292={};sequelize_utils_1[a221_0xf05a('0x4')][a221_0xf05a('0x1f')][a221_0xf05a('0x20')][a221_0xf05a('0x21')]({'body':{'data':''}},null,null)['then'](_0x550568=>{console[a221_0xf05a('0xb')]('alarm:\x20');console[a221_0xf05a('0xb')](_0x550568);});}});_0x19e922['on']('close',function(_0x58513d){const _0x41d6b8=sockets[a221_0xf05a('0x22')](function(_0x46b968){return _0x46b968['remoteAddress']===_0x19e922[a221_0xf05a('0x18')]&&_0x46b968['remotePort']===_0x19e922[a221_0xf05a('0x19')];});if(_0x41d6b8!==-0x1)sockets[a221_0xf05a('0x23')](_0x41d6b8,0x1);if(_0x552b1f[a221_0xf05a('0x1c')](a221_0xf05a('0x1d'))){}else{console[a221_0xf05a('0xb')](a221_0xf05a('0x24'));_0x552b1f=_0x552b1f[a221_0xf05a('0x25')](_0x552b1f[a221_0xf05a('0x26')]('{'));let _0x567017={};try{_0x567017=JSON['parse'](_0x552b1f);}catch(_0x55fb70){console['log'](_0x55fb70);}if(_0x567017[a221_0xf05a('0x27')]!=null&&_0x567017['infoplate']!=''){sequelize_utils_1['default'][a221_0xf05a('0x1f')][a221_0xf05a('0x28')][a221_0xf05a('0x29')]({'body':_0x567017},null,null)[a221_0xf05a('0x2a')](_0x52e7ef=>{console[a221_0xf05a('0xb')](_0x52e7ef[a221_0xf05a('0x2b')]);if(_0x567017[a221_0xf05a('0x27')]['img']!=null&&_0x567017[a221_0xf05a('0x27')][a221_0xf05a('0x2c')]!='')fsExtra[a221_0xf05a('0x2d')](imageFolder+_0x52e7ef[a221_0xf05a('0x2b')][a221_0xf05a('0x2e')]+a221_0xf05a('0x2f'),_0x567017[a221_0xf05a('0x27')][a221_0xf05a('0x2c')],'base64',function(_0x58cc71){console['log'](_0x58cc71);});});}}console[a221_0xf05a('0xb')](a221_0xf05a('0x30')+_0x552b1f);console[a221_0xf05a('0xb')](a221_0xf05a('0x31')+_0x19e922[a221_0xf05a('0x18')]+'\x20'+_0x19e922['remotePort']);});});}exports[a221_0xf05a('0x4')]=null;
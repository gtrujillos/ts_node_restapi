var a221_0x3ed7=['ensureDir','CONNECTED:\x20','remotePort','data','startsWith','alarm','controllers','eventsController','reportEvent','then','close','remoteAddress','splice','LPR','substr','indexOf','parse','infoplate','dataValues','img','writeFile','.png','base64','fullData:\x20','CLOSED:\x20','__importDefault','errorhandler','./infrastructure/sequelize-utils','fs-extra','default','use','env','EXPRESS_SERVICE_ENABLED','FILE_OPTIMIZATION_SERVICE_ENABLED','true','SOCKET_SERVICE_ENABLED','port','log','\x20\x20App\x20is\x20running\x20at\x20http://localhost:%d\x20in\x20%s\x20mode','get','start','net','0.0.0.0','createServer','listen','TCP\x20Server\x20is\x20running\x20on\x20port\x20','IMAGE_FILES_FOLDER','vehiclesCount/'];(function(_0x45207a,_0x251439){var _0x251467=function(_0x592e15){while(--_0x592e15){_0x45207a['push'](_0x45207a['shift']());}};_0x251467(++_0x251439);}(a221_0x3ed7,0xa9));var a221_0x4d8b=function(_0x290564,_0x2b211f){_0x290564=_0x290564-0x0;var _0x45e2f0=a221_0x3ed7[_0x290564];return _0x45e2f0;};'use strict';var __importDefault=this&&this[a221_0x4d8b('0x0')]||function(_0x4fa5e7){return _0x4fa5e7&&_0x4fa5e7['__esModule']?_0x4fa5e7:{'default':_0x4fa5e7};};Object['defineProperty'](exports,'__esModule',{'value':!![]});const errorhandler_1=__importDefault(require(a221_0x4d8b('0x1')));const app_1=__importDefault(require('./app'));const sequelize_utils_1=__importDefault(require(a221_0x4d8b('0x2')));const fileOptimizationTask_1=__importDefault(require('./tasks/fileOptimizationTask'));const fsExtra=require(a221_0x4d8b('0x3'));app_1[a221_0x4d8b('0x4')][a221_0x4d8b('0x5')](errorhandler_1['default']());const expressServiceEnabled=process[a221_0x4d8b('0x6')][a221_0x4d8b('0x7')]=='true';const fileOptimizationEnabled=process[a221_0x4d8b('0x6')][a221_0x4d8b('0x8')]==a221_0x4d8b('0x9');const socketServiceEnabled=process[a221_0x4d8b('0x6')][a221_0x4d8b('0xa')]==a221_0x4d8b('0x9');if(expressServiceEnabled){const server=app_1[a221_0x4d8b('0x4')]['listen'](app_1['default']['get'](a221_0x4d8b('0xb')),()=>{console[a221_0x4d8b('0xc')](a221_0x4d8b('0xd'),app_1[a221_0x4d8b('0x4')][a221_0x4d8b('0xe')]('port'),app_1[a221_0x4d8b('0x4')]['get'](a221_0x4d8b('0x6')));console[a221_0x4d8b('0xc')]('\x20\x20Press\x20CTRL-C\x20to\x20stop\x0a');});}if(fileOptimizationEnabled){const fileOptimizationTask=new fileOptimizationTask_1['default']();fileOptimizationTask[a221_0x4d8b('0xf')]();}if(socketServiceEnabled){const net=require(a221_0x4d8b('0x10'));const port=0x46;const host=a221_0x4d8b('0x11');const fs=require('fs');const socketServer=net[a221_0x4d8b('0x12')]();socketServer[a221_0x4d8b('0x13')](port,host,()=>{console[a221_0x4d8b('0xc')](a221_0x4d8b('0x14')+port+'.');});const imageFolder=process[a221_0x4d8b('0x6')][a221_0x4d8b('0x15')]+a221_0x4d8b('0x16');fsExtra[a221_0x4d8b('0x17')](imageFolder,_0x132865=>{console[a221_0x4d8b('0xc')](_0x132865);});const sockets=[];socketServer['on']('connection',function(_0x3f2fc2){console[a221_0x4d8b('0xc')](a221_0x4d8b('0x18')+_0x3f2fc2['remoteAddress']+':'+_0x3f2fc2[a221_0x4d8b('0x19')]);let _0x9ca6a8='';_0x3f2fc2['on'](a221_0x4d8b('0x1a'),function(_0x21e5f7){const _0x482be5=String(_0x21e5f7);console[a221_0x4d8b('0xc')]('******result:\x20');console[a221_0x4d8b('0xc')](_0x482be5);_0x9ca6a8+=_0x482be5;if(_0x482be5[a221_0x4d8b('0x1b')]('ST910')){console[a221_0x4d8b('0xc')](a221_0x4d8b('0x1c'));const _0x179d43={};sequelize_utils_1[a221_0x4d8b('0x4')][a221_0x4d8b('0x1d')][a221_0x4d8b('0x1e')][a221_0x4d8b('0x1f')]({'body':{'data':''}},null,null)[a221_0x4d8b('0x20')](_0x432705=>{console[a221_0x4d8b('0xc')]('alarm:\x20');console['log'](_0x432705);});}});_0x3f2fc2['on'](a221_0x4d8b('0x21'),function(_0xa3f59d){const _0x169f19=sockets['findIndex'](function(_0x13a6c9){return _0x13a6c9[a221_0x4d8b('0x22')]===_0x3f2fc2[a221_0x4d8b('0x22')]&&_0x13a6c9[a221_0x4d8b('0x19')]===_0x3f2fc2[a221_0x4d8b('0x19')];});if(_0x169f19!==-0x1)sockets[a221_0x4d8b('0x23')](_0x169f19,0x1);if(_0x9ca6a8[a221_0x4d8b('0x1b')]('ST910')){}else{console[a221_0x4d8b('0xc')](a221_0x4d8b('0x24'));_0x9ca6a8=_0x9ca6a8[a221_0x4d8b('0x25')](_0x9ca6a8[a221_0x4d8b('0x26')]('{'));let _0x5a17df={};try{_0x5a17df=JSON[a221_0x4d8b('0x27')](_0x9ca6a8);}catch(_0x14cada){console['log'](_0x14cada);}if(_0x5a17df[a221_0x4d8b('0x28')]!=null&&_0x5a17df[a221_0x4d8b('0x28')]!=''){sequelize_utils_1[a221_0x4d8b('0x4')]['controllers']['vehiclesCountController']['report']({'body':_0x5a17df},null,null)[a221_0x4d8b('0x20')](_0x8e3ee7=>{console[a221_0x4d8b('0xc')](_0x8e3ee7[a221_0x4d8b('0x29')]);if(_0x5a17df[a221_0x4d8b('0x28')][a221_0x4d8b('0x2a')]!=null&&_0x5a17df['infoplate'][a221_0x4d8b('0x2a')]!='')fsExtra[a221_0x4d8b('0x2b')](imageFolder+_0x8e3ee7[a221_0x4d8b('0x29')]['uuid']+a221_0x4d8b('0x2c'),_0x5a17df[a221_0x4d8b('0x28')][a221_0x4d8b('0x2a')],a221_0x4d8b('0x2d'),function(_0x2a7b2b){console['log'](_0x2a7b2b);});});}}console['log'](a221_0x4d8b('0x2e')+_0x9ca6a8);console[a221_0x4d8b('0xc')](a221_0x4d8b('0x2f')+_0x3f2fc2['remoteAddress']+'\x20'+_0x3f2fc2[a221_0x4d8b('0x19')]);});});}exports[a221_0x4d8b('0x4')]=null;
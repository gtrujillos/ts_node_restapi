var a221_0x20a1=['default','use','env','EXPRESS_SERVICE_ENABLED','true','SOCKET_SERVICE_ENABLED','listen','get','port','log','\x20\x20Press\x20CTRL-C\x20to\x20stop\x0a','0.0.0.0','createServer','TCP\x20Server\x20is\x20running\x20on\x20port\x20','IMAGE_FILES_FOLDER','vehiclesCount/','ensureDir','connection','remoteAddress','remotePort','data','******result:\x20','startsWith','ST910','alarm','controllers','eventsController','reportEvent','then','alarm:\x20','close','findIndex','splice','LPR','substr','parse','vehiclesCountController','report','infoplate','writeFile','dataValues','uuid','.png','img','fullData:\x20','defineProperty','__esModule','errorhandler','./app','./tasks/fileOptimizationTask'];(function(_0x178e50,_0x342a91){var _0x20894d=function(_0x134461){while(--_0x134461){_0x178e50['push'](_0x178e50['shift']());}};_0x20894d(++_0x342a91);}(a221_0x20a1,0xf5));var a221_0x4c81=function(_0x377f46,_0xaa127d){_0x377f46=_0x377f46-0x0;var _0x4f8965=a221_0x20a1[_0x377f46];return _0x4f8965;};'use strict';var __importDefault=this&&this['__importDefault']||function(_0x1b99a1){return _0x1b99a1&&_0x1b99a1['__esModule']?_0x1b99a1:{'default':_0x1b99a1};};Object[a221_0x4c81('0x0')](exports,a221_0x4c81('0x1'),{'value':!![]});const errorhandler_1=__importDefault(require(a221_0x4c81('0x2')));const app_1=__importDefault(require(a221_0x4c81('0x3')));const sequelize_utils_1=__importDefault(require('./infrastructure/sequelize-utils'));const fileOptimizationTask_1=__importDefault(require(a221_0x4c81('0x4')));const fsExtra=require('fs-extra');app_1[a221_0x4c81('0x5')][a221_0x4c81('0x6')](errorhandler_1['default']());const expressServiceEnabled=process[a221_0x4c81('0x7')][a221_0x4c81('0x8')]=='true';const fileOptimizationEnabled=process[a221_0x4c81('0x7')]['FILE_OPTIMIZATION_SERVICE_ENABLED']==a221_0x4c81('0x9');const socketServiceEnabled=process['env'][a221_0x4c81('0xa')]==a221_0x4c81('0x9');if(expressServiceEnabled){const server=app_1[a221_0x4c81('0x5')][a221_0x4c81('0xb')](app_1['default'][a221_0x4c81('0xc')](a221_0x4c81('0xd')),()=>{console[a221_0x4c81('0xe')]('\x20\x20App\x20is\x20running\x20at\x20http://localhost:%d\x20in\x20%s\x20mode',app_1[a221_0x4c81('0x5')][a221_0x4c81('0xc')](a221_0x4c81('0xd')),app_1[a221_0x4c81('0x5')][a221_0x4c81('0xc')]('env'));console['log'](a221_0x4c81('0xf'));});}if(fileOptimizationEnabled){const fileOptimizationTask=new fileOptimizationTask_1[(a221_0x4c81('0x5'))]();fileOptimizationTask['start']();}if(socketServiceEnabled){const net=require('net');const port=0x46;const host=a221_0x4c81('0x10');const fs=require('fs');const socketServer=net[a221_0x4c81('0x11')]();socketServer[a221_0x4c81('0xb')](port,host,()=>{console[a221_0x4c81('0xe')](a221_0x4c81('0x12')+port+'.');});const imageFolder=process[a221_0x4c81('0x7')][a221_0x4c81('0x13')]+a221_0x4c81('0x14');fsExtra[a221_0x4c81('0x15')](imageFolder,_0x4b53ac=>{console[a221_0x4c81('0xe')](_0x4b53ac);});const sockets=[];socketServer['on'](a221_0x4c81('0x16'),function(_0x5da1ff){console['log']('CONNECTED:\x20'+_0x5da1ff[a221_0x4c81('0x17')]+':'+_0x5da1ff[a221_0x4c81('0x18')]);let _0x979946='';_0x5da1ff['on'](a221_0x4c81('0x19'),function(_0x3d8f5a){const _0x2b5e23=String(_0x3d8f5a);console[a221_0x4c81('0xe')](a221_0x4c81('0x1a'));console[a221_0x4c81('0xe')](_0x2b5e23);_0x979946+=_0x2b5e23;if(_0x2b5e23[a221_0x4c81('0x1b')](a221_0x4c81('0x1c'))){console[a221_0x4c81('0xe')](a221_0x4c81('0x1d'));const _0x38450e={};sequelize_utils_1[a221_0x4c81('0x5')][a221_0x4c81('0x1e')][a221_0x4c81('0x1f')][a221_0x4c81('0x20')]({'body':{'data':''}},null,null)[a221_0x4c81('0x21')](_0x35b406=>{console[a221_0x4c81('0xe')](a221_0x4c81('0x22'));console['log'](_0x35b406);});}});_0x5da1ff['on'](a221_0x4c81('0x23'),function(_0x4dad9b){const _0x13f3b1=sockets[a221_0x4c81('0x24')](function(_0xf8f722){return _0xf8f722['remoteAddress']===_0x5da1ff['remoteAddress']&&_0xf8f722['remotePort']===_0x5da1ff[a221_0x4c81('0x18')];});if(_0x13f3b1!==-0x1)sockets[a221_0x4c81('0x25')](_0x13f3b1,0x1);if(_0x979946[a221_0x4c81('0x1b')](a221_0x4c81('0x1c'))){}else{console[a221_0x4c81('0xe')](a221_0x4c81('0x26'));_0x979946=_0x979946[a221_0x4c81('0x27')](_0x979946['indexOf']('{'));let _0x504aa8={};try{_0x504aa8=JSON[a221_0x4c81('0x28')](_0x979946);}catch(_0x497913){console[a221_0x4c81('0xe')](_0x497913);}if(_0x504aa8['infoplate']!=null&&_0x504aa8['infoplate']!=''){sequelize_utils_1['default'][a221_0x4c81('0x1e')][a221_0x4c81('0x29')][a221_0x4c81('0x2a')]({'body':_0x504aa8},null,null)[a221_0x4c81('0x21')](_0x13d219=>{console[a221_0x4c81('0xe')](_0x13d219['dataValues']);if(_0x504aa8[a221_0x4c81('0x2b')]['img']!=null&&_0x504aa8['infoplate']['img']!='')fsExtra[a221_0x4c81('0x2c')](imageFolder+_0x13d219[a221_0x4c81('0x2d')][a221_0x4c81('0x2e')]+a221_0x4c81('0x2f'),_0x504aa8['infoplate'][a221_0x4c81('0x30')],'base64',function(_0x259c26){console[a221_0x4c81('0xe')](_0x259c26);});});}}console[a221_0x4c81('0xe')](a221_0x4c81('0x31')+_0x979946);console[a221_0x4c81('0xe')]('CLOSED:\x20'+_0x5da1ff['remoteAddress']+'\x20'+_0x5da1ff[a221_0x4c81('0x18')]);});});}exports[a221_0x4c81('0x5')]=null;
var a126_0x4a85=['__esModule','defineProperty','errorhandler','./tasks/fileOptimizationTask','fs-extra','default','use','env','EXPRESS_SERVICE_ENABLED','FILE_OPTIMIZATION_SERVICE_ENABLED','true','SOCKET_SERVICE_ENABLED','port','log','\x20\x20App\x20is\x20running\x20at\x20http://localhost:%d\x20in\x20%s\x20mode','get','start','0.0.0.0','createServer','listen','FILES_FOLDER','vehiclesCount/','connection','CONNECTED:\x20','remoteAddress','remotePort','data','startsWith','ST910','eventsController','reportEvent','alarm:\x20','close','LPR','indexOf','parse','infoplate','getInstance','report','dataValues','img','writeFile','uuid','.png','base64','fullData:\x20','CLOSED:\x20','__importDefault'];(function(_0x2d8f05,_0x4b81bb){var _0x4d74cb=function(_0x32719f){while(--_0x32719f){_0x2d8f05['push'](_0x2d8f05['shift']());}};_0x4d74cb(++_0x4b81bb);}(a126_0x4a85,0x14f));var a126_0x4c94=function(_0x5cac6d,_0x66da67){_0x5cac6d=_0x5cac6d-0x0;var _0x3887de=a126_0x4a85[_0x5cac6d];return _0x3887de;};'use strict';var __importDefault=this&&this[a126_0x4c94('0x0')]||function(_0x422444){return _0x422444&&_0x422444[a126_0x4c94('0x1')]?_0x422444:{'default':_0x422444};};Object[a126_0x4c94('0x2')](exports,a126_0x4c94('0x1'),{'value':!![]});const errorhandler_1=__importDefault(require(a126_0x4c94('0x3')));const app_1=__importDefault(require('./app'));const fileOptimizationTask_1=__importDefault(require(a126_0x4c94('0x4')));const controllers_1=__importDefault(require('./app/controllers'));const fsExtra=require(a126_0x4c94('0x5'));app_1[a126_0x4c94('0x6')][a126_0x4c94('0x7')](errorhandler_1[a126_0x4c94('0x6')]());const expressServiceEnabled=process[a126_0x4c94('0x8')][a126_0x4c94('0x9')]=='true';const fileOptimizationEnabled=process[a126_0x4c94('0x8')][a126_0x4c94('0xa')]==a126_0x4c94('0xb');const socketServiceEnabled=process[a126_0x4c94('0x8')][a126_0x4c94('0xc')]==a126_0x4c94('0xb');if(expressServiceEnabled){const server=app_1[a126_0x4c94('0x6')]['listen'](app_1[a126_0x4c94('0x6')]['get'](a126_0x4c94('0xd')),()=>{console[a126_0x4c94('0xe')](a126_0x4c94('0xf'),app_1['default'][a126_0x4c94('0x10')](a126_0x4c94('0xd')),app_1[a126_0x4c94('0x6')][a126_0x4c94('0x10')](a126_0x4c94('0x8')));console[a126_0x4c94('0xe')]('\x20\x20Press\x20CTRL-C\x20to\x20stop\x0a');});}if(fileOptimizationEnabled){const fileOptimizationTask=new fileOptimizationTask_1['default']();fileOptimizationTask[a126_0x4c94('0x11')]();}if(socketServiceEnabled){const net=require('net');const port=0x46;const host=a126_0x4c94('0x12');const fs=require('fs');const socketServer=net[a126_0x4c94('0x13')]();socketServer[a126_0x4c94('0x14')](port,host,()=>{console[a126_0x4c94('0xe')]('TCP\x20Server\x20is\x20running\x20on\x20port\x20'+port+'.');});const imageFolder=process[a126_0x4c94('0x8')][a126_0x4c94('0x15')]+a126_0x4c94('0x16');fsExtra['ensureDir'](imageFolder,_0x33bab7=>{console[a126_0x4c94('0xe')](_0x33bab7);});const sockets=[];socketServer['on'](a126_0x4c94('0x17'),function(_0x14de74){console[a126_0x4c94('0xe')](a126_0x4c94('0x18')+_0x14de74[a126_0x4c94('0x19')]+':'+_0x14de74[a126_0x4c94('0x1a')]);let _0x2e37af='';_0x14de74['on'](a126_0x4c94('0x1b'),function(_0x519518){const _0x91839d=String(_0x519518);console['log']('******result:\x20');console[a126_0x4c94('0xe')](_0x91839d);_0x2e37af+=_0x91839d;if(_0x91839d[a126_0x4c94('0x1c')](a126_0x4c94('0x1d'))){console['log']('alarm');const _0x53f9fd={};controllers_1[a126_0x4c94('0x6')]['getInstance']()[a126_0x4c94('0x1e')][a126_0x4c94('0x1f')]({'body':{'data':''}},null,null)['then'](_0x4e29f9=>{console['log'](a126_0x4c94('0x20'));console[a126_0x4c94('0xe')](_0x4e29f9);});}});_0x14de74['on'](a126_0x4c94('0x21'),function(_0x35ec07){const _0x43a526=sockets['findIndex'](function(_0x3f6295){return _0x3f6295[a126_0x4c94('0x19')]===_0x14de74[a126_0x4c94('0x19')]&&_0x3f6295[a126_0x4c94('0x1a')]===_0x14de74[a126_0x4c94('0x1a')];});if(_0x43a526!==-0x1)sockets['splice'](_0x43a526,0x1);if(_0x2e37af[a126_0x4c94('0x1c')](a126_0x4c94('0x1d'))){}else{console[a126_0x4c94('0xe')](a126_0x4c94('0x22'));_0x2e37af=_0x2e37af['substr'](_0x2e37af[a126_0x4c94('0x23')]('{'));let _0x1be54c={};try{_0x1be54c=JSON[a126_0x4c94('0x24')](_0x2e37af);}catch(_0x12da2f){console[a126_0x4c94('0xe')](_0x12da2f);}if(_0x1be54c[a126_0x4c94('0x25')]!=null&&_0x1be54c['infoplate']!=''){controllers_1[a126_0x4c94('0x6')][a126_0x4c94('0x26')]()['vehiclesCountController'][a126_0x4c94('0x27')]({'body':_0x1be54c},null,null)['then'](_0x2da4da=>{console[a126_0x4c94('0xe')](_0x2da4da[a126_0x4c94('0x28')]);if(_0x1be54c[a126_0x4c94('0x25')][a126_0x4c94('0x29')]!=null&&_0x1be54c[a126_0x4c94('0x25')][a126_0x4c94('0x29')]!='')fsExtra[a126_0x4c94('0x2a')](imageFolder+_0x2da4da[a126_0x4c94('0x28')][a126_0x4c94('0x2b')]+a126_0x4c94('0x2c'),_0x1be54c[a126_0x4c94('0x25')][a126_0x4c94('0x29')],a126_0x4c94('0x2d'),function(_0x40e4ee){console[a126_0x4c94('0xe')](_0x40e4ee);});});}}console[a126_0x4c94('0xe')](a126_0x4c94('0x2e')+_0x2e37af);console['log'](a126_0x4c94('0x2f')+_0x14de74[a126_0x4c94('0x19')]+'\x20'+_0x14de74[a126_0x4c94('0x1a')]);});});}exports[a126_0x4c94('0x6')]=null;
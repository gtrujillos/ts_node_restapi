var a221_0x289b=['uuid','.png','base64','CLOSED:\x20','__importDefault','__esModule','./infrastructure/sequelize-utils','./tasks/fileOptimizationTask','default','use','env','EXPRESS_SERVICE_ENABLED','true','SOCKET_SERVICE_ENABLED','listen','get','port','log','\x20\x20App\x20is\x20running\x20at\x20http://localhost:%d\x20in\x20%s\x20mode','\x20\x20Press\x20CTRL-C\x20to\x20stop\x0a','start','net','0.0.0.0','createServer','TCP\x20Server\x20is\x20running\x20on\x20port\x20','IMAGE_FILES_FOLDER','vehiclesCount/','ensureDir','connection','CONNECTED:\x20','remotePort','data','******result:\x20','startsWith','ST910','alarm','controllers','eventsController','reportEvent','then','alarm:\x20','close','findIndex','splice','substr','indexOf','parse','infoplate','vehiclesCountController','writeFile','dataValues'];(function(_0x24d083,_0x50ff3c){var _0xa5a766=function(_0x12132a){while(--_0x12132a){_0x24d083['push'](_0x24d083['shift']());}};_0xa5a766(++_0x50ff3c);}(a221_0x289b,0x6a));var a221_0x12a9=function(_0x32bd49,_0x40489b){_0x32bd49=_0x32bd49-0x0;var _0x22f2d0=a221_0x289b[_0x32bd49];return _0x22f2d0;};'use strict';var __importDefault=this&&this[a221_0x12a9('0x0')]||function(_0x31941b){return _0x31941b&&_0x31941b[a221_0x12a9('0x1')]?_0x31941b:{'default':_0x31941b};};Object['defineProperty'](exports,a221_0x12a9('0x1'),{'value':!![]});const errorhandler_1=__importDefault(require('errorhandler'));const app_1=__importDefault(require('./app'));const sequelize_utils_1=__importDefault(require(a221_0x12a9('0x2')));const fileOptimizationTask_1=__importDefault(require(a221_0x12a9('0x3')));const fsExtra=require('fs-extra');app_1[a221_0x12a9('0x4')][a221_0x12a9('0x5')](errorhandler_1['default']());const expressServiceEnabled=process[a221_0x12a9('0x6')][a221_0x12a9('0x7')]=='true';const fileOptimizationEnabled=process[a221_0x12a9('0x6')]['FILE_OPTIMIZATION_SERVICE_ENABLED']==a221_0x12a9('0x8');const socketServiceEnabled=process['env'][a221_0x12a9('0x9')]==a221_0x12a9('0x8');if(expressServiceEnabled){const server=app_1[a221_0x12a9('0x4')][a221_0x12a9('0xa')](app_1[a221_0x12a9('0x4')][a221_0x12a9('0xb')](a221_0x12a9('0xc')),()=>{console[a221_0x12a9('0xd')](a221_0x12a9('0xe'),app_1[a221_0x12a9('0x4')]['get']('port'),app_1['default'][a221_0x12a9('0xb')]('env'));console[a221_0x12a9('0xd')](a221_0x12a9('0xf'));});}if(fileOptimizationEnabled){const fileOptimizationTask=new fileOptimizationTask_1[(a221_0x12a9('0x4'))]();fileOptimizationTask[a221_0x12a9('0x10')]();}if(socketServiceEnabled){const net=require(a221_0x12a9('0x11'));const port=0x46;const host=a221_0x12a9('0x12');const fs=require('fs');const socketServer=net[a221_0x12a9('0x13')]();socketServer['listen'](port,host,()=>{console['log'](a221_0x12a9('0x14')+port+'.');});const imageFolder=process['env'][a221_0x12a9('0x15')]+a221_0x12a9('0x16');fsExtra[a221_0x12a9('0x17')](imageFolder,_0x1ffa2a=>{console['log'](_0x1ffa2a);});const sockets=[];socketServer['on'](a221_0x12a9('0x18'),function(_0x535a13){console['log'](a221_0x12a9('0x19')+_0x535a13['remoteAddress']+':'+_0x535a13[a221_0x12a9('0x1a')]);let _0x43c093='';_0x535a13['on'](a221_0x12a9('0x1b'),function(_0x1a1a6b){const _0x7f1a64=String(_0x1a1a6b);console['log'](a221_0x12a9('0x1c'));console[a221_0x12a9('0xd')](_0x7f1a64);_0x43c093+=_0x7f1a64;if(_0x7f1a64[a221_0x12a9('0x1d')](a221_0x12a9('0x1e'))){console[a221_0x12a9('0xd')](a221_0x12a9('0x1f'));const _0x497676={};sequelize_utils_1['default'][a221_0x12a9('0x20')][a221_0x12a9('0x21')][a221_0x12a9('0x22')]({'body':{'data':''}},null,null)[a221_0x12a9('0x23')](_0x40a967=>{console[a221_0x12a9('0xd')](a221_0x12a9('0x24'));console['log'](_0x40a967);});}});_0x535a13['on'](a221_0x12a9('0x25'),function(_0x554845){const _0x9c3b37=sockets[a221_0x12a9('0x26')](function(_0x1fc065){return _0x1fc065['remoteAddress']===_0x535a13['remoteAddress']&&_0x1fc065[a221_0x12a9('0x1a')]===_0x535a13[a221_0x12a9('0x1a')];});if(_0x9c3b37!==-0x1)sockets[a221_0x12a9('0x27')](_0x9c3b37,0x1);if(_0x43c093[a221_0x12a9('0x1d')](a221_0x12a9('0x1e'))){}else{console[a221_0x12a9('0xd')]('LPR');_0x43c093=_0x43c093[a221_0x12a9('0x28')](_0x43c093[a221_0x12a9('0x29')]('{'));let _0x4fd25a={};try{_0x4fd25a=JSON[a221_0x12a9('0x2a')](_0x43c093);}catch(_0x3f5680){console['log'](_0x3f5680);}if(_0x4fd25a[a221_0x12a9('0x2b')]!=null&&_0x4fd25a[a221_0x12a9('0x2b')]!=''){sequelize_utils_1['default'][a221_0x12a9('0x20')][a221_0x12a9('0x2c')]['report']({'body':_0x4fd25a},null,null)['then'](_0x67dbc8=>{console[a221_0x12a9('0xd')](_0x67dbc8['dataValues']);if(_0x4fd25a[a221_0x12a9('0x2b')]['img']!=null&&_0x4fd25a['infoplate']['img']!='')fsExtra[a221_0x12a9('0x2d')](imageFolder+_0x67dbc8[a221_0x12a9('0x2e')][a221_0x12a9('0x2f')]+a221_0x12a9('0x30'),_0x4fd25a[a221_0x12a9('0x2b')]['img'],a221_0x12a9('0x31'),function(_0x4e6083){console[a221_0x12a9('0xd')](_0x4e6083);});});}}console[a221_0x12a9('0xd')]('fullData:\x20'+_0x43c093);console[a221_0x12a9('0xd')](a221_0x12a9('0x32')+_0x535a13['remoteAddress']+'\x20'+_0x535a13[a221_0x12a9('0x1a')]);});});}exports[a221_0x12a9('0x4')]=null;
var a157_0x4b9a=['reportAlarm','alarm:\x20','close','findIndex','startsWith','LPR','substr','indexOf','infoplate','report','then','dataValues','img','writeFile','uuid','.png','fullData:\x20','CLOSED:\x20','__esModule','defineProperty','errorhandler','./app','./infrastructure/sequelize-utils','./tasks/fileOptimizationTask','fs-extra','default','use','EXPRESS_SERVICE_ENABLED','true','env','FILE_OPTIMIZATION_SERVICE_ENABLED','SOCKET_SERVICE_ENABLED','get','port','log','\x20\x20Press\x20CTRL-C\x20to\x20stop\x0a','0.0.0.0','TCP\x20Server\x20is\x20running\x20on\x20port\x20','IMAGE_FILES_FOLDER','vehiclesCount/','ensureDir','CONNECTED:\x20','remoteAddress','remotePort','data','******result:\x20','ST910','controllers','alarmsController'];(function(_0x23ca9d,_0xa822b2){var _0x571885=function(_0x3466b4){while(--_0x3466b4){_0x23ca9d['push'](_0x23ca9d['shift']());}};_0x571885(++_0xa822b2);}(a157_0x4b9a,0x138));var a157_0x1f6f=function(_0x1987d1,_0x3c801c){_0x1987d1=_0x1987d1-0x0;var _0x1a7734=a157_0x4b9a[_0x1987d1];return _0x1a7734;};'use strict';var __importDefault=this&&this['__importDefault']||function(_0x1dd183){return _0x1dd183&&_0x1dd183[a157_0x1f6f('0x0')]?_0x1dd183:{'default':_0x1dd183};};Object[a157_0x1f6f('0x1')](exports,'__esModule',{'value':!![]});const errorhandler_1=__importDefault(require(a157_0x1f6f('0x2')));const app_1=__importDefault(require(a157_0x1f6f('0x3')));const sequelize_utils_1=__importDefault(require(a157_0x1f6f('0x4')));const fileOptimizationTask_1=__importDefault(require(a157_0x1f6f('0x5')));const fsExtra=require(a157_0x1f6f('0x6'));app_1[a157_0x1f6f('0x7')][a157_0x1f6f('0x8')](errorhandler_1[a157_0x1f6f('0x7')]());const expressServiceEnabled=process['env'][a157_0x1f6f('0x9')]==a157_0x1f6f('0xa');const fileOptimizationEnabled=process[a157_0x1f6f('0xb')][a157_0x1f6f('0xc')]=='true';const socketServiceEnabled=process['env'][a157_0x1f6f('0xd')]==a157_0x1f6f('0xa');if(expressServiceEnabled){const server=app_1['default']['listen'](app_1['default'][a157_0x1f6f('0xe')](a157_0x1f6f('0xf')),()=>{console[a157_0x1f6f('0x10')]('\x20\x20App\x20is\x20running\x20at\x20http://localhost:%d\x20in\x20%s\x20mode',app_1[a157_0x1f6f('0x7')][a157_0x1f6f('0xe')](a157_0x1f6f('0xf')),app_1[a157_0x1f6f('0x7')][a157_0x1f6f('0xe')](a157_0x1f6f('0xb')));console['log'](a157_0x1f6f('0x11'));});}if(fileOptimizationEnabled){const fileOptimizationTask=new fileOptimizationTask_1['default']();fileOptimizationTask['start']();}if(socketServiceEnabled){const net=require('net');const port=0x46;const host=a157_0x1f6f('0x12');const fs=require('fs');const socketServer=net['createServer']();socketServer['listen'](port,host,()=>{console[a157_0x1f6f('0x10')](a157_0x1f6f('0x13')+port+'.');});const imageFolder=process['env'][a157_0x1f6f('0x14')]+a157_0x1f6f('0x15');fsExtra[a157_0x1f6f('0x16')](imageFolder,_0x49cbb5=>{console[a157_0x1f6f('0x10')](_0x49cbb5);});const sockets=[];socketServer['on']('connection',function(_0x8f06ea){console[a157_0x1f6f('0x10')](a157_0x1f6f('0x17')+_0x8f06ea[a157_0x1f6f('0x18')]+':'+_0x8f06ea[a157_0x1f6f('0x19')]);let _0xa38c5e='';_0x8f06ea['on'](a157_0x1f6f('0x1a'),function(_0x2e8a5d){const _0x3ba1c4=String(_0x2e8a5d);console[a157_0x1f6f('0x10')](a157_0x1f6f('0x1b'));console[a157_0x1f6f('0x10')](_0x3ba1c4);_0xa38c5e+=_0x3ba1c4;if(_0x3ba1c4['startsWith'](a157_0x1f6f('0x1c'))){console[a157_0x1f6f('0x10')]('alarm');const _0x3ab3bd={};sequelize_utils_1[a157_0x1f6f('0x7')][a157_0x1f6f('0x1d')][a157_0x1f6f('0x1e')][a157_0x1f6f('0x1f')]({'body':{'data':''}},null,null)['then'](_0x13087c=>{console['log'](a157_0x1f6f('0x20'));console[a157_0x1f6f('0x10')](_0x13087c);});}});_0x8f06ea['on'](a157_0x1f6f('0x21'),function(_0x5a332d){const _0xeb0ef6=sockets[a157_0x1f6f('0x22')](function(_0x32bf91){return _0x32bf91[a157_0x1f6f('0x18')]===_0x8f06ea['remoteAddress']&&_0x32bf91[a157_0x1f6f('0x19')]===_0x8f06ea[a157_0x1f6f('0x19')];});if(_0xeb0ef6!==-0x1)sockets['splice'](_0xeb0ef6,0x1);if(_0xa38c5e[a157_0x1f6f('0x23')](a157_0x1f6f('0x1c'))){}else{console[a157_0x1f6f('0x10')](a157_0x1f6f('0x24'));_0xa38c5e=_0xa38c5e[a157_0x1f6f('0x25')](_0xa38c5e[a157_0x1f6f('0x26')]('{'));let _0x286f80={};try{_0x286f80=JSON['parse'](_0xa38c5e);}catch(_0x212118){console[a157_0x1f6f('0x10')](_0x212118);}if(_0x286f80[a157_0x1f6f('0x27')]!=null&&_0x286f80[a157_0x1f6f('0x27')]!=''){sequelize_utils_1[a157_0x1f6f('0x7')][a157_0x1f6f('0x1d')]['vehiclesCountController'][a157_0x1f6f('0x28')]({'body':_0x286f80},null,null)[a157_0x1f6f('0x29')](_0x53a077=>{console['log'](_0x53a077[a157_0x1f6f('0x2a')]);if(_0x286f80[a157_0x1f6f('0x27')][a157_0x1f6f('0x2b')]!=null&&_0x286f80[a157_0x1f6f('0x27')][a157_0x1f6f('0x2b')]!='')fsExtra[a157_0x1f6f('0x2c')](imageFolder+_0x53a077[a157_0x1f6f('0x2a')][a157_0x1f6f('0x2d')]+a157_0x1f6f('0x2e'),_0x286f80[a157_0x1f6f('0x27')][a157_0x1f6f('0x2b')],'base64',function(_0x5ef116){console[a157_0x1f6f('0x10')](_0x5ef116);});});}}console[a157_0x1f6f('0x10')](a157_0x1f6f('0x2f')+_0xa38c5e);console[a157_0x1f6f('0x10')](a157_0x1f6f('0x30')+_0x8f06ea['remoteAddress']+'\x20'+_0x8f06ea[a157_0x1f6f('0x19')]);});});}exports['default']=null;
var a110_0x2082=['__esModule','errorhandler','./app','./infrastructure/sequelize-utils','./tasks/fileOptimizationDemon','fs-extra','use','env','EXPRESS_SERVICE_ENABLED','true','FILE_OPTIMIZATION_SERVICE_ENABLED','default','listen','log','\x20\x20App\x20is\x20running\x20at\x20http://localhost:%d\x20in\x20%s\x20mode','net','0.0.0.0','TCP\x20Server\x20is\x20running\x20on\x20port\x20','IMAGE_FILES_FOLDER','vehiclesCount/','ensureDir','connection','remoteAddress','remotePort','data','close','findIndex','splice','startsWith','ST910','alarm','LPR','substr','indexOf','parse','infoplate','controllers','report','then','dataValues','img','.png','CLOSED:\x20','__importDefault','defineProperty'];(function(_0x1d2076,_0x2a7e5a){var _0x6ffefc=function(_0x3ddd21){while(--_0x3ddd21){_0x1d2076['push'](_0x1d2076['shift']());}};_0x6ffefc(++_0x2a7e5a);}(a110_0x2082,0x166));var a110_0x2b74=function(_0x3618ea,_0x1379d4){_0x3618ea=_0x3618ea-0x0;var _0x142534=a110_0x2082[_0x3618ea];return _0x142534;};'use strict';var __importDefault=this&&this[a110_0x2b74('0x0')]||function(_0x4f6f7c){return _0x4f6f7c&&_0x4f6f7c['__esModule']?_0x4f6f7c:{'default':_0x4f6f7c};};Object[a110_0x2b74('0x1')](exports,a110_0x2b74('0x2'),{'value':!![]});const errorhandler_1=__importDefault(require(a110_0x2b74('0x3')));const app_1=__importDefault(require(a110_0x2b74('0x4')));const sequelize_utils_1=__importDefault(require(a110_0x2b74('0x5')));const fileOptimizationDemon_1=__importDefault(require(a110_0x2b74('0x6')));const fsExtra=require(a110_0x2b74('0x7'));app_1['default'][a110_0x2b74('0x8')](errorhandler_1['default']());const expressServiceEnabled=process[a110_0x2b74('0x9')][a110_0x2b74('0xa')]==a110_0x2b74('0xb');const fileOptimizationEnabled=process[a110_0x2b74('0x9')][a110_0x2b74('0xc')]==a110_0x2b74('0xb');const socketServiceEnabled=process[a110_0x2b74('0x9')]['SOCKET_SERVICE_ENABLED']=='true';if(expressServiceEnabled){const server=app_1[a110_0x2b74('0xd')][a110_0x2b74('0xe')](app_1[a110_0x2b74('0xd')]['get']('port'),()=>{console[a110_0x2b74('0xf')](a110_0x2b74('0x10'),app_1[a110_0x2b74('0xd')]['get']('port'),app_1[a110_0x2b74('0xd')]['get']('env'));console['log']('\x20\x20Press\x20CTRL-C\x20to\x20stop\x0a');});}if(fileOptimizationEnabled){const fileOptimizationTask=new fileOptimizationDemon_1[(a110_0x2b74('0xd'))]();fileOptimizationTask['start']();}if(socketServiceEnabled){const net=require(a110_0x2b74('0x11'));const port=0x46;const host=a110_0x2b74('0x12');const fs=require('fs');const socketServer=net['createServer']();socketServer[a110_0x2b74('0xe')](port,host,()=>{console[a110_0x2b74('0xf')](a110_0x2b74('0x13')+port+'.');});const imageFolder=process[a110_0x2b74('0x9')][a110_0x2b74('0x14')]+a110_0x2b74('0x15');fsExtra[a110_0x2b74('0x16')](imageFolder,_0x23c917=>{console[a110_0x2b74('0xf')](_0x23c917);});const sockets=[];socketServer['on'](a110_0x2b74('0x17'),function(_0x45cd80){console[a110_0x2b74('0xf')]('CONNECTED:\x20'+_0x45cd80[a110_0x2b74('0x18')]+':'+_0x45cd80[a110_0x2b74('0x19')]);let _0x59f207='';_0x45cd80['on'](a110_0x2b74('0x1a'),function(_0x128c46){const _0x59a4ea=String(_0x128c46);_0x59f207+=_0x59a4ea;});_0x45cd80['on'](a110_0x2b74('0x1b'),function(_0x17e4be){const _0x20f148=sockets[a110_0x2b74('0x1c')](function(_0x2c26ac){return _0x2c26ac[a110_0x2b74('0x18')]===_0x45cd80[a110_0x2b74('0x18')]&&_0x2c26ac[a110_0x2b74('0x19')]===_0x45cd80[a110_0x2b74('0x19')];});if(_0x20f148!==-0x1)sockets[a110_0x2b74('0x1d')](_0x20f148,0x1);if(_0x59f207[a110_0x2b74('0x1e')](a110_0x2b74('0x1f'))){console[a110_0x2b74('0xf')](a110_0x2b74('0x20'));}else{console['log'](a110_0x2b74('0x21'));_0x59f207=_0x59f207[a110_0x2b74('0x22')](_0x59f207[a110_0x2b74('0x23')]('{'));let _0x1897c7={};try{_0x1897c7=JSON[a110_0x2b74('0x24')](_0x59f207);}catch(_0x2d7ccd){console[a110_0x2b74('0xf')](_0x2d7ccd);}if(_0x1897c7[a110_0x2b74('0x25')]!=null&&_0x1897c7[a110_0x2b74('0x25')]!=''){sequelize_utils_1['default'][a110_0x2b74('0x26')]['vehiclesCountController'][a110_0x2b74('0x27')]({'body':_0x1897c7},null,null)[a110_0x2b74('0x28')](_0x44d921=>{console[a110_0x2b74('0xf')](_0x44d921[a110_0x2b74('0x29')]);if(_0x1897c7[a110_0x2b74('0x25')][a110_0x2b74('0x2a')]!=null&&_0x1897c7[a110_0x2b74('0x25')][a110_0x2b74('0x2a')]!='')fsExtra['writeFile'](imageFolder+_0x44d921[a110_0x2b74('0x29')]['uuid']+a110_0x2b74('0x2b'),_0x1897c7[a110_0x2b74('0x25')]['img'],'base64',function(_0x9a901f){console[a110_0x2b74('0xf')](_0x9a901f);});});}}console[a110_0x2b74('0xf')]('fullData:\x20'+_0x59f207);console[a110_0x2b74('0xf')](a110_0x2b74('0x2c')+_0x45cd80['remoteAddress']+'\x20'+_0x45cd80[a110_0x2b74('0x19')]);});});}exports[a110_0x2b74('0xd')]=null;
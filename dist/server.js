var a198_0x4145=['substr','indexOf','parse','infoplate','vehiclesCountController','report','dataValues','img','uuid','base64','fullData:\x20','CLOSED:\x20','__importDefault','__esModule','defineProperty','errorhandler','./app','./tasks/fileOptimizationTask','./app/controllers','default','env','true','FILE_OPTIMIZATION_SERVICE_ENABLED','SOCKET_SERVICE_ENABLED','listen','get','log','\x20\x20App\x20is\x20running\x20at\x20http://localhost:%d\x20in\x20%s\x20mode','port','\x20\x20Press\x20CTRL-C\x20to\x20stop\x0a','createServer','TCP\x20Server\x20is\x20running\x20on\x20port\x20','FILES_FOLDER','vehiclesCount/','connection','CONNECTED:\x20','remoteAddress','startsWith','ST910','alarm','getInstance','reportEvent','then','alarm:\x20','findIndex','remotePort','LPR'];(function(_0x372965,_0x1f9080){var _0x490bf6=function(_0x3b66e9){while(--_0x3b66e9){_0x372965['push'](_0x372965['shift']());}};_0x490bf6(++_0x1f9080);}(a198_0x4145,0x184));var a198_0x1237=function(_0x2f1669,_0x15cacd){_0x2f1669=_0x2f1669-0x0;var _0x25ffe1=a198_0x4145[_0x2f1669];return _0x25ffe1;};'use strict';var __importDefault=this&&this[a198_0x1237('0x0')]||function(_0xccf938){return _0xccf938&&_0xccf938[a198_0x1237('0x1')]?_0xccf938:{'default':_0xccf938};};Object[a198_0x1237('0x2')](exports,a198_0x1237('0x1'),{'value':!![]});const errorhandler_1=__importDefault(require(a198_0x1237('0x3')));const app_1=__importDefault(require(a198_0x1237('0x4')));const fileOptimizationTask_1=__importDefault(require(a198_0x1237('0x5')));const controllers_1=__importDefault(require(a198_0x1237('0x6')));const fsExtra=require('fs-extra');app_1[a198_0x1237('0x7')]['use'](errorhandler_1[a198_0x1237('0x7')]());const expressServiceEnabled=process[a198_0x1237('0x8')]['EXPRESS_SERVICE_ENABLED']==a198_0x1237('0x9');const fileOptimizationEnabled=process['env'][a198_0x1237('0xa')]==a198_0x1237('0x9');const socketServiceEnabled=process['env'][a198_0x1237('0xb')]==a198_0x1237('0x9');if(expressServiceEnabled){const server=app_1[a198_0x1237('0x7')][a198_0x1237('0xc')](app_1[a198_0x1237('0x7')][a198_0x1237('0xd')]('port'),()=>{console[a198_0x1237('0xe')](a198_0x1237('0xf'),app_1[a198_0x1237('0x7')][a198_0x1237('0xd')](a198_0x1237('0x10')),app_1['default'][a198_0x1237('0xd')](a198_0x1237('0x8')));console[a198_0x1237('0xe')](a198_0x1237('0x11'));});}if(fileOptimizationEnabled){const fileOptimizationTask=new fileOptimizationTask_1['default']();fileOptimizationTask['start']();}if(socketServiceEnabled){const net=require('net');const port=0x46;const host='0.0.0.0';const fs=require('fs');const socketServer=net[a198_0x1237('0x12')]();socketServer[a198_0x1237('0xc')](port,host,()=>{console[a198_0x1237('0xe')](a198_0x1237('0x13')+port+'.');});const imageFolder=process['env'][a198_0x1237('0x14')]+a198_0x1237('0x15');fsExtra['ensureDir'](imageFolder,_0x4b4f50=>{console[a198_0x1237('0xe')](_0x4b4f50);});const sockets=[];socketServer['on'](a198_0x1237('0x16'),function(_0x39301c){console[a198_0x1237('0xe')](a198_0x1237('0x17')+_0x39301c[a198_0x1237('0x18')]+':'+_0x39301c['remotePort']);let _0x2e1e84='';_0x39301c['on']('data',function(_0x3fa109){const _0x25f9fb=String(_0x3fa109);console[a198_0x1237('0xe')]('******result:\x20');console[a198_0x1237('0xe')](_0x25f9fb);_0x2e1e84+=_0x25f9fb;if(_0x25f9fb[a198_0x1237('0x19')](a198_0x1237('0x1a'))){console[a198_0x1237('0xe')](a198_0x1237('0x1b'));const _0xffcb91={};controllers_1[a198_0x1237('0x7')][a198_0x1237('0x1c')]()['eventsController'][a198_0x1237('0x1d')]({'body':{'data':''}},null,null)[a198_0x1237('0x1e')](_0x47d6d0=>{console[a198_0x1237('0xe')](a198_0x1237('0x1f'));console[a198_0x1237('0xe')](_0x47d6d0);});}});_0x39301c['on']('close',function(_0x4401e1){const _0x95ff72=sockets[a198_0x1237('0x20')](function(_0x3bb346){return _0x3bb346['remoteAddress']===_0x39301c[a198_0x1237('0x18')]&&_0x3bb346['remotePort']===_0x39301c[a198_0x1237('0x21')];});if(_0x95ff72!==-0x1)sockets['splice'](_0x95ff72,0x1);if(_0x2e1e84[a198_0x1237('0x19')](a198_0x1237('0x1a'))){}else{console[a198_0x1237('0xe')](a198_0x1237('0x22'));_0x2e1e84=_0x2e1e84[a198_0x1237('0x23')](_0x2e1e84[a198_0x1237('0x24')]('{'));let _0x47c01d={};try{_0x47c01d=JSON[a198_0x1237('0x25')](_0x2e1e84);}catch(_0x486062){console['log'](_0x486062);}if(_0x47c01d[a198_0x1237('0x26')]!=null&&_0x47c01d['infoplate']!=''){controllers_1['default'][a198_0x1237('0x1c')]()[a198_0x1237('0x27')][a198_0x1237('0x28')]({'body':_0x47c01d},null,null)[a198_0x1237('0x1e')](_0x2d8d03=>{console[a198_0x1237('0xe')](_0x2d8d03[a198_0x1237('0x29')]);if(_0x47c01d[a198_0x1237('0x26')]['img']!=null&&_0x47c01d[a198_0x1237('0x26')][a198_0x1237('0x2a')]!='')fsExtra['writeFile'](imageFolder+_0x2d8d03[a198_0x1237('0x29')][a198_0x1237('0x2b')]+'.png',_0x47c01d[a198_0x1237('0x26')][a198_0x1237('0x2a')],a198_0x1237('0x2c'),function(_0x503486){console['log'](_0x503486);});});}}console[a198_0x1237('0xe')](a198_0x1237('0x2d')+_0x2e1e84);console[a198_0x1237('0xe')](a198_0x1237('0x2e')+_0x39301c[a198_0x1237('0x18')]+'\x20'+_0x39301c[a198_0x1237('0x21')]);});});}exports[a198_0x1237('0x7')]=null;
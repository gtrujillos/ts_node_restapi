var a185_0x12fb=['join','view\x20engine','pug','use','json','10mb','urlencoded','DEV_MODE','options','initialize','session','SAMEORIGIN','user','static','public','./app/models','./app/routes','./app/controllers','./config/passport','usersModel','setSequelize','get','/api/syncftp','/api/downloadFtp','downloadFtp','/api/processFtp','processFtp','getPassCountingByDay','/api/getPassCountingByHour/:direction','getPassCountingByHour','trust\x20proxy','__importDefault','__esModule','__importStar','hasOwnProperty','call','defineProperty','express','compression','body-parser','./util/logger','lusca','path','passport','express-validator','cors','express-rate-limit','express-slow-down','default','existsSync','debug','config','.env','.env.example','./controllers/api','set','port','env','PORT','views'];(function(_0xecb4ee,_0x1b64d7){var _0x3231db=function(_0x183573){while(--_0x183573){_0xecb4ee['push'](_0xecb4ee['shift']());}};_0x3231db(++_0x1b64d7);}(a185_0x12fb,0x97));var a185_0x2634=function(_0x3b285c,_0x172846){_0x3b285c=_0x3b285c-0x0;var _0x2fe2e7=a185_0x12fb[_0x3b285c];return _0x2fe2e7;};'use strict';var __importDefault=this&&this[a185_0x2634('0x0')]||function(_0x2badab){return _0x2badab&&_0x2badab[a185_0x2634('0x1')]?_0x2badab:{'default':_0x2badab};};var __importStar=this&&this[a185_0x2634('0x2')]||function(_0xeecfa7){if(_0xeecfa7&&_0xeecfa7[a185_0x2634('0x1')])return _0xeecfa7;var _0x5a6969={};if(_0xeecfa7!=null)for(var _0x330259 in _0xeecfa7)if(Object[a185_0x2634('0x3')][a185_0x2634('0x4')](_0xeecfa7,_0x330259))_0x5a6969[_0x330259]=_0xeecfa7[_0x330259];_0x5a6969['default']=_0xeecfa7;return _0x5a6969;};Object[a185_0x2634('0x5')](exports,a185_0x2634('0x1'),{'value':!![]});const express_1=__importDefault(require(a185_0x2634('0x6')));const compression_1=__importDefault(require(a185_0x2634('0x7')));const body_parser_1=__importDefault(require(a185_0x2634('0x8')));const logger_1=__importDefault(require(a185_0x2634('0x9')));const lusca_1=__importDefault(require(a185_0x2634('0xa')));const dotenv_1=__importDefault(require('dotenv'));const express_flash_1=__importDefault(require('express-flash'));const path_1=__importDefault(require(a185_0x2634('0xb')));const passport_1=__importDefault(require(a185_0x2634('0xc')));const express_validator_1=__importDefault(require(a185_0x2634('0xd')));const fs_1=__importDefault(require('fs'));const cors=require(a185_0x2634('0xe'));const rateLimit=require(a185_0x2634('0xf'));const slowDown=require(a185_0x2634('0x10'));if(fs_1[a185_0x2634('0x11')][a185_0x2634('0x12')]('.env')){logger_1[a185_0x2634('0x11')][a185_0x2634('0x13')]('Using\x20.env\x20file\x20to\x20supply\x20config\x20environment\x20variables');dotenv_1[a185_0x2634('0x11')][a185_0x2634('0x14')]({'path':a185_0x2634('0x15')});}else{logger_1[a185_0x2634('0x11')]['debug']('Using\x20.env.example\x20file\x20to\x20supply\x20config\x20environment\x20variables');dotenv_1['default'][a185_0x2634('0x14')]({'path':a185_0x2634('0x16')});}const apiController=__importStar(require(a185_0x2634('0x17')));const app=express_1[a185_0x2634('0x11')]();app[a185_0x2634('0x18')](a185_0x2634('0x19'),process[a185_0x2634('0x1a')][a185_0x2634('0x1b')]||0xbb8);app[a185_0x2634('0x18')](a185_0x2634('0x1c'),path_1[a185_0x2634('0x11')][a185_0x2634('0x1d')](__dirname,'../views'));app['set'](a185_0x2634('0x1e'),a185_0x2634('0x1f'));app['use'](compression_1['default']());app[a185_0x2634('0x20')](body_parser_1[a185_0x2634('0x11')][a185_0x2634('0x21')]({'limit':a185_0x2634('0x22')}));app[a185_0x2634('0x20')](body_parser_1['default'][a185_0x2634('0x23')]({'limit':'10mb','extended':!![]}));if(process[a185_0x2634('0x1a')][a185_0x2634('0x24')]){app[a185_0x2634('0x20')](cors());app[a185_0x2634('0x20')](cors({'origin':!![]}));app[a185_0x2634('0x25')]('*',cors());}else{app['use'](cors());}app['use'](express_validator_1[a185_0x2634('0x11')]());app['use'](passport_1['default'][a185_0x2634('0x26')]());app[a185_0x2634('0x20')](passport_1['default'][a185_0x2634('0x27')]());app[a185_0x2634('0x20')](express_flash_1[a185_0x2634('0x11')]());app[a185_0x2634('0x20')](lusca_1[a185_0x2634('0x11')]['xframe'](a185_0x2634('0x28')));app['use'](lusca_1[a185_0x2634('0x11')]['xssProtection'](!![]));app['use']((_0x51fe9f,_0x5b8c86,_0xf04ba3)=>{_0x5b8c86['locals'][a185_0x2634('0x29')]=_0x51fe9f[a185_0x2634('0x29')];_0xf04ba3();});app[a185_0x2634('0x20')]((_0x19ad73,_0x3a8c3e,_0x1a4bc0)=>{_0x1a4bc0();});app[a185_0x2634('0x20')](express_1[a185_0x2634('0x11')][a185_0x2634('0x2a')](path_1[a185_0x2634('0x11')][a185_0x2634('0x1d')](__dirname,a185_0x2634('0x2b')),{'maxAge':0x758fac300}));const sequelize_1=__importDefault(require('./config/sequelize'));const models_1=__importDefault(require(a185_0x2634('0x2c')));const routes_1=__importDefault(require(a185_0x2634('0x2d')));const controllers_1=__importDefault(require(a185_0x2634('0x2e')));const models=new models_1[(a185_0x2634('0x11'))](sequelize_1['default']);const controllers=new controllers_1[(a185_0x2634('0x11'))](models);routes_1[a185_0x2634('0x11')](app,passport_1['default'],models,controllers);require(a185_0x2634('0x2f'))(passport_1[a185_0x2634('0x11')],models[a185_0x2634('0x30')]);apiController[a185_0x2634('0x31')](sequelize_1[a185_0x2634('0x11')]);app[a185_0x2634('0x32')](a185_0x2634('0x33'),apiController['syncFtp']);app[a185_0x2634('0x32')](a185_0x2634('0x34'),apiController[a185_0x2634('0x35')]);app[a185_0x2634('0x32')](a185_0x2634('0x36'),apiController[a185_0x2634('0x37')]);app[a185_0x2634('0x32')]('/api/getPassCounting/:direction',apiController['getPassCounting']);app[a185_0x2634('0x32')]('/api/getPassCountingByDay/:direction',apiController[a185_0x2634('0x38')]);app[a185_0x2634('0x32')](a185_0x2634('0x39'),apiController[a185_0x2634('0x3a')]);const limiter=rateLimit({'windowMs':0x2*0x3c*0x3e8,'max':0x64});app[a185_0x2634('0x20')](limiter);app['enable'](a185_0x2634('0x3b'));const speedLimiter=slowDown({'windowMs':0x2*0x3c*0x3e8,'delayAfter':0x64,'delayMs':0x1f4});app[a185_0x2634('0x20')](speedLimiter);exports['default']=app;
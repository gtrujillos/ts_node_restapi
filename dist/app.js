var a283_0x1fc2=['port','views','join','../views','pug','use','json','10mb','env','DEV_MODE','session','xframe','xssProtection','locals','user','static','public','./config/sequelize','./app/models','./app/routes','./app/controllers','./config/passport','usersModel','get','/api/syncftp','syncFtp','/api/downloadFtp','downloadFtp','/api/getPassCounting/:direction','/api/getPassCountingByDay/:direction','/api/getPassCountingByHour/:direction','getPassCountingByHour','enable','__importDefault','__esModule','__importStar','hasOwnProperty','call','default','defineProperty','compression','body-parser','lusca','dotenv','express-flash','path','passport','express-validator','cors','express-slow-down','existsSync','.env','debug','Using\x20.env\x20file\x20to\x20supply\x20config\x20environment\x20variables','config','.env.example','set'];(function(_0x2d0b0c,_0xac8737){var _0xee0d2a=function(_0x50a9e0){while(--_0x50a9e0){_0x2d0b0c['push'](_0x2d0b0c['shift']());}};_0xee0d2a(++_0xac8737);}(a283_0x1fc2,0x177));var a283_0x26c3=function(_0x3f39b4,_0x1d2979){_0x3f39b4=_0x3f39b4-0x0;var _0x467cb1=a283_0x1fc2[_0x3f39b4];return _0x467cb1;};'use strict';var __importDefault=this&&this[a283_0x26c3('0x0')]||function(_0x298fdc){return _0x298fdc&&_0x298fdc[a283_0x26c3('0x1')]?_0x298fdc:{'default':_0x298fdc};};var __importStar=this&&this[a283_0x26c3('0x2')]||function(_0x486458){if(_0x486458&&_0x486458[a283_0x26c3('0x1')])return _0x486458;var _0x373062={};if(_0x486458!=null)for(var _0x19f1eb in _0x486458)if(Object[a283_0x26c3('0x3')][a283_0x26c3('0x4')](_0x486458,_0x19f1eb))_0x373062[_0x19f1eb]=_0x486458[_0x19f1eb];_0x373062[a283_0x26c3('0x5')]=_0x486458;return _0x373062;};Object[a283_0x26c3('0x6')](exports,'__esModule',{'value':!![]});const express_1=__importDefault(require('express'));const compression_1=__importDefault(require(a283_0x26c3('0x7')));const body_parser_1=__importDefault(require(a283_0x26c3('0x8')));const logger_1=__importDefault(require('./util/logger'));const lusca_1=__importDefault(require(a283_0x26c3('0x9')));const dotenv_1=__importDefault(require(a283_0x26c3('0xa')));const express_flash_1=__importDefault(require(a283_0x26c3('0xb')));const path_1=__importDefault(require(a283_0x26c3('0xc')));const passport_1=__importDefault(require(a283_0x26c3('0xd')));const express_validator_1=__importDefault(require(a283_0x26c3('0xe')));const fs_1=__importDefault(require('fs'));const cors=require(a283_0x26c3('0xf'));const rateLimit=require('express-rate-limit');const slowDown=require(a283_0x26c3('0x10'));if(fs_1[a283_0x26c3('0x5')][a283_0x26c3('0x11')](a283_0x26c3('0x12'))){logger_1[a283_0x26c3('0x5')][a283_0x26c3('0x13')](a283_0x26c3('0x14'));dotenv_1[a283_0x26c3('0x5')][a283_0x26c3('0x15')]({'path':'.env'});}else{logger_1[a283_0x26c3('0x5')]['debug']('Using\x20.env.example\x20file\x20to\x20supply\x20config\x20environment\x20variables');dotenv_1['default']['config']({'path':a283_0x26c3('0x16')});}const apiController=__importStar(require('./controllers/api'));const app=express_1[a283_0x26c3('0x5')]();app[a283_0x26c3('0x17')](a283_0x26c3('0x18'),process['env']['PORT']||0xbb8);app[a283_0x26c3('0x17')](a283_0x26c3('0x19'),path_1[a283_0x26c3('0x5')][a283_0x26c3('0x1a')](__dirname,a283_0x26c3('0x1b')));app[a283_0x26c3('0x17')]('view\x20engine',a283_0x26c3('0x1c'));app[a283_0x26c3('0x1d')](compression_1[a283_0x26c3('0x5')]());app['use'](body_parser_1[a283_0x26c3('0x5')][a283_0x26c3('0x1e')]({'limit':'10mb'}));app[a283_0x26c3('0x1d')](body_parser_1['default']['urlencoded']({'limit':a283_0x26c3('0x1f'),'extended':!![]}));if(process[a283_0x26c3('0x20')][a283_0x26c3('0x21')]){app[a283_0x26c3('0x1d')](cors());app[a283_0x26c3('0x1d')](cors({'origin':!![]}));app['options']('*',cors());}else{app[a283_0x26c3('0x1d')](cors());}app[a283_0x26c3('0x1d')](express_validator_1[a283_0x26c3('0x5')]());app[a283_0x26c3('0x1d')](passport_1[a283_0x26c3('0x5')]['initialize']());app[a283_0x26c3('0x1d')](passport_1['default'][a283_0x26c3('0x22')]());app['use'](express_flash_1[a283_0x26c3('0x5')]());app[a283_0x26c3('0x1d')](lusca_1[a283_0x26c3('0x5')][a283_0x26c3('0x23')]('SAMEORIGIN'));app['use'](lusca_1['default'][a283_0x26c3('0x24')](!![]));app[a283_0x26c3('0x1d')]((_0x3af8bc,_0x1949fe,_0x48d529)=>{_0x1949fe[a283_0x26c3('0x25')][a283_0x26c3('0x26')]=_0x3af8bc[a283_0x26c3('0x26')];_0x48d529();});app[a283_0x26c3('0x1d')]((_0x459ff6,_0x54445b,_0xc5fed3)=>{_0xc5fed3();});app[a283_0x26c3('0x1d')](express_1[a283_0x26c3('0x5')][a283_0x26c3('0x27')](path_1[a283_0x26c3('0x5')][a283_0x26c3('0x1a')](__dirname,a283_0x26c3('0x28')),{'maxAge':0x758fac300}));const sequelize_1=__importDefault(require(a283_0x26c3('0x29')));const models_1=__importDefault(require(a283_0x26c3('0x2a')));const routes_1=__importDefault(require(a283_0x26c3('0x2b')));const controllers_1=__importDefault(require(a283_0x26c3('0x2c')));const models=new models_1[(a283_0x26c3('0x5'))](sequelize_1[a283_0x26c3('0x5')]);const controllers=new controllers_1[(a283_0x26c3('0x5'))](models);routes_1[a283_0x26c3('0x5')](app,passport_1[a283_0x26c3('0x5')],models,controllers);require(a283_0x26c3('0x2d'))(passport_1[a283_0x26c3('0x5')],models[a283_0x26c3('0x2e')]);apiController['setSequelize'](sequelize_1['default']);app[a283_0x26c3('0x2f')](a283_0x26c3('0x30'),apiController[a283_0x26c3('0x31')]);app[a283_0x26c3('0x2f')](a283_0x26c3('0x32'),apiController[a283_0x26c3('0x33')]);app[a283_0x26c3('0x2f')]('/api/processFtp',apiController['processFtp']);app[a283_0x26c3('0x2f')](a283_0x26c3('0x34'),apiController['getPassCounting']);app[a283_0x26c3('0x2f')](a283_0x26c3('0x35'),apiController['getPassCountingByDay']);app[a283_0x26c3('0x2f')](a283_0x26c3('0x36'),apiController[a283_0x26c3('0x37')]);const limiter=rateLimit({'windowMs':0x2*0x3c*0x3e8,'max':0x64});app[a283_0x26c3('0x1d')](limiter);app[a283_0x26c3('0x38')]('trust\x20proxy');const speedLimiter=slowDown({'windowMs':0x2*0x3c*0x3e8,'delayAfter':0x64,'delayMs':0x1f4});app[a283_0x26c3('0x1d')](speedLimiter);exports['default']=app;
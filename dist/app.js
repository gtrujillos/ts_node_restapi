var a104_0x4cb6=['passport','express-validator','cors','express-rate-limit','express-slow-down','existsSync','debug','Using\x20.env\x20file\x20to\x20supply\x20config\x20environment\x20variables','config','.env.example','./controllers/api','set','port','PORT','views','join','../views','view\x20engine','pug','use','json','10mb','urlencoded','options','session','xframe','SAMEORIGIN','xssProtection','locals','user','static','public','./config/sequelize','./app/models','./app/routes','./app/controllers','./config/passport','usersModel','setSequelize','get','/api/syncftp','/api/downloadFtp','downloadFtp','processFtp','/api/getPassCounting/:direction','getPassCounting','/api/getPassCountingByDay/:direction','getPassCountingByDay','getPassCountingByHour','enable','__esModule','__importStar','hasOwnProperty','call','default','express','compression','body-parser','./util/logger','lusca','dotenv'];(function(_0x30abed,_0x402845){var _0x28f9c5=function(_0x50411a){while(--_0x50411a){_0x30abed['push'](_0x30abed['shift']());}};_0x28f9c5(++_0x402845);}(a104_0x4cb6,0xac));var a104_0xcd56=function(_0x56f262,_0x1508f2){_0x56f262=_0x56f262-0x0;var _0x5e764b=a104_0x4cb6[_0x56f262];return _0x5e764b;};'use strict';var __importDefault=this&&this['__importDefault']||function(_0x16cbab){return _0x16cbab&&_0x16cbab[a104_0xcd56('0x0')]?_0x16cbab:{'default':_0x16cbab};};var __importStar=this&&this[a104_0xcd56('0x1')]||function(_0x2a1f38){if(_0x2a1f38&&_0x2a1f38['__esModule'])return _0x2a1f38;var _0x51aff3={};if(_0x2a1f38!=null)for(var _0x57ec10 in _0x2a1f38)if(Object[a104_0xcd56('0x2')][a104_0xcd56('0x3')](_0x2a1f38,_0x57ec10))_0x51aff3[_0x57ec10]=_0x2a1f38[_0x57ec10];_0x51aff3[a104_0xcd56('0x4')]=_0x2a1f38;return _0x51aff3;};Object['defineProperty'](exports,'__esModule',{'value':!![]});const express_1=__importDefault(require(a104_0xcd56('0x5')));const compression_1=__importDefault(require(a104_0xcd56('0x6')));const body_parser_1=__importDefault(require(a104_0xcd56('0x7')));const logger_1=__importDefault(require(a104_0xcd56('0x8')));const lusca_1=__importDefault(require(a104_0xcd56('0x9')));const dotenv_1=__importDefault(require(a104_0xcd56('0xa')));const express_flash_1=__importDefault(require('express-flash'));const path_1=__importDefault(require('path'));const passport_1=__importDefault(require(a104_0xcd56('0xb')));const express_validator_1=__importDefault(require(a104_0xcd56('0xc')));const fs_1=__importDefault(require('fs'));const cors=require(a104_0xcd56('0xd'));const rateLimit=require(a104_0xcd56('0xe'));const slowDown=require(a104_0xcd56('0xf'));if(fs_1['default'][a104_0xcd56('0x10')]('.env')){logger_1[a104_0xcd56('0x4')][a104_0xcd56('0x11')](a104_0xcd56('0x12'));dotenv_1[a104_0xcd56('0x4')]['config']({'path':'.env'});}else{logger_1[a104_0xcd56('0x4')][a104_0xcd56('0x11')]('Using\x20.env.example\x20file\x20to\x20supply\x20config\x20environment\x20variables');dotenv_1[a104_0xcd56('0x4')][a104_0xcd56('0x13')]({'path':a104_0xcd56('0x14')});}const apiController=__importStar(require(a104_0xcd56('0x15')));const app=express_1[a104_0xcd56('0x4')]();app[a104_0xcd56('0x16')](a104_0xcd56('0x17'),process['env'][a104_0xcd56('0x18')]||0xbb8);app[a104_0xcd56('0x16')](a104_0xcd56('0x19'),path_1[a104_0xcd56('0x4')][a104_0xcd56('0x1a')](__dirname,a104_0xcd56('0x1b')));app[a104_0xcd56('0x16')](a104_0xcd56('0x1c'),a104_0xcd56('0x1d'));app[a104_0xcd56('0x1e')](compression_1[a104_0xcd56('0x4')]());app[a104_0xcd56('0x1e')](body_parser_1[a104_0xcd56('0x4')][a104_0xcd56('0x1f')]({'limit':a104_0xcd56('0x20')}));app['use'](body_parser_1[a104_0xcd56('0x4')][a104_0xcd56('0x21')]({'limit':a104_0xcd56('0x20'),'extended':!![]}));if(process['env']['DEV_MODE']){app['use'](cors());app[a104_0xcd56('0x1e')](cors({'origin':!![]}));app[a104_0xcd56('0x22')]('*',cors());}else{app[a104_0xcd56('0x1e')](cors());}app['use'](express_validator_1['default']());app[a104_0xcd56('0x1e')](passport_1[a104_0xcd56('0x4')]['initialize']());app[a104_0xcd56('0x1e')](passport_1[a104_0xcd56('0x4')][a104_0xcd56('0x23')]());app[a104_0xcd56('0x1e')](express_flash_1[a104_0xcd56('0x4')]());app[a104_0xcd56('0x1e')](lusca_1[a104_0xcd56('0x4')][a104_0xcd56('0x24')](a104_0xcd56('0x25')));app['use'](lusca_1['default'][a104_0xcd56('0x26')](!![]));app['use']((_0x248745,_0x14fdcd,_0xf4d853)=>{_0x14fdcd[a104_0xcd56('0x27')][a104_0xcd56('0x28')]=_0x248745[a104_0xcd56('0x28')];_0xf4d853();});app[a104_0xcd56('0x1e')]((_0x35077e,_0x17dd3a,_0x32c832)=>{_0x32c832();});app[a104_0xcd56('0x1e')](express_1[a104_0xcd56('0x4')][a104_0xcd56('0x29')](path_1['default']['join'](__dirname,a104_0xcd56('0x2a')),{'maxAge':0x758fac300}));const sequelize_1=__importDefault(require(a104_0xcd56('0x2b')));const models_1=__importDefault(require(a104_0xcd56('0x2c')));const routes_1=__importDefault(require(a104_0xcd56('0x2d')));const controllers_1=__importDefault(require(a104_0xcd56('0x2e')));const models=new models_1[(a104_0xcd56('0x4'))](sequelize_1[a104_0xcd56('0x4')]);const controllers=new controllers_1[(a104_0xcd56('0x4'))](models);routes_1[a104_0xcd56('0x4')](app,passport_1[a104_0xcd56('0x4')],models,controllers);require(a104_0xcd56('0x2f'))(passport_1[a104_0xcd56('0x4')],models[a104_0xcd56('0x30')]);apiController[a104_0xcd56('0x31')](sequelize_1['default']);app[a104_0xcd56('0x32')](a104_0xcd56('0x33'),apiController['syncFtp']);app['get'](a104_0xcd56('0x34'),apiController[a104_0xcd56('0x35')]);app[a104_0xcd56('0x32')]('/api/processFtp',apiController[a104_0xcd56('0x36')]);app[a104_0xcd56('0x32')](a104_0xcd56('0x37'),apiController[a104_0xcd56('0x38')]);app[a104_0xcd56('0x32')](a104_0xcd56('0x39'),apiController[a104_0xcd56('0x3a')]);app[a104_0xcd56('0x32')]('/api/getPassCountingByHour/:direction',apiController[a104_0xcd56('0x3b')]);const limiter=rateLimit({'windowMs':0x2*0x3c*0x3e8,'max':0x64});app[a104_0xcd56('0x1e')](limiter);app[a104_0xcd56('0x3c')]('trust\x20proxy');const speedLimiter=slowDown({'windowMs':0x2*0x3c*0x3e8,'delayAfter':0x64,'delayMs':0x1f4});app[a104_0xcd56('0x1e')](speedLimiter);exports[a104_0xcd56('0x4')]=app;